(function(){const Et=document.createElement("link").relList;if(Et&&Et.supports&&Et.supports("modulepreload"))return;for(const _t of document.querySelectorAll('link[rel="modulepreload"]'))ue(_t);new MutationObserver(_t=>{for(const Mt of _t)if(Mt.type==="childList")for(const O of Mt.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&ue(O)}).observe(document,{childList:!0,subtree:!0});function Tt(_t){const Mt={};return _t.integrity&&(Mt.integrity=_t.integrity),_t.referrerPolicy&&(Mt.referrerPolicy=_t.referrerPolicy),_t.crossOrigin==="use-credentials"?Mt.credentials="include":_t.crossOrigin==="anonymous"?Mt.credentials="omit":Mt.credentials="same-origin",Mt}function ue(_t){if(_t.ep)return;_t.ep=!0;const Mt=Tt(_t);fetch(_t.href,Mt)}})();function kp(Ce){return Ce&&Ce.__esModule&&Object.prototype.hasOwnProperty.call(Ce,"default")?Ce.default:Ce}var Tp={exports:{}},af={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jp;function cm(){if(jp)return af;jp=1;var Ce=Symbol.for("react.transitional.element"),Et=Symbol.for("react.fragment");function Tt(ue,_t,Mt){var O=null;if(Mt!==void 0&&(O=""+Mt),_t.key!==void 0&&(O=""+_t.key),"key"in _t){Mt={};for(var y in _t)y!=="key"&&(Mt[y]=_t[y])}else Mt=_t;return _t=Mt.ref,{$$typeof:Ce,type:ue,key:O,ref:_t!==void 0?_t:null,props:Mt}}return af.Fragment=Et,af.jsx=Tt,af.jsxs=Tt,af}var Up;function hm(){return Up||(Up=1,Tp.exports=cm()),Tp.exports}var Te=hm(),Ap={exports:{}},ai={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vp;function dm(){if(Vp)return ai;Vp=1;var Ce=Symbol.for("react.transitional.element"),Et=Symbol.for("react.portal"),Tt=Symbol.for("react.fragment"),ue=Symbol.for("react.strict_mode"),_t=Symbol.for("react.profiler"),Mt=Symbol.for("react.consumer"),O=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),Ue=Symbol.for("react.suspense"),Ee=Symbol.for("react.memo"),ht=Symbol.for("react.lazy"),me=Symbol.for("react.activity"),pe=Symbol.iterator;function Ii(Q){return Q===null||typeof Q!="object"?null:(Q=pe&&Q[pe]||Q["@@iterator"],typeof Q=="function"?Q:null)}var ki={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ti=Object.assign,Ut={};function Ct(Q,be,qe){this.props=Q,this.context=be,this.refs=Ut,this.updater=qe||ki}Ct.prototype.isReactComponent={},Ct.prototype.setState=function(Q,be){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,be,"setState")},Ct.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function qt(){}qt.prototype=Ct.prototype;function dt(Q,be,qe){this.props=Q,this.context=be,this.refs=Ut,this.updater=qe||ki}var ft=dt.prototype=new qt;ft.constructor=dt,ti(ft,Ct.prototype),ft.isPureReactComponent=!0;var Ht=Array.isArray;function Zt(){}var ot={H:null,A:null,T:null,S:null},ni=Object.prototype.hasOwnProperty;function vi(Q,be,qe){var et=qe.ref;return{$$typeof:Ce,type:Q,key:be,ref:et!==void 0?et:null,props:qe}}function Si(Q,be){return vi(Q.type,be,Q.props)}function Pt(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===Ce}function Vi(Q){var be={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(qe){return be[qe]})}var Ti=/\/+/g;function li(Q,be){return typeof Q=="object"&&Q!==null&&Q.key!=null?Vi(""+Q.key):be.toString(36)}function mt(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(Zt,Zt):(Q.status="pending",Q.then(function(be){Q.status==="pending"&&(Q.status="fulfilled",Q.value=be)},function(be){Q.status==="pending"&&(Q.status="rejected",Q.reason=be)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function ge(Q,be,qe,et,lt){var Lt=typeof Q;(Lt==="undefined"||Lt==="boolean")&&(Q=null);var Ot=!1;if(Q===null)Ot=!0;else switch(Lt){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(Q.$$typeof){case Ce:case Et:Ot=!0;break;case ht:return Ot=Q._init,ge(Ot(Q._payload),be,qe,et,lt)}}if(Ot)return lt=lt(Q),Ot=et===""?"."+li(Q,0):et,Ht(lt)?(qe="",Ot!=null&&(qe=Ot.replace(Ti,"$&/")+"/"),ge(lt,be,qe,"",function(rr){return rr})):lt!=null&&(Pt(lt)&&(lt=Si(lt,qe+(lt.key==null||Q&&Q.key===lt.key?"":(""+lt.key).replace(Ti,"$&/")+"/")+Ot)),be.push(lt)),1;Ot=0;var qi=et===""?".":et+":";if(Ht(Q))for(var Ai=0;Ai<Q.length;Ai++)et=Q[Ai],Lt=qi+li(et,Ai),Ot+=ge(et,be,qe,Lt,lt);else if(Ai=Ii(Q),typeof Ai=="function")for(Q=Ai.call(Q),Ai=0;!(et=Q.next()).done;)et=et.value,Lt=qi+li(et,Ai++),Ot+=ge(et,be,qe,Lt,lt);else if(Lt==="object"){if(typeof Q.then=="function")return ge(mt(Q),be,qe,et,lt);throw be=String(Q),Error("Objects are not valid as a React child (found: "+(be==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":be)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function He(Q,be,qe){if(Q==null)return Q;var et=[],lt=0;return ge(Q,et,"","",function(Lt){return be.call(qe,Lt,lt++)}),et}function gt(Q){if(Q._status===-1){var be=Q._result;be=be(),be.then(function(qe){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=qe)},function(qe){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=qe)}),Q._status===-1&&(Q._status=0,Q._result=be)}if(Q._status===1)return Q._result.default;throw Q._result}var Ne=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var be=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(be))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},nt={map:He,forEach:function(Q,be,qe){He(Q,function(){be.apply(this,arguments)},qe)},count:function(Q){var be=0;return He(Q,function(){be++}),be},toArray:function(Q){return He(Q,function(be){return be})||[]},only:function(Q){if(!Pt(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return ai.Activity=me,ai.Children=nt,ai.Component=Ct,ai.Fragment=Tt,ai.Profiler=_t,ai.PureComponent=dt,ai.StrictMode=ue,ai.Suspense=Ue,ai.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ot,ai.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return ot.H.useMemoCache(Q)}},ai.cache=function(Q){return function(){return Q.apply(null,arguments)}},ai.cacheSignal=function(){return null},ai.cloneElement=function(Q,be,qe){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var et=ti({},Q.props),lt=Q.key;if(be!=null)for(Lt in be.key!==void 0&&(lt=""+be.key),be)!ni.call(be,Lt)||Lt==="key"||Lt==="__self"||Lt==="__source"||Lt==="ref"&&be.ref===void 0||(et[Lt]=be[Lt]);var Lt=arguments.length-2;if(Lt===1)et.children=qe;else if(1<Lt){for(var Ot=Array(Lt),qi=0;qi<Lt;qi++)Ot[qi]=arguments[qi+2];et.children=Ot}return vi(Q.type,lt,et)},ai.createContext=function(Q){return Q={$$typeof:O,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:Mt,_context:Q},Q},ai.createElement=function(Q,be,qe){var et,lt={},Lt=null;if(be!=null)for(et in be.key!==void 0&&(Lt=""+be.key),be)ni.call(be,et)&&et!=="key"&&et!=="__self"&&et!=="__source"&&(lt[et]=be[et]);var Ot=arguments.length-2;if(Ot===1)lt.children=qe;else if(1<Ot){for(var qi=Array(Ot),Ai=0;Ai<Ot;Ai++)qi[Ai]=arguments[Ai+2];lt.children=qi}if(Q&&Q.defaultProps)for(et in Ot=Q.defaultProps,Ot)lt[et]===void 0&&(lt[et]=Ot[et]);return vi(Q,Lt,lt)},ai.createRef=function(){return{current:null}},ai.forwardRef=function(Q){return{$$typeof:y,render:Q}},ai.isValidElement=Pt,ai.lazy=function(Q){return{$$typeof:ht,_payload:{_status:-1,_result:Q},_init:gt}},ai.memo=function(Q,be){return{$$typeof:Ee,type:Q,compare:be===void 0?null:be}},ai.startTransition=function(Q){var be=ot.T,qe={};ot.T=qe;try{var et=Q(),lt=ot.S;lt!==null&&lt(qe,et),typeof et=="object"&&et!==null&&typeof et.then=="function"&&et.then(Zt,Ne)}catch(Lt){Ne(Lt)}finally{be!==null&&qe.types!==null&&(be.types=qe.types),ot.T=be}},ai.unstable_useCacheRefresh=function(){return ot.H.useCacheRefresh()},ai.use=function(Q){return ot.H.use(Q)},ai.useActionState=function(Q,be,qe){return ot.H.useActionState(Q,be,qe)},ai.useCallback=function(Q,be){return ot.H.useCallback(Q,be)},ai.useContext=function(Q){return ot.H.useContext(Q)},ai.useDebugValue=function(){},ai.useDeferredValue=function(Q,be){return ot.H.useDeferredValue(Q,be)},ai.useEffect=function(Q,be){return ot.H.useEffect(Q,be)},ai.useEffectEvent=function(Q){return ot.H.useEffectEvent(Q)},ai.useId=function(){return ot.H.useId()},ai.useImperativeHandle=function(Q,be,qe){return ot.H.useImperativeHandle(Q,be,qe)},ai.useInsertionEffect=function(Q,be){return ot.H.useInsertionEffect(Q,be)},ai.useLayoutEffect=function(Q,be){return ot.H.useLayoutEffect(Q,be)},ai.useMemo=function(Q,be){return ot.H.useMemo(Q,be)},ai.useOptimistic=function(Q,be){return ot.H.useOptimistic(Q,be)},ai.useReducer=function(Q,be,qe){return ot.H.useReducer(Q,be,qe)},ai.useRef=function(Q){return ot.H.useRef(Q)},ai.useState=function(Q){return ot.H.useState(Q)},ai.useSyncExternalStore=function(Q,be,qe){return ot.H.useSyncExternalStore(Q,be,qe)},ai.useTransition=function(){return ot.H.useTransition()},ai.version="19.2.0",ai}var qp;function Rp(){return qp||(qp=1,Ap.exports=dm()),Ap.exports}var oi=Rp();const tm=kp(oi);var zp={exports:{}},nf={},Ep={exports:{}},Mp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zp;function fm(){return Zp||(Zp=1,(function(Ce){function Et(ge,He){var gt=ge.length;ge.push(He);e:for(;0<gt;){var Ne=gt-1>>>1,nt=ge[Ne];if(0<_t(nt,He))ge[Ne]=He,ge[gt]=nt,gt=Ne;else break e}}function Tt(ge){return ge.length===0?null:ge[0]}function ue(ge){if(ge.length===0)return null;var He=ge[0],gt=ge.pop();if(gt!==He){ge[0]=gt;e:for(var Ne=0,nt=ge.length,Q=nt>>>1;Ne<Q;){var be=2*(Ne+1)-1,qe=ge[be],et=be+1,lt=ge[et];if(0>_t(qe,gt))et<nt&&0>_t(lt,qe)?(ge[Ne]=lt,ge[et]=gt,Ne=et):(ge[Ne]=qe,ge[be]=gt,Ne=be);else if(et<nt&&0>_t(lt,gt))ge[Ne]=lt,ge[et]=gt,Ne=et;else break e}}return He}function _t(ge,He){var gt=ge.sortIndex-He.sortIndex;return gt!==0?gt:ge.id-He.id}if(Ce.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var Mt=performance;Ce.unstable_now=function(){return Mt.now()}}else{var O=Date,y=O.now();Ce.unstable_now=function(){return O.now()-y}}var Ue=[],Ee=[],ht=1,me=null,pe=3,Ii=!1,ki=!1,ti=!1,Ut=!1,Ct=typeof setTimeout=="function"?setTimeout:null,qt=typeof clearTimeout=="function"?clearTimeout:null,dt=typeof setImmediate<"u"?setImmediate:null;function ft(ge){for(var He=Tt(Ee);He!==null;){if(He.callback===null)ue(Ee);else if(He.startTime<=ge)ue(Ee),He.sortIndex=He.expirationTime,Et(Ue,He);else break;He=Tt(Ee)}}function Ht(ge){if(ti=!1,ft(ge),!ki)if(Tt(Ue)!==null)ki=!0,Zt||(Zt=!0,Vi());else{var He=Tt(Ee);He!==null&&mt(Ht,He.startTime-ge)}}var Zt=!1,ot=-1,ni=5,vi=-1;function Si(){return Ut?!0:!(Ce.unstable_now()-vi<ni)}function Pt(){if(Ut=!1,Zt){var ge=Ce.unstable_now();vi=ge;var He=!0;try{e:{ki=!1,ti&&(ti=!1,qt(ot),ot=-1),Ii=!0;var gt=pe;try{t:{for(ft(ge),me=Tt(Ue);me!==null&&!(me.expirationTime>ge&&Si());){var Ne=me.callback;if(typeof Ne=="function"){me.callback=null,pe=me.priorityLevel;var nt=Ne(me.expirationTime<=ge);if(ge=Ce.unstable_now(),typeof nt=="function"){me.callback=nt,ft(ge),He=!0;break t}me===Tt(Ue)&&ue(Ue),ft(ge)}else ue(Ue);me=Tt(Ue)}if(me!==null)He=!0;else{var Q=Tt(Ee);Q!==null&&mt(Ht,Q.startTime-ge),He=!1}}break e}finally{me=null,pe=gt,Ii=!1}He=void 0}}finally{He?Vi():Zt=!1}}}var Vi;if(typeof dt=="function")Vi=function(){dt(Pt)};else if(typeof MessageChannel<"u"){var Ti=new MessageChannel,li=Ti.port2;Ti.port1.onmessage=Pt,Vi=function(){li.postMessage(null)}}else Vi=function(){Ct(Pt,0)};function mt(ge,He){ot=Ct(function(){ge(Ce.unstable_now())},He)}Ce.unstable_IdlePriority=5,Ce.unstable_ImmediatePriority=1,Ce.unstable_LowPriority=4,Ce.unstable_NormalPriority=3,Ce.unstable_Profiling=null,Ce.unstable_UserBlockingPriority=2,Ce.unstable_cancelCallback=function(ge){ge.callback=null},Ce.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ni=0<ge?Math.floor(1e3/ge):5},Ce.unstable_getCurrentPriorityLevel=function(){return pe},Ce.unstable_next=function(ge){switch(pe){case 1:case 2:case 3:var He=3;break;default:He=pe}var gt=pe;pe=He;try{return ge()}finally{pe=gt}},Ce.unstable_requestPaint=function(){Ut=!0},Ce.unstable_runWithPriority=function(ge,He){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var gt=pe;pe=ge;try{return He()}finally{pe=gt}},Ce.unstable_scheduleCallback=function(ge,He,gt){var Ne=Ce.unstable_now();switch(typeof gt=="object"&&gt!==null?(gt=gt.delay,gt=typeof gt=="number"&&0<gt?Ne+gt:Ne):gt=Ne,ge){case 1:var nt=-1;break;case 2:nt=250;break;case 5:nt=1073741823;break;case 4:nt=1e4;break;default:nt=5e3}return nt=gt+nt,ge={id:ht++,callback:He,priorityLevel:ge,startTime:gt,expirationTime:nt,sortIndex:-1},gt>Ne?(ge.sortIndex=gt,Et(Ee,ge),Tt(Ue)===null&&ge===Tt(Ee)&&(ti?(qt(ot),ot=-1):ti=!0,mt(Ht,gt-Ne))):(ge.sortIndex=nt,Et(Ue,ge),ki||Ii||(ki=!0,Zt||(Zt=!0,Vi()))),ge},Ce.unstable_shouldYield=Si,Ce.unstable_wrapCallback=function(ge){var He=pe;return function(){var gt=pe;pe=He;try{return ge.apply(this,arguments)}finally{pe=gt}}}})(Mp)),Mp}var Gp;function pm(){return Gp||(Gp=1,Ep.exports=fm()),Ep.exports}var Cp={exports:{}},nr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hp;function mm(){if(Hp)return nr;Hp=1;var Ce=Rp();function Et(Ue){var Ee="https://react.dev/errors/"+Ue;if(1<arguments.length){Ee+="?args[]="+encodeURIComponent(arguments[1]);for(var ht=2;ht<arguments.length;ht++)Ee+="&args[]="+encodeURIComponent(arguments[ht])}return"Minified React error #"+Ue+"; visit "+Ee+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Tt(){}var ue={d:{f:Tt,r:function(){throw Error(Et(522))},D:Tt,C:Tt,L:Tt,m:Tt,X:Tt,S:Tt,M:Tt},p:0,findDOMNode:null},_t=Symbol.for("react.portal");function Mt(Ue,Ee,ht){var me=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_t,key:me==null?null:""+me,children:Ue,containerInfo:Ee,implementation:ht}}var O=Ce.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function y(Ue,Ee){if(Ue==="font")return"";if(typeof Ee=="string")return Ee==="use-credentials"?Ee:""}return nr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ue,nr.createPortal=function(Ue,Ee){var ht=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ee||Ee.nodeType!==1&&Ee.nodeType!==9&&Ee.nodeType!==11)throw Error(Et(299));return Mt(Ue,Ee,null,ht)},nr.flushSync=function(Ue){var Ee=O.T,ht=ue.p;try{if(O.T=null,ue.p=2,Ue)return Ue()}finally{O.T=Ee,ue.p=ht,ue.d.f()}},nr.preconnect=function(Ue,Ee){typeof Ue=="string"&&(Ee?(Ee=Ee.crossOrigin,Ee=typeof Ee=="string"?Ee==="use-credentials"?Ee:"":void 0):Ee=null,ue.d.C(Ue,Ee))},nr.prefetchDNS=function(Ue){typeof Ue=="string"&&ue.d.D(Ue)},nr.preinit=function(Ue,Ee){if(typeof Ue=="string"&&Ee&&typeof Ee.as=="string"){var ht=Ee.as,me=y(ht,Ee.crossOrigin),pe=typeof Ee.integrity=="string"?Ee.integrity:void 0,Ii=typeof Ee.fetchPriority=="string"?Ee.fetchPriority:void 0;ht==="style"?ue.d.S(Ue,typeof Ee.precedence=="string"?Ee.precedence:void 0,{crossOrigin:me,integrity:pe,fetchPriority:Ii}):ht==="script"&&ue.d.X(Ue,{crossOrigin:me,integrity:pe,fetchPriority:Ii,nonce:typeof Ee.nonce=="string"?Ee.nonce:void 0})}},nr.preinitModule=function(Ue,Ee){if(typeof Ue=="string")if(typeof Ee=="object"&&Ee!==null){if(Ee.as==null||Ee.as==="script"){var ht=y(Ee.as,Ee.crossOrigin);ue.d.M(Ue,{crossOrigin:ht,integrity:typeof Ee.integrity=="string"?Ee.integrity:void 0,nonce:typeof Ee.nonce=="string"?Ee.nonce:void 0})}}else Ee==null&&ue.d.M(Ue)},nr.preload=function(Ue,Ee){if(typeof Ue=="string"&&typeof Ee=="object"&&Ee!==null&&typeof Ee.as=="string"){var ht=Ee.as,me=y(ht,Ee.crossOrigin);ue.d.L(Ue,ht,{crossOrigin:me,integrity:typeof Ee.integrity=="string"?Ee.integrity:void 0,nonce:typeof Ee.nonce=="string"?Ee.nonce:void 0,type:typeof Ee.type=="string"?Ee.type:void 0,fetchPriority:typeof Ee.fetchPriority=="string"?Ee.fetchPriority:void 0,referrerPolicy:typeof Ee.referrerPolicy=="string"?Ee.referrerPolicy:void 0,imageSrcSet:typeof Ee.imageSrcSet=="string"?Ee.imageSrcSet:void 0,imageSizes:typeof Ee.imageSizes=="string"?Ee.imageSizes:void 0,media:typeof Ee.media=="string"?Ee.media:void 0})}},nr.preloadModule=function(Ue,Ee){if(typeof Ue=="string")if(Ee){var ht=y(Ee.as,Ee.crossOrigin);ue.d.m(Ue,{as:typeof Ee.as=="string"&&Ee.as!=="script"?Ee.as:void 0,crossOrigin:ht,integrity:typeof Ee.integrity=="string"?Ee.integrity:void 0})}else ue.d.m(Ue)},nr.requestFormReset=function(Ue){ue.d.r(Ue)},nr.unstable_batchedUpdates=function(Ue,Ee){return Ue(Ee)},nr.useFormState=function(Ue,Ee,ht){return O.H.useFormState(Ue,Ee,ht)},nr.useFormStatus=function(){return O.H.useHostTransitionStatus()},nr.version="19.2.0",nr}var Xp;function gm(){if(Xp)return Cp.exports;Xp=1;function Ce(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ce)}catch(Et){console.error(Et)}}return Ce(),Cp.exports=mm(),Cp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $p;function ym(){if($p)return nf;$p=1;var Ce=pm(),Et=Rp(),Tt=gm();function ue(i){var n="https://react.dev/errors/"+i;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function _t(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Mt(i){var n=i,o=i;if(i.alternate)for(;n.return;)n=n.return;else{i=n;do n=i,(n.flags&4098)!==0&&(o=n.return),i=n.return;while(i)}return n.tag===3?o:null}function O(i){if(i.tag===13){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function y(i){if(i.tag===31){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function Ue(i){if(Mt(i)!==i)throw Error(ue(188))}function Ee(i){var n=i.alternate;if(!n){if(n=Mt(i),n===null)throw Error(ue(188));return n!==i?null:i}for(var o=i,d=n;;){var _=o.return;if(_===null)break;var w=_.alternate;if(w===null){if(d=_.return,d!==null){o=d;continue}break}if(_.child===w.child){for(w=_.child;w;){if(w===o)return Ue(_),i;if(w===d)return Ue(_),n;w=w.sibling}throw Error(ue(188))}if(o.return!==d.return)o=_,d=w;else{for(var C=!1,U=_.child;U;){if(U===o){C=!0,o=_,d=w;break}if(U===d){C=!0,d=_,o=w;break}U=U.sibling}if(!C){for(U=w.child;U;){if(U===o){C=!0,o=w,d=_;break}if(U===d){C=!0,d=w,o=_;break}U=U.sibling}if(!C)throw Error(ue(189))}}if(o.alternate!==d)throw Error(ue(190))}if(o.tag!==3)throw Error(ue(188));return o.stateNode.current===o?i:n}function ht(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i;for(i=i.child;i!==null;){if(n=ht(i),n!==null)return n;i=i.sibling}return null}var me=Object.assign,pe=Symbol.for("react.element"),Ii=Symbol.for("react.transitional.element"),ki=Symbol.for("react.portal"),ti=Symbol.for("react.fragment"),Ut=Symbol.for("react.strict_mode"),Ct=Symbol.for("react.profiler"),qt=Symbol.for("react.consumer"),dt=Symbol.for("react.context"),ft=Symbol.for("react.forward_ref"),Ht=Symbol.for("react.suspense"),Zt=Symbol.for("react.suspense_list"),ot=Symbol.for("react.memo"),ni=Symbol.for("react.lazy"),vi=Symbol.for("react.activity"),Si=Symbol.for("react.memo_cache_sentinel"),Pt=Symbol.iterator;function Vi(i){return i===null||typeof i!="object"?null:(i=Pt&&i[Pt]||i["@@iterator"],typeof i=="function"?i:null)}var Ti=Symbol.for("react.client.reference");function li(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Ti?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ti:return"Fragment";case Ct:return"Profiler";case Ut:return"StrictMode";case Ht:return"Suspense";case Zt:return"SuspenseList";case vi:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case ki:return"Portal";case dt:return i.displayName||"Context";case qt:return(i._context.displayName||"Context")+".Consumer";case ft:var n=i.render;return i=i.displayName,i||(i=n.displayName||n.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ot:return n=i.displayName||null,n!==null?n:li(i.type)||"Memo";case ni:n=i._payload,i=i._init;try{return li(i(n))}catch{}}return null}var mt=Array.isArray,ge=Et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,He=Tt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gt={pending:!1,data:null,method:null,action:null},Ne=[],nt=-1;function Q(i){return{current:i}}function be(i){0>nt||(i.current=Ne[nt],Ne[nt]=null,nt--)}function qe(i,n){nt++,Ne[nt]=i.current,i.current=n}var et=Q(null),lt=Q(null),Lt=Q(null),Ot=Q(null);function qi(i,n){switch(qe(Lt,n),qe(lt,i),qe(et,null),n.nodeType){case 9:case 11:i=(i=n.documentElement)&&(i=i.namespaceURI)?m(i):0;break;default:if(i=n.tagName,n=n.namespaceURI)n=m(n),i=g(n,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}be(et),qe(et,i)}function Ai(){be(et),be(lt),be(Lt)}function rr(i){i.memoizedState!==null&&qe(Ot,i);var n=et.current,o=g(n,i.type);n!==o&&(qe(lt,i),qe(et,o))}function ss(i){lt.current===i&&(be(et),be(lt)),Ot.current===i&&(be(Ot),Hu._currentValue=gt)}var sr,Nr;function _n(i){if(sr===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);sr=n&&n[1]||"",Nr=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sr+i+Nr}var os=!1;function xe(i,n){if(!i||os)return"";os=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(n){var Le=function(){throw Error()};if(Object.defineProperty(Le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Le,[])}catch(ze){var we=ze}Reflect.construct(i,[],Le)}else{try{Le.call()}catch(ze){we=ze}i.call(Le.prototype)}}else{try{throw Error()}catch(ze){we=ze}(Le=i())&&typeof Le.catch=="function"&&Le.catch(function(){})}}catch(ze){if(ze&&we&&typeof ze.stack=="string")return[ze.stack,we.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=d.DetermineComponentFrameRoot(),C=w[0],U=w[1];if(C&&U){var te=C.split(`
`),ve=U.split(`
`);for(_=d=0;d<te.length&&!te[d].includes("DetermineComponentFrameRoot");)d++;for(;_<ve.length&&!ve[_].includes("DetermineComponentFrameRoot");)_++;if(d===te.length||_===ve.length)for(d=te.length-1,_=ve.length-1;1<=d&&0<=_&&te[d]!==ve[_];)_--;for(;1<=d&&0<=_;d--,_--)if(te[d]!==ve[_]){if(d!==1||_!==1)do if(d--,_--,0>_||te[d]!==ve[_]){var Ie=`
`+te[d].replace(" at new "," at ");return i.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",i.displayName)),Ie}while(1<=d&&0<=_);break}}}finally{os=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?_n(o):""}function Cs(i,n){switch(i.tag){case 26:case 27:case 5:return _n(i.type);case 16:return _n("Lazy");case 13:return i.child!==n&&n!==null?_n("Suspense Fallback"):_n("Suspense");case 19:return _n("SuspenseList");case 0:case 15:return xe(i.type,!1);case 11:return xe(i.type.render,!1);case 1:return xe(i.type,!0);case 31:return _n("Activity");default:return""}}function mo(i){try{var n="",o=null;do n+=Cs(i,o),o=i,i=i.return;while(i);return n}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var pi=Object.prototype.hasOwnProperty,ea=Ce.unstable_scheduleCallback,Ds=Ce.unstable_cancelCallback,ls=Ce.unstable_shouldYield,Fr=Ce.unstable_requestPaint,Pa=Ce.unstable_now,Fn=Ce.unstable_getCurrentPriorityLevel,go=Ce.unstable_ImmediatePriority,yo=Ce.unstable_UserBlockingPriority,je=Ce.unstable_NormalPriority,wr=Ce.unstable_LowPriority,Ja=Ce.unstable_IdlePriority,Sr=Ce.log,us=Ce.unstable_setDisableYieldValue,Xe=null,Dt=null;function xt(i){if(typeof Sr=="function"&&us(i),Dt&&typeof Dt.setStrictMode=="function")try{Dt.setStrictMode(Xe,i)}catch{}}var Ki=Math.clz32?Math.clz32:Tr,or=Math.log,Ft=Math.LN2;function Tr(i){return i>>>=0,i===0?32:31-(or(i)/Ft|0)|0}var jn=256,lr=262144,In=4194304;function $(i){var n=i&42;if(n!==0)return n;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function L(i,n,o){var d=i.pendingLanes;if(d===0)return 0;var _=0,w=i.suspendedLanes,C=i.pingedLanes;i=i.warmLanes;var U=d&134217727;return U!==0?(d=U&~w,d!==0?_=$(d):(C&=U,C!==0?_=$(C):o||(o=U&~i,o!==0&&(_=$(o))))):(U=d&~w,U!==0?_=$(U):C!==0?_=$(C):o||(o=d&~i,o!==0&&(_=$(o)))),_===0?0:n!==0&&n!==_&&(n&w)===0&&(w=_&-_,o=n&-n,w>=o||w===32&&(o&4194048)!==0)?n:_}function R(i,n){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&n)===0}function V(i,n){switch(i){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function H(){var i=In;return In<<=1,(In&62914560)===0&&(In=4194304),i}function ie(i){for(var n=[],o=0;31>o;o++)n.push(i);return n}function re(i,n){i.pendingLanes|=n,n!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ce(i,n,o,d,_,w){var C=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var U=i.entanglements,te=i.expirationTimes,ve=i.hiddenUpdates;for(o=C&~o;0<o;){var Ie=31-Ki(o),Le=1<<Ie;U[Ie]=0,te[Ie]=-1;var we=ve[Ie];if(we!==null)for(ve[Ie]=null,Ie=0;Ie<we.length;Ie++){var ze=we[Ie];ze!==null&&(ze.lane&=-536870913)}o&=~Le}d!==0&&W(i,d,0),w!==0&&_===0&&i.tag!==0&&(i.suspendedLanes|=w&~(C&~n))}function W(i,n,o){i.pendingLanes|=n,i.suspendedLanes&=~n;var d=31-Ki(n);i.entangledLanes|=n,i.entanglements[d]=i.entanglements[d]|1073741824|o&261930}function Ae(i,n){var o=i.entangledLanes|=n;for(i=i.entanglements;o;){var d=31-Ki(o),_=1<<d;_&n|i[d]&n&&(i[d]|=n),o&=~_}}function ke(i,n){var o=n&-n;return o=(o&42)!==0?1:ye(o),(o&(i.suspendedLanes|n))!==0?0:o}function ye(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ze(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function pt(){var i=He.p;return i!==0?i:(i=window.event,i===void 0?32:ln(i.type))}function bt(i,n){var o=He.p;try{return He.p=i,n()}finally{He.p=o}}var Yt=Math.random().toString(36).slice(2),yt="__reactFiber$"+Yt,jt="__reactProps$"+Yt,Xt="__reactContainer$"+Yt,fa="__reactEvents$"+Yt,ra="__reactListeners$"+Yt,Kt="__reactHandles$"+Yt,zi="__reactResources$"+Yt,Ri="__reactMarker$"+Yt;function Ta(i){delete i[yt],delete i[jt],delete i[fa],delete i[ra],delete i[Kt]}function pa(i){var n=i[yt];if(n)return n;for(var o=i.parentNode;o;){if(n=o[Xt]||o[yt]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(i=rt(i);i!==null;){if(o=i[yt])return o;i=rt(i)}return n}i=o,o=i.parentNode}return null}function Aa(i){if(i=i[yt]||i[Xt]){var n=i.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return i}return null}function Ar(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i.stateNode;throw Error(ue(33))}function mi(i){var n=i[zi];return n||(n=i[zi]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function za(i){i[Ri]=!0}var Fl=new Set,vn={};function Da(i,n){_o(i,n),_o(i+"Capture",n)}function _o(i,n){for(vn[i]=n,i=0;i<n.length;i++)Fl.add(n[i])}var Un=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xn={},Is={};function ks(i){return pi.call(Is,i)?!0:pi.call(xn,i)?!1:Un.test(i)?Is[i]=!0:(xn[i]=!0,!1)}function sa(i,n,o){if(ks(n))if(o===null)i.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(n);return;case"boolean":var d=n.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){i.removeAttribute(n);return}}i.setAttribute(n,""+o)}}function cs(i,n,o){if(o===null)i.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(n);return}i.setAttribute(n,""+o)}}function Ia(i,n,o,d){if(d===null)i.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(n,o,""+d)}}function xi(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function rl(i){var n=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function ur(i,n,o){var d=Object.getOwnPropertyDescriptor(i.constructor.prototype,n);if(!i.hasOwnProperty(n)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,w=d.set;return Object.defineProperty(i,n,{configurable:!0,get:function(){return _.call(this)},set:function(C){o=""+C,w.call(this,C)}}),Object.defineProperty(i,n,{enumerable:d.enumerable}),{getValue:function(){return o},setValue:function(C){o=""+C},stopTracking:function(){i._valueTracker=null,delete i[n]}}}}function sl(i){if(!i._valueTracker){var n=rl(i)?"checked":"value";i._valueTracker=ur(i,n,""+i[n])}}function Vn(i){if(!i)return!1;var n=i._valueTracker;if(!n)return!0;var o=n.getValue(),d="";return i&&(d=rl(i)?i.checked?"true":"false":i.value),i=d,i!==o?(n.setValue(i),!0):!1}function jl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Ul=/[\n"\\]/g;function Oa(i){return i.replace(Ul,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function zr(i,n,o,d,_,w,C,U){i.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?i.type=C:i.removeAttribute("type"),n!=null?C==="number"?(n===0&&i.value===""||i.value!=n)&&(i.value=""+xi(n)):i.value!==""+xi(n)&&(i.value=""+xi(n)):C!=="submit"&&C!=="reset"||i.removeAttribute("value"),n!=null?ol(i,C,xi(n)):o!=null?ol(i,C,xi(o)):d!=null&&i.removeAttribute("value"),_==null&&w!=null&&(i.defaultChecked=!!w),_!=null&&(i.checked=_&&typeof _!="function"&&typeof _!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.name=""+xi(U):i.removeAttribute("name")}function yi(i,n,o,d,_,w,C,U){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.type=w),n!=null||o!=null){if(!(w!=="submit"&&w!=="reset"||n!=null)){sl(i);return}o=o!=null?""+xi(o):"",n=n!=null?""+xi(n):o,U||n===i.value||(i.value=n),i.defaultValue=n}d=d??_,d=typeof d!="function"&&typeof d!="symbol"&&!!d,i.checked=U?i.checked:!!d,i.defaultChecked=!!d,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.name=C),sl(i)}function ol(i,n,o){n==="number"&&jl(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function hs(i,n,o,d){if(i=i.options,n){n={};for(var _=0;_<o.length;_++)n["$"+o[_]]=!0;for(o=0;o<i.length;o++)_=n.hasOwnProperty("$"+i[o].value),i[o].selected!==_&&(i[o].selected=_),_&&d&&(i[o].defaultSelected=!0)}else{for(o=""+xi(o),n=null,_=0;_<i.length;_++){if(i[_].value===o){i[_].selected=!0,d&&(i[_].defaultSelected=!0);return}n!==null||i[_].disabled||(n=i[_])}n!==null&&(n.selected=!0)}}function Rs(i,n,o){if(n!=null&&(n=""+xi(n),n!==i.value&&(i.value=n),o==null)){i.defaultValue!==n&&(i.defaultValue=n);return}i.defaultValue=o!=null?""+xi(o):""}function Vl(i,n,o,d){if(n==null){if(d!=null){if(o!=null)throw Error(ue(92));if(mt(d)){if(1<d.length)throw Error(ue(93));d=d[0]}o=d}o==null&&(o=""),n=o}o=xi(n),i.defaultValue=o,d=i.textContent,d===o&&d!==""&&d!==null&&(i.value=d),sl(i)}function jr(i,n){if(n){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=n;return}}i.textContent=n}var ll=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ul(i,n,o){var d=n.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?d?i.setProperty(n,""):n==="float"?i.cssFloat="":i[n]="":d?i.setProperty(n,o):typeof o!="number"||o===0||ll.has(n)?n==="float"?i.cssFloat=o:i[n]=(""+o).trim():i[n]=o+"px"}function Ls(i,n,o){if(n!=null&&typeof n!="object")throw Error(ue(62));if(i=i.style,o!=null){for(var d in o)!o.hasOwnProperty(d)||n!=null&&n.hasOwnProperty(d)||(d.indexOf("--")===0?i.setProperty(d,""):d==="float"?i.cssFloat="":i[d]="");for(var _ in n)d=n[_],n.hasOwnProperty(_)&&o[_]!==d&&ul(i,_,d)}else for(var w in n)n.hasOwnProperty(w)&&ul(i,w,n[w])}function ql(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zl(i){return Xc.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function cn(){}var Bs=null;function Qa(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ka=null,Ur=null;function cl(i){var n=Aa(i);if(n&&(i=n.stateNode)){var o=i[jt]||null;e:switch(i=n.stateNode,n.type){case"input":if(zr(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),n=o.name,o.type==="radio"&&n!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Oa(""+n)+'"][type="radio"]'),n=0;n<o.length;n++){var d=o[n];if(d!==i&&d.form===i.form){var _=d[jt]||null;if(!_)throw Error(ue(90));zr(d,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(n=0;n<o.length;n++)d=o[n],d.form===i.form&&Vn(d)}break e;case"textarea":Rs(i,o.value,o.defaultValue);break e;case"select":n=o.value,n!=null&&hs(i,!!o.multiple,n,!1)}}}var vo=!1;function Yu(i,n,o){if(vo)return i(n,o);vo=!0;try{var d=i(n);return d}finally{if(vo=!1,(ka!==null||Ur!==null)&&(Bc(),ka&&(n=ka,i=Ur,Ur=ka=null,cl(n),i)))for(n=0;n<i.length;n++)cl(i[n])}}function Er(i,n){var o=i.stateNode;if(o===null)return null;var d=o[jt]||null;if(d===null)return null;o=d[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(i=i.type,d=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!d;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(ue(231,n,typeof o));return o}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gl=!1;if(Vr)try{var xo={};Object.defineProperty(xo,"passive",{get:function(){Gl=!0}}),window.addEventListener("test",xo,xo),window.removeEventListener("test",xo,xo)}catch{Gl=!1}var ds=null,Ku=null,hl=null;function bo(){if(hl)return hl;var i,n=Ku,o=n.length,d,_="value"in ds?ds.value:ds.textContent,w=_.length;for(i=0;i<o&&n[i]===_[i];i++);var C=o-i;for(d=1;d<=C&&n[o-d]===_[w-d];d++);return hl=_.slice(i,1<d?1-d:void 0)}function wo(i){var n=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&n===13&&(i=13)):i=n,i===10&&(i=13),32<=i||i===13?i:0}function Ps(){return!0}function Hl(){return!1}function Wa(i){function n(o,d,_,w,C){this._reactName=o,this._targetInst=_,this.type=d,this.nativeEvent=w,this.target=C,this.currentTarget=null;for(var U in i)i.hasOwnProperty(U)&&(o=i[U],this[U]=o?o(w):w[U]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ps:Hl,this.isPropagationStopped=Hl,this}return me(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ps)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ps)},persist:function(){},isPersistent:Ps}),n}var en={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xl=Wa(en),Os=me({},en,{view:0,detail:0}),Ns=Wa(Os),Mr,_i,fs,$l=me({},Os,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qu,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==fs&&(fs&&i.type==="mousemove"?(Mr=i.screenX-fs.screenX,_i=i.screenY-fs.screenY):_i=Mr=0,fs=i),Mr)},movementY:function(i){return"movementY"in i?i.movementY:_i}}),Fs=Wa($l),Xh=me({},$l,{dataTransfer:0}),$c=Wa(Xh),$h=me({},Os,{relatedTarget:0}),Yl=Wa($h),Ju=me({},en,{animationName:0,elapsedTime:0,pseudoElement:0}),Yc=Wa(Ju),Kc=me({},en,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Jc=Wa(Kc),Qc=me({},en,{data:0}),ps=Wa(Qc),Wc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dl(i){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(i):(i=eh[i])?!!n[i]:!1}function Qu(){return dl}var Kl=me({},Os,{key:function(i){if(i.key){var n=Wc[i.key]||i.key;if(n!=="Unidentified")return n}return i.type==="keypress"?(i=wo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Yh[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qu,charCode:function(i){return i.type==="keypress"?wo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?wo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Kh=Wa(Kl),Jh=me({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wu=Wa(Jh),th=me({},Os,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qu}),ih=Wa(th),ec=me({},en,{propertyName:0,elapsedTime:0,pseudoElement:0}),ah=Wa(ec),Jl=me({},$l,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),qr=Wa(Jl),tc=me({},en,{newState:0,oldState:0}),ic=Wa(tc),ac=[9,13,27,32],So=Vr&&"CompositionEvent"in window,js=null;Vr&&"documentMode"in document&&(js=document.documentMode);var Us=Vr&&"TextEvent"in window&&!js,Ql=Vr&&(!So||js&&8<js&&11>=js),nh=" ",oa=!1;function rh(i,n){switch(i){case"keyup":return ac.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jt(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Zr=!1;function Zi(i,n){switch(i){case"compositionend":return Jt(n);case"keypress":return n.which!==32?null:(oa=!0,nh);case"textInput":return i=n.data,i===nh&&oa?null:i;default:return null}}function Li(i,n){if(Zr)return i==="compositionend"||!So&&rh(i,n)?(i=bo(),hl=Ku=ds=null,Zr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Ql&&n.locale!=="ko"?null:n.data;default:return null}}var Vs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function To(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n==="input"?!!Vs[i.type]:n==="textarea"}function Ao(i,n,o,d){ka?Ur?Ur.push(d):Ur=[d]:ka=d,n=Vc(n,"onChange"),0<n.length&&(o=new Xl("onChange","change",null,o,d),i.push({event:o,listeners:n}))}var qs=null,cr=null;function zo(i){Nh(i,0)}function hn(i){var n=Ar(i);if(Vn(n))return i}function Wl(i,n){if(i==="change")return n}var eu=!1;if(Vr){var fl;if(Vr){var Gr="oninput"in document;if(!Gr){var Eo=document.createElement("div");Eo.setAttribute("oninput","return;"),Gr=typeof Eo.oninput=="function"}fl=Gr}else fl=!1;eu=fl&&(!document.documentMode||9<document.documentMode)}function Mo(){qs&&(qs.detachEvent("onpropertychange",Zs),cr=qs=null)}function Zs(i){if(i.propertyName==="value"&&hn(cr)){var n=[];Ao(n,cr,i,Qa(i)),Yu(zo,n)}}function pl(i,n,o){i==="focusin"?(Mo(),qs=n,cr=o,qs.attachEvent("onpropertychange",Zs)):i==="focusout"&&Mo()}function tu(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return hn(cr)}function Co(i,n){if(i==="click")return hn(n)}function Do(i,n){if(i==="input"||i==="change")return hn(n)}function sh(i,n){return i===n&&(i!==0||1/i===1/n)||i!==i&&n!==n}var dn=typeof Object.is=="function"?Object.is:sh;function ui(i,n){if(dn(i,n))return!0;if(typeof i!="object"||i===null||typeof n!="object"||n===null)return!1;var o=Object.keys(i),d=Object.keys(n);if(o.length!==d.length)return!1;for(d=0;d<o.length;d++){var _=o[d];if(!pi.call(n,_)||!dn(i[_],n[_]))return!1}return!0}function ml(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function oh(i,n){var o=ml(i);i=0;for(var d;o;){if(o.nodeType===3){if(d=i+o.textContent.length,i<=n&&d>=n)return{node:o,offset:n-i};i=d}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ml(o)}}function nc(i,n){return i&&n?i===n?!0:i&&i.nodeType===3?!1:n&&n.nodeType===3?nc(i,n.parentNode):"contains"in i?i.contains(n):i.compareDocumentPosition?!!(i.compareDocumentPosition(n)&16):!1:!1}function Gs(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var n=jl(i.document);n instanceof i.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)i=n.contentWindow;else break;n=jl(i.document)}return n}function iu(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n&&(n==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||n==="textarea"||i.contentEditable==="true")}var au=Vr&&"documentMode"in document&&11>=document.documentMode,Hs=null,nu=null,ms=null,Io=!1;function Xs(i,n,o){var d=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Io||Hs==null||Hs!==jl(d)||(d=Hs,"selectionStart"in d&&iu(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),ms&&ui(ms,d)||(ms=d,d=Vc(nu,"onSelect"),0<d.length&&(n=new Xl("onSelect","select",null,n,o),i.push({event:n,listeners:d}),n.target=Hs)))}function qn(i,n){var o={};return o[i.toLowerCase()]=n.toLowerCase(),o["Webkit"+i]="webkit"+n,o["Moz"+i]="moz"+n,o}var hr={animationend:qn("Animation","AnimationEnd"),animationiteration:qn("Animation","AnimationIteration"),animationstart:qn("Animation","AnimationStart"),transitionrun:qn("Transition","TransitionRun"),transitionstart:qn("Transition","TransitionStart"),transitioncancel:qn("Transition","TransitionCancel"),transitionend:qn("Transition","TransitionEnd")},gl={},$s={};Vr&&($s=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);function dr(i){if(gl[i])return gl[i];if(!hr[i])return i;var n=hr[i],o;for(o in n)if(n.hasOwnProperty(o)&&o in $s)return gl[i]=n[o];return i}var yl=dr("animationend"),_l=dr("animationiteration"),ru=dr("animationstart"),Qh=dr("transitionrun"),lh=dr("transitionstart"),su=dr("transitioncancel"),ou=dr("transitionend"),ko=new Map,Ys="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ys.push("scrollEnd");function Ji(i,n){ko.set(i,n),Da(n,[i])}var Cr=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},kn=[],Ks=0,ia=0;function bn(){for(var i=Ks,n=ia=Ks=0;n<i;){var o=kn[n];kn[n++]=null;var d=kn[n];kn[n++]=null;var _=kn[n];kn[n++]=null;var w=kn[n];if(kn[n++]=null,d!==null&&_!==null){var C=d.pending;C===null?_.next=_:(_.next=C.next,C.next=_),d.pending=_}w!==0&&vl(o,_,w)}}function tn(i,n,o,d){kn[Ks++]=i,kn[Ks++]=n,kn[Ks++]=o,kn[Ks++]=d,ia|=d,i.lanes|=d,i=i.alternate,i!==null&&(i.lanes|=d)}function Js(i,n,o,d){return tn(i,n,o,d),Xr(i)}function Hr(i,n){return tn(i,null,null,n),Xr(i)}function vl(i,n,o){i.lanes|=o;var d=i.alternate;d!==null&&(d.lanes|=o);for(var _=!1,w=i.return;w!==null;)w.childLanes|=o,d=w.alternate,d!==null&&(d.childLanes|=o),w.tag===22&&(i=w.stateNode,i===null||i._visibility&1||(_=!0)),i=w,w=w.return;return i.tag===3?(w=i.stateNode,_&&n!==null&&(_=31-Ki(o),i=w.hiddenUpdates,d=i[_],d===null?i[_]=[n]:d.push(n),n.lane=o|536870912),w):null}function Xr(i){if(50<Wo)throw Wo=0,Lc=null,Error(ue(185));for(var n=i.return;n!==null;)i=n,n=i.return;return i.tag===3?i.stateNode:null}var wn={};function rc(i,n,o,d){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(i,n,o,d){return new rc(i,n,o,d)}function xl(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Zn(i,n){var o=i.alternate;return o===null?(o=an(i.tag,n,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=n,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&65011712,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,n=i.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function lu(i,n){i.flags&=65011714;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),i}function Ro(i,n,o,d,_,w){var C=0;if(d=i,typeof i=="function")xl(i)&&(C=1);else if(typeof i=="string")C=br(i,o,et.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case vi:return i=an(31,o,n,_),i.elementType=vi,i.lanes=w,i;case ti:return Rn(o.children,_,w,n);case Ut:C=8,_|=24;break;case Ct:return i=an(12,o,n,_|2),i.elementType=Ct,i.lanes=w,i;case Ht:return i=an(13,o,n,_),i.elementType=Ht,i.lanes=w,i;case Zt:return i=an(19,o,n,_),i.elementType=Zt,i.lanes=w,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case dt:C=10;break e;case qt:C=9;break e;case ft:C=11;break e;case ot:C=14;break e;case ni:C=16,d=null;break e}C=29,o=Error(ue(130,i===null?"null":typeof i,"")),d=null}return n=an(C,o,n,_),n.elementType=i,n.type=d,n.lanes=w,n}function Rn(i,n,o,d){return i=an(7,i,d,n),i.lanes=o,i}function Lo(i,n,o){return i=an(6,i,null,n),i.lanes=o,i}function Bo(i){var n=an(18,null,null,0);return n.stateNode=i,n}function bl(i,n,o){return n=an(4,i.children!==null?i.children:[],i.key,n),n.lanes=o,n.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},n}var uu=new WeakMap;function Sn(i,n){if(typeof i=="object"&&i!==null){var o=uu.get(i);return o!==void 0?o:(n={value:i,source:n,stack:mo(n)},uu.set(i,n),n)}return{value:i,source:n,stack:mo(n)}}var gs=[],$r=0,ys=null,Po=0,la=[],xa=0,Dr=null,Ea=1,nn="";function Yr(i,n){gs[$r++]=Po,gs[$r++]=ys,ys=i,Po=n}function uh(i,n,o){la[xa++]=Ea,la[xa++]=nn,la[xa++]=Dr,Dr=i;var d=Ea;i=nn;var _=32-Ki(d)-1;d&=~(1<<_),o+=1;var w=32-Ki(n)+_;if(30<w){var C=_-_%5;w=(d&(1<<C)-1).toString(32),d>>=C,_-=C,Ea=1<<32-Ki(n)+_|o<<_|d,nn=w+i}else Ea=1<<w|o<<_|d,nn=i}function cu(i){i.return!==null&&(Yr(i,1),uh(i,1,0))}function hu(i){for(;i===ys;)ys=gs[--$r],gs[$r]=null,Po=gs[--$r],gs[$r]=null;for(;i===Dr;)Dr=la[--xa],la[xa]=null,nn=la[--xa],la[xa]=null,Ea=la[--xa],la[xa]=null}function du(i,n){la[xa++]=Ea,la[xa++]=nn,la[xa++]=Dr,Ea=n.id,nn=n.overflow,Dr=i}var ma=null,hi=null,Be=!1,fr=null,Tn=!1,fu=Error(ue(519));function Ln(i){var n=Error(ue(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ws(Sn(n,i)),fu}function Qs(i){var n=i.stateNode,o=i.type,d=i.memoizedProps;switch(n[yt]=i,n[jt]=d,o){case"dialog":gi("cancel",n),gi("close",n);break;case"iframe":case"object":case"embed":gi("load",n);break;case"video":case"audio":for(o=0;o<Vu.length;o++)gi(Vu[o],n);break;case"source":gi("error",n);break;case"img":case"image":case"link":gi("error",n),gi("load",n);break;case"details":gi("toggle",n);break;case"input":gi("invalid",n),yi(n,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":gi("invalid",n);break;case"textarea":gi("invalid",n),Vl(n,d.value,d.defaultValue,d.children)}o=d.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||n.textContent===""+o||d.suppressHydrationWarning===!0||qu(n.textContent,o)?(d.popover!=null&&(gi("beforetoggle",n),gi("toggle",n)),d.onScroll!=null&&gi("scroll",n),d.onScrollEnd!=null&&gi("scrollend",n),d.onClick!=null&&(n.onclick=cn),n=!0):n=!1,n||Ln(i,!0)}function pu(i){for(ma=i.return;ma;)switch(ma.tag){case 5:case 31:case 13:Tn=!1;return;case 27:case 3:Tn=!0;return;default:ma=ma.return}}function $t(i){if(i!==ma)return!1;if(!Be)return pu(i),Be=!0,!1;var n=i.tag,o;if((o=n!==3&&n!==27)&&((o=n===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||v(i.type,i.memoizedProps)),o=!o),o&&hi&&Ln(i),pu(i),n===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(317));hi=ct(i)}else if(n===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(317));hi=ct(i)}else n===27?(n=hi,F(i.type)?(i=Ke,Ke=null,hi=i):hi=n):hi=ma?Ve(i.stateNode.nextSibling):null;return!0}function Kr(){hi=ma=null,Be=!1}function sc(){var i=fr;return i!==null&&(Pn===null?Pn=i:Pn.push.apply(Pn,i),fr=null),i}function Ws(i){fr===null?fr=[i]:fr.push(i)}var oc=Q(null),Gn=null,Ir=null;function kr(i,n,o){qe(oc,n._currentValue),n._currentValue=o}function Rr(i){i._currentValue=oc.current,be(oc)}function lc(i,n,o){for(;i!==null;){var d=i.alternate;if((i.childLanes&n)!==n?(i.childLanes|=n,d!==null&&(d.childLanes|=n)):d!==null&&(d.childLanes&n)!==n&&(d.childLanes|=n),i===o)break;i=i.return}}function wl(i,n,o,d){var _=i.child;for(_!==null&&(_.return=i);_!==null;){var w=_.dependencies;if(w!==null){var C=_.child;w=w.firstContext;e:for(;w!==null;){var U=w;w=_;for(var te=0;te<n.length;te++)if(U.context===n[te]){w.lanes|=o,U=w.alternate,U!==null&&(U.lanes|=o),lc(w.return,o,i),d||(C=null);break e}w=U.next}}else if(_.tag===18){if(C=_.return,C===null)throw Error(ue(341));C.lanes|=o,w=C.alternate,w!==null&&(w.lanes|=o),lc(C,o,i),C=null}else C=_.child;if(C!==null)C.return=_;else for(C=_;C!==null;){if(C===i){C=null;break}if(_=C.sibling,_!==null){_.return=C.return,C=_;break}C=C.return}_=C}}function Oo(i,n,o,d){i=null;for(var _=n,w=!1;_!==null;){if(!w){if((_.flags&524288)!==0)w=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var C=_.alternate;if(C===null)throw Error(ue(387));if(C=C.memoizedProps,C!==null){var U=_.type;dn(_.pendingProps.value,C.value)||(i!==null?i.push(U):i=[U])}}else if(_===Ot.current){if(C=_.alternate,C===null)throw Error(ue(387));C.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(i!==null?i.push(Hu):i=[Hu])}_=_.return}i!==null&&wl(n,i,o,d),n.flags|=262144}function mu(i){for(i=i.firstContext;i!==null;){if(!dn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Ra(i){Gn=i,Ir=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Qt(i){return Sl(Gn,i)}function Jr(i,n){return Gn===null&&Ra(i),Sl(i,n)}function Sl(i,n){var o=n._currentValue;if(n={context:n,memoizedValue:o,next:null},Ir===null){if(i===null)throw Error(ue(308));Ir=n,i.dependencies={lanes:0,firstContext:n},i.flags|=524288}else Ir=Ir.next=n;return o}var gu=typeof AbortController<"u"?AbortController:function(){var i=[],n=this.signal={aborted:!1,addEventListener:function(o,d){i.push(d)}};this.abort=function(){n.aborted=!0,i.forEach(function(o){return o()})}},ch=Ce.unstable_scheduleCallback,Tl=Ce.unstable_NormalPriority,aa={$$typeof:dt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Hn(){return{controller:new gu,data:new Map,refCount:0}}function Qr(i){i.refCount--,i.refCount===0&&ch(Tl,function(){i.controller.abort()})}var st=null,wt=0,Wr=0,es=null;function uc(i,n){if(st===null){var o=st=[];wt=0,Wr=Uu(),es={status:"pending",value:void 0,then:function(d){o.push(d)}}}return wt++,n.then(p,p),n}function p(){if(--wt===0&&st!==null){es!==null&&(es.status="fulfilled");var i=st;st=null,Wr=0,es=null;for(var n=0;n<i.length;n++)(0,i[n])()}}function e(i,n){var o=[],d={status:"pending",value:null,reason:null,then:function(_){o.push(_)}};return i.then(function(){d.status="fulfilled",d.value=n;for(var _=0;_<o.length;_++)(0,o[_])(n)},function(_){for(d.status="rejected",d.reason=_,_=0;_<o.length;_++)(0,o[_])(void 0)}),d}var s=ge.S;ge.S=function(i,n){Pf=Pa(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&uc(i,n),s!==null&&s(i,n)};var u=Q(null);function c(){var i=u.current;return i!==null?i:Wi.pooledCache}function f(i,n){n===null?qe(u,u.current):qe(u,n.pool)}function x(){var i=c();return i===null?null:{parent:aa._currentValue,pool:i}}var S=Error(ue(460)),T=Error(ue(474)),E=Error(ue(542)),D={then:function(){}};function I(i){return i=i.status,i==="fulfilled"||i==="rejected"}function P(i,n,o){switch(o=i[o],o===void 0?i.push(n):o!==n&&(n.then(cn,cn),n=o),n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,K(i),i;default:if(typeof n.status=="string")n.then(cn,cn);else{if(i=Wi,i!==null&&100<i.shellSuspendCounter)throw Error(ue(482));i=n,i.status="pending",i.then(function(d){if(n.status==="pending"){var _=n;_.status="fulfilled",_.value=d}},function(d){if(n.status==="pending"){var _=n;_.status="rejected",_.reason=d}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,K(i),i}throw q=n,S}}function j(i){try{var n=i._init;return n(i._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(q=o,S):o}}var q=null;function X(){if(q===null)throw Error(ue(459));var i=q;return q=null,i}function K(i){if(i===S||i===E)throw Error(ue(483))}var J=null,ee=0;function Z(i){var n=ee;return ee+=1,J===null&&(J=[]),P(J,i,n)}function ne(i,n){n=n.props.ref,i.ref=n!==void 0?n:null}function oe(i,n){throw n.$$typeof===pe?Error(ue(525)):(i=Object.prototype.toString.call(n),Error(ue(31,i==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":i)))}function fe(i){function n(de,se){if(i){var _e=de.deletions;_e===null?(de.deletions=[se],de.flags|=16):_e.push(se)}}function o(de,se){if(!i)return null;for(;se!==null;)n(de,se),se=se.sibling;return null}function d(de){for(var se=new Map;de!==null;)de.key!==null?se.set(de.key,de):se.set(de.index,de),de=de.sibling;return se}function _(de,se){return de=Zn(de,se),de.index=0,de.sibling=null,de}function w(de,se,_e){return de.index=_e,i?(_e=de.alternate,_e!==null?(_e=_e.index,_e<se?(de.flags|=67108866,se):_e):(de.flags|=67108866,se)):(de.flags|=1048576,se)}function C(de){return i&&de.alternate===null&&(de.flags|=67108866),de}function U(de,se,_e,Re){return se===null||se.tag!==6?(se=Lo(_e,de.mode,Re),se.return=de,se):(se=_(se,_e),se.return=de,se)}function te(de,se,_e,Re){var Bt=_e.type;return Bt===ti?Ie(de,se,_e.props.children,Re,_e.key):se!==null&&(se.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===ni&&j(Bt)===se.type)?(se=_(se,_e.props),ne(se,_e),se.return=de,se):(se=Ro(_e.type,_e.key,_e.props,null,de.mode,Re),ne(se,_e),se.return=de,se)}function ve(de,se,_e,Re){return se===null||se.tag!==4||se.stateNode.containerInfo!==_e.containerInfo||se.stateNode.implementation!==_e.implementation?(se=bl(_e,de.mode,Re),se.return=de,se):(se=_(se,_e.children||[]),se.return=de,se)}function Ie(de,se,_e,Re,Bt){return se===null||se.tag!==7?(se=Rn(_e,de.mode,Re,Bt),se.return=de,se):(se=_(se,_e),se.return=de,se)}function Le(de,se,_e){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Lo(""+se,de.mode,_e),se.return=de,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case Ii:return _e=Ro(se.type,se.key,se.props,null,de.mode,_e),ne(_e,se),_e.return=de,_e;case ki:return se=bl(se,de.mode,_e),se.return=de,se;case ni:return se=j(se),Le(de,se,_e)}if(mt(se)||Vi(se))return se=Rn(se,de.mode,_e,null),se.return=de,se;if(typeof se.then=="function")return Le(de,Z(se),_e);if(se.$$typeof===dt)return Le(de,Jr(de,se),_e);oe(de,se)}return null}function we(de,se,_e,Re){var Bt=se!==null?se.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return Bt!==null?null:U(de,se,""+_e,Re);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case Ii:return _e.key===Bt?te(de,se,_e,Re):null;case ki:return _e.key===Bt?ve(de,se,_e,Re):null;case ni:return _e=j(_e),we(de,se,_e,Re)}if(mt(_e)||Vi(_e))return Bt!==null?null:Ie(de,se,_e,Re,null);if(typeof _e.then=="function")return we(de,se,Z(_e),Re);if(_e.$$typeof===dt)return we(de,se,Jr(de,_e),Re);oe(de,_e)}return null}function ze(de,se,_e,Re,Bt){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return de=de.get(_e)||null,U(se,de,""+Re,Bt);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case Ii:return de=de.get(Re.key===null?_e:Re.key)||null,te(se,de,Re,Bt);case ki:return de=de.get(Re.key===null?_e:Re.key)||null,ve(se,de,Re,Bt);case ni:return Re=j(Re),ze(de,se,_e,Re,Bt)}if(mt(Re)||Vi(Re))return de=de.get(_e)||null,Ie(se,de,Re,Bt,null);if(typeof Re.then=="function")return ze(de,se,_e,Z(Re),Bt);if(Re.$$typeof===dt)return ze(de,se,_e,Jr(se,Re),Bt);oe(se,Re)}return null}function vt(de,se,_e,Re){for(var Bt=null,ji=null,At=se,ci=se=0,wi=null;At!==null&&ci<_e.length;ci++){At.index>ci?(wi=At,At=null):wi=At.sibling;var Ui=we(de,At,_e[ci],Re);if(Ui===null){At===null&&(At=wi);break}i&&At&&Ui.alternate===null&&n(de,At),se=w(Ui,se,ci),ji===null?Bt=Ui:ji.sibling=Ui,ji=Ui,At=wi}if(ci===_e.length)return o(de,At),Be&&Yr(de,ci),Bt;if(At===null){for(;ci<_e.length;ci++)At=Le(de,_e[ci],Re),At!==null&&(se=w(At,se,ci),ji===null?Bt=At:ji.sibling=At,ji=At);return Be&&Yr(de,ci),Bt}for(At=d(At);ci<_e.length;ci++)wi=ze(At,de,ci,_e[ci],Re),wi!==null&&(i&&wi.alternate!==null&&At.delete(wi.key===null?ci:wi.key),se=w(wi,se,ci),ji===null?Bt=wi:ji.sibling=wi,ji=wi);return i&&At.forEach(function($u){return n(de,$u)}),Be&&Yr(de,ci),Bt}function Vt(de,se,_e,Re){if(_e==null)throw Error(ue(151));for(var Bt=null,ji=null,At=se,ci=se=0,wi=null,Ui=_e.next();At!==null&&!Ui.done;ci++,Ui=_e.next()){At.index>ci?(wi=At,At=null):wi=At.sibling;var $u=we(de,At,Ui.value,Re);if($u===null){At===null&&(At=wi);break}i&&At&&$u.alternate===null&&n(de,At),se=w($u,se,ci),ji===null?Bt=$u:ji.sibling=$u,ji=$u,At=wi}if(Ui.done)return o(de,At),Be&&Yr(de,ci),Bt;if(At===null){for(;!Ui.done;ci++,Ui=_e.next())Ui=Le(de,Ui.value,Re),Ui!==null&&(se=w(Ui,se,ci),ji===null?Bt=Ui:ji.sibling=Ui,ji=Ui);return Be&&Yr(de,ci),Bt}for(At=d(At);!Ui.done;ci++,Ui=_e.next())Ui=ze(At,de,ci,Ui.value,Re),Ui!==null&&(i&&Ui.alternate!==null&&At.delete(Ui.key===null?ci:Ui.key),se=w(Ui,se,ci),ji===null?Bt=Ui:ji.sibling=Ui,ji=Ui);return i&&At.forEach(function(um){return n(de,um)}),Be&&Yr(de,ci),Bt}function na(de,se,_e,Re){if(typeof _e=="object"&&_e!==null&&_e.type===ti&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case Ii:e:{for(var Bt=_e.key;se!==null;){if(se.key===Bt){if(Bt=_e.type,Bt===ti){if(se.tag===7){o(de,se.sibling),Re=_(se,_e.props.children),Re.return=de,de=Re;break e}}else if(se.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===ni&&j(Bt)===se.type){o(de,se.sibling),Re=_(se,_e.props),ne(Re,_e),Re.return=de,de=Re;break e}o(de,se);break}else n(de,se);se=se.sibling}_e.type===ti?(Re=Rn(_e.props.children,de.mode,Re,_e.key),Re.return=de,de=Re):(Re=Ro(_e.type,_e.key,_e.props,null,de.mode,Re),ne(Re,_e),Re.return=de,de=Re)}return C(de);case ki:e:{for(Bt=_e.key;se!==null;){if(se.key===Bt)if(se.tag===4&&se.stateNode.containerInfo===_e.containerInfo&&se.stateNode.implementation===_e.implementation){o(de,se.sibling),Re=_(se,_e.children||[]),Re.return=de,de=Re;break e}else{o(de,se);break}else n(de,se);se=se.sibling}Re=bl(_e,de.mode,Re),Re.return=de,de=Re}return C(de);case ni:return _e=j(_e),na(de,se,_e,Re)}if(mt(_e))return vt(de,se,_e,Re);if(Vi(_e)){if(Bt=Vi(_e),typeof Bt!="function")throw Error(ue(150));return _e=Bt.call(_e),Vt(de,se,_e,Re)}if(typeof _e.then=="function")return na(de,se,Z(_e),Re);if(_e.$$typeof===dt)return na(de,se,Jr(de,_e),Re);oe(de,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint"?(_e=""+_e,se!==null&&se.tag===6?(o(de,se.sibling),Re=_(se,_e),Re.return=de,de=Re):(o(de,se),Re=Lo(_e,de.mode,Re),Re.return=de,de=Re),C(de)):o(de,se)}return function(de,se,_e,Re){try{ee=0;var Bt=na(de,se,_e,Re);return J=null,Bt}catch(At){if(At===S||At===E)throw At;var ji=an(29,At,null,de.mode);return ji.lanes=Re,ji.return=de,ji}finally{}}}var De=fe(!0),Oe=fe(!1),Ge=!1;function We(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $e(i,n){i=i.updateQueue,n.updateQueue===i&&(n.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Fe(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function it(i,n,o){var d=i.updateQueue;if(d===null)return null;if(d=d.shared,(Di&2)!==0){var _=d.pending;return _===null?n.next=n:(n.next=_.next,_.next=n),d.pending=n,n=Xr(i),vl(i,null,o),n}return tn(i,d,n,o),Xr(i)}function It(i,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194048)!==0)){var d=n.lanes;d&=i.pendingLanes,o|=d,n.lanes=o,Ae(i,o)}}function Ye(i,n){var o=i.updateQueue,d=i.alternate;if(d!==null&&(d=d.updateQueue,o===d)){var _=null,w=null;if(o=o.firstBaseUpdate,o!==null){do{var C={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};w===null?_=w=C:w=w.next=C,o=o.next}while(o!==null);w===null?_=w=n:w=w.next=n}else _=w=n;o={baseState:d.baseState,firstBaseUpdate:_,lastBaseUpdate:w,shared:d.shared,callbacks:d.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=n:i.next=n,o.lastBaseUpdate=n}var Je=!1;function zt(){if(Je){var i=es;if(i!==null)throw i}}function Ci(i,n,o,d){Je=!1;var _=i.updateQueue;Ge=!1;var w=_.firstBaseUpdate,C=_.lastBaseUpdate,U=_.shared.pending;if(U!==null){_.shared.pending=null;var te=U,ve=te.next;te.next=null,C===null?w=ve:C.next=ve,C=te;var Ie=i.alternate;Ie!==null&&(Ie=Ie.updateQueue,U=Ie.lastBaseUpdate,U!==C&&(U===null?Ie.firstBaseUpdate=ve:U.next=ve,Ie.lastBaseUpdate=te))}if(w!==null){var Le=_.baseState;C=0,Ie=ve=te=null,U=w;do{var we=U.lane&-536870913,ze=we!==U.lane;if(ze?(di&we)===we:(d&we)===we){we!==0&&we===Wr&&(Je=!0),Ie!==null&&(Ie=Ie.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var vt=i,Vt=U;we=n;var na=o;switch(Vt.tag){case 1:if(vt=Vt.payload,typeof vt=="function"){Le=vt.call(na,Le,we);break e}Le=vt;break e;case 3:vt.flags=vt.flags&-65537|128;case 0:if(vt=Vt.payload,we=typeof vt=="function"?vt.call(na,Le,we):vt,we==null)break e;Le=me({},Le,we);break e;case 2:Ge=!0}}we=U.callback,we!==null&&(i.flags|=64,ze&&(i.flags|=8192),ze=_.callbacks,ze===null?_.callbacks=[we]:ze.push(we))}else ze={lane:we,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Ie===null?(ve=Ie=ze,te=Le):Ie=Ie.next=ze,C|=we;if(U=U.next,U===null){if(U=_.shared.pending,U===null)break;ze=U,U=ze.next,ze.next=null,_.lastBaseUpdate=ze,_.shared.pending=null}}while(!0);Ie===null&&(te=Le),_.baseState=te,_.firstBaseUpdate=ve,_.lastBaseUpdate=Ie,w===null&&(_.shared.lanes=0),Qo|=C,i.lanes=C,i.memoizedState=Le}}function Gt(i,n){if(typeof i!="function")throw Error(ue(191,i));i.call(n)}function ii(i,n){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)Gt(o[i],n)}var Ei=Q(null),La=Q(0);function Xn(i,n){i=Or,qe(La,i),qe(Ei,n),Or=i|n.baseLanes}function Pi(){qe(La,Or),qe(Ei,Ei.current)}function rn(){Or=La.current,be(Ei),be(La)}var Gi=Q(null),Hi=null;function ga(i){var n=i.alternate;qe(bi,bi.current&1),qe(Gi,i),Hi===null&&(n===null||Ei.current!==null||n.memoizedState!==null)&&(Hi=i)}function $n(i){qe(bi,bi.current),qe(Gi,i),Hi===null&&(Hi=i)}function eo(i){i.tag===22?(qe(bi,bi.current),qe(Gi,i),Hi===null&&(Hi=i)):pr()}function pr(){qe(bi,bi.current),qe(Gi,Gi.current)}function Na(i){be(Gi),Hi===i&&(Hi=null),be(bi)}var bi=Q(0);function to(i){for(var n=i;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Pe(o)||Qe(o)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var mr=0,Rt=null,ri=null,Xi=null,An=!1,ya=!1,_a=!1,sn=0,Wt=0,Yn=null,No=0;function $i(){throw Error(ue(321))}function yu(i,n){if(n===null)return!1;for(var o=0;o<n.length&&o<i.length;o++)if(!dn(i[o],n[o]))return!1;return!0}function cc(i,n,o,d,_,w){return mr=w,Rt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,ge.H=i===null||i.memoizedState===null?ff:md,_a=!1,w=o(d,_),_a=!1,ya&&(w=ts(n,o,d,_)),hc(i),w}function hc(i){ge.H=_c;var n=ri!==null&&ri.next!==null;if(mr=0,Xi=ri=Rt=null,An=!1,Wt=0,Yn=null,n)throw Error(ue(300));i===null||wa||(i=i.dependencies,i!==null&&mu(i)&&(wa=!0))}function ts(i,n,o,d){Rt=i;var _=0;do{if(ya&&(Yn=null),Wt=0,ya=!1,25<=_)throw Error(ue(301));if(_+=1,Xi=ri=null,i.updateQueue!=null){var w=i.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}ge.H=gd,w=n(o,d)}while(ya);return w}function hh(){var i=ge.H,n=i.useState()[0];return n=typeof n.then=="function"?Uo(n):n,i=i.useState()[0],(ri!==null?ri.memoizedState:null)!==i&&(Rt.flags|=1024),n}function Fo(){var i=sn!==0;return sn=0,i}function io(i,n,o){n.updateQueue=i.updateQueue,n.flags&=-2053,i.lanes&=~o}function jo(i){if(An){for(i=i.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}An=!1}mr=0,Xi=ri=Rt=null,ya=!1,Wt=sn=0,Yn=null}function Fa(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xi===null?Rt.memoizedState=Xi=i:Xi=Xi.next=i,Xi}function Qi(){if(ri===null){var i=Rt.alternate;i=i!==null?i.memoizedState:null}else i=ri.next;var n=Xi===null?Rt.memoizedState:Xi.next;if(n!==null)Xi=n,ri=i;else{if(i===null)throw Rt.alternate===null?Error(ue(467)):Error(ue(310));ri=i,i={memoizedState:ri.memoizedState,baseState:ri.baseState,baseQueue:ri.baseQueue,queue:ri.queue,next:null},Xi===null?Rt.memoizedState=Xi=i:Xi=Xi.next=i}return Xi}function _s(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Uo(i){var n=Wt;return Wt+=1,Yn===null&&(Yn=[]),i=P(Yn,i,n),n=Rt,(Xi===null?n.memoizedState:Xi.next)===null&&(n=n.alternate,ge.H=n===null||n.memoizedState===null?ff:md),i}function dc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Uo(i);if(i.$$typeof===dt)return Qt(i)}throw Error(ue(438,String(i)))}function dh(i){var n=null,o=Rt.updateQueue;if(o!==null&&(n=o.memoCache),n==null){var d=Rt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(n={data:d.data.map(function(_){return _.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),o===null&&(o=_s(),Rt.updateQueue=o),o.memoCache=n,o=n.data[n.index],o===void 0)for(o=n.data[n.index]=Array(i),d=0;d<i;d++)o[d]=Si;return n.index++,o}function ao(i,n){return typeof n=="function"?n(i):n}function _u(i){var n=Qi();return Al(n,ri,i)}function Al(i,n,o){var d=i.queue;if(d===null)throw Error(ue(311));d.lastRenderedReducer=o;var _=i.baseQueue,w=d.pending;if(w!==null){if(_!==null){var C=_.next;_.next=w.next,w.next=C}n.baseQueue=_=w,d.pending=null}if(w=i.baseState,_===null)i.memoizedState=w;else{n=_.next;var U=C=null,te=null,ve=n,Ie=!1;do{var Le=ve.lane&-536870913;if(Le!==ve.lane?(di&Le)===Le:(mr&Le)===Le){var we=ve.revertLane;if(we===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),Le===Wr&&(Ie=!0);else if((mr&we)===we){ve=ve.next,we===Wr&&(Ie=!0);continue}else Le={lane:0,revertLane:ve.revertLane,gesture:null,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},te===null?(U=te=Le,C=w):te=te.next=Le,Rt.lanes|=we,Qo|=we;Le=ve.action,_a&&o(w,Le),w=ve.hasEagerState?ve.eagerState:o(w,Le)}else we={lane:Le,revertLane:ve.revertLane,gesture:ve.gesture,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},te===null?(U=te=we,C=w):te=te.next=we,Rt.lanes|=Le,Qo|=Le;ve=ve.next}while(ve!==null&&ve!==n);if(te===null?C=w:te.next=U,!dn(w,i.memoizedState)&&(wa=!0,Ie&&(o=es,o!==null)))throw o;i.memoizedState=w,i.baseState=C,i.baseQueue=te,d.lastRenderedState=w}return _===null&&(d.lanes=0),[i.memoizedState,d.dispatch]}function Vo(i){var n=Qi(),o=n.queue;if(o===null)throw Error(ue(311));o.lastRenderedReducer=i;var d=o.dispatch,_=o.pending,w=n.memoizedState;if(_!==null){o.pending=null;var C=_=_.next;do w=i(w,C.action),C=C.next;while(C!==_);dn(w,n.memoizedState)||(wa=!0),n.memoizedState=w,n.baseQueue===null&&(n.baseState=w),o.lastRenderedState=w}return[w,d]}function vs(i,n,o){var d=Rt,_=Qi(),w=Be;if(w){if(o===void 0)throw Error(ue(407));o=o()}else o=n();var C=!dn((ri||_).memoizedState,o);if(C&&(_.memoizedState=o,wa=!0),_=_.queue,zl(Wh.bind(null,d,_,i),[i]),_.getSnapshot!==n||C||Xi!==null&&Xi.memoizedState.tag&1){if(d.flags|=2048,Ho(9,{destroy:void 0},no.bind(null,d,_,o,n),null),Wi===null)throw Error(ue(349));w||(mr&127)!==0||Lr(d,n,o)}return o}function Lr(i,n,o){i.flags|=16384,i={getSnapshot:n,value:o},n=Rt.updateQueue,n===null?(n=_s(),Rt.updateQueue=n,n.stores=[i]):(o=n.stores,o===null?n.stores=[i]:o.push(i))}function no(i,n,o,d){n.value=o,n.getSnapshot=d,qo(n)&&rf(i)}function Wh(i,n,o){return o(function(){qo(n)&&rf(i)})}function qo(i){var n=i.getSnapshot;i=i.value;try{var o=n();return!dn(i,o)}catch{return!0}}function rf(i){var n=Hr(i,2);n!==null&&zn(n,i,2)}function fh(i){var n=Fa();if(typeof i=="function"){var o=i;if(i=o(),_a){xt(!0);try{o()}finally{xt(!1)}}}return n.memoizedState=n.baseState=i,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ao,lastRenderedState:i},n}function ba(i,n,o,d){return i.baseState=o,Al(i,ri,typeof d=="function"?d:ao)}function ed(i,n,o,d,_){if(vh(i))throw Error(ue(485));if(i=n.action,i!==null){var w={payload:_,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){w.listeners.push(C)}};ge.T!==null?o(!0):w.isTransition=!1,d(w),o=n.pending,o===null?(w.next=n.pending=w,td(n,w)):(w.next=o.next,n.pending=o.next=w)}}function td(i,n){var o=n.action,d=n.payload,_=i.state;if(n.isTransition){var w=ge.T,C={};ge.T=C;try{var U=o(_,d),te=ge.S;te!==null&&te(C,U),Zo(i,n,U)}catch(ve){vu(i,n,ve)}finally{w!==null&&C.types!==null&&(w.types=C.types),ge.T=w}}else try{w=o(_,d),Zo(i,n,w)}catch(ve){vu(i,n,ve)}}function Zo(i,n,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(d){Go(i,n,d)},function(d){return vu(i,n,d)}):Go(i,n,o)}function Go(i,n,o){n.status="fulfilled",n.value=o,ph(n),i.state=o,n=i.pending,n!==null&&(o=n.next,o===n?i.pending=null:(o=o.next,n.next=o,td(i,o)))}function vu(i,n,o){var d=i.pending;if(i.pending=null,d!==null){d=d.next;do n.status="rejected",n.reason=o,ph(n),n=n.next;while(n!==d)}i.action=null}function ph(i){i=i.listeners;for(var n=0;n<i.length;n++)(0,i[n])()}function id(i,n){return n}function sf(i,n){if(Be){var o=Wi.formState;if(o!==null){e:{var d=Rt;if(Be){if(hi){t:{for(var _=hi,w=Tn;_.nodeType!==8;){if(!w){_=null;break t}if(_=Ve(_.nextSibling),_===null){_=null;break t}}w=_.data,_=w==="F!"||w==="F"?_:null}if(_){hi=Ve(_.nextSibling),d=_.data==="F!";break e}}Ln(d)}d=!1}d&&(n=o[0])}}return o=Fa(),o.memoizedState=o.baseState=n,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:id,lastRenderedState:n},o.queue=d,o=Kn.bind(null,Rt,d),d.dispatch=o,d=fh(!1),w=yc.bind(null,Rt,!1,d.queue),d=Fa(),_={state:n,dispatch:null,action:i,pending:null},d.queue=_,o=ed.bind(null,Rt,_,w,o),_.dispatch=o,d.memoizedState=i,[n,o,!1]}function ad(i){var n=Qi();return of(n,ri,i)}function of(i,n,o){if(n=Al(i,n,id)[0],i=_u(ao)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var d=Uo(n)}catch(C){throw C===S?E:C}else d=n;n=Qi();var _=n.queue,w=_.dispatch;return o!==n.memoizedState&&(Rt.flags|=2048,Ho(9,{destroy:void 0},nd.bind(null,_,o),null)),[d,w,i]}function nd(i,n){i.action=n}function lf(i){var n=Qi(),o=ri;if(o!==null)return of(n,o,i);Qi(),n=n.memoizedState,o=Qi();var d=o.queue.dispatch;return o.memoizedState=i,[n,d,!1]}function Ho(i,n,o,d){return i={tag:i,create:o,deps:d,inst:n,next:null},n=Rt.updateQueue,n===null&&(n=_s(),Rt.updateQueue=n),o=n.lastEffect,o===null?n.lastEffect=i.next=i:(d=o.next,o.next=i,i.next=d,n.lastEffect=i),i}function rd(){return Qi().memoizedState}function fc(i,n,o,d){var _=Fa();Rt.flags|=i,_.memoizedState=Ho(1|n,{destroy:void 0},o,d===void 0?null:d)}function ro(i,n,o,d){var _=Qi();d=d===void 0?null:d;var w=_.memoizedState.inst;ri!==null&&d!==null&&yu(d,ri.memoizedState.deps)?_.memoizedState=Ho(n,w,o,d):(Rt.flags|=i,_.memoizedState=Ho(1|n,w,o,d))}function uf(i,n){fc(8390656,8,i,n)}function zl(i,n){ro(2048,8,i,n)}function mh(i){Rt.flags|=4;var n=Rt.updateQueue;if(n===null)n=_s(),Rt.updateQueue=n,n.events=[i];else{var o=n.events;o===null?n.events=[i]:o.push(i)}}function pc(i){var n=Qi().memoizedState;return mh({ref:n,nextImpl:i}),function(){if((Di&2)!==0)throw Error(ue(440));return n.impl.apply(void 0,arguments)}}function sd(i,n){return ro(4,2,i,n)}function od(i,n){return ro(4,4,i,n)}function cf(i,n){if(typeof n=="function"){i=i();var o=n(i);return function(){typeof o=="function"?o():n(null)}}if(n!=null)return i=i(),n.current=i,function(){n.current=null}}function fn(i,n,o){o=o!=null?o.concat([i]):null,ro(4,4,cf.bind(null,n,i),o)}function Xo(){}function gh(i,n){var o=Qi();n=n===void 0?null:n;var d=o.memoizedState;return n!==null&&yu(n,d[1])?d[0]:(o.memoizedState=[i,n],i)}function ld(i,n){var o=Qi();n=n===void 0?null:n;var d=o.memoizedState;if(n!==null&&yu(n,d[1]))return d[0];if(d=i(),_a){xt(!0);try{i()}finally{xt(!1)}}return o.memoizedState=[d,n],d}function El(i,n,o){return o===void 0||(mr&1073741824)!==0&&(di&261930)===0?i.memoizedState=n:(i.memoizedState=o,i=Dh(),Rt.lanes|=i,Qo|=i,o)}function hf(i,n,o,d){return dn(o,n)?o:Ei.current!==null?(i=El(i,o,d),dn(i,n)||(wa=!0),i):(mr&42)===0||(mr&1073741824)!==0&&(di&261930)===0?(wa=!0,i.memoizedState=o):(i=Dh(),Rt.lanes|=i,Qo|=i,n)}function mc(i,n,o,d,_){var w=He.p;He.p=w!==0&&8>w?w:8;var C=ge.T,U={};ge.T=U,yc(i,!1,n,o);try{var te=_(),ve=ge.S;if(ve!==null&&ve(U,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Ie=e(te,d);xu(i,n,Ie,_r(i))}else xu(i,n,d,_r(i))}catch(Le){xu(i,n,{then:function(){},status:"rejected",reason:Le},_r())}finally{He.p=w,C!==null&&U.types!==null&&(C.types=U.types),ge.T=C}}function dp(){}function yh(i,n,o,d){if(i.tag!==5)throw Error(ue(476));var _=ud(i).queue;mc(i,_,n,gt,o===null?dp:function(){return cd(i),o(d)})}function ud(i){var n=i.memoizedState;if(n!==null)return n;n={memoizedState:gt,baseState:gt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ao,lastRenderedState:gt},next:null};var o={};return n.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ao,lastRenderedState:o},next:null},i.memoizedState=n,i=i.alternate,i!==null&&(i.memoizedState=n),n}function cd(i){var n=ud(i);n.next===null&&(n=i.alternate.memoizedState),xu(i,n.next.queue,{},_r())}function hd(){return Qt(Hu)}function _h(){return Qi().memoizedState}function dd(){return Qi().memoizedState}function fd(i){for(var n=i.return;n!==null;){switch(n.tag){case 24:case 3:var o=_r();i=Fe(o);var d=it(n,i,o);d!==null&&(zn(d,n,o),It(d,n,o)),n={cache:Hn()},i.payload=n;return}n=n.return}}function gc(i,n,o){var d=_r();o={lane:d,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},vh(i)?pd(n,o):(o=Js(i,n,o,d),o!==null&&(zn(o,i,d),df(o,n,d)))}function Kn(i,n,o){var d=_r();xu(i,n,o,d)}function xu(i,n,o,d){var _={lane:d,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(vh(i))pd(n,_);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=n.lastRenderedReducer,w!==null))try{var C=n.lastRenderedState,U=w(C,o);if(_.hasEagerState=!0,_.eagerState=U,dn(U,C))return tn(i,n,_,0),Wi===null&&bn(),!1}catch{}finally{}if(o=Js(i,n,_,d),o!==null)return zn(o,i,d),df(o,n,d),!0}return!1}function yc(i,n,o,d){if(d={lane:2,revertLane:Uu(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},vh(i)){if(n)throw Error(ue(479))}else n=Js(i,o,d,2),n!==null&&zn(n,i,2)}function vh(i){var n=i.alternate;return i===Rt||n!==null&&n===Rt}function pd(i,n){ya=An=!0;var o=i.pending;o===null?n.next=n:(n.next=o.next,o.next=n),i.pending=n}function df(i,n,o){if((o&4194048)!==0){var d=n.lanes;d&=i.pendingLanes,o|=d,n.lanes=o,Ae(i,o)}}var _c={readContext:Qt,use:dc,useCallback:$i,useContext:$i,useEffect:$i,useImperativeHandle:$i,useLayoutEffect:$i,useInsertionEffect:$i,useMemo:$i,useReducer:$i,useRef:$i,useState:$i,useDebugValue:$i,useDeferredValue:$i,useTransition:$i,useSyncExternalStore:$i,useId:$i,useHostTransitionStatus:$i,useFormState:$i,useActionState:$i,useOptimistic:$i,useMemoCache:$i,useCacheRefresh:$i};_c.useEffectEvent=$i;var ff={readContext:Qt,use:dc,useCallback:function(i,n){return Fa().memoizedState=[i,n===void 0?null:n],i},useContext:Qt,useEffect:uf,useImperativeHandle:function(i,n,o){o=o!=null?o.concat([i]):null,fc(4194308,4,cf.bind(null,n,i),o)},useLayoutEffect:function(i,n){return fc(4194308,4,i,n)},useInsertionEffect:function(i,n){fc(4,2,i,n)},useMemo:function(i,n){var o=Fa();n=n===void 0?null:n;var d=i();if(_a){xt(!0);try{i()}finally{xt(!1)}}return o.memoizedState=[d,n],d},useReducer:function(i,n,o){var d=Fa();if(o!==void 0){var _=o(n);if(_a){xt(!0);try{o(n)}finally{xt(!1)}}}else _=n;return d.memoizedState=d.baseState=_,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:_},d.queue=i,i=i.dispatch=gc.bind(null,Rt,i),[d.memoizedState,i]},useRef:function(i){var n=Fa();return i={current:i},n.memoizedState=i},useState:function(i){i=fh(i);var n=i.queue,o=Kn.bind(null,Rt,n);return n.dispatch=o,[i.memoizedState,o]},useDebugValue:Xo,useDeferredValue:function(i,n){var o=Fa();return El(o,i,n)},useTransition:function(){var i=fh(!1);return i=mc.bind(null,Rt,i.queue,!0,!1),Fa().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,n,o){var d=Rt,_=Fa();if(Be){if(o===void 0)throw Error(ue(407));o=o()}else{if(o=n(),Wi===null)throw Error(ue(349));(di&127)!==0||Lr(d,n,o)}_.memoizedState=o;var w={value:o,getSnapshot:n};return _.queue=w,uf(Wh.bind(null,d,w,i),[i]),d.flags|=2048,Ho(9,{destroy:void 0},no.bind(null,d,w,o,n),null),o},useId:function(){var i=Fa(),n=Wi.identifierPrefix;if(Be){var o=nn,d=Ea;o=(d&~(1<<32-Ki(d)-1)).toString(32)+o,n="_"+n+"R_"+o,o=sn++,0<o&&(n+="H"+o.toString(32)),n+="_"}else o=No++,n="_"+n+"r_"+o.toString(32)+"_";return i.memoizedState=n},useHostTransitionStatus:hd,useFormState:sf,useActionState:sf,useOptimistic:function(i){var n=Fa();n.memoizedState=n.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=o,n=yc.bind(null,Rt,!0,o),o.dispatch=n,[i,n]},useMemoCache:dh,useCacheRefresh:function(){return Fa().memoizedState=fd.bind(null,Rt)},useEffectEvent:function(i){var n=Fa(),o={impl:i};return n.memoizedState=o,function(){if((Di&2)!==0)throw Error(ue(440));return o.impl.apply(void 0,arguments)}}},md={readContext:Qt,use:dc,useCallback:gh,useContext:Qt,useEffect:zl,useImperativeHandle:fn,useInsertionEffect:sd,useLayoutEffect:od,useMemo:ld,useReducer:_u,useRef:rd,useState:function(){return _u(ao)},useDebugValue:Xo,useDeferredValue:function(i,n){var o=Qi();return hf(o,ri.memoizedState,i,n)},useTransition:function(){var i=_u(ao)[0],n=Qi().memoizedState;return[typeof i=="boolean"?i:Uo(i),n]},useSyncExternalStore:vs,useId:_h,useHostTransitionStatus:hd,useFormState:ad,useActionState:ad,useOptimistic:function(i,n){var o=Qi();return ba(o,ri,i,n)},useMemoCache:dh,useCacheRefresh:dd};md.useEffectEvent=pc;var gd={readContext:Qt,use:dc,useCallback:gh,useContext:Qt,useEffect:zl,useImperativeHandle:fn,useInsertionEffect:sd,useLayoutEffect:od,useMemo:ld,useReducer:Vo,useRef:rd,useState:function(){return Vo(ao)},useDebugValue:Xo,useDeferredValue:function(i,n){var o=Qi();return ri===null?El(o,i,n):hf(o,ri.memoizedState,i,n)},useTransition:function(){var i=Vo(ao)[0],n=Qi().memoizedState;return[typeof i=="boolean"?i:Uo(i),n]},useSyncExternalStore:vs,useId:_h,useHostTransitionStatus:hd,useFormState:lf,useActionState:lf,useOptimistic:function(i,n){var o=Qi();return ri!==null?ba(o,ri,i,n):(o.baseState=i,[i,o.queue.dispatch])},useMemoCache:dh,useCacheRefresh:dd};gd.useEffectEvent=pc;function xh(i,n,o,d){n=i.memoizedState,o=o(d,n),o=o==null?n:me({},n,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var so={enqueueSetState:function(i,n,o){i=i._reactInternals;var d=_r(),_=Fe(d);_.payload=n,o!=null&&(_.callback=o),n=it(i,_,d),n!==null&&(zn(n,i,d),It(n,i,d))},enqueueReplaceState:function(i,n,o){i=i._reactInternals;var d=_r(),_=Fe(d);_.tag=1,_.payload=n,o!=null&&(_.callback=o),n=it(i,_,d),n!==null&&(zn(n,i,d),It(n,i,d))},enqueueForceUpdate:function(i,n){i=i._reactInternals;var o=_r(),d=Fe(o);d.tag=2,n!=null&&(d.callback=n),n=it(i,d,o),n!==null&&(zn(n,i,o),It(n,i,o))}};function bu(i,n,o,d,_,w,C){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(d,w,C):n.prototype&&n.prototype.isPureReactComponent?!ui(o,d)||!ui(_,w):!0}function pf(i,n,o,d){i=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,d),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,d),n.state!==i&&so.enqueueReplaceState(n,n.state,null)}function Ml(i,n){var o=n;if("ref"in n){o={};for(var d in n)d!=="ref"&&(o[d]=n[d])}if(i=i.defaultProps){o===n&&(o=me({},o));for(var _ in i)o[_]===void 0&&(o[_]=i[_])}return o}function mf(i){Cr(i)}function gf(i){console.error(i)}function yf(i){Cr(i)}function bh(i,n){try{var o=i.onUncaughtError;o(n.value,{componentStack:n.stack})}catch(d){setTimeout(function(){throw d})}}function _f(i,n,o){try{var d=i.onCaughtError;d(o.value,{componentStack:o.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function vc(i,n,o){return o=Fe(o),o.tag=3,o.payload={element:null},o.callback=function(){bh(i,n)},o}function vf(i){return i=Fe(i),i.tag=3,i}function Cl(i,n,o,d){var _=o.type.getDerivedStateFromError;if(typeof _=="function"){var w=d.value;i.payload=function(){return _(w)},i.callback=function(){_f(n,o,d)}}var C=o.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(i.callback=function(){_f(n,o,d),typeof _!="function"&&(ho===null?ho=new Set([this]):ho.add(this));var U=d.stack;this.componentDidCatch(d.value,{componentStack:U!==null?U:""})})}function fp(i,n,o,d,_){if(o.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(n=o.alternate,n!==null&&Oo(n,o,_,!0),o=Gi.current,o!==null){switch(o.tag){case 31:case 13:return Hi===null?Ih():o.alternate===null&&da===0&&(da=3),o.flags&=-257,o.flags|=65536,o.lanes=_,d===D?o.flags|=16384:(n=o.updateQueue,n===null?o.updateQueue=new Set([d]):n.add(d),Lh(i,d,_)),!1;case 22:return o.flags|=65536,d===D?o.flags|=16384:(n=o.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([d])},o.updateQueue=n):(o=n.retryQueue,o===null?n.retryQueue=new Set([d]):o.add(d)),Lh(i,d,_)),!1}throw Error(ue(435,o.tag))}return Lh(i,d,_),Ih(),!1}if(Be)return n=Gi.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=_,d!==fu&&(i=Error(ue(422),{cause:d}),Ws(Sn(i,o)))):(d!==fu&&(n=Error(ue(423),{cause:d}),Ws(Sn(n,o))),i=i.current.alternate,i.flags|=65536,_&=-_,i.lanes|=_,d=Sn(d,o),_=vc(i.stateNode,d,_),Ye(i,_),da!==4&&(da=2)),!1;var w=Error(ue(520),{cause:d});if(w=Sn(w,o),Lu===null?Lu=[w]:Lu.push(w),da!==4&&(da=2),n===null)return!0;d=Sn(d,o),o=n;do{switch(o.tag){case 3:return o.flags|=65536,i=_&-_,o.lanes|=i,i=vc(o.stateNode,d,i),Ye(o,i),!1;case 1:if(n=o.type,w=o.stateNode,(o.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ho===null||!ho.has(w))))return o.flags|=65536,_&=-_,o.lanes|=_,_=vf(_),Cl(_,i,o,d),Ye(o,_),!1}o=o.return}while(o!==null);return!1}var ua=Error(ue(461)),wa=!1;function on(i,n,o,d){n.child=i===null?Oe(n,null,o,d):De(n,i.child,o,d)}function xc(i,n,o,d,_){o=o.render;var w=n.ref;if("ref"in d){var C={};for(var U in d)U!=="ref"&&(C[U]=d[U])}else C=d;return Ra(n),d=cc(i,n,o,C,w,_),U=Fo(),i!==null&&!wa?(io(i,n,_),xs(i,n,_)):(Be&&U&&cu(n),n.flags|=1,on(i,n,d,_),n.child)}function bc(i,n,o,d,_){if(i===null){var w=o.type;return typeof w=="function"&&!xl(w)&&w.defaultProps===void 0&&o.compare===null?(n.tag=15,n.type=w,wu(i,n,w,d,_)):(i=Ro(o.type,null,d,n,n.mode,_),i.ref=n.ref,i.return=n,n.child=i)}if(w=i.child,!Th(i,_)){var C=w.memoizedProps;if(o=o.compare,o=o!==null?o:ui,o(C,d)&&i.ref===n.ref)return xs(i,n,_)}return n.flags|=1,i=Zn(w,d),i.ref=n.ref,i.return=n,n.child=i}function wu(i,n,o,d,_){if(i!==null){var w=i.memoizedProps;if(ui(w,d)&&i.ref===n.ref)if(wa=!1,n.pendingProps=d=w,Th(i,_))(i.flags&131072)!==0&&(wa=!0);else return n.lanes=i.lanes,xs(i,n,_)}return Sh(i,n,o,d,_)}function yd(i,n,o,d){var _=d.children,w=i!==null?i.memoizedState:null;if(i===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((n.flags&128)!==0){if(w=w!==null?w.baseLanes|o:o,i!==null){for(d=n.child=i.child,_=0;d!==null;)_=_|d.lanes|d.childLanes,d=d.sibling;d=_&~w}else d=0,n.child=null;return Tu(i,n,w,o,d)}if((o&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},i!==null&&f(n,w!==null?w.cachePool:null),w!==null?Xn(n,w):Pi(),eo(n);else return d=n.lanes=536870912,Tu(i,n,w!==null?w.baseLanes|o:o,o,d)}else w!==null?(f(n,w.cachePool),Xn(n,w),pr(),n.memoizedState=null):(i!==null&&f(n,null),Pi(),pr());return on(i,n,_,o),n.child}function Su(i,n){return i!==null&&i.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Tu(i,n,o,d,_){var w=c();return w=w===null?null:{parent:aa._currentValue,pool:w},n.memoizedState={baseLanes:o,cachePool:w},i!==null&&f(n,null),Pi(),eo(n),i!==null&&Oo(i,n,d,!0),n.childLanes=_,null}function Au(i,n){return n=wc({mode:n.mode,children:n.children},i.mode),n.ref=i.ref,i.child=n,n.return=i,n}function wh(i,n,o){return De(n,i.child,null,o),i=Au(n,n.pendingProps),i.flags|=2,Na(n),n.memoizedState=null,i}function _d(i,n,o){var d=n.pendingProps,_=(n.flags&128)!==0;if(n.flags&=-129,i===null){if(Be){if(d.mode==="hidden")return i=Au(n,d),n.lanes=536870912,Su(null,i);if($n(n),(i=hi)?(i=Se(i,Tn),i=i!==null&&i.data==="&"?i:null,i!==null&&(n.memoizedState={dehydrated:i,treeContext:Dr!==null?{id:Ea,overflow:nn}:null,retryLane:536870912,hydrationErrors:null},o=Bo(i),o.return=n,n.child=o,ma=n,hi=null)):i=null,i===null)throw Ln(n);return n.lanes=536870912,null}return Au(n,d)}var w=i.memoizedState;if(w!==null){var C=w.dehydrated;if($n(n),_)if(n.flags&256)n.flags&=-257,n=wh(i,n,o);else if(n.memoizedState!==null)n.child=i.child,n.flags|=128,n=null;else throw Error(ue(558));else if(wa||Oo(i,n,o,!1),_=(o&i.childLanes)!==0,wa||_){if(d=Wi,d!==null&&(C=ke(d,o),C!==0&&C!==w.retryLane))throw w.retryLane=C,Hr(i,C),zn(d,i,C),ua;Ih(),n=wh(i,n,o)}else i=w.treeContext,hi=Ve(C.nextSibling),ma=n,Be=!0,fr=null,Tn=!1,i!==null&&du(n,i),n=Au(n,d),n.flags|=4096;return n}return i=Zn(i.child,{mode:d.mode,children:d.children}),i.ref=n.ref,n.child=i,i.return=n,i}function zu(i,n){var o=n.ref;if(o===null)i!==null&&i.ref!==null&&(n.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(ue(284));(i===null||i.ref!==o)&&(n.flags|=4194816)}}function Sh(i,n,o,d,_){return Ra(n),o=cc(i,n,o,d,void 0,_),d=Fo(),i!==null&&!wa?(io(i,n,_),xs(i,n,_)):(Be&&d&&cu(n),n.flags|=1,on(i,n,o,_),n.child)}function vd(i,n,o,d,_,w){return Ra(n),n.updateQueue=null,o=ts(n,d,o,_),hc(i),d=Fo(),i!==null&&!wa?(io(i,n,w),xs(i,n,w)):(Be&&d&&cu(n),n.flags|=1,on(i,n,o,w),n.child)}function xf(i,n,o,d,_){if(Ra(n),n.stateNode===null){var w=wn,C=o.contextType;typeof C=="object"&&C!==null&&(w=Qt(C)),w=new o(d,w),n.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=so,n.stateNode=w,w._reactInternals=n,w=n.stateNode,w.props=d,w.state=n.memoizedState,w.refs={},We(n),C=o.contextType,w.context=typeof C=="object"&&C!==null?Qt(C):wn,w.state=n.memoizedState,C=o.getDerivedStateFromProps,typeof C=="function"&&(xh(n,o,C,d),w.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(C=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),C!==w.state&&so.enqueueReplaceState(w,w.state,null),Ci(n,d,w,_),zt(),w.state=n.memoizedState),typeof w.componentDidMount=="function"&&(n.flags|=4194308),d=!0}else if(i===null){w=n.stateNode;var U=n.memoizedProps,te=Ml(o,U);w.props=te;var ve=w.context,Ie=o.contextType;C=wn,typeof Ie=="object"&&Ie!==null&&(C=Qt(Ie));var Le=o.getDerivedStateFromProps;Ie=typeof Le=="function"||typeof w.getSnapshotBeforeUpdate=="function",U=n.pendingProps!==U,Ie||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(U||ve!==C)&&pf(n,w,d,C),Ge=!1;var we=n.memoizedState;w.state=we,Ci(n,d,w,_),zt(),ve=n.memoizedState,U||we!==ve||Ge?(typeof Le=="function"&&(xh(n,o,Le,d),ve=n.memoizedState),(te=Ge||bu(n,o,te,d,we,ve,C))?(Ie||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(n.flags|=4194308)):(typeof w.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=d,n.memoizedState=ve),w.props=d,w.state=ve,w.context=C,d=te):(typeof w.componentDidMount=="function"&&(n.flags|=4194308),d=!1)}else{w=n.stateNode,$e(i,n),C=n.memoizedProps,Ie=Ml(o,C),w.props=Ie,Le=n.pendingProps,we=w.context,ve=o.contextType,te=wn,typeof ve=="object"&&ve!==null&&(te=Qt(ve)),U=o.getDerivedStateFromProps,(ve=typeof U=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(C!==Le||we!==te)&&pf(n,w,d,te),Ge=!1,we=n.memoizedState,w.state=we,Ci(n,d,w,_),zt();var ze=n.memoizedState;C!==Le||we!==ze||Ge||i!==null&&i.dependencies!==null&&mu(i.dependencies)?(typeof U=="function"&&(xh(n,o,U,d),ze=n.memoizedState),(Ie=Ge||bu(n,o,Ie,d,we,ze,te)||i!==null&&i.dependencies!==null&&mu(i.dependencies))?(ve||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(d,ze,te),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(d,ze,te)),typeof w.componentDidUpdate=="function"&&(n.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof w.componentDidUpdate!="function"||C===i.memoizedProps&&we===i.memoizedState||(n.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&we===i.memoizedState||(n.flags|=1024),n.memoizedProps=d,n.memoizedState=ze),w.props=d,w.state=ze,w.context=te,d=Ie):(typeof w.componentDidUpdate!="function"||C===i.memoizedProps&&we===i.memoizedState||(n.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&we===i.memoizedState||(n.flags|=1024),d=!1)}return w=d,zu(i,n),d=(n.flags&128)!==0,w||d?(w=n.stateNode,o=d&&typeof o.getDerivedStateFromError!="function"?null:w.render(),n.flags|=1,i!==null&&d?(n.child=De(n,i.child,null,_),n.child=De(n,null,o,_)):on(i,n,o,_),n.memoizedState=w.state,i=n.child):i=xs(i,n,_),i}function bf(i,n,o,d){return Kr(),n.flags|=256,on(i,n,o,d),n.child}var xd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bd(i){return{baseLanes:i,cachePool:x()}}function wd(i,n,o){return i=i!==null?i.childLanes&~o:0,n&&(i|=Wn),i}function oo(i,n,o){var d=n.pendingProps,_=!1,w=(n.flags&128)!==0,C;if((C=w)||(C=i!==null&&i.memoizedState===null?!1:(bi.current&2)!==0),C&&(_=!0,n.flags&=-129),C=(n.flags&32)!==0,n.flags&=-33,i===null){if(Be){if(_?ga(n):pr(),(i=hi)?(i=Se(i,Tn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(n.memoizedState={dehydrated:i,treeContext:Dr!==null?{id:Ea,overflow:nn}:null,retryLane:536870912,hydrationErrors:null},o=Bo(i),o.return=n,n.child=o,ma=n,hi=null)):i=null,i===null)throw Ln(n);return Qe(i)?n.lanes=32:n.lanes=536870912,null}var U=d.children;return d=d.fallback,_?(pr(),_=n.mode,U=wc({mode:"hidden",children:U},_),d=Rn(d,_,o,null),U.return=n,d.return=n,U.sibling=d,n.child=U,d=n.child,d.memoizedState=bd(o),d.childLanes=wd(i,C,o),n.memoizedState=xd,Su(null,d)):(ga(n),Sd(n,U))}var te=i.memoizedState;if(te!==null&&(U=te.dehydrated,U!==null)){if(w)n.flags&256?(ga(n),n.flags&=-257,n=$o(i,n,o)):n.memoizedState!==null?(pr(),n.child=i.child,n.flags|=128,n=null):(pr(),U=d.fallback,_=n.mode,d=wc({mode:"visible",children:d.children},_),U=Rn(U,_,o,null),U.flags|=2,d.return=n,U.return=n,d.sibling=U,n.child=d,De(n,i.child,null,o),d=n.child,d.memoizedState=bd(o),d.childLanes=wd(i,C,o),n.memoizedState=xd,n=Su(null,d));else if(ga(n),Qe(U)){if(C=U.nextSibling&&U.nextSibling.dataset,C)var ve=C.dgst;C=ve,d=Error(ue(419)),d.stack="",d.digest=C,Ws({value:d,source:null,stack:null}),n=$o(i,n,o)}else if(wa||Oo(i,n,o,!1),C=(o&i.childLanes)!==0,wa||C){if(C=Wi,C!==null&&(d=ke(C,o),d!==0&&d!==te.retryLane))throw te.retryLane=d,Hr(i,d),zn(C,i,d),ua;Pe(U)||Ih(),n=$o(i,n,o)}else Pe(U)?(n.flags|=192,n.child=i.child,n=null):(i=te.treeContext,hi=Ve(U.nextSibling),ma=n,Be=!0,fr=null,Tn=!1,i!==null&&du(n,i),n=Sd(n,d.children),n.flags|=4096);return n}return _?(pr(),U=d.fallback,_=n.mode,te=i.child,ve=te.sibling,d=Zn(te,{mode:"hidden",children:d.children}),d.subtreeFlags=te.subtreeFlags&65011712,ve!==null?U=Zn(ve,U):(U=Rn(U,_,o,null),U.flags|=2),U.return=n,d.return=n,d.sibling=U,n.child=d,Su(null,d),d=n.child,U=i.child.memoizedState,U===null?U=bd(o):(_=U.cachePool,_!==null?(te=aa._currentValue,_=_.parent!==te?{parent:te,pool:te}:_):_=x(),U={baseLanes:U.baseLanes|o,cachePool:_}),d.memoizedState=U,d.childLanes=wd(i,C,o),n.memoizedState=xd,Su(i.child,d)):(ga(n),o=i.child,i=o.sibling,o=Zn(o,{mode:"visible",children:d.children}),o.return=n,o.sibling=null,i!==null&&(C=n.deletions,C===null?(n.deletions=[i],n.flags|=16):C.push(i)),n.child=o,n.memoizedState=null,o)}function Sd(i,n){return n=wc({mode:"visible",children:n},i.mode),n.return=i,i.child=n}function wc(i,n){return i=an(22,i,null,n),i.lanes=0,i}function $o(i,n,o){return De(n,i.child,null,o),i=Sd(n,n.pendingProps.children),i.flags|=2,n.memoizedState=null,i}function wf(i,n,o){i.lanes|=n;var d=i.alternate;d!==null&&(d.lanes|=n),lc(i.return,n,o)}function Td(i,n,o,d,_,w){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:d,tail:o,tailMode:_,treeForkCount:w}:(C.isBackwards=n,C.rendering=null,C.renderingStartTime=0,C.last=d,C.tail=o,C.tailMode=_,C.treeForkCount=w)}function Sf(i,n,o){var d=n.pendingProps,_=d.revealOrder,w=d.tail;d=d.children;var C=bi.current,U=(C&2)!==0;if(U?(C=C&1|2,n.flags|=128):C&=1,qe(bi,C),on(i,n,d,o),d=Be?Po:0,!U&&i!==null&&(i.flags&128)!==0)e:for(i=n.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&wf(i,o,n);else if(i.tag===19)wf(i,o,n);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(_){case"forwards":for(o=n.child,_=null;o!==null;)i=o.alternate,i!==null&&to(i)===null&&(_=o),o=o.sibling;o=_,o===null?(_=n.child,n.child=null):(_=o.sibling,o.sibling=null),Td(n,!1,_,o,w,d);break;case"backwards":case"unstable_legacy-backwards":for(o=null,_=n.child,n.child=null;_!==null;){if(i=_.alternate,i!==null&&to(i)===null){n.child=_;break}i=_.sibling,_.sibling=o,o=_,_=i}Td(n,!0,o,null,w,d);break;case"together":Td(n,!1,null,null,void 0,d);break;default:n.memoizedState=null}return n.child}function xs(i,n,o){if(i!==null&&(n.dependencies=i.dependencies),Qo|=n.lanes,(o&n.childLanes)===0)if(i!==null){if(Oo(i,n,o,!1),(o&n.childLanes)===0)return null}else return null;if(i!==null&&n.child!==i.child)throw Error(ue(153));if(n.child!==null){for(i=n.child,o=Zn(i,i.pendingProps),n.child=o,o.return=n;i.sibling!==null;)i=i.sibling,o=o.sibling=Zn(i,i.pendingProps),o.return=n;o.sibling=null}return n.child}function Th(i,n){return(i.lanes&n)!==0?!0:(i=i.dependencies,!!(i!==null&&mu(i)))}function pp(i,n,o){switch(n.tag){case 3:qi(n,n.stateNode.containerInfo),kr(n,aa,i.memoizedState.cache),Kr();break;case 27:case 5:rr(n);break;case 4:qi(n,n.stateNode.containerInfo);break;case 10:kr(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,$n(n),null;break;case 13:var d=n.memoizedState;if(d!==null)return d.dehydrated!==null?(ga(n),n.flags|=128,null):(o&n.child.childLanes)!==0?oo(i,n,o):(ga(n),i=xs(i,n,o),i!==null?i.sibling:null);ga(n);break;case 19:var _=(i.flags&128)!==0;if(d=(o&n.childLanes)!==0,d||(Oo(i,n,o,!1),d=(o&n.childLanes)!==0),_){if(d)return Sf(i,n,o);n.flags|=128}if(_=n.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),qe(bi,bi.current),d)break;return null;case 22:return n.lanes=0,yd(i,n,o,n.pendingProps);case 24:kr(n,aa,i.memoizedState.cache)}return xs(i,n,o)}function Tf(i,n,o){if(i!==null)if(i.memoizedProps!==n.pendingProps)wa=!0;else{if(!Th(i,o)&&(n.flags&128)===0)return wa=!1,pp(i,n,o);wa=(i.flags&131072)!==0}else wa=!1,Be&&(n.flags&1048576)!==0&&uh(n,Po,n.index);switch(n.lanes=0,n.tag){case 16:e:{var d=n.pendingProps;if(i=j(n.elementType),n.type=i,typeof i=="function")xl(i)?(d=Ml(i,d),n.tag=1,n=xf(null,n,i,d,o)):(n.tag=0,n=Sh(null,n,i,d,o));else{if(i!=null){var _=i.$$typeof;if(_===ft){n.tag=11,n=xc(null,n,i,d,o);break e}else if(_===ot){n.tag=14,n=bc(null,n,i,d,o);break e}}throw n=li(i)||i,Error(ue(306,n,""))}}return n;case 0:return Sh(i,n,n.type,n.pendingProps,o);case 1:return d=n.type,_=Ml(d,n.pendingProps),xf(i,n,d,_,o);case 3:e:{if(qi(n,n.stateNode.containerInfo),i===null)throw Error(ue(387));d=n.pendingProps;var w=n.memoizedState;_=w.element,$e(i,n),Ci(n,d,null,o);var C=n.memoizedState;if(d=C.cache,kr(n,aa,d),d!==w.cache&&wl(n,[aa],o,!0),zt(),d=C.element,w.isDehydrated)if(w={element:d,isDehydrated:!1,cache:C.cache},n.updateQueue.baseState=w,n.memoizedState=w,n.flags&256){n=bf(i,n,d,o);break e}else if(d!==_){_=Sn(Error(ue(424)),n),Ws(_),n=bf(i,n,d,o);break e}else{switch(i=n.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(hi=Ve(i.firstChild),ma=n,Be=!0,fr=null,Tn=!0,o=Oe(n,null,d,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Kr(),d===_){n=xs(i,n,o);break e}on(i,n,d,o)}n=n.child}return n;case 26:return zu(i,n),i===null?(o=Ka(n.type,null,n.pendingProps,null))?n.memoizedState=o:Be||(o=n.type,i=n.pendingProps,d=h(Lt.current).createElement(o),d[yt]=n,d[jt]=i,$a(d,o,i),za(d),n.stateNode=d):n.memoizedState=Ka(n.type,i.memoizedProps,n.pendingProps,i.memoizedState),null;case 27:return rr(n),i===null&&Be&&(d=n.stateNode=tt(n.type,n.pendingProps,Lt.current),ma=n,Tn=!0,_=hi,F(n.type)?(Ke=_,hi=Ve(d.firstChild)):hi=_),on(i,n,n.pendingProps.children,o),zu(i,n),i===null&&(n.flags|=4194304),n.child;case 5:return i===null&&Be&&((_=d=hi)&&(d=ae(d,n.type,n.pendingProps,Tn),d!==null?(n.stateNode=d,ma=n,hi=Ve(d.firstChild),Tn=!1,_=!0):_=!1),_||Ln(n)),rr(n),_=n.type,w=n.pendingProps,C=i!==null?i.memoizedProps:null,d=w.children,v(_,w)?d=null:C!==null&&v(_,C)&&(n.flags|=32),n.memoizedState!==null&&(_=cc(i,n,hh,null,null,o),Hu._currentValue=_),zu(i,n),on(i,n,d,o),n.child;case 6:return i===null&&Be&&((i=o=hi)&&(o=le(o,n.pendingProps,Tn),o!==null?(n.stateNode=o,ma=n,hi=null,i=!0):i=!1),i||Ln(n)),null;case 13:return oo(i,n,o);case 4:return qi(n,n.stateNode.containerInfo),d=n.pendingProps,i===null?n.child=De(n,null,d,o):on(i,n,d,o),n.child;case 11:return xc(i,n,n.type,n.pendingProps,o);case 7:return on(i,n,n.pendingProps,o),n.child;case 8:return on(i,n,n.pendingProps.children,o),n.child;case 12:return on(i,n,n.pendingProps.children,o),n.child;case 10:return d=n.pendingProps,kr(n,n.type,d.value),on(i,n,d.children,o),n.child;case 9:return _=n.type._context,d=n.pendingProps.children,Ra(n),_=Qt(_),d=d(_),n.flags|=1,on(i,n,d,o),n.child;case 14:return bc(i,n,n.type,n.pendingProps,o);case 15:return wu(i,n,n.type,n.pendingProps,o);case 19:return Sf(i,n,o);case 31:return _d(i,n,o);case 22:return yd(i,n,o,n.pendingProps);case 24:return Ra(n),d=Qt(aa),i===null?(_=c(),_===null&&(_=Wi,w=Hn(),_.pooledCache=w,w.refCount++,w!==null&&(_.pooledCacheLanes|=o),_=w),n.memoizedState={parent:d,cache:_},We(n),kr(n,aa,_)):((i.lanes&o)!==0&&($e(i,n),Ci(n,null,null,o),zt()),_=i.memoizedState,w=n.memoizedState,_.parent!==d?(_={parent:d,cache:d},n.memoizedState=_,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=_),kr(n,aa,d)):(d=w.cache,kr(n,aa,d),d!==_.cache&&wl(n,[aa],o,!0))),on(i,n,n.pendingProps.children,o),n.child;case 29:throw n.pendingProps}throw Error(ue(156,n.tag))}function lo(i){i.flags|=4}function Ad(i,n,o,d,_){if((n=(i.mode&32)!==0)&&(n=!1),n){if(i.flags|=16777216,(_&335544128)===_)if(i.stateNode.complete)i.flags|=8192;else if(jf())i.flags|=8192;else throw q=D,T}else i.flags&=-16777217}function Ah(i,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Ha(n))if(jf())i.flags|=8192;else throw q=D,T}function Yo(i,n){n!==null&&(i.flags|=4),i.flags&16384&&(n=i.tag!==22?H():536870912,i.lanes|=n,Ru|=n)}function Dl(i,n){if(!Be)switch(i.tailMode){case"hidden":n=i.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?n||i.tail===null?i.tail=null:i.tail.sibling=null:d.sibling=null}}function ca(i){var n=i.alternate!==null&&i.alternate.child===i.child,o=0,d=0;if(n)for(var _=i.child;_!==null;)o|=_.lanes|_.childLanes,d|=_.subtreeFlags&65011712,d|=_.flags&65011712,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)o|=_.lanes|_.childLanes,d|=_.subtreeFlags,d|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=d,i.childLanes=o,n}function mp(i,n,o){var d=n.pendingProps;switch(hu(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ca(n),null;case 1:return ca(n),null;case 3:return o=n.stateNode,d=null,i!==null&&(d=i.memoizedState.cache),n.memoizedState.cache!==d&&(n.flags|=2048),Rr(aa),Ai(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&($t(n)?lo(n):i===null||i.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,sc())),ca(n),null;case 26:var _=n.type,w=n.memoizedState;return i===null?(lo(n),w!==null?(ca(n),Ah(n,w)):(ca(n),Ad(n,_,null,d,o))):w?w!==i.memoizedState?(lo(n),ca(n),Ah(n,w)):(ca(n),n.flags&=-16777217):(i=i.memoizedProps,i!==d&&lo(n),ca(n),Ad(n,_,i,d,o)),null;case 27:if(ss(n),o=Lt.current,_=n.type,i!==null&&n.stateNode!=null)i.memoizedProps!==d&&lo(n);else{if(!d){if(n.stateNode===null)throw Error(ue(166));return ca(n),null}i=et.current,$t(n)?Qs(n):(i=tt(_,d,o),n.stateNode=i,lo(n))}return ca(n),null;case 5:if(ss(n),_=n.type,i!==null&&n.stateNode!=null)i.memoizedProps!==d&&lo(n);else{if(!d){if(n.stateNode===null)throw Error(ue(166));return ca(n),null}if(w=et.current,$t(n))Qs(n);else{var C=h(Lt.current);switch(w){case 1:w=C.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:w=C.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":w=C.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":w=C.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":w=C.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof d.is=="string"?C.createElement("select",{is:d.is}):C.createElement("select"),d.multiple?w.multiple=!0:d.size&&(w.size=d.size);break;default:w=typeof d.is=="string"?C.createElement(_,{is:d.is}):C.createElement(_)}}w[yt]=n,w[jt]=d;e:for(C=n.child;C!==null;){if(C.tag===5||C.tag===6)w.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===n)break e;for(;C.sibling===null;){if(C.return===null||C.return===n)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}n.stateNode=w;e:switch($a(w,_,d),_){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&lo(n)}}return ca(n),Ad(n,n.type,i===null?null:i.memoizedProps,n.pendingProps,o),null;case 6:if(i&&n.stateNode!=null)i.memoizedProps!==d&&lo(n);else{if(typeof d!="string"&&n.stateNode===null)throw Error(ue(166));if(i=Lt.current,$t(n)){if(i=n.stateNode,o=n.memoizedProps,d=null,_=ma,_!==null)switch(_.tag){case 27:case 5:d=_.memoizedProps}i[yt]=n,i=!!(i.nodeValue===o||d!==null&&d.suppressHydrationWarning===!0||qu(i.nodeValue,o)),i||Ln(n,!0)}else i=h(i).createTextNode(d),i[yt]=n,n.stateNode=i}return ca(n),null;case 31:if(o=n.memoizedState,i===null||i.memoizedState!==null){if(d=$t(n),o!==null){if(i===null){if(!d)throw Error(ue(318));if(i=n.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(557));i[yt]=n}else Kr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ca(n),i=!1}else o=sc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=o),i=!0;if(!i)return n.flags&256?(Na(n),n):(Na(n),null);if((n.flags&128)!==0)throw Error(ue(558))}return ca(n),null;case 13:if(d=n.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(_=$t(n),d!==null&&d.dehydrated!==null){if(i===null){if(!_)throw Error(ue(318));if(_=n.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(ue(317));_[yt]=n}else Kr(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ca(n),_=!1}else _=sc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=_),_=!0;if(!_)return n.flags&256?(Na(n),n):(Na(n),null)}return Na(n),(n.flags&128)!==0?(n.lanes=o,n):(o=d!==null,i=i!==null&&i.memoizedState!==null,o&&(d=n.child,_=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(_=d.alternate.memoizedState.cachePool.pool),w=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(w=d.memoizedState.cachePool.pool),w!==_&&(d.flags|=2048)),o!==i&&o&&(n.child.flags|=8192),Yo(n,n.updateQueue),ca(n),null);case 4:return Ai(),i===null&&$d(n.stateNode.containerInfo),ca(n),null;case 10:return Rr(n.type),ca(n),null;case 19:if(be(bi),d=n.memoizedState,d===null)return ca(n),null;if(_=(n.flags&128)!==0,w=d.rendering,w===null)if(_)Dl(d,!1);else{if(da!==0||i!==null&&(i.flags&128)!==0)for(i=n.child;i!==null;){if(w=to(i),w!==null){for(n.flags|=128,Dl(d,!1),i=w.updateQueue,n.updateQueue=i,Yo(n,i),n.subtreeFlags=0,i=o,o=n.child;o!==null;)lu(o,i),o=o.sibling;return qe(bi,bi.current&1|2),Be&&Yr(n,d.treeForkCount),n.child}i=i.sibling}d.tail!==null&&Pa()>Ch&&(n.flags|=128,_=!0,Dl(d,!1),n.lanes=4194304)}else{if(!_)if(i=to(w),i!==null){if(n.flags|=128,_=!0,i=i.updateQueue,n.updateQueue=i,Yo(n,i),Dl(d,!0),d.tail===null&&d.tailMode==="hidden"&&!w.alternate&&!Be)return ca(n),null}else 2*Pa()-d.renderingStartTime>Ch&&o!==536870912&&(n.flags|=128,_=!0,Dl(d,!1),n.lanes=4194304);d.isBackwards?(w.sibling=n.child,n.child=w):(i=d.last,i!==null?i.sibling=w:n.child=w,d.last=w)}return d.tail!==null?(i=d.tail,d.rendering=i,d.tail=i.sibling,d.renderingStartTime=Pa(),i.sibling=null,o=bi.current,qe(bi,_?o&1|2:o&1),Be&&Yr(n,d.treeForkCount),i):(ca(n),null);case 22:case 23:return Na(n),rn(),d=n.memoizedState!==null,i!==null?i.memoizedState!==null!==d&&(n.flags|=8192):d&&(n.flags|=8192),d?(o&536870912)!==0&&(n.flags&128)===0&&(ca(n),n.subtreeFlags&6&&(n.flags|=8192)):ca(n),o=n.updateQueue,o!==null&&Yo(n,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),d=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),d!==o&&(n.flags|=2048),i!==null&&be(u),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),Rr(aa),ca(n),null;case 25:return null;case 30:return null}throw Error(ue(156,n.tag))}function Af(i,n){switch(hu(n),n.tag){case 1:return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 3:return Rr(aa),Ai(),i=n.flags,(i&65536)!==0&&(i&128)===0?(n.flags=i&-65537|128,n):null;case 26:case 27:case 5:return ss(n),null;case 31:if(n.memoizedState!==null){if(Na(n),n.alternate===null)throw Error(ue(340));Kr()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 13:if(Na(n),i=n.memoizedState,i!==null&&i.dehydrated!==null){if(n.alternate===null)throw Error(ue(340));Kr()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 19:return be(bi),null;case 4:return Ai(),null;case 10:return Rr(n.type),null;case 22:case 23:return Na(n),rn(),i!==null&&be(u),i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 24:return Rr(aa),null;case 25:return null;default:return null}}function zf(i,n){switch(hu(n),n.tag){case 3:Rr(aa),Ai();break;case 26:case 27:case 5:ss(n);break;case 4:Ai();break;case 31:n.memoizedState!==null&&Na(n);break;case 13:Na(n);break;case 19:be(bi);break;case 10:Rr(n.type);break;case 22:case 23:Na(n),rn(),i!==null&&be(u);break;case 24:Rr(aa)}}function Sc(i,n){try{var o=n.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var _=d.next;o=_;do{if((o.tag&i)===i){d=void 0;var w=o.create,C=o.inst;d=w(),C.destroy=d}o=o.next}while(o!==_)}}catch(U){Ni(n,n.return,U)}}function Br(i,n,o){try{var d=n.updateQueue,_=d!==null?d.lastEffect:null;if(_!==null){var w=_.next;d=w;do{if((d.tag&i)===i){var C=d.inst,U=C.destroy;if(U!==void 0){C.destroy=void 0,_=n;var te=o,ve=U;try{ve()}catch(Ie){Ni(_,te,Ie)}}}d=d.next}while(d!==w)}}catch(Ie){Ni(n,n.return,Ie)}}function zd(i){var n=i.updateQueue;if(n!==null){var o=i.stateNode;try{ii(n,o)}catch(d){Ni(i,i.return,d)}}}function Ef(i,n,o){o.props=Ml(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(d){Ni(i,n,d)}}function Tc(i,n){try{var o=i.ref;if(o!==null){switch(i.tag){case 26:case 27:case 5:var d=i.stateNode;break;case 30:d=i.stateNode;break;default:d=i.stateNode}typeof o=="function"?i.refCleanup=o(d):o.current=d}}catch(_){Ni(i,n,_)}}function bs(i,n){var o=i.ref,d=i.refCleanup;if(o!==null)if(typeof d=="function")try{d()}catch(_){Ni(i,n,_)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(_){Ni(i,n,_)}else o.current=null}function Mf(i){var n=i.type,o=i.memoizedProps,d=i.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":o.autoFocus&&d.focus();break e;case"img":o.src?d.src=o.src:o.srcSet&&(d.srcset=o.srcSet)}}catch(_){Ni(i,i.return,_)}}function Ed(i,n,o){try{var d=i.stateNode;wp(d,i.type,o,n),d[jt]=n}catch(_){Ni(i,i.return,_)}}function Cf(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&F(i.type)||i.tag===4}function zh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Cf(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&F(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Ac(i,n,o){var d=i.tag;if(d===5||d===6)i=i.stateNode,n?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(i,n):(n=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,n.appendChild(i),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=cn));else if(d!==4&&(d===27&&F(i.type)&&(o=i.stateNode,n=null),i=i.child,i!==null))for(Ac(i,n,o),i=i.sibling;i!==null;)Ac(i,n,o),i=i.sibling}function zc(i,n,o){var d=i.tag;if(d===5||d===6)i=i.stateNode,n?o.insertBefore(i,n):o.appendChild(i);else if(d!==4&&(d===27&&F(i.type)&&(o=i.stateNode),i=i.child,i!==null))for(zc(i,n,o),i=i.sibling;i!==null;)zc(i,n,o),i=i.sibling}function Md(i){var n=i.stateNode,o=i.memoizedProps;try{for(var d=i.type,_=n.attributes;_.length;)n.removeAttributeNode(_[0]);$a(n,d,o),n[yt]=i,n[jt]=o}catch(w){Ni(i,i.return,w)}}var ws=!1,ja=!1,Eu=!1,Df=typeof WeakSet=="function"?WeakSet:Set,Xa=null;function gp(i,n){if(i=i.containerInfo,r=Uh,i=Gs(i),iu(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var d=o.getSelection&&o.getSelection();if(d&&d.rangeCount!==0){o=d.anchorNode;var _=d.anchorOffset,w=d.focusNode;d=d.focusOffset;try{o.nodeType,w.nodeType}catch{o=null;break e}var C=0,U=-1,te=-1,ve=0,Ie=0,Le=i,we=null;t:for(;;){for(var ze;Le!==o||_!==0&&Le.nodeType!==3||(U=C+_),Le!==w||d!==0&&Le.nodeType!==3||(te=C+d),Le.nodeType===3&&(C+=Le.nodeValue.length),(ze=Le.firstChild)!==null;)we=Le,Le=ze;for(;;){if(Le===i)break t;if(we===o&&++ve===_&&(U=C),we===w&&++Ie===d&&(te=C),(ze=Le.nextSibling)!==null)break;Le=we,we=Le.parentNode}Le=ze}o=U===-1||te===-1?null:{start:U,end:te}}else o=null}o=o||{start:0,end:0}}else o=null;for(l={focusedElem:i,selectionRange:o},Uh=!1,Xa=n;Xa!==null;)if(n=Xa,i=n.child,(n.subtreeFlags&1028)!==0&&i!==null)i.return=n,Xa=i;else for(;Xa!==null;){switch(n=Xa,w=n.alternate,i=n.flags,n.tag){case 0:if((i&4)!==0&&(i=n.updateQueue,i=i!==null?i.events:null,i!==null))for(o=0;o<i.length;o++)_=i[o],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&w!==null){i=void 0,o=n,_=w.memoizedProps,w=w.memoizedState,d=o.stateNode;try{var vt=Ml(o.type,_);i=d.getSnapshotBeforeUpdate(vt,w),d.__reactInternalSnapshotBeforeUpdate=i}catch(Vt){Ni(o,o.return,Vt)}}break;case 3:if((i&1024)!==0){if(i=n.stateNode.containerInfo,o=i.nodeType,o===9)he(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":he(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(ue(163))}if(i=n.sibling,i!==null){i.return=n.return,Xa=i;break}Xa=n.return}}function If(i,n,o){var d=o.flags;switch(o.tag){case 0:case 11:case 15:Qn(i,o),d&4&&Sc(5,o);break;case 1:if(Qn(i,o),d&4)if(i=o.stateNode,n===null)try{i.componentDidMount()}catch(C){Ni(o,o.return,C)}else{var _=Ml(o.type,n.memoizedProps);n=n.memoizedState;try{i.componentDidUpdate(_,n,i.__reactInternalSnapshotBeforeUpdate)}catch(C){Ni(o,o.return,C)}}d&64&&zd(o),d&512&&Tc(o,o.return);break;case 3:if(Qn(i,o),d&64&&(i=o.updateQueue,i!==null)){if(n=null,o.child!==null)switch(o.child.tag){case 27:case 5:n=o.child.stateNode;break;case 1:n=o.child.stateNode}try{ii(i,n)}catch(C){Ni(o,o.return,C)}}break;case 27:n===null&&d&4&&Md(o);case 26:case 5:Qn(i,o),n===null&&d&4&&Mf(o),d&512&&Tc(o,o.return);break;case 12:Qn(i,o);break;case 31:Qn(i,o),d&4&&Ma(i,o);break;case 13:Qn(i,o),d&4&&Cd(i,o),d&64&&(i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(o=qf.bind(null,o),St(i,o))));break;case 22:if(d=o.memoizedState!==null||ws,!d){n=n!==null&&n.memoizedState!==null||ja,_=ws;var w=ja;ws=d,(ja=n)&&!w?co(i,o,(o.subtreeFlags&8772)!==0):Qn(i,o),ws=_,ja=w}break;case 30:break;default:Qn(i,o)}}function kf(i){var n=i.alternate;n!==null&&(i.alternate=null,kf(n)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(n=i.stateNode,n!==null&&Ta(n)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var ha=null,Jn=!1;function uo(i,n,o){for(o=o.child;o!==null;)Mu(i,n,o),o=o.sibling}function Mu(i,n,o){if(Dt&&typeof Dt.onCommitFiberUnmount=="function")try{Dt.onCommitFiberUnmount(Xe,o)}catch{}switch(o.tag){case 26:ja||bs(o,n),uo(i,n,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ja||bs(o,n);var d=ha,_=Jn;F(o.type)&&(ha=o.stateNode,Jn=!1),uo(i,n,o),Me(o.stateNode),ha=d,Jn=_;break;case 5:ja||bs(o,n);case 6:if(d=ha,_=Jn,ha=null,uo(i,n,o),ha=d,Jn=_,ha!==null)if(Jn)try{(ha.nodeType===9?ha.body:ha.nodeName==="HTML"?ha.ownerDocument.body:ha).removeChild(o.stateNode)}catch(w){Ni(o,n,w)}else try{ha.removeChild(o.stateNode)}catch(w){Ni(o,n,w)}break;case 18:ha!==null&&(Jn?(i=ha,G(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,o.stateNode),Gh(i)):G(ha,o.stateNode));break;case 4:d=ha,_=Jn,ha=o.stateNode.containerInfo,Jn=!0,uo(i,n,o),ha=d,Jn=_;break;case 0:case 11:case 14:case 15:Br(2,o,n),ja||Br(4,o,n),uo(i,n,o);break;case 1:ja||(bs(o,n),d=o.stateNode,typeof d.componentWillUnmount=="function"&&Ef(o,n,d)),uo(i,n,o);break;case 21:uo(i,n,o);break;case 22:ja=(d=ja)||o.memoizedState!==null,uo(i,n,o),ja=d;break;default:uo(i,n,o)}}function Ma(i,n){if(n.memoizedState===null&&(i=n.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Gh(i)}catch(o){Ni(n,n.return,o)}}}function Cd(i,n){if(n.memoizedState===null&&(i=n.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Gh(i)}catch(o){Ni(n,n.return,o)}}function Rf(i){switch(i.tag){case 31:case 13:case 19:var n=i.stateNode;return n===null&&(n=i.stateNode=new Df),n;case 22:return i=i.stateNode,n=i._retryCache,n===null&&(n=i._retryCache=new Df),n;default:throw Error(ue(435,i.tag))}}function Ec(i,n){var o=Rf(i);n.forEach(function(d){if(!o.has(d)){o.add(d);var _=xp.bind(null,i,d);d.then(_,_)}})}function ei(i,n){var o=n.deletions;if(o!==null)for(var d=0;d<o.length;d++){var _=o[d],w=i,C=n,U=C;e:for(;U!==null;){switch(U.tag){case 27:if(F(U.type)){ha=U.stateNode,Jn=!1;break e}break;case 5:ha=U.stateNode,Jn=!1;break e;case 3:case 4:ha=U.stateNode.containerInfo,Jn=!0;break e}U=U.return}if(ha===null)throw Error(ue(160));Mu(w,C,_),ha=null,Jn=!1,w=_.alternate,w!==null&&(w.return=null),_.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)Dd(n,i),n=n.sibling}var gr=null;function Dd(i,n){var o=i.alternate,d=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ei(n,i),Bn(i),d&4&&(Br(3,i,i.return),Sc(3,i),Br(5,i,i.return));break;case 1:ei(n,i),Bn(i),d&512&&(ja||o===null||bs(o,o.return)),d&64&&ws&&(i=i.updateQueue,i!==null&&(d=i.callbacks,d!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?d:o.concat(d))));break;case 26:var _=gr;if(ei(n,i),Bn(i),d&512&&(ja||o===null||bs(o,o.return)),d&4){var w=o!==null?o.memoizedState:null;if(d=i.memoizedState,o===null)if(d===null)if(i.stateNode===null){e:{d=i.type,o=i.memoizedProps,_=_.ownerDocument||_;t:switch(d){case"title":w=_.getElementsByTagName("title")[0],(!w||w[Ri]||w[yt]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=_.createElement(d),_.head.insertBefore(w,_.querySelector("head > title"))),$a(w,d,o),w[yt]=i,za(w),d=w;break e;case"link":var C=ns("link","href",_).get(d+(o.href||""));if(C){for(var U=0;U<C.length;U++)if(w=C[U],w.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&w.getAttribute("rel")===(o.rel==null?null:o.rel)&&w.getAttribute("title")===(o.title==null?null:o.title)&&w.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){C.splice(U,1);break t}}w=_.createElement(d),$a(w,d,o),_.head.appendChild(w);break;case"meta":if(C=ns("meta","content",_).get(d+(o.content||""))){for(U=0;U<C.length;U++)if(w=C[U],w.getAttribute("content")===(o.content==null?null:""+o.content)&&w.getAttribute("name")===(o.name==null?null:o.name)&&w.getAttribute("property")===(o.property==null?null:o.property)&&w.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&w.getAttribute("charset")===(o.charSet==null?null:o.charSet)){C.splice(U,1);break t}}w=_.createElement(d),$a(w,d,o),_.head.appendChild(w);break;default:throw Error(ue(468,d))}w[yt]=i,za(w),d=w}i.stateNode=d}else xr(_,i.type,i.stateNode);else i.stateNode=Yi(_,d,i.memoizedProps);else w!==d?(w===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):w.count--,d===null?xr(_,i.type,i.stateNode):Yi(_,d,i.memoizedProps)):d===null&&i.stateNode!==null&&Ed(i,i.memoizedProps,o.memoizedProps)}break;case 27:ei(n,i),Bn(i),d&512&&(ja||o===null||bs(o,o.return)),o!==null&&d&4&&Ed(i,i.memoizedProps,o.memoizedProps);break;case 5:if(ei(n,i),Bn(i),d&512&&(ja||o===null||bs(o,o.return)),i.flags&32){_=i.stateNode;try{jr(_,"")}catch(vt){Ni(i,i.return,vt)}}d&4&&i.stateNode!=null&&(_=i.memoizedProps,Ed(i,_,o!==null?o.memoizedProps:_)),d&1024&&(Eu=!0);break;case 6:if(ei(n,i),Bn(i),d&4){if(i.stateNode===null)throw Error(ue(162));d=i.memoizedProps,o=i.stateNode;try{o.nodeValue=d}catch(vt){Ni(i,i.return,vt)}}break;case 3:if(vr=null,_=gr,gr=kt(n.containerInfo),ei(n,i),gr=_,Bn(i),d&4&&o!==null&&o.memoizedState.isDehydrated)try{Gh(n.containerInfo)}catch(vt){Ni(i,i.return,vt)}Eu&&(Eu=!1,Ss(i));break;case 4:d=gr,gr=kt(i.stateNode.containerInfo),ei(n,i),Bn(i),gr=d;break;case 12:ei(n,i),Bn(i);break;case 31:ei(n,i),Bn(i),d&4&&(d=i.updateQueue,d!==null&&(i.updateQueue=null,Ec(i,d)));break;case 13:ei(n,i),Bn(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Bu=Pa()),d&4&&(d=i.updateQueue,d!==null&&(i.updateQueue=null,Ec(i,d)));break;case 22:_=i.memoizedState!==null;var te=o!==null&&o.memoizedState!==null,ve=ws,Ie=ja;if(ws=ve||_,ja=Ie||te,ei(n,i),ja=Ie,ws=ve,Bn(i),d&8192)e:for(n=i.stateNode,n._visibility=_?n._visibility&-2:n._visibility|1,_&&(o===null||te||ws||ja||Ko(i)),o=null,n=i;;){if(n.tag===5||n.tag===26){if(o===null){te=o=n;try{if(w=te.stateNode,_)C=w.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{U=te.stateNode;var Le=te.memoizedProps.style,we=Le!=null&&Le.hasOwnProperty("display")?Le.display:null;U.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(vt){Ni(te,te.return,vt)}}}else if(n.tag===6){if(o===null){te=n;try{te.stateNode.nodeValue=_?"":te.memoizedProps}catch(vt){Ni(te,te.return,vt)}}}else if(n.tag===18){if(o===null){te=n;try{var ze=te.stateNode;_?Y(ze,!0):Y(te.stateNode,!1)}catch(vt){Ni(te,te.return,vt)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===i)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;o===n&&(o=null),n=n.return}o===n&&(o=null),n.sibling.return=n.return,n=n.sibling}d&4&&(d=i.updateQueue,d!==null&&(o=d.retryQueue,o!==null&&(d.retryQueue=null,Ec(i,o))));break;case 19:ei(n,i),Bn(i),d&4&&(d=i.updateQueue,d!==null&&(i.updateQueue=null,Ec(i,d)));break;case 30:break;case 21:break;default:ei(n,i),Bn(i)}}function Bn(i){var n=i.flags;if(n&2){try{for(var o,d=i.return;d!==null;){if(Cf(d)){o=d;break}d=d.return}if(o==null)throw Error(ue(160));switch(o.tag){case 27:var _=o.stateNode,w=zh(i);zc(i,w,_);break;case 5:var C=o.stateNode;o.flags&32&&(jr(C,""),o.flags&=-33);var U=zh(i);zc(i,U,C);break;case 3:case 4:var te=o.stateNode.containerInfo,ve=zh(i);Ac(i,ve,te);break;default:throw Error(ue(161))}}catch(Ie){Ni(i,i.return,Ie)}i.flags&=-3}n&4096&&(i.flags&=-4097)}function Ss(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var n=i;Ss(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),i=i.sibling}}function Qn(i,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)If(i,n.alternate,n),n=n.sibling}function Ko(i){for(i=i.child;i!==null;){var n=i;switch(n.tag){case 0:case 11:case 14:case 15:Br(4,n,n.return),Ko(n);break;case 1:bs(n,n.return);var o=n.stateNode;typeof o.componentWillUnmount=="function"&&Ef(n,n.return,o),Ko(n);break;case 27:Me(n.stateNode);case 26:case 5:bs(n,n.return),Ko(n);break;case 22:n.memoizedState===null&&Ko(n);break;case 30:Ko(n);break;default:Ko(n)}i=i.sibling}}function co(i,n,o){for(o=o&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var d=n.alternate,_=i,w=n,C=w.flags;switch(w.tag){case 0:case 11:case 15:co(_,w,o),Sc(4,w);break;case 1:if(co(_,w,o),d=w,_=d.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(ve){Ni(d,d.return,ve)}if(d=w,_=d.updateQueue,_!==null){var U=d.stateNode;try{var te=_.shared.hiddenCallbacks;if(te!==null)for(_.shared.hiddenCallbacks=null,_=0;_<te.length;_++)Gt(te[_],U)}catch(ve){Ni(d,d.return,ve)}}o&&C&64&&zd(w),Tc(w,w.return);break;case 27:Md(w);case 26:case 5:co(_,w,o),o&&d===null&&C&4&&Mf(w),Tc(w,w.return);break;case 12:co(_,w,o);break;case 31:co(_,w,o),o&&C&4&&Ma(_,w);break;case 13:co(_,w,o),o&&C&4&&Cd(_,w);break;case 22:w.memoizedState===null&&co(_,w,o),Tc(w,w.return);break;case 30:break;default:co(_,w,o)}n=n.sibling}}function Id(i,n){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&Qr(o))}function kd(i,n){i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&Qr(i))}function is(i,n,o,d){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Lf(i,n,o,d),n=n.sibling}function Lf(i,n,o,d){var _=n.flags;switch(n.tag){case 0:case 11:case 15:is(i,n,o,d),_&2048&&Sc(9,n);break;case 1:is(i,n,o,d);break;case 3:is(i,n,o,d),_&2048&&(i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&Qr(i)));break;case 12:if(_&2048){is(i,n,o,d),i=n.stateNode;try{var w=n.memoizedProps,C=w.id,U=w.onPostCommit;typeof U=="function"&&U(C,n.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(te){Ni(n,n.return,te)}}else is(i,n,o,d);break;case 31:is(i,n,o,d);break;case 13:is(i,n,o,d);break;case 23:break;case 22:w=n.stateNode,C=n.alternate,n.memoizedState!==null?w._visibility&2?is(i,n,o,d):Mc(i,n):w._visibility&2?is(i,n,o,d):(w._visibility|=2,Cu(i,n,o,d,(n.subtreeFlags&10256)!==0||!1)),_&2048&&Id(C,n);break;case 24:is(i,n,o,d),_&2048&&kd(n.alternate,n);break;default:is(i,n,o,d)}}function Cu(i,n,o,d,_){for(_=_&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var w=i,C=n,U=o,te=d,ve=C.flags;switch(C.tag){case 0:case 11:case 15:Cu(w,C,U,te,_),Sc(8,C);break;case 23:break;case 22:var Ie=C.stateNode;C.memoizedState!==null?Ie._visibility&2?Cu(w,C,U,te,_):Mc(w,C):(Ie._visibility|=2,Cu(w,C,U,te,_)),_&&ve&2048&&Id(C.alternate,C);break;case 24:Cu(w,C,U,te,_),_&&ve&2048&&kd(C.alternate,C);break;default:Cu(w,C,U,te,_)}n=n.sibling}}function Mc(i,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var o=i,d=n,_=d.flags;switch(d.tag){case 22:Mc(o,d),_&2048&&Id(d.alternate,d);break;case 24:Mc(o,d),_&2048&&kd(d.alternate,d);break;default:Mc(o,d)}n=n.sibling}}var Cc=8192;function Du(i,n,o){if(i.subtreeFlags&Cc)for(i=i.child;i!==null;)Dc(i,n,o),i=i.sibling}function Dc(i,n,o){switch(i.tag){case 26:Du(i,n,o),i.flags&Cc&&i.memoizedState!==null&&fo(o,gr,i.memoizedState,i.memoizedProps);break;case 5:Du(i,n,o);break;case 3:case 4:var d=gr;gr=kt(i.stateNode.containerInfo),Du(i,n,o),gr=d;break;case 22:i.memoizedState===null&&(d=i.alternate,d!==null&&d.memoizedState!==null?(d=Cc,Cc=16777216,Du(i,n,o),Cc=d):Du(i,n,o));break;default:Du(i,n,o)}}function Il(i){var n=i.alternate;if(n!==null&&(i=n.child,i!==null)){n.child=null;do n=i.sibling,i.sibling=null,i=n;while(i!==null)}}function Iu(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var d=n[o];Xa=d,Bf(d,i)}Il(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Eh(i),i=i.sibling}function Eh(i){switch(i.tag){case 0:case 11:case 15:Iu(i),i.flags&2048&&Br(9,i,i.return);break;case 3:Iu(i);break;case 12:Iu(i);break;case 22:var n=i.stateNode;i.memoizedState!==null&&n._visibility&2&&(i.return===null||i.return.tag!==13)?(n._visibility&=-3,ku(i)):Iu(i);break;default:Iu(i)}}function ku(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var o=0;o<n.length;o++){var d=n[o];Xa=d,Bf(d,i)}Il(i)}for(i=i.child;i!==null;){switch(n=i,n.tag){case 0:case 11:case 15:Br(8,n,n.return),ku(n);break;case 22:o=n.stateNode,o._visibility&2&&(o._visibility&=-3,ku(n));break;default:ku(n)}i=i.sibling}}function Bf(i,n){for(;Xa!==null;){var o=Xa;switch(o.tag){case 0:case 11:case 15:Br(8,o,n);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var d=o.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Qr(o.memoizedState.cache)}if(d=o.child,d!==null)d.return=o,Xa=d;else e:for(o=i;Xa!==null;){d=Xa;var _=d.sibling,w=d.return;if(kf(d),d===o){Xa=null;break e}if(_!==null){_.return=w,Xa=_;break e}Xa=w}}}var yp={getCacheForType:function(i){var n=Qt(aa),o=n.data.get(i);return o===void 0&&(o=i(),n.data.set(i,o)),o},cacheSignal:function(){return Qt(aa).controller.signal}},_p=typeof WeakMap=="function"?WeakMap:Map,Di=0,Wi=null,Nt=null,di=0,Oi=0,Ua=null,Pr=!1,Ts=!1,Jo=!1,Or=0,da=0,Qo=0,kl=0,Mh=0,Wn=0,Ru=0,Lu=null,Pn=null,Ic=!1,Bu=0,Pf=0,Ch=1/0,kc=null,ho=null,Sa=0,pn=null,yr=null,As=0,Rc=0,Rd=null,Of=null,Wo=0,Lc=null;function _r(){return(Di&2)!==0&&di!==0?di&-di:ge.T!==null?Uu():pt()}function Dh(){if(Wn===0)if((di&536870912)===0||Be){var i=lr;lr<<=1,(lr&3932160)===0&&(lr=262144),Wn=i}else Wn=536870912;return i=Gi.current,i!==null&&(i.flags|=32),Wn}function zn(i,n,o){(i===Wi&&(Oi===2||Oi===9)||i.cancelPendingCommit!==null)&&(Ll(i,0),zs(i,di,Wn,!1)),re(i,o),((Di&2)===0||i!==Wi)&&(i===Wi&&((Di&2)===0&&(kl|=o),da===4&&zs(i,di,Wn,!1)),Es(i))}function Rl(i,n,o){if((Di&6)!==0)throw Error(ue(327));var d=!o&&(n&127)===0&&(n&i.expiredLanes)===0||R(i,n),_=d?Od(i,n):Pd(i,n,!0),w=d;do{if(_===0){Ts&&!d&&zs(i,n,0,!1);break}else{if(o=i.current.alternate,w&&!Nf(o)){_=Pd(i,n,!1),w=!1;continue}if(_===2){if(w=n,i.errorRecoveryDisabledLanes&w)var C=0;else C=i.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){n=C;e:{var U=i;_=Lu;var te=U.current.memoizedState.isDehydrated;if(te&&(Ll(U,C).flags|=256),C=Pd(U,C,!1),C!==2){if(Jo&&!te){U.errorRecoveryDisabledLanes|=w,kl|=w,_=4;break e}w=Pn,Pn=_,w!==null&&(Pn===null?Pn=w:Pn.push.apply(Pn,w))}_=C}if(w=!1,_!==2)continue}}if(_===1){Ll(i,0),zs(i,n,0,!0);break}e:{switch(d=i,w=_,w){case 0:case 1:throw Error(ue(345));case 4:if((n&4194048)!==n)break;case 6:zs(d,n,Wn,!Pr);break e;case 2:Pn=null;break;case 3:case 5:break;default:throw Error(ue(329))}if((n&62914560)===n&&(_=Bu+300-Pa(),10<_)){if(zs(d,n,Wn,!Pr),L(d,0,!0)!==0)break e;As=n,d.timeoutHandle=z(Ld.bind(null,d,o,Pn,kc,Ic,n,Wn,kl,Ru,Pr,w,"Throttled",-0,0),_);break e}Ld(d,o,Pn,kc,Ic,n,Wn,kl,Ru,Pr,w,null,-0,0)}}break}while(!0);Es(i)}function Ld(i,n,o,d,_,w,C,U,te,ve,Ie,Le,we,ze){if(i.timeoutHandle=-1,Le=n.subtreeFlags,Le&8192||(Le&16785408)===16785408){Le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:cn},Dc(n,w,Le);var vt=(w&62914560)===w?Bu-Pa():(w&4194048)===w?Pf-Pa():0;if(vt=Yf(Le,vt),vt!==null){As=w,i.cancelPendingCommit=vt(kh.bind(null,i,n,w,o,d,_,C,U,te,Ie,Le,null,we,ze)),zs(i,w,C,!ve);return}}kh(i,n,w,o,d,_,C,U,te)}function Nf(i){for(var n=i;;){var o=n.tag;if((o===0||o===11||o===15)&&n.flags&16384&&(o=n.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var d=0;d<o.length;d++){var _=o[d],w=_.getSnapshot;_=_.value;try{if(!dn(w(),_))return!1}catch{return!1}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function zs(i,n,o,d){n&=~Mh,n&=~kl,i.suspendedLanes|=n,i.pingedLanes&=~n,d&&(i.warmLanes|=n),d=i.expirationTimes;for(var _=n;0<_;){var w=31-Ki(_),C=1<<w;d[w]=-1,_&=~C}o!==0&&W(i,o,n)}function Bc(){return(Di&6)===0?(Fu(0),!1):!0}function Pu(){if(Nt!==null){if(Oi===0)var i=Nt.return;else i=Nt,Ir=Gn=null,jo(i),J=null,ee=0,i=Nt;for(;i!==null;)zf(i.alternate,i),i=i.return;Nt=null}}function Ll(i,n){var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,M(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),As=0,Pu(),Wi=i,Nt=o=Zn(i.current,null),di=n,Oi=0,Ua=null,Pr=!1,Ts=R(i,n),Jo=!1,Ru=Wn=Mh=kl=Qo=da=0,Pn=Lu=null,Ic=!1,(n&8)!==0&&(n|=n&32);var d=i.entangledLanes;if(d!==0)for(i=i.entanglements,d&=n;0<d;){var _=31-Ki(d),w=1<<_;n|=i[_],d&=~w}return Or=n,bn(),o}function Ff(i,n){Rt=null,ge.H=_c,n===S||n===E?(n=X(),Oi=3):n===T?(n=X(),Oi=4):Oi=n===ua?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Ua=n,Nt===null&&(da=1,bh(i,Sn(n,i.current)))}function jf(){var i=Gi.current;return i===null?!0:(di&4194048)===di?Hi===null:(di&62914560)===di||(di&536870912)!==0?i===Hi:!1}function Bd(){var i=ge.H;return ge.H=_c,i===null?_c:i}function Uf(){var i=ge.A;return ge.A=yp,i}function Ih(){da=4,Pr||(di&4194048)!==di&&Gi.current!==null||(Ts=!0),(Qo&134217727)===0&&(kl&134217727)===0||Wi===null||zs(Wi,di,Wn,!1)}function Pd(i,n,o){var d=Di;Di|=2;var _=Bd(),w=Uf();(Wi!==i||di!==n)&&(kc=null,Ll(i,n)),n=!1;var C=da;e:do try{if(Oi!==0&&Nt!==null){var U=Nt,te=Ua;switch(Oi){case 8:Pu(),C=6;break e;case 3:case 2:case 9:case 6:Gi.current===null&&(n=!0);var ve=Oi;if(Oi=0,Ua=null,Bl(i,U,te,ve),o&&Ts){C=0;break e}break;default:ve=Oi,Oi=0,Ua=null,Bl(i,U,te,ve)}}vp(),C=da;break}catch(Ie){Ff(i,Ie)}while(!0);return n&&i.shellSuspendCounter++,Ir=Gn=null,Di=d,ge.H=_,ge.A=w,Nt===null&&(Wi=null,di=0,bn()),C}function vp(){for(;Nt!==null;)Nd(Nt)}function Od(i,n){var o=Di;Di|=2;var d=Bd(),_=Uf();Wi!==i||di!==n?(kc=null,Ch=Pa()+500,Ll(i,n)):Ts=R(i,n);e:do try{if(Oi!==0&&Nt!==null){n=Nt;var w=Ua;t:switch(Oi){case 1:Oi=0,Ua=null,Bl(i,n,w,1);break;case 2:case 9:if(I(w)){Oi=0,Ua=null,Fd(n);break}n=function(){Oi!==2&&Oi!==9||Wi!==i||(Oi=7),Es(i)},w.then(n,n);break e;case 3:Oi=7;break e;case 4:Oi=5;break e;case 7:I(w)?(Oi=0,Ua=null,Fd(n)):(Oi=0,Ua=null,Bl(i,n,w,7));break;case 5:var C=null;switch(Nt.tag){case 26:C=Nt.memoizedState;case 5:case 27:var U=Nt;if(C?Ha(C):U.stateNode.complete){Oi=0,Ua=null;var te=U.sibling;if(te!==null)Nt=te;else{var ve=U.return;ve!==null?(Nt=ve,Pc(ve)):Nt=null}break t}}Oi=0,Ua=null,Bl(i,n,w,5);break;case 6:Oi=0,Ua=null,Bl(i,n,w,6);break;case 8:Pu(),da=6;break e;default:throw Error(ue(462))}}el();break}catch(Ie){Ff(i,Ie)}while(!0);return Ir=Gn=null,ge.H=d,ge.A=_,Di=o,Nt!==null?0:(Wi=null,di=0,bn(),da)}function el(){for(;Nt!==null&&!ls();)Nd(Nt)}function Nd(i){var n=Tf(i.alternate,i,Or);i.memoizedProps=i.pendingProps,n===null?Pc(i):Nt=n}function Fd(i){var n=i,o=n.alternate;switch(n.tag){case 15:case 0:n=vd(o,n,n.pendingProps,n.type,void 0,di);break;case 11:n=vd(o,n,n.pendingProps,n.type.render,n.ref,di);break;case 5:jo(n);default:zf(o,n),n=Nt=lu(n,Or),n=Tf(o,n,Or)}i.memoizedProps=i.pendingProps,n===null?Pc(i):Nt=n}function Bl(i,n,o,d){Ir=Gn=null,jo(n),J=null,ee=0;var _=n.return;try{if(fp(i,_,n,o,di)){da=1,bh(i,Sn(o,i.current)),Nt=null;return}}catch(w){if(_!==null)throw Nt=_,w;da=1,bh(i,Sn(o,i.current)),Nt=null;return}n.flags&32768?(Be||d===1?i=!0:Ts||(di&536870912)!==0?i=!1:(Pr=i=!0,(d===2||d===9||d===3||d===6)&&(d=Gi.current,d!==null&&d.tag===13&&(d.flags|=16384))),jd(n,i)):Pc(n)}function Pc(i){var n=i;do{if((n.flags&32768)!==0){jd(n,Pr);return}i=n.return;var o=mp(n.alternate,n,Or);if(o!==null){Nt=o;return}if(n=n.sibling,n!==null){Nt=n;return}Nt=n=i}while(n!==null);da===0&&(da=5)}function jd(i,n){do{var o=Af(i.alternate,i);if(o!==null){o.flags&=32767,Nt=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!n&&(i=i.sibling,i!==null)){Nt=i;return}Nt=i=o}while(i!==null);da=6,Nt=null}function kh(i,n,o,d,_,w,C,U,te){i.cancelPendingCommit=null;do En();while(Sa!==0);if((Di&6)!==0)throw Error(ue(327));if(n!==null){if(n===i.current)throw Error(ue(177));if(w=n.lanes|n.childLanes,w|=ia,ce(i,o,w,C,U,te),i===Wi&&(Nt=Wi=null,di=0),yr=n,pn=i,As=o,Rc=w,Rd=_,Of=d,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Zf(je,function(){return Nu(),null})):(i.callbackNode=null,i.callbackPriority=0),d=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||d){d=ge.T,ge.T=null,_=He.p,He.p=2,C=Di,Di|=4;try{gp(i,n,o)}finally{Di=C,He.p=_,ge.T=d}}Sa=1,Ou(),Ud(),Rh()}}function Ou(){if(Sa===1){Sa=0;var i=pn,n=yr,o=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||o){o=ge.T,ge.T=null;var d=He.p;He.p=2;var _=Di;Di|=4;try{Dd(n,i);var w=l,C=Gs(i.containerInfo),U=w.focusedElem,te=w.selectionRange;if(C!==U&&U&&U.ownerDocument&&nc(U.ownerDocument.documentElement,U)){if(te!==null&&iu(U)){var ve=te.start,Ie=te.end;if(Ie===void 0&&(Ie=ve),"selectionStart"in U)U.selectionStart=ve,U.selectionEnd=Math.min(Ie,U.value.length);else{var Le=U.ownerDocument||document,we=Le&&Le.defaultView||window;if(we.getSelection){var ze=we.getSelection(),vt=U.textContent.length,Vt=Math.min(te.start,vt),na=te.end===void 0?Vt:Math.min(te.end,vt);!ze.extend&&Vt>na&&(C=na,na=Vt,Vt=C);var de=oh(U,Vt),se=oh(U,na);if(de&&se&&(ze.rangeCount!==1||ze.anchorNode!==de.node||ze.anchorOffset!==de.offset||ze.focusNode!==se.node||ze.focusOffset!==se.offset)){var _e=Le.createRange();_e.setStart(de.node,de.offset),ze.removeAllRanges(),Vt>na?(ze.addRange(_e),ze.extend(se.node,se.offset)):(_e.setEnd(se.node,se.offset),ze.addRange(_e))}}}}for(Le=[],ze=U;ze=ze.parentNode;)ze.nodeType===1&&Le.push({element:ze,left:ze.scrollLeft,top:ze.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Le.length;U++){var Re=Le[U];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Uh=!!r,l=r=null}finally{Di=_,He.p=d,ge.T=o}}i.current=n,Sa=2}}function Ud(){if(Sa===2){Sa=0;var i=pn,n=yr,o=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||o){o=ge.T,ge.T=null;var d=He.p;He.p=2;var _=Di;Di|=4;try{If(i,n.alternate,n)}finally{Di=_,He.p=d,ge.T=o}}Sa=3}}function Rh(){if(Sa===4||Sa===3){Sa=0,Fr();var i=pn,n=yr,o=As,d=Of;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?Sa=5:(Sa=0,yr=pn=null,Vd(i,i.pendingLanes));var _=i.pendingLanes;if(_===0&&(ho=null),Ze(o),n=n.stateNode,Dt&&typeof Dt.onCommitFiberRoot=="function")try{Dt.onCommitFiberRoot(Xe,n,void 0,(n.current.flags&128)===128)}catch{}if(d!==null){n=ge.T,_=He.p,He.p=2,ge.T=null;try{for(var w=i.onRecoverableError,C=0;C<d.length;C++){var U=d[C];w(U.value,{componentStack:U.stack})}}finally{ge.T=n,He.p=_}}(As&3)!==0&&En(),Es(i),_=i.pendingLanes,(o&261930)!==0&&(_&42)!==0?i===Lc?Wo++:(Wo=0,Lc=i):Wo=0,Fu(0)}}function Vd(i,n){(i.pooledCacheLanes&=n)===0&&(n=i.pooledCache,n!=null&&(i.pooledCache=null,Qr(n)))}function En(){return Ou(),Ud(),Rh(),Nu()}function Nu(){if(Sa!==5)return!1;var i=pn,n=Rc;Rc=0;var o=Ze(As),d=ge.T,_=He.p;try{He.p=32>o?32:o,ge.T=null,o=Rd,Rd=null;var w=pn,C=As;if(Sa=0,yr=pn=null,As=0,(Di&6)!==0)throw Error(ue(331));var U=Di;if(Di|=4,Eh(w.current),Lf(w,w.current,C,o),Di=U,Fu(0,!1),Dt&&typeof Dt.onPostCommitFiberRoot=="function")try{Dt.onPostCommitFiberRoot(Xe,w)}catch{}return!0}finally{He.p=_,ge.T=d,Vd(i,n)}}function qd(i,n,o){n=Sn(o,n),n=vc(i.stateNode,n,2),i=it(i,n,2),i!==null&&(re(i,2),Es(i))}function Ni(i,n,o){if(i.tag===3)qd(i,i,o);else for(;n!==null;){if(n.tag===3){qd(n,i,o);break}else if(n.tag===1){var d=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(ho===null||!ho.has(d))){i=Sn(o,i),o=vf(2),d=it(n,o,2),d!==null&&(Cl(o,d,n,i),re(d,2),Es(d));break}}n=n.return}}function Lh(i,n,o){var d=i.pingCache;if(d===null){d=i.pingCache=new _p;var _=new Set;d.set(n,_)}else _=d.get(n),_===void 0&&(_=new Set,d.set(n,_));_.has(o)||(Jo=!0,_.add(o),i=Vf.bind(null,i,n,o),n.then(i,i))}function Vf(i,n,o){var d=i.pingCache;d!==null&&d.delete(n),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,Wi===i&&(di&o)===o&&(da===4||da===3&&(di&62914560)===di&&300>Pa()-Bu?(Di&2)===0&&Ll(i,0):Mh|=o,Ru===di&&(Ru=0)),Es(i)}function Zd(i,n){n===0&&(n=H()),i=Hr(i,n),i!==null&&(re(i,n),Es(i))}function qf(i){var n=i.memoizedState,o=0;n!==null&&(o=n.retryLane),Zd(i,o)}function xp(i,n){var o=0;switch(i.tag){case 31:case 13:var d=i.stateNode,_=i.memoizedState;_!==null&&(o=_.retryLane);break;case 19:d=i.stateNode;break;case 22:d=i.stateNode._retryCache;break;default:throw Error(ue(314))}d!==null&&d.delete(n),Zd(i,o)}function Zf(i,n){return ea(i,n)}var as=null,Pl=null,Bh=!1,Oc=!1,Ph=!1,tl=0;function Es(i){i!==Pl&&i.next===null&&(Pl===null?as=Pl=i:Pl=Pl.next=i),Oc=!0,Bh||(Bh=!0,Oh())}function Fu(i,n){if(!Ph&&Oc){Ph=!0;do for(var o=!1,d=as;d!==null;){if(i!==0){var _=d.pendingLanes;if(_===0)var w=0;else{var C=d.suspendedLanes,U=d.pingedLanes;w=(1<<31-Ki(42|i)+1)-1,w&=_&~(C&~U),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(o=!0,Fc(d,w))}else w=di,w=L(d,d===Wi?w:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(w&3)===0||R(d,w)||(o=!0,Fc(d,w));d=d.next}while(o);Ph=!1}}function ju(){Gd()}function Gd(){Oc=Bh=!1;var i=0;tl!==0&&A()&&(i=tl);for(var n=Pa(),o=null,d=as;d!==null;){var _=d.next,w=Nc(d,n);w===0?(d.next=null,o===null?as=_:o.next=_,_===null&&(Pl=o)):(o=d,(i!==0||(w&3)!==0)&&(Oc=!0)),d=_}Sa!==0&&Sa!==5||Fu(i),tl!==0&&(tl=0)}function Nc(i,n){for(var o=i.suspendedLanes,d=i.pingedLanes,_=i.expirationTimes,w=i.pendingLanes&-62914561;0<w;){var C=31-Ki(w),U=1<<C,te=_[C];te===-1?((U&o)===0||(U&d)!==0)&&(_[C]=V(U,n)):te<=n&&(i.expiredLanes|=U),w&=~U}if(n=Wi,o=di,o=L(i,i===n?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),d=i.callbackNode,o===0||i===n&&(Oi===2||Oi===9)||i.cancelPendingCommit!==null)return d!==null&&d!==null&&Ds(d),i.callbackNode=null,i.callbackPriority=0;if((o&3)===0||R(i,o)){if(n=o&-o,n===i.callbackPriority)return n;switch(d!==null&&Ds(d),Ze(o)){case 2:case 8:o=yo;break;case 32:o=je;break;case 268435456:o=Ja;break;default:o=je}return d=Hd.bind(null,i),o=ea(o,d),i.callbackPriority=n,i.callbackNode=o,n}return d!==null&&d!==null&&Ds(d),i.callbackPriority=2,i.callbackNode=null,2}function Hd(i,n){if(Sa!==0&&Sa!==5)return i.callbackNode=null,i.callbackPriority=0,null;var o=i.callbackNode;if(En()&&i.callbackNode!==o)return null;var d=di;return d=L(i,i===Wi?d:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),d===0?null:(Rl(i,d,n),Nc(i,Pa()),i.callbackNode!=null&&i.callbackNode===o?Hd.bind(null,i):null)}function Fc(i,n){if(En())return null;Rl(i,n,!0)}function Oh(){B(function(){(Di&6)!==0?ea(go,ju):Gd()})}function Uu(){if(tl===0){var i=Wr;i===0&&(i=jn,jn<<=1,(jn&261888)===0&&(jn=256)),tl=i}return tl}function Gf(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Zl(""+i)}function Hf(i,n){var o=n.ownerDocument.createElement("input");return o.name=n.name,o.value=n.value,i.id&&o.setAttribute("form",i.id),n.parentNode.insertBefore(o,n),i=new FormData(i),o.parentNode.removeChild(o),i}function bp(i,n,o,d,_){if(n==="submit"&&o&&o.stateNode===_){var w=Gf((_[jt]||null).action),C=d.submitter;C&&(n=(n=C[jt]||null)?Gf(n.formAction):C.getAttribute("formAction"),n!==null&&(w=n,C=null));var U=new Xl("action","action",null,d,_);i.push({event:U,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(tl!==0){var te=C?Hf(_,C):new FormData(_);yh(o,{pending:!0,data:te,method:_.method,action:w},null,te)}}else typeof w=="function"&&(U.preventDefault(),te=C?Hf(_,C):new FormData(_),yh(o,{pending:!0,data:te,method:_.method,action:w},w,te))},currentTarget:_}]})}}for(var il=0;il<Ys.length;il++){var Va=Ys[il],al=Va.toLowerCase(),Xd=Va[0].toUpperCase()+Va.slice(1);Ji(al,"on"+Xd)}Ji(yl,"onAnimationEnd"),Ji(_l,"onAnimationIteration"),Ji(ru,"onAnimationStart"),Ji("dblclick","onDoubleClick"),Ji("focusin","onFocus"),Ji("focusout","onBlur"),Ji(Qh,"onTransitionRun"),Ji(lh,"onTransitionStart"),Ji(su,"onTransitionCancel"),Ji(ou,"onTransitionEnd"),_o("onMouseEnter",["mouseout","mouseover"]),_o("onMouseLeave",["mouseout","mouseover"]),_o("onPointerEnter",["pointerout","pointerover"]),_o("onPointerLeave",["pointerout","pointerover"]),Da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Da("onBeforeInput",["compositionend","keypress","textInput","paste"]),Da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xf=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vu));function Nh(i,n){n=(n&4)!==0;for(var o=0;o<i.length;o++){var d=i[o],_=d.event;d=d.listeners;e:{var w=void 0;if(n)for(var C=d.length-1;0<=C;C--){var U=d[C],te=U.instance,ve=U.currentTarget;if(U=U.listener,te!==w&&_.isPropagationStopped())break e;w=U,_.currentTarget=ve;try{w(_)}catch(Ie){Cr(Ie)}_.currentTarget=null,w=te}else for(C=0;C<d.length;C++){if(U=d[C],te=U.instance,ve=U.currentTarget,U=U.listener,te!==w&&_.isPropagationStopped())break e;w=U,_.currentTarget=ve;try{w(_)}catch(Ie){Cr(Ie)}_.currentTarget=null,w=te}}}}function gi(i,n){var o=n[fa];o===void 0&&(o=n[fa]=new Set);var d=i+"__bubble";o.has(d)||(Yd(n,i,2,!1),o.add(d))}function Fh(i,n,o){var d=0;n&&(d|=4),Yd(o,i,d,n)}var jc="_reactListening"+Math.random().toString(36).slice(2);function $d(i){if(!i[jc]){i[jc]=!0,Fl.forEach(function(o){o!=="selectionchange"&&(Xf.has(o)||Fh(o,!1,i),Fh(o,!0,i))});var n=i.nodeType===9?i:i.ownerDocument;n===null||n[jc]||(n[jc]=!0,Fh("selectionchange",!1,n))}}function Yd(i,n,o,d){switch(ln(n)){case 2:var _=rs;break;case 8:_=Vh;break;default:_=qh}o=_.bind(null,n,o,i),_=void 0,!Gl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(_=!0),d?_!==void 0?i.addEventListener(n,o,{capture:!0,passive:_}):i.addEventListener(n,o,!0):_!==void 0?i.addEventListener(n,o,{passive:_}):i.addEventListener(n,o,!1)}function Uc(i,n,o,d,_){var w=d;if((n&1)===0&&(n&2)===0&&d!==null)e:for(;;){if(d===null)return;var C=d.tag;if(C===3||C===4){var U=d.stateNode.containerInfo;if(U===_)break;if(C===4)for(C=d.return;C!==null;){var te=C.tag;if((te===3||te===4)&&C.stateNode.containerInfo===_)return;C=C.return}for(;U!==null;){if(C=pa(U),C===null)return;if(te=C.tag,te===5||te===6||te===26||te===27){d=w=C;continue e}U=U.parentNode}}d=d.return}Yu(function(){var ve=w,Ie=Qa(o),Le=[];e:{var we=ko.get(i);if(we!==void 0){var ze=Xl,vt=i;switch(i){case"keypress":if(wo(o)===0)break e;case"keydown":case"keyup":ze=Kh;break;case"focusin":vt="focus",ze=Yl;break;case"focusout":vt="blur",ze=Yl;break;case"beforeblur":case"afterblur":ze=Yl;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ze=Fs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ze=$c;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ze=ih;break;case yl:case _l:case ru:ze=Yc;break;case ou:ze=ah;break;case"scroll":case"scrollend":ze=Ns;break;case"wheel":ze=qr;break;case"copy":case"cut":case"paste":ze=Jc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ze=Wu;break;case"toggle":case"beforetoggle":ze=ic}var Vt=(n&4)!==0,na=!Vt&&(i==="scroll"||i==="scrollend"),de=Vt?we!==null?we+"Capture":null:we;Vt=[];for(var se=ve,_e;se!==null;){var Re=se;if(_e=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||_e===null||de===null||(Re=Er(se,de),Re!=null&&Vt.push(Ol(se,Re,_e))),na)break;se=se.return}0<Vt.length&&(we=new ze(we,vt,null,o,Ie),Le.push({event:we,listeners:Vt}))}}if((n&7)===0){e:{if(we=i==="mouseover"||i==="pointerover",ze=i==="mouseout"||i==="pointerout",we&&o!==Bs&&(vt=o.relatedTarget||o.fromElement)&&(pa(vt)||vt[Xt]))break e;if((ze||we)&&(we=Ie.window===Ie?Ie:(we=Ie.ownerDocument)?we.defaultView||we.parentWindow:window,ze?(vt=o.relatedTarget||o.toElement,ze=ve,vt=vt?pa(vt):null,vt!==null&&(na=Mt(vt),Vt=vt.tag,vt!==na||Vt!==5&&Vt!==27&&Vt!==6)&&(vt=null)):(ze=null,vt=ve),ze!==vt)){if(Vt=Fs,Re="onMouseLeave",de="onMouseEnter",se="mouse",(i==="pointerout"||i==="pointerover")&&(Vt=Wu,Re="onPointerLeave",de="onPointerEnter",se="pointer"),na=ze==null?we:Ar(ze),_e=vt==null?we:Ar(vt),we=new Vt(Re,se+"leave",ze,o,Ie),we.target=na,we.relatedTarget=_e,Re=null,pa(Ie)===ve&&(Vt=new Vt(de,se+"enter",vt,o,Ie),Vt.target=_e,Vt.relatedTarget=na,Re=Vt),na=Re,ze&&vt)t:{for(Vt=qc,de=ze,se=vt,_e=0,Re=de;Re;Re=Vt(Re))_e++;Re=0;for(var Bt=se;Bt;Bt=Vt(Bt))Re++;for(;0<_e-Re;)de=Vt(de),_e--;for(;0<Re-_e;)se=Vt(se),Re--;for(;_e--;){if(de===se||se!==null&&de===se.alternate){Vt=de;break t}de=Vt(de),se=Vt(se)}Vt=null}else Vt=null;ze!==null&&jh(Le,we,ze,Vt,!1),vt!==null&&na!==null&&jh(Le,na,vt,Vt,!0)}}e:{if(we=ve?Ar(ve):window,ze=we.nodeName&&we.nodeName.toLowerCase(),ze==="select"||ze==="input"&&we.type==="file")var ji=Wl;else if(To(we))if(eu)ji=Do;else{ji=tu;var At=pl}else ze=we.nodeName,!ze||ze.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?ve&&ql(ve.elementType)&&(ji=Wl):ji=Co;if(ji&&(ji=ji(i,ve))){Ao(Le,ji,o,Ie);break e}At&&At(i,we,ve),i==="focusout"&&ve&&we.type==="number"&&ve.memoizedProps.value!=null&&ol(we,"number",we.value)}switch(At=ve?Ar(ve):window,i){case"focusin":(To(At)||At.contentEditable==="true")&&(Hs=At,nu=ve,ms=null);break;case"focusout":ms=nu=Hs=null;break;case"mousedown":Io=!0;break;case"contextmenu":case"mouseup":case"dragend":Io=!1,Xs(Le,o,Ie);break;case"selectionchange":if(au)break;case"keydown":case"keyup":Xs(Le,o,Ie)}var ci;if(So)e:{switch(i){case"compositionstart":var wi="onCompositionStart";break e;case"compositionend":wi="onCompositionEnd";break e;case"compositionupdate":wi="onCompositionUpdate";break e}wi=void 0}else Zr?rh(i,o)&&(wi="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(wi="onCompositionStart");wi&&(Ql&&o.locale!=="ko"&&(Zr||wi!=="onCompositionStart"?wi==="onCompositionEnd"&&Zr&&(ci=bo()):(ds=Ie,Ku="value"in ds?ds.value:ds.textContent,Zr=!0)),At=Vc(ve,wi),0<At.length&&(wi=new ps(wi,i,null,o,Ie),Le.push({event:wi,listeners:At}),ci?wi.data=ci:(ci=Jt(o),ci!==null&&(wi.data=ci)))),(ci=Us?Zi(i,o):Li(i,o))&&(wi=Vc(ve,"onBeforeInput"),0<wi.length&&(At=new ps("onBeforeInput","beforeinput",null,o,Ie),Le.push({event:At,listeners:wi}),At.data=ci)),bp(Le,i,ve,o,Ie)}Nh(Le,n)})}function Ol(i,n,o){return{instance:i,listener:n,currentTarget:o}}function Vc(i,n){for(var o=n+"Capture",d=[];i!==null;){var _=i,w=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||w===null||(_=Er(i,o),_!=null&&d.unshift(Ol(i,_,w)),_=Er(i,n),_!=null&&d.push(Ol(i,_,w))),i.tag===3)return d;i=i.return}return[]}function qc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function jh(i,n,o,d,_){for(var w=n._reactName,C=[];o!==null&&o!==d;){var U=o,te=U.alternate,ve=U.stateNode;if(U=U.tag,te!==null&&te===d)break;U!==5&&U!==26&&U!==27||ve===null||(te=ve,_?(ve=Er(o,w),ve!=null&&C.unshift(Ol(o,ve,te))):_||(ve=Er(o,w),ve!=null&&C.push(Ol(o,ve,te)))),o=o.return}C.length!==0&&i.push({event:n,listeners:C})}var $f=/\r\n?/g,Kd=/\u0000|\uFFFD/g;function Zc(i){return(typeof i=="string"?i:""+i).replace($f,`
`).replace(Kd,"")}function qu(i,n){return n=Zc(n),Zc(i)===n}function Fi(i,n,o,d,_,w){switch(o){case"children":typeof d=="string"?n==="body"||n==="textarea"&&d===""||jr(i,d):(typeof d=="number"||typeof d=="bigint")&&n!=="body"&&jr(i,""+d);break;case"className":cs(i,"class",d);break;case"tabIndex":cs(i,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":cs(i,o,d);break;case"style":Ls(i,d,w);break;case"data":if(n!=="object"){cs(i,"data",d);break}case"src":case"href":if(d===""&&(n!=="a"||o!=="href")){i.removeAttribute(o);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){i.removeAttribute(o);break}d=Zl(""+d),i.setAttribute(o,d);break;case"action":case"formAction":if(typeof d=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(o==="formAction"?(n!=="input"&&Fi(i,n,"name",_.name,_,null),Fi(i,n,"formEncType",_.formEncType,_,null),Fi(i,n,"formMethod",_.formMethod,_,null),Fi(i,n,"formTarget",_.formTarget,_,null)):(Fi(i,n,"encType",_.encType,_,null),Fi(i,n,"method",_.method,_,null),Fi(i,n,"target",_.target,_,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){i.removeAttribute(o);break}d=Zl(""+d),i.setAttribute(o,d);break;case"onClick":d!=null&&(i.onclick=cn);break;case"onScroll":d!=null&&gi("scroll",i);break;case"onScrollEnd":d!=null&&gi("scrollend",i);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(ue(61));if(o=d.__html,o!=null){if(_.children!=null)throw Error(ue(60));i.innerHTML=o}}break;case"multiple":i.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":i.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){i.removeAttribute("xlink:href");break}o=Zl(""+d),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?i.setAttribute(o,""+d):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":d===!0?i.setAttribute(o,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?i.setAttribute(o,d):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?i.setAttribute(o,d):i.removeAttribute(o);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?i.removeAttribute(o):i.setAttribute(o,d);break;case"popover":gi("beforetoggle",i),gi("toggle",i),sa(i,"popover",d);break;case"xlinkActuate":Ia(i,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Ia(i,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Ia(i,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Ia(i,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Ia(i,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Ia(i,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Ia(i,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Ia(i,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Ia(i,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":sa(i,"is",d);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Hh.get(o)||o,sa(i,o,d))}}function Gc(i,n,o,d,_,w){switch(o){case"style":Ls(i,d,w);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(ue(61));if(o=d.__html,o!=null){if(_.children!=null)throw Error(ue(60));i.innerHTML=o}}break;case"children":typeof d=="string"?jr(i,d):(typeof d=="number"||typeof d=="bigint")&&jr(i,""+d);break;case"onScroll":d!=null&&gi("scroll",i);break;case"onScrollEnd":d!=null&&gi("scrollend",i);break;case"onClick":d!=null&&(i.onclick=cn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vn.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(_=o.endsWith("Capture"),n=o.slice(2,_?o.length-7:void 0),w=i[jt]||null,w=w!=null?w[o]:null,typeof w=="function"&&i.removeEventListener(n,w,_),typeof d=="function")){typeof w!="function"&&w!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(n,d,_);break e}o in i?i[o]=d:d===!0?i.setAttribute(o,""):sa(i,o,d)}}}function $a(i,n,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gi("error",i),gi("load",i);var d=!1,_=!1,w;for(w in o)if(o.hasOwnProperty(w)){var C=o[w];if(C!=null)switch(w){case"src":d=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(ue(137,n));default:Fi(i,n,w,C,o,null)}}_&&Fi(i,n,"srcSet",o.srcSet,o,null),d&&Fi(i,n,"src",o.src,o,null);return;case"input":gi("invalid",i);var U=w=C=_=null,te=null,ve=null;for(d in o)if(o.hasOwnProperty(d)){var Ie=o[d];if(Ie!=null)switch(d){case"name":_=Ie;break;case"type":C=Ie;break;case"checked":te=Ie;break;case"defaultChecked":ve=Ie;break;case"value":w=Ie;break;case"defaultValue":U=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(ue(137,n));break;default:Fi(i,n,d,Ie,o,null)}}yi(i,w,U,te,ve,C,_,!1);return;case"select":gi("invalid",i),d=C=w=null;for(_ in o)if(o.hasOwnProperty(_)&&(U=o[_],U!=null))switch(_){case"value":w=U;break;case"defaultValue":C=U;break;case"multiple":d=U;default:Fi(i,n,_,U,o,null)}n=w,o=C,i.multiple=!!d,n!=null?hs(i,!!d,n,!1):o!=null&&hs(i,!!d,o,!0);return;case"textarea":gi("invalid",i),w=_=d=null;for(C in o)if(o.hasOwnProperty(C)&&(U=o[C],U!=null))switch(C){case"value":d=U;break;case"defaultValue":_=U;break;case"children":w=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(ue(91));break;default:Fi(i,n,C,U,o,null)}Vl(i,d,_,w);return;case"option":for(te in o)if(o.hasOwnProperty(te)&&(d=o[te],d!=null))switch(te){case"selected":i.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Fi(i,n,te,d,o,null)}return;case"dialog":gi("beforetoggle",i),gi("toggle",i),gi("cancel",i),gi("close",i);break;case"iframe":case"object":gi("load",i);break;case"video":case"audio":for(d=0;d<Vu.length;d++)gi(Vu[d],i);break;case"image":gi("error",i),gi("load",i);break;case"details":gi("toggle",i);break;case"embed":case"source":case"link":gi("error",i),gi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ve in o)if(o.hasOwnProperty(ve)&&(d=o[ve],d!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":throw Error(ue(137,n));default:Fi(i,n,ve,d,o,null)}return;default:if(ql(n)){for(Ie in o)o.hasOwnProperty(Ie)&&(d=o[Ie],d!==void 0&&Gc(i,n,Ie,d,o,void 0));return}}for(U in o)o.hasOwnProperty(U)&&(d=o[U],d!=null&&Fi(i,n,U,d,o,null))}function wp(i,n,o,d){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,w=null,C=null,U=null,te=null,ve=null,Ie=null;for(ze in o){var Le=o[ze];if(o.hasOwnProperty(ze)&&Le!=null)switch(ze){case"checked":break;case"value":break;case"defaultValue":te=Le;default:d.hasOwnProperty(ze)||Fi(i,n,ze,null,d,Le)}}for(var we in d){var ze=d[we];if(Le=o[we],d.hasOwnProperty(we)&&(ze!=null||Le!=null))switch(we){case"type":w=ze;break;case"name":_=ze;break;case"checked":ve=ze;break;case"defaultChecked":Ie=ze;break;case"value":C=ze;break;case"defaultValue":U=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(ue(137,n));break;default:ze!==Le&&Fi(i,n,we,ze,d,Le)}}zr(i,C,U,te,ve,Ie,w,_);return;case"select":ze=C=U=we=null;for(w in o)if(te=o[w],o.hasOwnProperty(w)&&te!=null)switch(w){case"value":break;case"multiple":ze=te;default:d.hasOwnProperty(w)||Fi(i,n,w,null,d,te)}for(_ in d)if(w=d[_],te=o[_],d.hasOwnProperty(_)&&(w!=null||te!=null))switch(_){case"value":we=w;break;case"defaultValue":U=w;break;case"multiple":C=w;default:w!==te&&Fi(i,n,_,w,d,te)}n=U,o=C,d=ze,we!=null?hs(i,!!o,we,!1):!!d!=!!o&&(n!=null?hs(i,!!o,n,!0):hs(i,!!o,o?[]:"",!1));return;case"textarea":ze=we=null;for(U in o)if(_=o[U],o.hasOwnProperty(U)&&_!=null&&!d.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:Fi(i,n,U,null,d,_)}for(C in d)if(_=d[C],w=o[C],d.hasOwnProperty(C)&&(_!=null||w!=null))switch(C){case"value":we=_;break;case"defaultValue":ze=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(ue(91));break;default:_!==w&&Fi(i,n,C,_,d,w)}Rs(i,we,ze);return;case"option":for(var vt in o)if(we=o[vt],o.hasOwnProperty(vt)&&we!=null&&!d.hasOwnProperty(vt))switch(vt){case"selected":i.selected=!1;break;default:Fi(i,n,vt,null,d,we)}for(te in d)if(we=d[te],ze=o[te],d.hasOwnProperty(te)&&we!==ze&&(we!=null||ze!=null))switch(te){case"selected":i.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:Fi(i,n,te,we,d,ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Vt in o)we=o[Vt],o.hasOwnProperty(Vt)&&we!=null&&!d.hasOwnProperty(Vt)&&Fi(i,n,Vt,null,d,we);for(ve in d)if(we=d[ve],ze=o[ve],d.hasOwnProperty(ve)&&we!==ze&&(we!=null||ze!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(ue(137,n));break;default:Fi(i,n,ve,we,d,ze)}return;default:if(ql(n)){for(var na in o)we=o[na],o.hasOwnProperty(na)&&we!==void 0&&!d.hasOwnProperty(na)&&Gc(i,n,na,void 0,d,we);for(Ie in d)we=d[Ie],ze=o[Ie],!d.hasOwnProperty(Ie)||we===ze||we===void 0&&ze===void 0||Gc(i,n,Ie,we,d,ze);return}}for(var de in o)we=o[de],o.hasOwnProperty(de)&&we!=null&&!d.hasOwnProperty(de)&&Fi(i,n,de,null,d,we);for(Le in d)we=d[Le],ze=o[Le],!d.hasOwnProperty(Le)||we===ze||we==null&&ze==null||Fi(i,n,Le,we,d,ze)}function a(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function t(){if(typeof performance.getEntriesByType=="function"){for(var i=0,n=0,o=performance.getEntriesByType("resource"),d=0;d<o.length;d++){var _=o[d],w=_.transferSize,C=_.initiatorType,U=_.duration;if(w&&U&&a(C)){for(C=0,U=_.responseEnd,d+=1;d<o.length;d++){var te=o[d],ve=te.startTime;if(ve>U)break;var Ie=te.transferSize,Le=te.initiatorType;Ie&&a(Le)&&(te=te.responseEnd,C+=Ie*(te<U?1:(U-ve)/(te-ve)))}if(--d,n+=8*(w+C)/(_.duration/1e3),i++,10<i)break}}if(0<i)return n/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var r=null,l=null;function h(i){return i.nodeType===9?i:i.ownerDocument}function m(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function g(i,n){if(i===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&n==="foreignObject"?0:i}function v(i,n){return i==="textarea"||i==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var b=null;function A(){var i=window.event;return i&&i.type==="popstate"?i===b?!1:(b=i,!0):(b=null,!1)}var z=typeof setTimeout=="function"?setTimeout:void 0,M=typeof clearTimeout=="function"?clearTimeout:void 0,k=typeof Promise=="function"?Promise:void 0,B=typeof queueMicrotask=="function"?queueMicrotask:typeof k<"u"?function(i){return k.resolve(null).then(i).catch(N)}:z;function N(i){setTimeout(function(){throw i})}function F(i){return i==="head"}function G(i,n){var o=n,d=0;do{var _=o.nextSibling;if(i.removeChild(o),_&&_.nodeType===8)if(o=_.data,o==="/$"||o==="/&"){if(d===0){i.removeChild(_),Gh(n);return}d--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")d++;else if(o==="html")Me(i.ownerDocument.documentElement);else if(o==="head"){o=i.ownerDocument.head,Me(o);for(var w=o.firstChild;w;){var C=w.nextSibling,U=w.nodeName;w[Ri]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&w.rel.toLowerCase()==="stylesheet"||o.removeChild(w),w=C}}else o==="body"&&Me(i.ownerDocument.body);o=_}while(o);Gh(n)}function Y(i,n){var o=i;i=0;do{var d=o.nextSibling;if(o.nodeType===1?n?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(n?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),d&&d.nodeType===8)if(o=d.data,o==="/$"){if(i===0)break;i--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||i++;o=d}while(o)}function he(i){var n=i.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var o=n;switch(n=n.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":he(o),Ta(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function ae(i,n,o,d){for(;i.nodeType===1;){var _=o;if(i.nodeName.toLowerCase()!==n.toLowerCase()){if(!d&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(d){if(!i[Ri])switch(n){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(w=i.getAttribute("rel"),w==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(w!==_.rel||i.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||i.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||i.getAttribute("title")!==(_.title==null?null:_.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(w=i.getAttribute("src"),(w!==(_.src==null?null:_.src)||i.getAttribute("type")!==(_.type==null?null:_.type)||i.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&w&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(n==="input"&&i.type==="hidden"){var w=_.name==null?null:""+_.name;if(_.type==="hidden"&&i.getAttribute("name")===w)return i}else return i;if(i=Ve(i.nextSibling),i===null)break}return null}function le(i,n,o){if(n==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Ve(i.nextSibling),i===null))return null;return i}function Se(i,n){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!n||(i=Ve(i.nextSibling),i===null))return null;return i}function Pe(i){return i.data==="$?"||i.data==="$~"}function Qe(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function St(i,n){var o=i.ownerDocument;if(i.data==="$~")i._reactRetry=n;else if(i.data!=="$?"||o.readyState!=="loading")n();else{var d=function(){n(),o.removeEventListener("DOMContentLoaded",d)};o.addEventListener("DOMContentLoaded",d),i._reactRetry=d}}function Ve(i){for(;i!=null;i=i.nextSibling){var n=i.nodeType;if(n===1||n===3)break;if(n===8){if(n=i.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return i}var Ke=null;function ct(i){i=i.nextSibling;for(var n=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"||o==="/&"){if(n===0)return Ve(i.nextSibling);n--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||n++}i=i.nextSibling}return null}function rt(i){i=i.previousSibling;for(var n=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(n===0)return i;n--}else o!=="/$"&&o!=="/&"||n++}i=i.previousSibling}return null}function tt(i,n,o){switch(n=h(o),i){case"html":if(i=n.documentElement,!i)throw Error(ue(452));return i;case"head":if(i=n.head,!i)throw Error(ue(453));return i;case"body":if(i=n.body,!i)throw Error(ue(454));return i;default:throw Error(ue(451))}}function Me(i){for(var n=i.attributes;n.length;)i.removeAttributeNode(n[0]);Ta(i)}var at=new Map,ut=new Set;function kt(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var fi=He.d;He.d={f:Bi,r:qa,D:Za,C:Mn,L:Cn,m:Dn,X:Ga,S:va,M:gn};function Bi(){var i=fi.f(),n=Bc();return i||n}function qa(i){var n=Aa(i);n!==null&&n.tag===5&&n.type==="form"?cd(n):fi.r(i)}var mn=typeof document>"u"?null:document;function Ya(i,n,o){var d=mn;if(d&&typeof n=="string"&&n){var _=Oa(n);_='link[rel="'+i+'"][href="'+_+'"]',typeof o=="string"&&(_+='[crossorigin="'+o+'"]'),ut.has(_)||(ut.add(_),i={rel:i,crossOrigin:o,href:n},d.querySelector(_)===null&&(n=d.createElement("link"),$a(n,"link",i),za(n),d.head.appendChild(n)))}}function Za(i){fi.D(i),Ya("dns-prefetch",i,null)}function Mn(i,n){fi.C(i,n),Ya("preconnect",i,n)}function Cn(i,n,o){fi.L(i,n,o);var d=mn;if(d&&i&&n){var _='link[rel="preload"][as="'+Oa(n)+'"]';n==="image"&&o&&o.imageSrcSet?(_+='[imagesrcset="'+Oa(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(_+='[imagesizes="'+Oa(o.imageSizes)+'"]')):_+='[href="'+Oa(i)+'"]';var w=_;switch(n){case"style":w=Ba(i);break;case"script":w=si(i)}at.has(w)||(i=me({rel:"preload",href:n==="image"&&o&&o.imageSrcSet?void 0:i,as:n},o),at.set(w,i),d.querySelector(_)!==null||n==="style"&&d.querySelector(Ca(w))||n==="script"&&d.querySelector(Mi(w))||(n=d.createElement("link"),$a(n,"link",i),za(n),d.head.appendChild(n)))}}function Dn(i,n){fi.m(i,n);var o=mn;if(o&&i){var d=n&&typeof n.as=="string"?n.as:"script",_='link[rel="modulepreload"][as="'+Oa(d)+'"][href="'+Oa(i)+'"]',w=_;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=si(i)}if(!at.has(w)&&(i=me({rel:"modulepreload",href:i},n),at.set(w,i),o.querySelector(_)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Mi(w)))return}d=o.createElement("link"),$a(d,"link",i),za(d),o.head.appendChild(d)}}}function va(i,n,o){fi.S(i,n,o);var d=mn;if(d&&i){var _=mi(d).hoistableStyles,w=Ba(i);n=n||"default";var C=_.get(w);if(!C){var U={loading:0,preload:null};if(C=d.querySelector(Ca(w)))U.loading=5;else{i=me({rel:"stylesheet",href:i,"data-precedence":n},o),(o=at.get(w))&&ta(i,o);var te=C=d.createElement("link");za(te),$a(te,"link",i),te._p=new Promise(function(ve,Ie){te.onload=ve,te.onerror=Ie}),te.addEventListener("load",function(){U.loading|=1}),te.addEventListener("error",function(){U.loading|=2}),U.loading|=4,yn(C,n,d)}C={type:"stylesheet",instance:C,count:1,state:U},_.set(w,C)}}}function Ga(i,n){fi.X(i,n);var o=mn;if(o&&i){var d=mi(o).hoistableScripts,_=si(i),w=d.get(_);w||(w=o.querySelector(Mi(_)),w||(i=me({src:i,async:!0},n),(n=at.get(_))&&nl(i,n),w=o.createElement("script"),za(w),$a(w,"link",i),o.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},d.set(_,w))}}function gn(i,n){fi.M(i,n);var o=mn;if(o&&i){var d=mi(o).hoistableScripts,_=si(i),w=d.get(_);w||(w=o.querySelector(Mi(_)),w||(i=me({src:i,async:!0,type:"module"},n),(n=at.get(_))&&nl(i,n),w=o.createElement("script"),za(w),$a(w,"link",i),o.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},d.set(_,w))}}function Ka(i,n,o,d){var _=(_=Lt.current)?kt(_):null;if(!_)throw Error(ue(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(n=Ba(o.href),o=mi(_).hoistableStyles,d=o.get(n),d||(d={type:"style",instance:null,count:0,state:null},o.set(n,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=Ba(o.href);var w=mi(_).hoistableStyles,C=w.get(i);if(C||(_=_.ownerDocument||_,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(i,C),(w=_.querySelector(Ca(i)))&&!w._p&&(C.instance=w,C.state.loading=5),at.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},at.set(i,o),w||On(_,i,o,C.state))),n&&d===null)throw Error(ue(528,""));return C}if(n&&d!==null)throw Error(ue(529,""));return null;case"script":return n=o.async,o=o.src,typeof o=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=si(o),o=mi(_).hoistableScripts,d=o.get(n),d||(d={type:"script",instance:null,count:0,state:null},o.set(n,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(ue(444,i))}}function Ba(i){return'href="'+Oa(i)+'"'}function Ca(i){return'link[rel="stylesheet"]['+i+"]"}function er(i){return me({},i,{"data-precedence":i.precedence,precedence:null})}function On(i,n,o,d){i.querySelector('link[rel="preload"][as="style"]['+n+"]")?d.loading=1:(n=i.createElement("link"),d.preload=n,n.addEventListener("load",function(){return d.loading|=1}),n.addEventListener("error",function(){return d.loading|=2}),$a(n,"link",o),za(n),i.head.appendChild(n))}function si(i){return'[src="'+Oa(i)+'"]'}function Mi(i){return"script[async]"+i}function Yi(i,n,o){if(n.count++,n.instance===null)switch(n.type){case"style":var d=i.querySelector('style[data-href~="'+Oa(o.href)+'"]');if(d)return n.instance=d,za(d),d;var _=me({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return d=(i.ownerDocument||i).createElement("style"),za(d),$a(d,"style",_),yn(d,o.precedence,i),n.instance=d;case"stylesheet":_=Ba(o.href);var w=i.querySelector(Ca(_));if(w)return n.state.loading|=4,n.instance=w,za(w),w;d=er(o),(_=at.get(_))&&ta(d,_),w=(i.ownerDocument||i).createElement("link"),za(w);var C=w;return C._p=new Promise(function(U,te){C.onload=U,C.onerror=te}),$a(w,"link",d),n.state.loading|=4,yn(w,o.precedence,i),n.instance=w;case"script":return w=si(o.src),(_=i.querySelector(Mi(w)))?(n.instance=_,za(_),_):(d=o,(_=at.get(w))&&(d=me({},o),nl(d,_)),i=i.ownerDocument||i,_=i.createElement("script"),za(_),$a(_,"link",d),i.head.appendChild(_),n.instance=_);case"void":return null;default:throw Error(ue(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(d=n.instance,n.state.loading|=4,yn(d,o.precedence,i));return n.instance}function yn(i,n,o){for(var d=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=d.length?d[d.length-1]:null,w=_,C=0;C<d.length;C++){var U=d[C];if(U.dataset.precedence===n)w=U;else if(w!==_)break}w?w.parentNode.insertBefore(i,w.nextSibling):(n=o.nodeType===9?o.head:o,n.insertBefore(i,n.firstChild))}function ta(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.title==null&&(i.title=n.title)}function nl(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.integrity==null&&(i.integrity=n.integrity)}var vr=null;function ns(i,n,o){if(vr===null){var d=new Map,_=vr=new Map;_.set(o,d)}else _=vr,d=_.get(o),d||(d=new Map,_.set(o,d));if(d.has(i))return d;for(d.set(i,null),o=o.getElementsByTagName(i),_=0;_<o.length;_++){var w=o[_];if(!(w[Ri]||w[yt]||i==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var C=w.getAttribute(n)||"";C=i+C;var U=d.get(C);U?U.push(w):d.set(C,[w])}}return d}function xr(i,n,o){i=i.ownerDocument||i,i.head.insertBefore(o,n==="title"?i.querySelector("head > title"):null)}function br(i,n,o){if(o===1||n.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return i=n.disabled,typeof n.precedence=="string"&&i==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Ha(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function fo(i,n,o,d){if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var _=Ba(d.href),w=n.querySelector(Ca(_));if(w){n=w._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(i.count++,i=Hc.bind(i),n.then(i,i)),o.state.loading|=4,o.instance=w,za(w);return}w=n.ownerDocument||n,d=er(d),(_=at.get(_))&&ta(d,_),w=w.createElement("link"),za(w);var C=w;C._p=new Promise(function(U,te){C.onload=U,C.onerror=te}),$a(w,"link",d),o.instance=w}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(o,n),(n=o.state.preload)&&(o.state.loading&3)===0&&(i.count++,o=Hc.bind(i),n.addEventListener("load",o),n.addEventListener("error",o))}}var Nl=0;function Yf(i,n){return i.stylesheets&&i.count===0&&Gu(i,i.stylesheets),0<i.count||0<i.imgCount?function(o){var d=setTimeout(function(){if(i.stylesheets&&Gu(i,i.stylesheets),i.unsuspend){var w=i.unsuspend;i.unsuspend=null,w()}},6e4+n);0<i.imgBytes&&Nl===0&&(Nl=62500*t());var _=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Gu(i,i.stylesheets),i.unsuspend)){var w=i.unsuspend;i.unsuspend=null,w()}},(i.imgBytes>Nl?50:800)+n);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(d),clearTimeout(_)}}:null}function Hc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gu(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Zu=null;function Gu(i,n){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Zu=new Map,n.forEach(po,i),Zu=null,Hc.call(i))}function po(i,n){if(!(n.state.loading&4)){var o=Zu.get(i);if(o)var d=o.get(null);else{o=new Map,Zu.set(i,o);for(var _=i.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<_.length;w++){var C=_[w];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(o.set(C.dataset.precedence,C),d=C)}d&&o.set(null,d)}_=n.instance,C=_.getAttribute("data-precedence"),w=o.get(C)||d,w===d&&o.set(null,_),o.set(C,_),this.count++,d=Hc.bind(this),_.addEventListener("load",d),_.addEventListener("error",d),w?w.parentNode.insertBefore(_,w.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(_,i.firstChild)),n.state.loading|=4}}var Hu={$$typeof:dt,Provider:null,Consumer:null,_currentValue:gt,_currentValue2:gt,_threadCount:0};function Kf(i,n,o,d,_,w,C,U,te){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ie(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ie(0),this.hiddenUpdates=ie(null),this.identifierPrefix=d,this.onUncaughtError=_,this.onCaughtError=w,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function Jf(i,n,o,d,_,w,C,U,te,ve,Ie,Le){return i=new Kf(i,n,o,C,te,ve,Ie,Le,U),n=1,w===!0&&(n|=24),w=an(3,null,null,n),i.current=w,w.stateNode=i,n=Hn(),n.refCount++,i.pooledCache=n,n.refCount++,w.memoizedState={element:d,isDehydrated:o,cache:n},We(w),i}function Qf(i){return i?(i=wn,i):wn}function Wf(i,n,o,d,_,w){_=Qf(_),d.context===null?d.context=_:d.pendingContext=_,d=Fe(n),d.payload={element:o},w=w===void 0?null:w,w!==null&&(d.callback=w),o=it(i,d,n),o!==null&&(zn(o,i,n),It(o,i,n))}function ep(i,n){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<n?o:n}}function Jd(i,n){ep(i,n),(i=i.alternate)&&ep(i,n)}function tp(i){if(i.tag===13||i.tag===31){var n=Hr(i,67108864);n!==null&&zn(n,i,67108864),Jd(i,67108864)}}function ip(i){if(i.tag===13||i.tag===31){var n=_r();n=ye(n);var o=Hr(i,n);o!==null&&zn(o,i,n),Jd(i,n)}}var Uh=!0;function rs(i,n,o,d){var _=ge.T;ge.T=null;var w=He.p;try{He.p=2,qh(i,n,o,d)}finally{He.p=w,ge.T=_}}function Vh(i,n,o,d){var _=ge.T;ge.T=null;var w=He.p;try{He.p=8,qh(i,n,o,d)}finally{He.p=w,ge.T=_}}function qh(i,n,o,d){if(Uh){var _=Qd(d);if(_===null)Uc(i,n,d,Zh,o),Lp(i,d);else if(sm(_,i,n,o,d))d.stopPropagation();else if(Lp(i,d),n&4&&-1<rm.indexOf(i)){for(;_!==null;){var w=Aa(_);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var C=$(w.pendingLanes);if(C!==0){var U=w;for(U.pendingLanes|=2,U.entangledLanes|=2;C;){var te=1<<31-Ki(C);U.entanglements[1]|=te,C&=~te}Es(w),(Di&6)===0&&(Ch=Pa()+500,Fu(0))}}break;case 31:case 13:U=Hr(w,2),U!==null&&zn(U,w,2),Bc(),Jd(w,2)}if(w=Qd(d),w===null&&Uc(i,n,d,Zh,o),w===_)break;_=w}_!==null&&d.stopPropagation()}else Uc(i,n,d,null,o)}}function Qd(i){return i=Qa(i),Wd(i)}var Zh=null;function Wd(i){if(Zh=null,i=pa(i),i!==null){var n=Mt(i);if(n===null)i=null;else{var o=n.tag;if(o===13){if(i=O(n),i!==null)return i;i=null}else if(o===31){if(i=y(n),i!==null)return i;i=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;i=null}else n!==i&&(i=null)}}return Zh=i,null}function ln(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fn()){case go:return 2;case yo:return 8;case je:case wr:return 32;case Ja:return 268435456;default:return 32}default:return 32}}var Nn=!1,tr=null,un=null,ir=null,ar=new Map,ef=new Map,Xu=[],rm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Lp(i,n){switch(i){case"focusin":case"focusout":tr=null;break;case"dragenter":case"dragleave":un=null;break;case"mouseover":case"mouseout":ir=null;break;case"pointerover":case"pointerout":ar.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ef.delete(n.pointerId)}}function tf(i,n,o,d,_,w){return i===null||i.nativeEvent!==w?(i={blockedOn:n,domEventName:o,eventSystemFlags:d,nativeEvent:w,targetContainers:[_]},n!==null&&(n=Aa(n),n!==null&&tp(n)),i):(i.eventSystemFlags|=d,n=i.targetContainers,_!==null&&n.indexOf(_)===-1&&n.push(_),i)}function sm(i,n,o,d,_){switch(n){case"focusin":return tr=tf(tr,i,n,o,d,_),!0;case"dragenter":return un=tf(un,i,n,o,d,_),!0;case"mouseover":return ir=tf(ir,i,n,o,d,_),!0;case"pointerover":var w=_.pointerId;return ar.set(w,tf(ar.get(w)||null,i,n,o,d,_)),!0;case"gotpointercapture":return w=_.pointerId,ef.set(w,tf(ef.get(w)||null,i,n,o,d,_)),!0}return!1}function Bp(i){var n=pa(i.target);if(n!==null){var o=Mt(n);if(o!==null){if(n=o.tag,n===13){if(n=O(o),n!==null){i.blockedOn=n,bt(i.priority,function(){ip(o)});return}}else if(n===31){if(n=y(o),n!==null){i.blockedOn=n,bt(i.priority,function(){ip(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ap(i){if(i.blockedOn!==null)return!1;for(var n=i.targetContainers;0<n.length;){var o=Qd(i.nativeEvent);if(o===null){o=i.nativeEvent;var d=new o.constructor(o.type,o);Bs=d,o.target.dispatchEvent(d),Bs=null}else return n=Aa(o),n!==null&&tp(n),i.blockedOn=o,!1;n.shift()}return!0}function Pp(i,n,o){ap(i)&&o.delete(n)}function om(){Nn=!1,tr!==null&&ap(tr)&&(tr=null),un!==null&&ap(un)&&(un=null),ir!==null&&ap(ir)&&(ir=null),ar.forEach(Pp),ef.forEach(Pp)}function np(i,n){i.blockedOn===n&&(i.blockedOn=null,Nn||(Nn=!0,Ce.unstable_scheduleCallback(Ce.unstable_NormalPriority,om)))}var rp=null;function Op(i){rp!==i&&(rp=i,Ce.unstable_scheduleCallback(Ce.unstable_NormalPriority,function(){rp===i&&(rp=null);for(var n=0;n<i.length;n+=3){var o=i[n],d=i[n+1],_=i[n+2];if(typeof d!="function"){if(Wd(d||o)===null)continue;break}var w=Aa(o);w!==null&&(i.splice(n,3),n-=3,yh(w,{pending:!0,data:_,method:o.method,action:d},d,_))}}))}function Gh(i){function n(te){return np(te,i)}tr!==null&&np(tr,i),un!==null&&np(un,i),ir!==null&&np(ir,i),ar.forEach(n),ef.forEach(n);for(var o=0;o<Xu.length;o++){var d=Xu[o];d.blockedOn===i&&(d.blockedOn=null)}for(;0<Xu.length&&(o=Xu[0],o.blockedOn===null);)Bp(o),o.blockedOn===null&&Xu.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(d=0;d<o.length;d+=3){var _=o[d],w=o[d+1],C=_[jt]||null;if(typeof w=="function")C||Op(o);else if(C){var U=null;if(w&&w.hasAttribute("formAction")){if(_=w,C=w[jt]||null)U=C.formAction;else if(Wd(_)!==null)continue}else U=C.action;typeof U=="function"?o[d+1]=U:(o.splice(d,3),d-=3),Op(o)}}}function Np(){function i(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(C){return _=C})},focusReset:"manual",scroll:"manual"})}function n(){_!==null&&(_(),_=null),d||setTimeout(o,20)}function o(){if(!d&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,_=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(o,100),function(){d=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),_!==null&&(_(),_=null)}}}function Sp(i){this._internalRoot=i}sp.prototype.render=Sp.prototype.render=function(i){var n=this._internalRoot;if(n===null)throw Error(ue(409));var o=n.current,d=_r();Wf(o,d,i,n,null,null)},sp.prototype.unmount=Sp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var n=i.containerInfo;Wf(i.current,2,null,i,null,null),Bc(),n[Xt]=null}};function sp(i){this._internalRoot=i}sp.prototype.unstable_scheduleHydration=function(i){if(i){var n=pt();i={blockedOn:null,target:i,priority:n};for(var o=0;o<Xu.length&&n!==0&&n<Xu[o].priority;o++);Xu.splice(o,0,i),o===0&&Bp(i)}};var Fp=Et.version;if(Fp!=="19.2.0")throw Error(ue(527,Fp,"19.2.0"));He.findDOMNode=function(i){var n=i._reactInternals;if(n===void 0)throw typeof i.render=="function"?Error(ue(188)):(i=Object.keys(i).join(","),Error(ue(268,i)));return i=Ee(n),i=i!==null?ht(i):null,i=i===null?null:i.stateNode,i};var lm={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ge,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!op.isDisabled&&op.supportsFiber)try{Xe=op.inject(lm),Dt=op}catch{}}return nf.createRoot=function(i,n){if(!_t(i))throw Error(ue(299));var o=!1,d="",_=mf,w=gf,C=yf;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onUncaughtError!==void 0&&(_=n.onUncaughtError),n.onCaughtError!==void 0&&(w=n.onCaughtError),n.onRecoverableError!==void 0&&(C=n.onRecoverableError)),n=Jf(i,1,!1,null,null,o,d,null,_,w,C,Np),i[Xt]=n.current,$d(i),new Sp(n)},nf.hydrateRoot=function(i,n,o){if(!_t(i))throw Error(ue(299));var d=!1,_="",w=mf,C=gf,U=yf,te=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onUncaughtError!==void 0&&(w=o.onUncaughtError),o.onCaughtError!==void 0&&(C=o.onCaughtError),o.onRecoverableError!==void 0&&(U=o.onRecoverableError),o.formState!==void 0&&(te=o.formState)),n=Jf(i,1,!0,n,o??null,d,_,te,w,C,U,Np),n.context=Qf(null),o=n.current,d=_r(),d=ye(d),_=Fe(d),_.callback=null,it(o,_,d),o=d,n.current.lanes=o,re(n,o),Es(n),i[Xt]=n.current,$d(i),new sp(n)},nf.version="19.2.0",nf}var Yp;function _m(){if(Yp)return zp.exports;Yp=1;function Ce(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ce)}catch(Et){console.error(Et)}}return Ce(),zp.exports=ym(),zp.exports}var vm=_m();const xm=kp(vm);var hp={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */var bm=hp.exports,Kp;function wm(){return Kp||(Kp=1,(function(Ce,Et){(function(Tt,ue){Ce.exports=ue()})(bm,(function(){var Tt={},ue={};function _t(O,y,Ue){if(ue[O]=Ue,O==="index"){var Ee="var sharedModule = {}; ("+ue.shared+")(sharedModule); ("+ue.worker+")(sharedModule);",ht={};return ue.shared(ht),ue.index(Tt,ht),typeof window<"u"&&Tt.setWorkerUrl(window.URL.createObjectURL(new Blob([Ee],{type:"text/javascript"}))),Tt}}_t("shared",["exports"],(function(O){function y(a,t,r,l){return new(r||(r=Promise))((function(h,m){function g(A){try{b(l.next(A))}catch(z){m(z)}}function v(A){try{b(l.throw(A))}catch(z){m(z)}}function b(A){var z;A.done?h(A.value):(z=A.value,z instanceof r?z:new r((function(M){M(z)}))).then(g,v)}b((l=l.apply(a,t||[])).next())}))}function Ue(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var Ee=ht;function ht(a,t){this.x=a,this.y=t}ht.prototype={clone:function(){return new ht(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,t){return this.clone()._rotateAround(a,t)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var t=a.x-this.x,r=a.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,t){return Math.atan2(this.x*t-this.y*a,this.x*a+this.y*t)},_matMult:function(a){var t=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=t,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var t=Math.cos(a),r=Math.sin(a),l=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=l,this},_rotateAround:function(a,t){var r=Math.cos(a),l=Math.sin(a),h=t.y+l*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ht.convert=function(a){return a instanceof ht?a:Array.isArray(a)?new ht(a[0],a[1]):a};var me=Ue(Ee),pe=Ii;function Ii(a,t,r,l){this.cx=3*a,this.bx=3*(r-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=t,this.p2x=r,this.p2y=l}Ii.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,t){if(t===void 0&&(t=1e-6),a<0)return 0;if(a>1)return 1;for(var r=a,l=0;l<8;l++){var h=this.sampleCurveX(r)-a;if(Math.abs(h)<t)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=h/m}var g=0,v=1;for(r=a,l=0;l<20&&(h=this.sampleCurveX(r),!(Math.abs(h-a)<t));l++)a>h?g=r:v=r,r=.5*(v-g)+g;return r},solve:function(a,t){return this.sampleCurveY(this.solveCurveX(a,t))}};var ki=Ue(pe);let ti,Ut;function Ct(){return ti==null&&(ti=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ti}function qt(){if(Ut==null&&(Ut=!1,Ct())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<25;l++){const h=4*l;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let l=0;l<100;l++)if(l%4!=3&&r[l]!==l){Ut=!0;break}}}return Ut||!1}function dt(a,t,r,l){const h=new ki(a,t,r,l);return m=>h.solve(m)}const ft=dt(.25,.1,.25,1);function Ht(a,t,r){return Math.min(r,Math.max(t,a))}function Zt(a,t,r){const l=r-t,h=((a-t)%l+l)%l+t;return h===t?r:h}function ot(a,...t){for(const r of t)for(const l in r)a[l]=r[l];return a}let ni=1;function vi(a,t,r){const l={};for(const h in a)l[h]=t.call(this,a[h],h,a);return l}function Si(a,t,r){const l={};for(const h in a)t.call(this,a[h],h,a)&&(l[h]=a[h]);return l}function Pt(a){return Array.isArray(a)?a.map(Pt):typeof a=="object"&&a?vi(a,Pt):a}const Vi={};function Ti(a){Vi[a]||(typeof console<"u"&&console.warn(a),Vi[a]=!0)}function li(a,t,r){return(r.y-a.y)*(t.x-a.x)>(t.y-a.y)*(r.x-a.x)}function mt(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let ge=null;function He(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const gt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ne(a,t,r,l,h){return y(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(a,{timestamp:0});try{const g=m==null?void 0:m.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const v=g.startsWith("BGR"),b=new Uint8ClampedArray(l*h*4);if(yield m.copyTo(b,(function(A,z,M,k,B){const N=4*Math.max(-z,0),F=(Math.max(0,M)-M)*k*4+N,G=4*k,Y=Math.max(0,z),he=Math.max(0,M);return{rect:{x:Y,y:he,width:Math.min(A.width,z+k)-Y,height:Math.min(A.height,M+B)-he},layout:[{offset:F,stride:G}]}})(a,t,r,l,h)),v)for(let A=0;A<b.length;A+=4){const z=b[A];b[A]=b[A+2],b[A+2]=z}return b}finally{m.close()}}))}let nt,Q;const be="AbortError";function qe(){return new Error(be)}const et={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function lt(a){return et.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Lt="global-dispatcher";class Ot extends Error{constructor(t,r,l,h){super(`AJAXError: ${r} (${t}): ${l}`),this.status=t,this.statusText=r,this.url=l,this.body=h}}const qi=()=>mt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ai=function(a,t){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const l=lt(a.url);if(l)return l(a,t);if(mt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Lt},t)}if(!(/^file:/.test(r=a.url)||/^file:/.test(qi())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(l,h){return y(this,void 0,void 0,(function*(){const m=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:qi(),signal:h.signal});l.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");const g=yield fetch(m);if(!g.ok){const A=yield g.blob();throw new Ot(g.status,g.statusText,l.url,A)}let v;v=l.type==="arrayBuffer"||l.type==="image"?g.arrayBuffer():l.type==="json"?g.json():g.text();const b=yield v;if(h.signal.aborted)throw qe();return{data:b,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}}))})(a,t);if(mt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Lt},t)}var r;return(function(l,h){return new Promise(((m,g)=>{var v;const b=new XMLHttpRequest;b.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(b.responseType="arraybuffer");for(const A in l.headers)b.setRequestHeader(A,l.headers[A]);l.type==="json"&&(b.responseType="text",!((v=l.headers)===null||v===void 0)&&v.Accept||b.setRequestHeader("Accept","application/json")),b.withCredentials=l.credentials==="include",b.onerror=()=>{g(new Error(b.statusText))},b.onload=()=>{if(!h.signal.aborted)if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let A=b.response;if(l.type==="json")try{A=JSON.parse(b.response)}catch(z){return void g(z)}m({data:A,cacheControl:b.getResponseHeader("Cache-Control"),expires:b.getResponseHeader("Expires")})}else{const A=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});g(new Ot(b.status,b.statusText,l.url,A))}},h.signal.addEventListener("abort",(()=>{b.abort(),g(qe())})),b.send(l.body)}))})(a,t)};function rr(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const t=new URL(a),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function ss(a,t,r){r[a]&&r[a].indexOf(t)!==-1||(r[a]=r[a]||[],r[a].push(t))}function sr(a,t,r){if(r&&r[a]){const l=r[a].indexOf(t);l!==-1&&r[a].splice(l,1)}}class Nr{constructor(t,r={}){ot(this,r),this.type=t}}class _n extends Nr{constructor(t,r={}){super("error",ot({error:t},r))}}class os{on(t,r){return this._listeners=this._listeners||{},ss(t,r,this._listeners),this}off(t,r){return sr(t,r,this._listeners),sr(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},ss(t,r,this._oneTimeListeners),this):new Promise((l=>this.once(t,l)))}fire(t,r){typeof t=="string"&&(t=new Nr(t,r||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const v of h)v.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const v of m)sr(l,v,this._oneTimeListeners),v.call(this,t);const g=this._eventedParent;g&&(ot(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof _n&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Cs=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function mo(a,t){const r={};for(const l in a)l!=="ref"&&(r[l]=a[l]);return Cs.forEach((l=>{l in t&&(r[l]=t[l])})),r}function pi(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let r=0;r<a.length;r++)if(!pi(a[r],t[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const r in a)if(!pi(a[r],t[r]))return!1;return!0}return a===t}function ea(a,t){a.push(t)}function Ds(a,t,r){ea(r,{command:"addSource",args:[a,t[a]]})}function ls(a,t,r){ea(t,{command:"removeSource",args:[a]}),r[a]=!0}function Fr(a,t,r,l){ls(a,r,l),Ds(a,t,r)}function Pa(a,t,r){let l;for(l in a[r])if(Object.prototype.hasOwnProperty.call(a[r],l)&&l!=="data"&&!pi(a[r][l],t[r][l]))return!1;for(l in t[r])if(Object.prototype.hasOwnProperty.call(t[r],l)&&l!=="data"&&!pi(a[r][l],t[r][l]))return!1;return!0}function Fn(a,t,r,l,h,m){a=a||{},t=t||{};for(const g in a)Object.prototype.hasOwnProperty.call(a,g)&&(pi(a[g],t[g])||r.push({command:m,args:[l,g,t[g],h]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(a,g)&&(pi(a[g],t[g])||r.push({command:m,args:[l,g,t[g],h]}))}function go(a){return a.id}function yo(a,t){return a[t.id]=t,a}class je{constructor(t,r,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function wr(a,...t){for(const r of t)for(const l in r)a[l]=r[l];return a}class Ja extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class Sr{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[l,h]of r)this.bindings[l]=h}concat(t){return new Sr(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const us={kind:"null"},Xe={kind:"number"},Dt={kind:"string"},xt={kind:"boolean"},Ki={kind:"color"},or={kind:"object"},Ft={kind:"value"},Tr={kind:"collator"},jn={kind:"formatted"},lr={kind:"padding"},In={kind:"resolvedImage"},$={kind:"variableAnchorOffsetCollection"};function L(a,t){return{kind:"array",itemType:a,N:t}}function R(a){if(a.kind==="array"){const t=R(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const V=[us,Xe,Dt,xt,Ki,jn,or,L(Ft),lr,In,$];function H(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!H(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const r of V)if(!H(r,t))return null}}return`Expected ${R(a)} but found ${R(t)} instead.`}function ie(a,t){return t.some((r=>r.kind===a.kind))}function re(a,t){return t.some((r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a))}function ce(a,t){return a.kind==="array"&&t.kind==="array"?a.itemType.kind===t.itemType.kind&&typeof a.N=="number":a.kind===t.kind}const W=.96422,Ae=.82521,ke=4/29,ye=6/29,Ze=3*ye*ye,pt=ye*ye*ye,bt=Math.PI/180,Yt=180/Math.PI;function yt(a){return(a%=360)<0&&(a+=360),a}function jt([a,t,r,l]){let h,m;const g=fa((.2225045*(a=Xt(a))+.7168786*(t=Xt(t))+.0606169*(r=Xt(r)))/1);a===t&&t===r?h=m=g:(h=fa((.4360747*a+.3850649*t+.1430804*r)/W),m=fa((.0139322*a+.0971045*t+.7141733*r)/Ae));const v=116*g-16;return[v<0?0:v,500*(h-g),200*(g-m),l]}function Xt(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function fa(a){return a>pt?Math.pow(a,1/3):a/Ze+ke}function ra([a,t,r,l]){let h=(a+16)/116,m=isNaN(t)?h:h+t/500,g=isNaN(r)?h:h-r/200;return h=1*zi(h),m=W*zi(m),g=Ae*zi(g),[Kt(3.1338561*m-1.6168667*h-.4906146*g),Kt(-.9787684*m+1.9161415*h+.033454*g),Kt(.0719453*m-.2289914*h+1.4052427*g),l]}function Kt(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function zi(a){return a>ye?a*a*a:Ze*(a-ke)}function Ri(a){return parseInt(a.padEnd(2,a),16)/255}function Ta(a,t){return pa(t?a/100:a,0,1)}function pa(a,t,r){return Math.min(Math.max(t,a),r)}function Aa(a){return!a.some(Number.isNaN)}const Ar={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class mi{constructor(t,r,l,h=1,m=!0){this.r=t,this.g=r,this.b=l,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,r,l,h]))}static parse(t){if(t instanceof mi)return t;if(typeof t!="string")return;const r=(function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Ar[l];if(h){const[g,v,b]=h;return[g/255,v/255,b/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const g=l.length<6?1:2;let v=1;return[Ri(l.slice(v,v+=g)),Ri(l.slice(v,v+=g)),Ri(l.slice(v,v+=g)),Ri(l.slice(v,v+g)||"ff")]}if(l.startsWith("rgb")){const g=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[v,b,A,z,M,k,B,N,F,G,Y,he]=g,ae=[z||" ",B||" ",G].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const le=[A,k,F].join(""),Se=le==="%%%"?100:le===""?255:0;if(Se){const Pe=[pa(+b/Se,0,1),pa(+M/Se,0,1),pa(+N/Se,0,1),Y?Ta(+Y,he):1];if(Aa(Pe))return Pe}}return}}const m=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[g,v,b,A,z,M,k,B,N]=m,F=[b||" ",z||" ",k].join("");if(F==="  "||F==="  /"||F===",,"||F===",,,"){const G=[+v,pa(+A,0,100),pa(+M,0,100),B?Ta(+B,N):1];if(Aa(G))return(function([Y,he,ae,le]){function Se(Pe){const Qe=(Pe+Y/30)%12,St=he*Math.min(ae,1-ae);return ae-St*Math.max(-1,Math.min(Qe-3,9-Qe,1))}return Y=yt(Y),he/=100,ae/=100,[Se(0),Se(8),Se(4),le]})(G)}}})(t);return r?new mi(...r,!1):void 0}get rgb(){const{r:t,g:r,b:l,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,r/m,l/m,h])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[r,l,h,m]=jt(t),g=Math.sqrt(l*l+h*h);return[Math.round(1e4*g)?yt(Math.atan2(h,l)*Yt):NaN,g,r,m]})(this.rgb))}get lab(){return this.overwriteGetter("lab",jt(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,l,h]=this.rgb;return`rgba(${[t,r,l].map((m=>Math.round(255*m))).join(",")},${h})`}}mi.black=new mi(0,0,0,1),mi.white=new mi(1,1,1,1),mi.transparent=new mi(0,0,0,0),mi.red=new mi(1,0,0,1);class za{constructor(t,r,l){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fl{constructor(t,r,l,h,m){this.text=t,this.image=r,this.scale=l,this.fontStack=h,this.textColor=m}}class vn{constructor(t){this.sections=t}static fromString(t){return new vn([new Fl(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof vn?t:vn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class Da{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Da)return t;if(typeof t=="number")return new Da([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Da(t)}}toString(){return JSON.stringify(this.values)}}const _o=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Un{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Un)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const l=t[r],h=t[r+1];if(typeof l!="string"||!_o.has(l)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new Un(t)}}toString(){return JSON.stringify(this.values)}}class xn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new xn({name:t,available:!1}):null}}function Is(a,t,r,l){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[a,t,r,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[a,t,r,l]:[a,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ks(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof mi||a instanceof za||a instanceof vn||a instanceof Da||a instanceof Un||a instanceof xn)return!0;if(Array.isArray(a)){for(const t of a)if(!ks(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!ks(a[t]))return!1;return!0}return!1}function sa(a){if(a===null)return us;if(typeof a=="string")return Dt;if(typeof a=="boolean")return xt;if(typeof a=="number")return Xe;if(a instanceof mi)return Ki;if(a instanceof za)return Tr;if(a instanceof vn)return jn;if(a instanceof Da)return lr;if(a instanceof Un)return $;if(a instanceof xn)return In;if(Array.isArray(a)){const t=a.length;let r;for(const l of a){const h=sa(l);if(r){if(r===h)continue;r=Ft;break}r=h}return L(r||Ft,t)}return or}function cs(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof mi||a instanceof vn||a instanceof Da||a instanceof Un||a instanceof xn?a.toString():JSON.stringify(a)}class Ia{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ks(t[1]))return r.error("invalid value");const l=t[1];let h=sa(l);const m=r.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Ia(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class xi{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const rl={string:Dt,number:Xe,boolean:xt,object:or};class ur{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let l,h=1;const m=t[0];if(m==="array"){let v,b;if(t.length>2){const A=t[1];if(typeof A!="string"||!(A in rl)||A==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=rl[A],h++}else v=Ft;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);b=t[2],h++}l=L(v,b)}else{if(!rl[m])throw new Error(`Types doesn't contain name = ${m}`);l=rl[m]}const g=[];for(;h<t.length;h++){const v=r.parse(t[h],h,Ft);if(!v)return null;g.push(v)}return new ur(l,g)}evaluate(t){for(let r=0;r<this.args.length;r++){const l=this.args[r].evaluate(t);if(!H(this.type,sa(l)))return l;if(r===this.args.length-1)throw new xi(`Expected value to be of type ${R(this.type)}, but found ${R(sa(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const sl={"to-boolean":xt,"to-color":Ki,"to-number":Xe,"to-string":Dt};class Vn{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[0];if(!sl[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return r.error("Expected one argument.");const h=sl[l],m=[];for(let g=1;g<t.length;g++){const v=r.parse(t[g],g,Ft);if(!v)return null;m.push(v)}return new Vn(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,l;for(const h of this.args){if(r=h.evaluate(t),l=null,r instanceof mi)return r;if(typeof r=="string"){const m=t.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(l=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Is(r[0],r[1],r[2],r[3]),!l))return new mi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new xi(l||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const l of this.args){r=l.evaluate(t);const h=Da.parse(r);if(h)return h}throw new xi(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const l of this.args){r=l.evaluate(t);const h=Un.parse(r);if(h)return h}throw new xi(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const l of this.args){if(r=l.evaluate(t),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new xi(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return vn.fromString(cs(this.args[0].evaluate(t)));case"resolvedImage":return xn.fromString(cs(this.args[0].evaluate(t)));default:return cs(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const jl=["Unknown","Point","LineString","Polygon"];class Ul{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?jl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=mi.parse(t)),r}}class Oa{constructor(t,r,l=[],h,m=new Sr,g=[]){this.registry=t,this.path=l,this.key=l.map((v=>`[${v}]`)).join(""),this.scope=m,this.errors=g,this.expectedType=h,this._isConstant=r}parse(t,r,l,h,m={}){return r?this.concat(r,l,h)._parse(t,m):this._parse(t,m)}_parse(t,r){function l(h,m,g){return g==="assert"?new ur(m,[h]):g==="coerce"?new Vn(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let g=m.parse(t,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,b=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(v.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||b.kind!=="value"&&b.kind!=="array"){if(this.checkSubtype(v,b))return null}else g=l(g,v,r.typeAnnotation||"coerce");else g=l(g,v,r.typeAnnotation||"coerce");else g=l(g,v,r.typeAnnotation||"coerce");else g=l(g,v,r.typeAnnotation||"assert")}if(!(g instanceof Ia)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const v=new Ul;try{g=new Ia(g.type,g.evaluate(v))}catch(b){return this.error(b.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,l){const h=typeof t=="number"?this.path.concat(t):this.path,m=l?this.scope.concat(l):this.scope;return new Oa(this.registry,this._isConstant,h,r||null,m,this.errors)}error(t,...r){const l=`${this.key}${r.map((h=>`[${h}]`)).join("")}`;this.errors.push(new Ja(l,t))}checkSubtype(t,r){const l=H(t,r);return l&&this.error(l),l}}class zr{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let m=1;m<t.length-1;m+=2){const g=t[m];if(typeof g!="string")return r.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=r.parse(t[m+1],m+1);if(!v)return null;l.push([g,v])}const h=r.parse(t[t.length-1],t.length-1,r.expectedType,l);return h?new zr(l,h):null}outputDefined(){return this.result.outputDefined()}}class yi{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const l=t[1];return r.scope.has(l)?new yi(l,r.scope.get(l)):r.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ol{constructor(t,r,l){this.type=t,this.index=r,this.input=l}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,Xe),h=r.parse(t[2],2,L(r.expectedType||Ft));return l&&h?new ol(h.type.itemType,l,h):null}evaluate(t){const r=this.index.evaluate(t),l=this.input.evaluate(t);if(r<0)throw new xi(`Array index out of bounds: ${r} < 0.`);if(r>=l.length)throw new xi(`Array index out of bounds: ${r} > ${l.length-1}.`);if(r!==Math.floor(r))throw new xi(`Array index must be an integer, but found ${r} instead.`);return l[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class hs{constructor(t,r){this.type=xt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,Ft),h=r.parse(t[2],2,Ft);return l&&h?ie(l.type,[xt,Dt,Xe,us,Ft])?new hs(l,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${R(l.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!re(r,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${R(sa(r))} instead.`);if(!re(l,["string","array"]))throw new xi(`Expected second argument to be of type array or string, but found ${R(sa(l))} instead.`);return l.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Rs{constructor(t,r,l){this.type=Xe,this.needle=t,this.haystack=r,this.fromIndex=l}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,Ft),h=r.parse(t[2],2,Ft);if(!l||!h)return null;if(!ie(l.type,[xt,Dt,Xe,us,Ft]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${R(l.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,Xe);return m?new Rs(l,h,m):null}return new Rs(l,h)}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!re(r,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${R(sa(r))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),re(l,["string"])){const m=l.indexOf(r,h);return m===-1?-1:[...l.slice(0,m)].length}if(re(l,["array"]))return l.indexOf(r,h);throw new xi(`Expected second argument to be of type array or string, but found ${R(sa(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Vl{constructor(t,r,l,h,m,g){this.inputType=t,this.type=r,this.input=l,this.cases=h,this.outputs=m,this.otherwise=g}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let l,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const m={},g=[];for(let A=2;A<t.length-1;A+=2){let z=t[A];const M=t[A+1];Array.isArray(z)||(z=[z]);const k=r.concat(A);if(z.length===0)return k.error("Expected at least one branch label.");for(const N of z){if(typeof N!="number"&&typeof N!="string")return k.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return k.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return k.error("Numeric branch labels must be integer values.");if(l){if(k.checkSubtype(l,sa(N)))return null}else l=sa(N);if(m[String(N)]!==void 0)return k.error("Branch labels must be unique.");m[String(N)]=g.length}const B=r.parse(M,A,h);if(!B)return null;h=h||B.type,g.push(B)}const v=r.parse(t[1],1,Ft);if(!v)return null;const b=r.parse(t[t.length-1],t.length-1,h);return b?v.type.kind!=="value"&&r.concat(1).checkSubtype(l,v.type)?null:new Vl(l,h,v,m,g,b):null}evaluate(t){const r=this.input.evaluate(t);return(sa(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class jr{constructor(t,r,l){this.type=t,this.branches=r,this.otherwise=l}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let l;r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);const h=[];for(let g=1;g<t.length-1;g+=2){const v=r.parse(t[g],g,xt);if(!v)return null;const b=r.parse(t[g+1],g+1,l);if(!b)return null;h.push([v,b]),l=l||b.type}const m=r.parse(t[t.length-1],t.length-1,l);if(!m)return null;if(!l)throw new Error("Can't infer output type");return new jr(l,h,m)}evaluate(t){for(const[r,l]of this.branches)if(r.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,l]of this.branches)t(r),t(l);t(this.otherwise)}outputDefined(){return this.branches.every((([t,r])=>r.outputDefined()))&&this.otherwise.outputDefined()}}class ll{constructor(t,r,l,h){this.type=t,this.input=r,this.beginIndex=l,this.endIndex=h}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,Ft),h=r.parse(t[2],2,Xe);if(!l||!h)return null;if(!ie(l.type,[L(Ft),Dt,Ft]))return r.error(`Expected first argument to be of type array or string, but found ${R(l.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,Xe);return m?new ll(l.type,l,h,m):null}return new ll(l.type,l,h)}evaluate(t){const r=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),re(r,["string"]))return[...r].slice(l,h).join("");if(re(r,["array"]))return r.slice(l,h);throw new xi(`Expected first argument to be of type array or string, but found ${R(sa(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ul(a,t){const r=a.length-1;let l,h,m=0,g=r,v=0;for(;m<=g;)if(v=Math.floor((m+g)/2),l=a[v],h=a[v+1],l<=t){if(v===r||t<h)return v;m=v+1}else{if(!(l>t))throw new xi("Input is not a number.");g=v-1}return 0}class Ls{constructor(t,r,l){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[h,m]of l)this.labels.push(h),this.outputs.push(m)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const l=r.parse(t[1],1,Xe);if(!l)return null;const h=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let g=1;g<t.length;g+=2){const v=g===1?-1/0:t[g],b=t[g+1],A=g,z=g+1;if(typeof v!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(h.length&&h[h.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const M=r.parse(b,z,m);if(!M)return null;m=m||M.type,h.push([v,M])}return new Ls(m,l,h)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return l[0].evaluate(t);const m=r.length;return h>=r[m-1]?l[m-1].evaluate(t):l[ul(r,h)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function ql(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Hh=Xc;function Xc(a,t,r,l){this.cx=3*a,this.bx=3*(r-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=t,this.p2x=r,this.p2y=l}Xc.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,t){if(t===void 0&&(t=1e-6),a<0)return 0;if(a>1)return 1;for(var r=a,l=0;l<8;l++){var h=this.sampleCurveX(r)-a;if(Math.abs(h)<t)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=h/m}var g=0,v=1;for(r=a,l=0;l<20&&(h=this.sampleCurveX(r),!(Math.abs(h-a)<t));l++)a>h?g=r:v=r,r=.5*(v-g)+g;return r},solve:function(a,t){return this.sampleCurveY(this.solveCurveX(a,t))}};var Zl=ql(Hh);function cn(a,t,r){return a+r*(t-a)}function Bs(a,t,r){return a.map(((l,h)=>cn(l,t[h],r)))}const Qa={number:cn,color:function(a,t,r,l="rgb"){switch(l){case"rgb":{const[h,m,g,v]=Bs(a.rgb,t.rgb,r);return new mi(h,m,g,v,!1)}case"hcl":{const[h,m,g,v]=a.hcl,[b,A,z,M]=t.hcl;let k,B;if(isNaN(h)||isNaN(b))isNaN(h)?isNaN(b)?k=NaN:(k=b,g!==1&&g!==0||(B=A)):(k=h,z!==1&&z!==0||(B=m));else{let he=b-h;b>h&&he>180?he-=360:b<h&&h-b>180&&(he+=360),k=h+r*he}const[N,F,G,Y]=(function([he,ae,le,Se]){return he=isNaN(he)?0:he*bt,ra([le,Math.cos(he)*ae,Math.sin(he)*ae,Se])})([k,B??cn(m,A,r),cn(g,z,r),cn(v,M,r)]);return new mi(N,F,G,Y,!1)}case"lab":{const[h,m,g,v]=ra(Bs(a.lab,t.lab,r));return new mi(h,m,g,v,!1)}}},array:Bs,padding:function(a,t,r){return new Da(Bs(a.values,t.values,r))},variableAnchorOffsetCollection:function(a,t,r){const l=a.values,h=t.values;if(l.length!==h.length)throw new xi(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${t.toString()}`);const m=[];for(let g=0;g<l.length;g+=2){if(l[g]!==h[g])throw new xi(`Cannot interpolate values containing mismatched anchors. from[${g}]: ${l[g]}, to[${g}]: ${h[g]}`);m.push(l[g]);const[v,b]=l[g+1],[A,z]=h[g+1];m.push([cn(v,A,r),cn(b,z,r)])}return new Un(m)}};class ka{constructor(t,r,l,h,m){this.type=t,this.operator=r,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[g,v]of m)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(t,r,l,h){let m=0;if(t.name==="exponential")m=Ur(r,t.base,l,h);else if(t.name==="linear")m=Ur(r,1,l,h);else if(t.name==="cubic-bezier"){const g=t.controlPoints;m=new Zl(g[0],g[1],g[2],g[3]).solve(Ur(r,1,l,h))}return m}static parse(t,r){let[l,h,m,...g]=t;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const A=h[1];if(typeof A!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:A}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const A=h.slice(1);if(A.length!==4||A.some((z=>typeof z!="number"||z<0||z>1)))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:A}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,Xe),!m)return null;const v=[];let b=null;l==="interpolate-hcl"||l==="interpolate-lab"?b=Ki:r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let A=0;A<g.length;A+=2){const z=g[A],M=g[A+1],k=A+3,B=A+4;if(typeof z!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(v.length&&v[v.length-1][0]>=z)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',k);const N=r.parse(M,B,b);if(!N)return null;b=b||N.type,v.push([z,N])}return ce(b,Xe)||ce(b,Ki)||ce(b,lr)||ce(b,$)||ce(b,L(Xe))?new ka(b,l,h,m,v):r.error(`Type ${R(b)} is not interpolatable.`)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return l[0].evaluate(t);const m=r.length;if(h>=r[m-1])return l[m-1].evaluate(t);const g=ul(r,h),v=ka.interpolationFactor(this.interpolation,h,r[g],r[g+1]),b=l[g].evaluate(t),A=l[g+1].evaluate(t);switch(this.operator){case"interpolate":return Qa[this.type.kind](b,A,v);case"interpolate-hcl":return Qa.color(b,A,v,"hcl");case"interpolate-lab":return Qa.color(b,A,v,"lab")}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Ur(a,t,r,l){const h=l-r,m=a-r;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}class cl{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let l=null;const h=r.expectedType;h&&h.kind!=="value"&&(l=h);const m=[];for(const v of t.slice(1)){const b=r.parse(v,1+m.length,l,void 0,{typeAnnotation:"omit"});if(!b)return null;l=l||b.type,m.push(b)}if(!l)throw new Error("No output type");const g=h&&m.some((v=>H(h,v.type)));return new cl(g?Ft:l,m)}evaluate(t){let r,l=null,h=0;for(const m of this.args)if(h++,l=m.evaluate(t),l&&l instanceof xn&&!l.available&&(r||(r=l.name),l=null,h===this.args.length&&(l=r)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function vo(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Yu(a,t,r,l){return l.compare(t,r)===0}function Er(a,t,r){const l=a!=="=="&&a!=="!=";return class im{constructor(m,g,v){this.type=xt,this.lhs=m,this.rhs=g,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const v=m[0];let b=g.parse(m[1],1,Ft);if(!b)return null;if(!vo(v,b.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${R(b.type)}'.`);let A=g.parse(m[2],2,Ft);if(!A)return null;if(!vo(v,A.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${R(A.type)}'.`);if(b.type.kind!==A.type.kind&&b.type.kind!=="value"&&A.type.kind!=="value")return g.error(`Cannot compare types '${R(b.type)}' and '${R(A.type)}'.`);l&&(b.type.kind==="value"&&A.type.kind!=="value"?b=new ur(A.type,[b]):b.type.kind!=="value"&&A.type.kind==="value"&&(A=new ur(b.type,[A])));let z=null;if(m.length===4){if(b.type.kind!=="string"&&A.type.kind!=="string"&&b.type.kind!=="value"&&A.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(z=g.parse(m[3],3,Tr),!z)return null}return new im(b,A,z)}evaluate(m){const g=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){const b=sa(g),A=sa(v);if(b.kind!==A.kind||b.kind!=="string"&&b.kind!=="number")throw new xi(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${b.kind}, ${A.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const b=sa(g),A=sa(v);if(b.kind!=="string"||A.kind!=="string")return t(m,g,v)}return this.collator?r(m,g,v,this.collator.evaluate(m)):t(m,g,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Vr=Er("==",(function(a,t,r){return t===r}),Yu),Gl=Er("!=",(function(a,t,r){return t!==r}),(function(a,t,r,l){return!Yu(0,t,r,l)})),xo=Er("<",(function(a,t,r){return t<r}),(function(a,t,r,l){return l.compare(t,r)<0})),ds=Er(">",(function(a,t,r){return t>r}),(function(a,t,r,l){return l.compare(t,r)>0})),Ku=Er("<=",(function(a,t,r){return t<=r}),(function(a,t,r,l){return l.compare(t,r)<=0})),hl=Er(">=",(function(a,t,r){return t>=r}),(function(a,t,r,l){return l.compare(t,r)>=0}));class bo{constructor(t,r,l){this.type=Tr,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return r.error("Collator options argument must be an object.");const h=r.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,xt);if(!h)return null;const m=r.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,xt);if(!m)return null;let g=null;return l.locale&&(g=r.parse(l.locale,1,Dt),!g)?null:new bo(h,m,g)}evaluate(t){return new za(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class wo{constructor(t,r,l,h,m){this.type=Dt,this.number=t,this.locale=r,this.currency=l,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const l=r.parse(t[1],1,Xe);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=r.parse(h.locale,1,Dt),!m))return null;let g=null;if(h.currency&&(g=r.parse(h.currency,1,Dt),!g))return null;let v=null;if(h["min-fraction-digits"]&&(v=r.parse(h["min-fraction-digits"],1,Xe),!v))return null;let b=null;return h["max-fraction-digits"]&&(b=r.parse(h["max-fraction-digits"],1,Xe),!b)?null:new wo(l,m,g,v,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Ps{constructor(t){this.type=jn,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return r.error("First argument must be an image or text section.");const h=[];let m=!1;for(let g=1;g<=t.length-1;++g){const v=t[g];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let b=null;if(v["font-scale"]&&(b=r.parse(v["font-scale"],1,Xe),!b))return null;let A=null;if(v["text-font"]&&(A=r.parse(v["text-font"],1,L(Dt)),!A))return null;let z=null;if(v["text-color"]&&(z=r.parse(v["text-color"],1,Ki),!z))return null;const M=h[h.length-1];M.scale=b,M.font=A,M.textColor=z}else{const b=r.parse(t[g],1,Ft);if(!b)return null;const A=b.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:b,scale:null,font:null,textColor:null})}}return new Ps(h)}evaluate(t){return new vn(this.sections.map((r=>{const l=r.content.evaluate(t);return sa(l)===In?new Fl("",l,null,null,null):new Fl(cs(l),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)})))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}}class Hl{constructor(t){this.type=In,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const l=r.parse(t[1],1,Dt);return l?new Hl(l):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),l=xn.fromString(r);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(r)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Wa{constructor(t){this.type=Xe,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=r.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${R(l.type)} instead.`):new Wa(l):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new xi(`Expected value to be of type string or array, but found ${R(sa(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const en=8192;function Xl(a,t){const r=(180+a[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(r*h*en),Math.round(l*h*en)]}function Os(a,t){const r=Math.pow(2,t.z);return[(h=(a[0]/en+t.x)/r,360*h-180),(l=(a[1]/en+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,h}function Ns(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function Mr(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function _i(a,t,r){const l=a[0]-t[0],h=a[1]-t[1],m=a[0]-r[0],g=a[1]-r[1];return l*g-m*h==0&&l*m<=0&&h*g<=0}function fs(a,t,r,l){return(h=[l[0]-r[0],l[1]-r[1]])[0]*(m=[t[0]-a[0],t[1]-a[1]])[1]-h[1]*m[0]!=0&&!(!Yl(a,t,r,l)||!Yl(r,l,a,t));var h,m}function $l(a,t,r){for(const l of r)for(let h=0;h<l.length-1;++h)if(fs(a,t,l[h],l[h+1]))return!0;return!1}function Fs(a,t,r=!1){let l=!1;for(const v of t)for(let b=0;b<v.length-1;b++){if(_i(a,v[b],v[b+1]))return r;(m=v[b])[1]>(h=a)[1]!=(g=v[b+1])[1]>h[1]&&h[0]<(g[0]-m[0])*(h[1]-m[1])/(g[1]-m[1])+m[0]&&(l=!l)}var h,m,g;return l}function Xh(a,t){for(const r of t)if(Fs(a,r))return!0;return!1}function $c(a,t){for(const r of a)if(!Fs(r,t))return!1;for(let r=0;r<a.length-1;++r)if($l(a[r],a[r+1],t))return!1;return!0}function $h(a,t){for(const r of t)if($c(a,r))return!0;return!1}function Yl(a,t,r,l){const h=l[0]-r[0],m=l[1]-r[1],g=(a[0]-r[0])*m-h*(a[1]-r[1]),v=(t[0]-r[0])*m-h*(t[1]-r[1]);return g>0&&v<0||g<0&&v>0}function Ju(a,t,r){const l=[];for(let h=0;h<a.length;h++){const m=[];for(let g=0;g<a[h].length;g++){const v=Xl(a[h][g],r);Ns(t,v),m.push(v)}l.push(m)}return l}function Yc(a,t,r){const l=[];for(let h=0;h<a.length;h++){const m=Ju(a[h],t,r);l.push(m)}return l}function Kc(a,t,r,l){if(a[0]<r[0]||a[0]>r[2]){const h=.5*l;let m=a[0]-r[0]>h?-l:r[0]-a[0]>h?l:0;m===0&&(m=a[0]-r[2]>h?-l:r[2]-a[0]>h?l:0),a[0]+=m}Ns(t,a)}function Jc(a,t,r,l){const h=Math.pow(2,l.z)*en,m=[l.x*en,l.y*en],g=[];for(const v of a)for(const b of v){const A=[b.x+m[0],b.y+m[1]];Kc(A,t,r,h),g.push(A)}return g}function Qc(a,t,r,l){const h=Math.pow(2,l.z)*en,m=[l.x*en,l.y*en],g=[];for(const b of a){const A=[];for(const z of b){const M=[z.x+m[0],z.y+m[1]];Ns(t,M),A.push(M)}g.push(A)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of g)for(const A of b)Kc(A,t,r,h)}var v;return g}class ps{constructor(t,r){this.type=xt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ks(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const h=[];for(const m of l.features){const{type:g,coordinates:v}=m.geometry;g==="Polygon"&&h.push(v),g==="MultiPolygon"&&h.push(...v)}if(h.length)return new ps(l,{type:"MultiPolygon",coordinates:h})}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new ps(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new ps(l,l)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(r,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(l.type==="Polygon"){const v=Ju(l.coordinates,m,g),b=Jc(r.geometry(),h,m,g);if(!Mr(h,m))return!1;for(const A of b)if(!Fs(A,v))return!1}if(l.type==="MultiPolygon"){const v=Yc(l.coordinates,m,g),b=Jc(r.geometry(),h,m,g);if(!Mr(h,m))return!1;for(const A of b)if(!Xh(A,v))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(r,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(l.type==="Polygon"){const v=Ju(l.coordinates,m,g),b=Qc(r.geometry(),h,m,g);if(!Mr(h,m))return!1;for(const A of b)if(!$c(A,v))return!1}if(l.type==="MultiPolygon"){const v=Yc(l.coordinates,m,g),b=Qc(r.geometry(),h,m,g);if(!Mr(h,m))return!1;for(const A of b)if(!$h(A,v))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Wc=class{constructor(a=[],t=((r,l)=>r<l?-1:r>l?1:0)){if(this.data=a,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:t,compare:r}=this,l=t[a];for(;a>0;){const h=a-1>>1,m=t[h];if(r(l,m)>=0)break;t[a]=m,a=h}t[a]=l}_down(a){const{data:t,compare:r}=this,l=this.length>>1,h=t[a];for(;a<l;){let m=1+(a<<1);const g=m+1;if(g<this.length&&r(t[g],t[m])<0&&(m=g),r(t[m],h)>=0)break;t[a]=t[m],a=m}t[a]=h}};function Yh(a,t,r,l,h){eh(a,t,r,l||a.length-1,h||Qu)}function eh(a,t,r,l,h){for(;l>r;){if(l-r>600){var m=l-r+1,g=t-r+1,v=Math.log(m),b=.5*Math.exp(2*v/3),A=.5*Math.sqrt(v*b*(m-b)/m)*(g-m/2<0?-1:1);eh(a,t,Math.max(r,Math.floor(t-g*b/m+A)),Math.min(l,Math.floor(t+(m-g)*b/m+A)),h)}var z=a[t],M=r,k=l;for(dl(a,r,t),h(a[l],z)>0&&dl(a,r,l);M<k;){for(dl(a,M,k),M++,k--;h(a[M],z)<0;)M++;for(;h(a[k],z)>0;)k--}h(a[r],z)===0?dl(a,r,k):dl(a,++k,l),k<=t&&(r=k+1),t<=k&&(l=k-1)}}function dl(a,t,r){var l=a[t];a[t]=a[r],a[r]=l}function Qu(a,t){return a<t?-1:a>t?1:0}function Kl(a,t){if(a.length<=1)return[a];const r=[];let l,h;for(const m of a){const g=Jh(m);g!==0&&(m.area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(l&&r.push(l),l=[m]):l.push(m))}if(l&&r.push(l),t>1)for(let m=0;m<r.length;m++)r[m].length<=t||(Yh(r[m],t,1,r[m].length-1,Kh),r[m]=r[m].slice(0,t));return r}function Kh(a,t){return t.area-a.area}function Jh(a){let t=0;for(let r,l,h=0,m=a.length,g=m-1;h<m;g=h++)r=a[h],l=a[g],t+=(l.x-r.x)*(r.y+l.y);return t}const Wu=1/298.257223563,th=Wu*(2-Wu),ih=Math.PI/180;class ec{constructor(t){const r=6378.137*ih*1e3,l=Math.cos(t*ih),h=1/(1-th*(1-l*l)),m=Math.sqrt(h);this.kx=r*m*l,this.ky=r*m*h*(1-th)}distance(t,r){const l=this.wrap(t[0]-r[0])*this.kx,h=(t[1]-r[1])*this.ky;return Math.sqrt(l*l+h*h)}pointOnLine(t,r){let l,h,m,g,v=1/0;for(let b=0;b<t.length-1;b++){let A=t[b][0],z=t[b][1],M=this.wrap(t[b+1][0]-A)*this.kx,k=(t[b+1][1]-z)*this.ky,B=0;M===0&&k===0||(B=(this.wrap(r[0]-A)*this.kx*M+(r[1]-z)*this.ky*k)/(M*M+k*k),B>1?(A=t[b+1][0],z=t[b+1][1]):B>0&&(A+=M/this.kx*B,z+=k/this.ky*B)),M=this.wrap(r[0]-A)*this.kx,k=(r[1]-z)*this.ky;const N=M*M+k*k;N<v&&(v=N,l=A,h=z,m=b,g=B)}return{point:[l,h],index:m,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function ah(a,t){return t[0]-a[0]}function Jl(a){return a[1]-a[0]+1}function qr(a,t){return a[1]>=a[0]&&a[1]<t}function tc(a,t){if(a[0]>a[1])return[null,null];const r=Jl(a);if(t){if(r===2)return[a,null];const h=Math.floor(r/2);return[[a[0],a[0]+h],[a[0]+h,a[1]]]}if(r===1)return[a,null];const l=Math.floor(r/2)-1;return[[a[0],a[0]+l],[a[0]+l+1,a[1]]]}function ic(a,t){if(!qr(t,a.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)Ns(r,a[l]);return r}function ac(a){const t=[1/0,1/0,-1/0,-1/0];for(const r of a)for(const l of r)Ns(t,l);return t}function So(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function js(a,t,r){if(!So(a)||!So(t))return NaN;let l=0,h=0;return a[2]<t[0]&&(l=t[0]-a[2]),a[0]>t[2]&&(l=a[0]-t[2]),a[1]>t[3]&&(h=a[1]-t[3]),a[3]<t[1]&&(h=t[1]-a[3]),r.distance([0,0],[l,h])}function Us(a,t,r){const l=r.pointOnLine(t,a);return r.distance(a,l.point)}function Ql(a,t,r,l,h){const m=Math.min(Us(a,[r,l],h),Us(t,[r,l],h)),g=Math.min(Us(r,[a,t],h),Us(l,[a,t],h));return Math.min(m,g)}function nh(a,t,r,l,h){if(!qr(t,a.length)||!qr(l,r.length))return 1/0;let m=1/0;for(let g=t[0];g<t[1];++g){const v=a[g],b=a[g+1];for(let A=l[0];A<l[1];++A){const z=r[A],M=r[A+1];if(fs(v,b,z,M))return 0;m=Math.min(m,Ql(v,b,z,M,h))}}return m}function oa(a,t,r,l,h){if(!qr(t,a.length)||!qr(l,r.length))return NaN;let m=1/0;for(let g=t[0];g<=t[1];++g)for(let v=l[0];v<=l[1];++v)if(m=Math.min(m,h.distance(a[g],r[v])),m===0)return m;return m}function rh(a,t,r){if(Fs(a,t,!0))return 0;let l=1/0;for(const h of t){const m=h[0],g=h[h.length-1];if(m!==g&&(l=Math.min(l,Us(a,[g,m],r)),l===0))return l;const v=r.pointOnLine(h,a);if(l=Math.min(l,r.distance(a,v.point)),l===0)return l}return l}function Jt(a,t,r,l){if(!qr(t,a.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Fs(a[m],r,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const g=a[m],v=a[m+1];for(const b of r)for(let A=0,z=b.length,M=z-1;A<z;M=A++){const k=b[M],B=b[A];if(fs(g,v,k,B))return 0;h=Math.min(h,Ql(g,v,k,B,l))}}return h}function Zr(a,t){for(const r of a)for(const l of r)if(Fs(l,t,!0))return!0;return!1}function Zi(a,t,r,l=1/0){const h=ac(a),m=ac(t);if(l!==1/0&&js(h,m,r)>=l)return l;if(Mr(h,m)){if(Zr(a,t))return 0}else if(Zr(t,a))return 0;let g=1/0;for(const v of a)for(let b=0,A=v.length,z=A-1;b<A;z=b++){const M=v[z],k=v[b];for(const B of t)for(let N=0,F=B.length,G=F-1;N<F;G=N++){const Y=B[G],he=B[N];if(fs(M,k,Y,he))return 0;g=Math.min(g,Ql(M,k,Y,he,r))}}return g}function Li(a,t,r,l,h,m){if(!m)return;const g=js(ic(l,m),h,r);g<t&&a.push([g,m,[0,0]])}function Vs(a,t,r,l,h,m,g){if(!m||!g)return;const v=js(ic(l,m),ic(h,g),r);v<t&&a.push([v,m,g])}function To(a,t,r,l,h=1/0){let m=Math.min(l.distance(a[0],r[0][0]),h);if(m===0)return m;const g=new Wc([[0,[0,a.length-1],[0,0]]],ah),v=ac(r);for(;g.length>0;){const b=g.pop();if(b[0]>=m)continue;const A=b[1],z=t?50:100;if(Jl(A)<=z){if(!qr(A,a.length))return NaN;if(t){const M=Jt(a,A,r,l);if(isNaN(M)||M===0)return M;m=Math.min(m,M)}else for(let M=A[0];M<=A[1];++M){const k=rh(a[M],r,l);if(m=Math.min(m,k),m===0)return 0}}else{const M=tc(A,t);Li(g,m,l,a,v,M[0]),Li(g,m,l,a,v,M[1])}}return m}function Ao(a,t,r,l,h,m=1/0){let g=Math.min(m,h.distance(a[0],r[0]));if(g===0)return g;const v=new Wc([[0,[0,a.length-1],[0,r.length-1]]],ah);for(;v.length>0;){const b=v.pop();if(b[0]>=g)continue;const A=b[1],z=b[2],M=t?50:100,k=l?50:100;if(Jl(A)<=M&&Jl(z)<=k){if(!qr(A,a.length)&&qr(z,r.length))return NaN;let B;if(t&&l)B=nh(a,A,r,z,h),g=Math.min(g,B);else if(t&&!l){const N=a.slice(A[0],A[1]+1);for(let F=z[0];F<=z[1];++F)if(B=Us(r[F],N,h),g=Math.min(g,B),g===0)return g}else if(!t&&l){const N=r.slice(z[0],z[1]+1);for(let F=A[0];F<=A[1];++F)if(B=Us(a[F],N,h),g=Math.min(g,B),g===0)return g}else B=oa(a,A,r,z,h),g=Math.min(g,B)}else{const B=tc(A,t),N=tc(z,l);Vs(v,g,h,a,r,B[0],N[0]),Vs(v,g,h,a,r,B[0],N[1]),Vs(v,g,h,a,r,B[1],N[0]),Vs(v,g,h,a,r,B[1],N[1])}}return g}function qs(a){return a.type==="MultiPolygon"?a.coordinates.map((t=>({type:"Polygon",coordinates:t}))):a.type==="MultiLineString"?a.coordinates.map((t=>({type:"LineString",coordinates:t}))):a.type==="MultiPoint"?a.coordinates.map((t=>({type:"Point",coordinates:t}))):[a]}class cr{constructor(t,r){this.type=Xe,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ks(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new cr(l,l.features.map((h=>qs(h.geometry))).flat());if(l.type==="Feature")return new cr(l,qs(l.geometry));if("type"in l&&"coordinates"in l)return new cr(l,qs(l))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(r,l){const h=r.geometry(),m=h.flat().map((b=>Os([b.x,b.y],r.canonical)));if(h.length===0)return NaN;const g=new ec(m[0][1]);let v=1/0;for(const b of l){switch(b.type){case"Point":v=Math.min(v,Ao(m,!1,[b.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Ao(m,!1,b.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,To(m,!1,b.coordinates,g,v))}if(v===0)return v}return v})(t,this.geometries);if(t.geometryType()==="LineString")return(function(r,l){const h=r.geometry(),m=h.flat().map((b=>Os([b.x,b.y],r.canonical)));if(h.length===0)return NaN;const g=new ec(m[0][1]);let v=1/0;for(const b of l){switch(b.type){case"Point":v=Math.min(v,Ao(m,!0,[b.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Ao(m,!0,b.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,To(m,!0,b.coordinates,g,v))}if(v===0)return v}return v})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(r,l){const h=r.geometry();if(h.length===0||h[0].length===0)return NaN;const m=Kl(h,0).map((b=>b.map((A=>A.map((z=>Os([z.x,z.y],r.canonical))))))),g=new ec(m[0][0][0][1]);let v=1/0;for(const b of l)for(const A of m){switch(b.type){case"Point":v=Math.min(v,To([b.coordinates],!1,A,g,v));break;case"LineString":v=Math.min(v,To(b.coordinates,!0,A,g,v));break;case"Polygon":v=Math.min(v,Zi(A,b.coordinates,g,v))}if(v===0)return v}return v})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const zo={"==":Vr,"!=":Gl,">":ds,"<":xo,">=":hl,"<=":Ku,array:ur,at:ol,boolean:ur,case:jr,coalesce:cl,collator:bo,format:Ps,image:Hl,in:hs,"index-of":Rs,interpolate:ka,"interpolate-hcl":ka,"interpolate-lab":ka,length:Wa,let:zr,literal:Ia,match:Vl,number:ur,"number-format":wo,object:ur,slice:ll,step:Ls,string:ur,"to-boolean":Vn,"to-color":Vn,"to-number":Vn,"to-string":Vn,var:yi,within:ps,distance:cr};class hn{constructor(t,r,l,h){this.name=t,this.type=r,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const l=t[0],h=hn.definitions[l];if(!h)return r.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=g.filter((([A])=>!Array.isArray(A)||A.length===t.length-1));let b=null;for(const[A,z]of v){b=new Oa(r.registry,Eo,r.path,null,r.scope);const M=[];let k=!1;for(let B=1;B<t.length;B++){const N=t[B],F=Array.isArray(A)?A[B-1]:A.type,G=b.parse(N,1+M.length,F);if(!G){k=!0;break}M.push(G)}if(!k)if(Array.isArray(A)&&A.length!==M.length)b.error(`Expected ${A.length} arguments, but found ${M.length} instead.`);else{for(let B=0;B<M.length;B++){const N=Array.isArray(A)?A[B]:A.type,F=M[B];b.concat(B+1).checkSubtype(N,F.type)}if(b.errors.length===0)return new hn(l,m,z,M)}}if(v.length===1)r.errors.push(...b.errors);else{const A=(v.length?v:g).map((([M])=>{return k=M,Array.isArray(k)?`(${k.map(R).join(", ")})`:`(${R(k.type)}...)`;var k})).join(" | "),z=[];for(let M=1;M<t.length;M++){const k=r.parse(t[M],1+z.length);if(!k)return null;z.push(R(k.type))}r.error(`Expected arguments of type ${A}, but found (${z.join(", ")}) instead.`)}return null}static register(t,r){hn.definitions=r;for(const l in r)t[l]=hn}}function Wl(a,[t,r,l,h]){t=t.evaluate(a),r=r.evaluate(a),l=l.evaluate(a);const m=h?h.evaluate(a):1,g=Is(t,r,l,m);if(g)throw new xi(g);return new mi(t/255,r/255,l/255,m,!1)}function eu(a,t){return a in t}function fl(a,t){const r=t[a];return r===void 0?null:r}function Gr(a){return{type:a}}function Eo(a){if(a instanceof yi)return Eo(a.boundExpression);if(a instanceof hn&&a.name==="error"||a instanceof bo||a instanceof ps||a instanceof cr)return!1;const t=a instanceof Vn||a instanceof ur;let r=!0;return a.eachChild((l=>{r=t?r&&Eo(l):r&&l instanceof Ia})),!!r&&Mo(a)&&pl(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Mo(a){if(a instanceof hn&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof ps||a instanceof cr)return!1;let t=!0;return a.eachChild((r=>{t&&!Mo(r)&&(t=!1)})),t}function Zs(a){if(a instanceof hn&&a.name==="feature-state")return!1;let t=!0;return a.eachChild((r=>{t&&!Zs(r)&&(t=!1)})),t}function pl(a,t){if(a instanceof hn&&t.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild((l=>{r&&!pl(l,t)&&(r=!1)})),r}function tu(a){return{result:"success",value:a}}function Co(a){return{result:"error",value:a}}function Do(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function sh(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function dn(a){return!!a.expression&&a.expression.interpolated}function ui(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ml(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function oh(a){return a}function nc(a,t){const r=t.type==="color",l=a.stops&&typeof a.stops[0][0]=="object",h=l||!(l||a.property!==void 0),m=a.type||(dn(t)?"exponential":"interval");if(r||t.type==="padding"){const z=r?mi.parse:Da.parse;(a=wr({},a)).stops&&(a.stops=a.stops.map((M=>[M[0],z(M[1])]))),a.default=z(a.default?a.default:t.default)}if(a.colorSpace&&(g=a.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var g;let v,b,A;if(m==="exponential")v=Hs;else if(m==="interval")v=au;else if(m==="categorical"){v=iu,b=Object.create(null);for(const z of a.stops)b[z[0]]=z[1];A=typeof a.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=nu}if(l){const z={},M=[];for(let N=0;N<a.stops.length;N++){const F=a.stops[N],G=F[0].zoom;z[G]===void 0&&(z[G]={zoom:G,type:a.type,property:a.property,default:a.default,stops:[]},M.push(G)),z[G].stops.push([F[0].value,F[1]])}const k=[];for(const N of M)k.push([z[N].zoom,nc(z[N],t)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:ka.interpolationFactor.bind(void 0,B),zoomStops:k.map((N=>N[0])),evaluate:({zoom:N},F)=>Hs({stops:k,base:a.base},t,N).evaluate(N,F)}}if(h){const z=m==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:ka.interpolationFactor.bind(void 0,z),zoomStops:a.stops.map((M=>M[0])),evaluate:({zoom:M})=>v(a,t,M,b,A)}}return{kind:"source",evaluate(z,M){const k=M&&M.properties?M.properties[a.property]:void 0;return k===void 0?Gs(a.default,t.default):v(a,t,k,b,A)}}}function Gs(a,t,r){return a!==void 0?a:t!==void 0?t:r!==void 0?r:void 0}function iu(a,t,r,l,h){return Gs(typeof r===h?l[r]:void 0,a.default,t.default)}function au(a,t,r){if(ui(r)!=="number")return Gs(a.default,t.default);const l=a.stops.length;if(l===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[l-1][0])return a.stops[l-1][1];const h=ul(a.stops.map((m=>m[0])),r);return a.stops[h][1]}function Hs(a,t,r){const l=a.base!==void 0?a.base:1;if(ui(r)!=="number")return Gs(a.default,t.default);const h=a.stops.length;if(h===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[h-1][0])return a.stops[h-1][1];const m=ul(a.stops.map((z=>z[0])),r),g=(function(z,M,k,B){const N=B-k,F=z-k;return N===0?0:M===1?F/N:(Math.pow(M,F)-1)/(Math.pow(M,N)-1)})(r,l,a.stops[m][0],a.stops[m+1][0]),v=a.stops[m][1],b=a.stops[m+1][1],A=Qa[t.type]||oh;return typeof v.evaluate=="function"?{evaluate(...z){const M=v.evaluate.apply(void 0,z),k=b.evaluate.apply(void 0,z);if(M!==void 0&&k!==void 0)return A(M,k,g,a.colorSpace)}}:A(v,b,g,a.colorSpace)}function nu(a,t,r){switch(t.type){case"color":r=mi.parse(r);break;case"formatted":r=vn.fromString(r.toString());break;case"resolvedImage":r=xn.fromString(r.toString());break;case"padding":r=Da.parse(r);break;default:ui(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return Gs(r,a.default,t.default)}hn.register(zo,{error:[{kind:"error"},[Dt],(a,[t])=>{throw new xi(t.evaluate(a))}],typeof:[Dt,[Ft],(a,[t])=>R(sa(t.evaluate(a)))],"to-rgba":[L(Xe,4),[Ki],(a,[t])=>{const[r,l,h,m]=t.evaluate(a).rgb;return[255*r,255*l,255*h,m]}],rgb:[Ki,[Xe,Xe,Xe],Wl],rgba:[Ki,[Xe,Xe,Xe,Xe],Wl],has:{type:xt,overloads:[[[Dt],(a,[t])=>eu(t.evaluate(a),a.properties())],[[Dt,or],(a,[t,r])=>eu(t.evaluate(a),r.evaluate(a))]]},get:{type:Ft,overloads:[[[Dt],(a,[t])=>fl(t.evaluate(a),a.properties())],[[Dt,or],(a,[t,r])=>fl(t.evaluate(a),r.evaluate(a))]]},"feature-state":[Ft,[Dt],(a,[t])=>fl(t.evaluate(a),a.featureState||{})],properties:[or,[],a=>a.properties()],"geometry-type":[Dt,[],a=>a.geometryType()],id:[Ft,[],a=>a.id()],zoom:[Xe,[],a=>a.globals.zoom],"heatmap-density":[Xe,[],a=>a.globals.heatmapDensity||0],"line-progress":[Xe,[],a=>a.globals.lineProgress||0],accumulated:[Ft,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Xe,Gr(Xe),(a,t)=>{let r=0;for(const l of t)r+=l.evaluate(a);return r}],"*":[Xe,Gr(Xe),(a,t)=>{let r=1;for(const l of t)r*=l.evaluate(a);return r}],"-":{type:Xe,overloads:[[[Xe,Xe],(a,[t,r])=>t.evaluate(a)-r.evaluate(a)],[[Xe],(a,[t])=>-t.evaluate(a)]]},"/":[Xe,[Xe,Xe],(a,[t,r])=>t.evaluate(a)/r.evaluate(a)],"%":[Xe,[Xe,Xe],(a,[t,r])=>t.evaluate(a)%r.evaluate(a)],ln2:[Xe,[],()=>Math.LN2],pi:[Xe,[],()=>Math.PI],e:[Xe,[],()=>Math.E],"^":[Xe,[Xe,Xe],(a,[t,r])=>Math.pow(t.evaluate(a),r.evaluate(a))],sqrt:[Xe,[Xe],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[Xe,[Xe],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[Xe,[Xe],(a,[t])=>Math.log(t.evaluate(a))],log2:[Xe,[Xe],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[Xe,[Xe],(a,[t])=>Math.sin(t.evaluate(a))],cos:[Xe,[Xe],(a,[t])=>Math.cos(t.evaluate(a))],tan:[Xe,[Xe],(a,[t])=>Math.tan(t.evaluate(a))],asin:[Xe,[Xe],(a,[t])=>Math.asin(t.evaluate(a))],acos:[Xe,[Xe],(a,[t])=>Math.acos(t.evaluate(a))],atan:[Xe,[Xe],(a,[t])=>Math.atan(t.evaluate(a))],min:[Xe,Gr(Xe),(a,t)=>Math.min(...t.map((r=>r.evaluate(a))))],max:[Xe,Gr(Xe),(a,t)=>Math.max(...t.map((r=>r.evaluate(a))))],abs:[Xe,[Xe],(a,[t])=>Math.abs(t.evaluate(a))],round:[Xe,[Xe],(a,[t])=>{const r=t.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[Xe,[Xe],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[Xe,[Xe],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[xt,[Dt,Ft],(a,[t,r])=>a.properties()[t.value]===r.value],"filter-id-==":[xt,[Ft],(a,[t])=>a.id()===t.value],"filter-type-==":[xt,[Dt],(a,[t])=>a.geometryType()===t.value],"filter-<":[xt,[Dt,Ft],(a,[t,r])=>{const l=a.properties()[t.value],h=r.value;return typeof l==typeof h&&l<h}],"filter-id-<":[xt,[Ft],(a,[t])=>{const r=a.id(),l=t.value;return typeof r==typeof l&&r<l}],"filter->":[xt,[Dt,Ft],(a,[t,r])=>{const l=a.properties()[t.value],h=r.value;return typeof l==typeof h&&l>h}],"filter-id->":[xt,[Ft],(a,[t])=>{const r=a.id(),l=t.value;return typeof r==typeof l&&r>l}],"filter-<=":[xt,[Dt,Ft],(a,[t,r])=>{const l=a.properties()[t.value],h=r.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[xt,[Ft],(a,[t])=>{const r=a.id(),l=t.value;return typeof r==typeof l&&r<=l}],"filter->=":[xt,[Dt,Ft],(a,[t,r])=>{const l=a.properties()[t.value],h=r.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[xt,[Ft],(a,[t])=>{const r=a.id(),l=t.value;return typeof r==typeof l&&r>=l}],"filter-has":[xt,[Ft],(a,[t])=>t.value in a.properties()],"filter-has-id":[xt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[xt,[L(Dt)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[xt,[L(Ft)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[xt,[Dt,L(Ft)],(a,[t,r])=>r.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[xt,[Dt,L(Ft)],(a,[t,r])=>(function(l,h,m,g){for(;m<=g;){const v=m+g>>1;if(h[v]===l)return!0;h[v]>l?g=v-1:m=v+1}return!1})(a.properties()[t.value],r.value,0,r.value.length-1)],all:{type:xt,overloads:[[[xt,xt],(a,[t,r])=>t.evaluate(a)&&r.evaluate(a)],[Gr(xt),(a,t)=>{for(const r of t)if(!r.evaluate(a))return!1;return!0}]]},any:{type:xt,overloads:[[[xt,xt],(a,[t,r])=>t.evaluate(a)||r.evaluate(a)],[Gr(xt),(a,t)=>{for(const r of t)if(r.evaluate(a))return!0;return!1}]]},"!":[xt,[xt],(a,[t])=>!t.evaluate(a)],"is-supported-script":[xt,[Dt],(a,[t])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(t.evaluate(a))}],upcase:[Dt,[Dt],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[Dt,[Dt],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[Dt,Gr(Ft),(a,t)=>t.map((r=>cs(r.evaluate(a)))).join("")],"resolved-locale":[Dt,[Tr],(a,[t])=>t.evaluate(a).resolvedLocale()]});class ms{constructor(t,r){var l;this.expression=t,this._warningHistory={},this._evaluator=new Ul,this._defaultValue=r?(l=r).type==="color"&&ml(l.default)?new mi(0,0,0,0):l.type==="color"?mi.parse(l.default)||null:l.type==="padding"?Da.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Un.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,l,h,m,g){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=l,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,r,l,h,m,g){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new xi(`Expected value to be one of ${Object.keys(this._enumValues).map((b=>JSON.stringify(b))).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Io(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in zo}function Xs(a,t){const r=new Oa(zo,Eo,[],t?(function(h){const m={color:Ki,string:Dt,number:Xe,enum:Dt,boolean:xt,formatted:jn,padding:lr,resolvedImage:In,variableAnchorOffsetCollection:$};return h.type==="array"?L(m[h.value]||Ft,h.length):m[h.type]})(t):void 0),l=r.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?tu(new ms(l,t)):Co(r.errors)}class qn{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Zs(r.expression)}evaluateWithoutErrorHandling(t,r,l,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,h,m,g)}evaluate(t,r,l,h,m,g){return this._styleExpression.evaluate(t,r,l,h,m,g)}}class hr{constructor(t,r,l,h){this.kind=t,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Zs(r.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,r,l,h,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,h,m,g)}evaluate(t,r,l,h,m,g){return this._styleExpression.evaluate(t,r,l,h,m,g)}interpolationFactor(t,r,l){return this.interpolationType?ka.interpolationFactor(this.interpolationType,t,r,l):0}}function gl(a,t){const r=Xs(a,t);if(r.result==="error")return r;const l=r.value.expression,h=Mo(l);if(!h&&!Do(t))return Co([new Ja("","data expressions not supported")]);const m=pl(l,["zoom"]);if(!m&&!sh(t))return Co([new Ja("","zoom expressions not supported")]);const g=dr(l);return g||m?g instanceof Ja?Co([g]):g instanceof ka&&!dn(t)?Co([new Ja("",'"interpolate" expressions cannot be used with this property')]):tu(g?new hr(h?"camera":"composite",r.value,g.labels,g instanceof ka?g.interpolation:void 0):new qn(h?"constant":"source",r.value)):Co([new Ja("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $s{constructor(t,r){this._parameters=t,this._specification=r,wr(this,nc(this._parameters,this._specification))}static deserialize(t){return new $s(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function dr(a){let t=null;if(a instanceof zr)t=dr(a.result);else if(a instanceof cl){for(const r of a.args)if(t=dr(r),t)break}else(a instanceof Ls||a instanceof ka)&&a.input instanceof hn&&a.input.name==="zoom"&&(t=a);return t instanceof Ja||a.eachChild((r=>{const l=dr(r);l instanceof Ja?t=l:!t&&l?t=new Ja("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new Ja("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function yl(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!yl(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const _l={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ru(a){if(a==null)return{filter:()=>!0,needGeometry:!1};yl(a)||(a=su(a));const t=Xs(a,_l);if(t.result==="error")throw new Error(t.value.map((r=>`${r.key}: ${r.message}`)).join(", "));return{filter:(r,l,h)=>t.value.evaluate(r,l,{},h),needGeometry:lh(a)}}function Qh(a,t){return a<t?-1:a>t?1:0}function lh(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(lh(a[t]))return!0;return!1}function su(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?ou(a[1],a[2],"=="):t==="!="?Ji(ou(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ou(a[1],a[2],t):t==="any"?(r=a.slice(1),["any"].concat(r.map(su))):t==="all"?["all"].concat(a.slice(1).map(su)):t==="none"?["all"].concat(a.slice(1).map(su).map(Ji)):t==="in"?ko(a[1],a.slice(2)):t==="!in"?Ji(ko(a[1],a.slice(2))):t==="has"?Ys(a[1]):t!=="!has"||Ji(Ys(a[1]));var r}function ou(a,t,r){switch(a){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,a,t]}}function ko(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((r=>typeof r!=typeof t[0]))?["filter-in-large",a,["literal",t.sort(Qh)]]:["filter-in-small",a,["literal",t]]}}function Ys(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ji(a){return["!",a]}function Cr(a){const t=typeof a;if(t==="number"||t==="boolean"||t==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let h="[";for(const m of a)h+=`${Cr(m)},`;return`${h}]`}const r=Object.keys(a).sort();let l="{";for(let h=0;h<r.length;h++)l+=`${JSON.stringify(r[h])}:${Cr(a[r[h]])},`;return`${l}}`}function kn(a){let t="";for(const r of Cs)t+=`/${Cr(a[r])}`;return t}function Ks(a){const t=a.value;return t?[new je(a.key,t,"constants have been deprecated as of v8")]:[]}function ia(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function bn(a){if(Array.isArray(a))return a.map(bn);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const r in a)t[r]=bn(a[r]);return t}return ia(a)}function tn(a){const t=a.key,r=a.value,l=a.valueSpec||{},h=a.objectElementValidators||{},m=a.style,g=a.styleSpec,v=a.validateSpec;let b=[];const A=ui(r);if(A!=="object")return[new je(t,r,`object expected, ${A} found`)];for(const z in r){const M=z.split(".")[0],k=l[M]||l["*"];let B;if(h[M])B=h[M];else if(l[M])B=v;else if(h["*"])B=h["*"];else{if(!l["*"]){b.push(new je(t,r[z],`unknown property "${z}"`));continue}B=v}b=b.concat(B({key:(t&&`${t}.`)+z,value:r[z],valueSpec:k,style:m,styleSpec:g,object:r,objectKey:z,validateSpec:v},r))}for(const z in l)h[z]||l[z].required&&l[z].default===void 0&&r[z]===void 0&&b.push(new je(t,r,`missing required property "${z}"`));return b}function Js(a){const t=a.value,r=a.valueSpec,l=a.style,h=a.styleSpec,m=a.key,g=a.arrayElementValidator||a.validateSpec;if(ui(t)!=="array")return[new je(m,t,`array expected, ${ui(t)} found`)];if(r.length&&t.length!==r.length)return[new je(m,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new je(m,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let v={type:r.value,values:r.values};h.$version<7&&(v.function=r.function),ui(r.value)==="object"&&(v=r.value);let b=[];for(let A=0;A<t.length;A++)b=b.concat(g({array:t,arrayIndex:A,value:t[A],valueSpec:v,validateSpec:a.validateSpec,style:l,styleSpec:h,key:`${m}[${A}]`}));return b}function Hr(a){const t=a.key,r=a.value,l=a.valueSpec;let h=ui(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new je(t,r,`number expected, ${h} found`)]:"minimum"in l&&r<l.minimum?[new je(t,r,`${r} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&r>l.maximum?[new je(t,r,`${r} is greater than the maximum value ${l.maximum}`)]:[]}function vl(a){const t=a.valueSpec,r=ia(a.value.type);let l,h,m,g={};const v=r!=="categorical"&&a.value.property===void 0,b=!v,A=ui(a.value.stops)==="array"&&ui(a.value.stops[0])==="array"&&ui(a.value.stops[0][0])==="object",z=tn({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(B){if(r==="identity")return[new je(B.key,B.value,'identity function may not have a "stops" property')];let N=[];const F=B.value;return N=N.concat(Js({key:B.key,value:F,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:M})),ui(F)==="array"&&F.length===0&&N.push(new je(B.key,F,"array must have at least one stop")),N},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:t,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return r==="identity"&&v&&z.push(new je(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||z.push(new je(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!dn(a.valueSpec)&&z.push(new je(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(b&&!Do(a.valueSpec)?z.push(new je(a.key,a.value,"property functions not supported")):v&&!sh(a.valueSpec)&&z.push(new je(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!A||a.value.property!==void 0||z.push(new je(a.key,a.value,'"property" property is required')),z;function M(B){let N=[];const F=B.value,G=B.key;if(ui(F)!=="array")return[new je(G,F,`array expected, ${ui(F)} found`)];if(F.length!==2)return[new je(G,F,`array length 2 expected, length ${F.length} found`)];if(A){if(ui(F[0])!=="object")return[new je(G,F,`object expected, ${ui(F[0])} found`)];if(F[0].zoom===void 0)return[new je(G,F,"object stop key must have zoom")];if(F[0].value===void 0)return[new je(G,F,"object stop key must have value")];if(m&&m>ia(F[0].zoom))return[new je(G,F[0].zoom,"stop zoom values must appear in ascending order")];ia(F[0].zoom)!==m&&(m=ia(F[0].zoom),h=void 0,g={}),N=N.concat(tn({key:`${G}[0]`,value:F[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Hr,value:k}}))}else N=N.concat(k({key:`${G}[0]`,value:F[0],validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},F));return Io(bn(F[1]))?N.concat([new je(`${G}[1]`,F[1],"expressions are not allowed in function stops.")]):N.concat(B.validateSpec({key:`${G}[1]`,value:F[1],valueSpec:t,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function k(B,N){const F=ui(B.value),G=ia(B.value),Y=B.value!==null?B.value:N;if(l){if(F!==l)return[new je(B.key,Y,`${F} stop domain type must match previous stop domain type ${l}`)]}else l=F;if(F!=="number"&&F!=="string"&&F!=="boolean")return[new je(B.key,Y,"stop domain value must be a number, string, or boolean")];if(F!=="number"&&r!=="categorical"){let he=`number expected, ${F} found`;return Do(t)&&r===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new je(B.key,Y,he)]}return r!=="categorical"||F!=="number"||isFinite(G)&&Math.floor(G)===G?r!=="categorical"&&F==="number"&&h!==void 0&&G<h?[new je(B.key,Y,"stop domain values must appear in ascending order")]:(h=G,r==="categorical"&&G in g?[new je(B.key,Y,"stop domain values must be unique")]:(g[G]=!0,[])):[new je(B.key,Y,`integer expected, found ${G}`)]}}function Xr(a){const t=(a.expressionContext==="property"?gl:Xs)(bn(a.value),a.valueSpec);if(t.result==="error")return t.value.map((l=>new je(`${a.key}${l.key}`,a.value,l.message)));const r=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new je(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Zs(r))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Zs(r))return[new je(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!pl(r,["zoom","feature-state"]))return[new je(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Mo(r))return[new je(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function wn(a){const t=a.key,r=a.value,l=a.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(ia(r))===-1&&h.push(new je(t,r,`expected one of [${l.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(l.values).indexOf(ia(r))===-1&&h.push(new je(t,r,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function rc(a){return yl(bn(a.value))?Xr(wr({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):an(a)}function an(a){const t=a.value,r=a.key;if(ui(t)!=="array")return[new je(r,t,`array expected, ${ui(t)} found`)];const l=a.styleSpec;let h,m=[];if(t.length<1)return[new je(r,t,"filter array must have at least 1 element")];switch(m=m.concat(wn({key:`${r}[0]`,value:t[0],valueSpec:l.filter_operator,style:a.style,styleSpec:a.styleSpec})),ia(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ia(t[1])==="$type"&&m.push(new je(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new je(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=ui(t[1]),h!=="string"&&m.push(new je(`${r}[1]`,t[1],`string expected, ${h} found`)));for(let g=2;g<t.length;g++)h=ui(t[g]),ia(t[1])==="$type"?m=m.concat(wn({key:`${r}[${g}]`,value:t[g],valueSpec:l.geometry_type,style:a.style,styleSpec:a.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new je(`${r}[${g}]`,t[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)m=m.concat(an({key:`${r}[${g}]`,value:t[g],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":h=ui(t[1]),t.length!==2?m.push(new je(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new je(`${r}[1]`,t[1],`string expected, ${h} found`))}return m}function xl(a,t){const r=a.key,l=a.validateSpec,h=a.style,m=a.styleSpec,g=a.value,v=a.objectKey,b=m[`${t}_${a.layerType}`];if(!b)return[];const A=v.match(/^(.*)-transition$/);if(t==="paint"&&A&&b[A[1]]&&b[A[1]].transition)return l({key:r,value:g,valueSpec:m.transition,style:h,styleSpec:m});const z=a.valueSpec||b[v];if(!z)return[new je(r,g,`unknown property "${v}"`)];let M;if(ui(g)==="string"&&Do(z)&&!z.tokens&&(M=/^{([^}]+)}$/.exec(g)))return[new je(r,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const k=[];return a.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&k.push(new je(r,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&ml(bn(g))&&ia(g.type)==="identity"&&k.push(new je(r,g,'"text-font" does not support identity functions'))),k.concat(l({key:a.key,value:g,valueSpec:z,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:v}))}function Zn(a){return xl(a,"paint")}function lu(a){return xl(a,"layout")}function Ro(a){let t=[];const r=a.value,l=a.key,h=a.style,m=a.styleSpec;r.type||r.ref||t.push(new je(l,r,'either "type" or "ref" is required'));let g=ia(r.type);const v=ia(r.ref);if(r.id){const b=ia(r.id);for(let A=0;A<a.arrayIndex;A++){const z=h.layers[A];ia(z.id)===b&&t.push(new je(l,r.id,`duplicate layer id "${r.id}", previously used at line ${z.id.__line__}`))}}if("ref"in r){let b;["type","source","source-layer","filter","layout"].forEach((A=>{A in r&&t.push(new je(l,r[A],`"${A}" is prohibited for ref layers`))})),h.layers.forEach((A=>{ia(A.id)===v&&(b=A)})),b?b.ref?t.push(new je(l,r.ref,"ref cannot reference another ref layer")):g=ia(b.type):t.push(new je(l,r.ref,`ref layer "${v}" not found`))}else if(g!=="background")if(r.source){const b=h.sources&&h.sources[r.source],A=b&&ia(b.type);b?A==="vector"&&g==="raster"?t.push(new je(l,r.source,`layer "${r.id}" requires a raster source`)):A!=="raster-dem"&&g==="hillshade"?t.push(new je(l,r.source,`layer "${r.id}" requires a raster-dem source`)):A==="raster"&&g!=="raster"?t.push(new je(l,r.source,`layer "${r.id}" requires a vector source`)):A!=="vector"||r["source-layer"]?A==="raster-dem"&&g!=="hillshade"?t.push(new je(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!r.paint||!r.paint["line-gradient"]||A==="geojson"&&b.lineMetrics||t.push(new je(l,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new je(l,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new je(l,r.source,`source "${r.source}" not found`))}else t.push(new je(l,r,'missing required property "source"'));return t=t.concat(tn({key:l,value:r,valueSpec:m.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${l}.type`,value:r.type,valueSpec:m.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:r,objectKey:"type"}),filter:rc,layout:b=>tn({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":A=>lu(wr({layerType:g},A))}}),paint:b=>tn({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":A=>Zn(wr({layerType:g},A))}})}})),t}function Rn(a){const t=a.value,r=a.key,l=ui(t);return l!=="string"?[new je(r,t,`string expected, ${l} found`)]:[]}const Lo={promoteId:function({key:a,value:t}){if(ui(t)==="string")return Rn({key:a,value:t});{const r=[];for(const l in t)r.push(...Rn({key:`${a}.${l}`,value:t[l]}));return r}}};function Bo(a){const t=a.value,r=a.key,l=a.styleSpec,h=a.style,m=a.validateSpec;if(!t.type)return[new je(r,t,'"type" is required')];const g=ia(t.type);let v;switch(g){case"vector":case"raster":return v=tn({key:r,value:t,valueSpec:l[`source_${g.replace("-","_")}`],style:a.style,styleSpec:l,objectElementValidators:Lo,validateSpec:m}),v;case"raster-dem":return v=(function(b){var A;const z=(A=b.sourceName)!==null&&A!==void 0?A:"",M=b.value,k=b.styleSpec,B=k.source_raster_dem,N=b.style;let F=[];const G=ui(M);if(M===void 0)return F;if(G!=="object")return F.push(new je("source_raster_dem",M,`object expected, ${G} found`)),F;const Y=ia(M.encoding)==="custom",he=["redFactor","greenFactor","blueFactor","baseShift"],ae=b.value.encoding?`"${b.value.encoding}"`:"Default";for(const le in M)!Y&&he.includes(le)?F.push(new je(le,M[le],`In "${z}": "${le}" is only valid when "encoding" is set to "custom". ${ae} encoding found`)):B[le]?F=F.concat(b.validateSpec({key:le,value:M[le],valueSpec:B[le],validateSpec:b.validateSpec,style:N,styleSpec:k})):F.push(new je(le,M[le],`unknown property "${le}"`));return F})({sourceName:r,value:t,style:a.style,styleSpec:l,validateSpec:m}),v;case"geojson":if(v=tn({key:r,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,validateSpec:m,objectElementValidators:Lo}),t.cluster)for(const b in t.clusterProperties){const[A,z]=t.clusterProperties[b],M=typeof A=="string"?[A,["accumulated"],["get",b]]:A;v.push(...Xr({key:`${r}.${b}.map`,value:z,expressionContext:"cluster-map"})),v.push(...Xr({key:`${r}.${b}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return v;case"video":return tn({key:r,value:t,valueSpec:l.source_video,style:h,validateSpec:m,styleSpec:l});case"image":return tn({key:r,value:t,valueSpec:l.source_image,style:h,validateSpec:m,styleSpec:l});case"canvas":return[new je(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return wn({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function bl(a){const t=a.value,r=a.styleSpec,l=r.light,h=a.style;let m=[];const g=ui(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new je("light",t,`object expected, ${g} found`)]),m;for(const v in t){const b=v.match(/^(.*)-transition$/);m=m.concat(b&&l[b[1]]&&l[b[1]].transition?a.validateSpec({key:v,value:t[v],valueSpec:r.transition,validateSpec:a.validateSpec,style:h,styleSpec:r}):l[v]?a.validateSpec({key:v,value:t[v],valueSpec:l[v],validateSpec:a.validateSpec,style:h,styleSpec:r}):[new je(v,t[v],`unknown property "${v}"`)])}return m}function uu(a){const t=a.value,r=a.styleSpec,l=r.sky,h=a.style,m=ui(t);if(t===void 0)return[];if(m!=="object")return[new je("sky",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(l[v]?a.validateSpec({key:v,value:t[v],valueSpec:l[v],style:h,styleSpec:r}):[new je(v,t[v],`unknown property "${v}"`)]);return g}function Sn(a){const t=a.value,r=a.styleSpec,l=r.terrain,h=a.style;let m=[];const g=ui(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new je("terrain",t,`object expected, ${g} found`)]),m;for(const v in t)m=m.concat(l[v]?a.validateSpec({key:v,value:t[v],valueSpec:l[v],validateSpec:a.validateSpec,style:h,styleSpec:r}):[new je(v,t[v],`unknown property "${v}"`)]);return m}function gs(a){let t=[];const r=a.value,l=a.key;if(Array.isArray(r)){const h=[],m=[];for(const g in r)r[g].id&&h.includes(r[g].id)&&t.push(new je(l,r,`all the sprites' ids must be unique, but ${r[g].id} is duplicated`)),h.push(r[g].id),r[g].url&&m.includes(r[g].url)&&t.push(new je(l,r,`all the sprites' URLs must be unique, but ${r[g].url} is duplicated`)),m.push(r[g].url),t=t.concat(tn({key:`${l}[${g}]`,value:r[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return t}return Rn({key:l,value:r})}const $r={"*":()=>[],array:Js,boolean:function(a){const t=a.value,r=a.key,l=ui(t);return l!=="boolean"?[new je(r,t,`boolean expected, ${l} found`)]:[]},number:Hr,color:function(a){const t=a.key,r=a.value,l=ui(r);return l!=="string"?[new je(t,r,`color expected, ${l} found`)]:mi.parse(String(r))?[]:[new je(t,r,`color expected, "${r}" found`)]},constants:Ks,enum:wn,filter:rc,function:vl,layer:Ro,object:tn,source:Bo,light:bl,sky:uu,terrain:Sn,projection:function(a){const t=a.value,r=a.styleSpec,l=r.projection,h=a.style,m=ui(t);if(t===void 0)return[];if(m!=="object")return[new je("projection",t,`object expected, ${m} found`)];let g=[];for(const v in t)g=g.concat(l[v]?a.validateSpec({key:v,value:t[v],valueSpec:l[v],style:h,styleSpec:r}):[new je(v,t[v],`unknown property "${v}"`)]);return g},string:Rn,formatted:function(a){return Rn(a).length===0?[]:Xr(a)},resolvedImage:function(a){return Rn(a).length===0?[]:Xr(a)},padding:function(a){const t=a.key,r=a.value;if(ui(r)==="array"){if(r.length<1||r.length>4)return[new je(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const l={type:"number"};let h=[];for(let m=0;m<r.length;m++)h=h.concat(a.validateSpec({key:`${t}[${m}]`,value:r[m],validateSpec:a.validateSpec,valueSpec:l}));return h}return Hr({key:t,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const t=a.key,r=a.value,l=ui(r),h=a.styleSpec;if(l!=="array"||r.length<1||r.length%2!=0)return[new je(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let g=0;g<r.length;g+=2)m=m.concat(wn({key:`${t}[${g}]`,value:r[g],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(Js({key:`${t}[${g+1}]`,value:r[g+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:h}));return m},sprite:gs};function ys(a){const t=a.value,r=a.valueSpec,l=a.styleSpec;return a.validateSpec=ys,r.expression&&ml(ia(t))?vl(a):r.expression&&Io(bn(t))?Xr(a):r.type&&$r[r.type]?$r[r.type](a):tn(wr({},a,{valueSpec:r.type?l[r.type]:r}))}function Po(a){const t=a.value,r=a.key,l=Rn(a);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new je(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new je(r,t,'"glyphs" url must include a "{range}" token'))),l}function la(a,t=xe){let r=[];return r=r.concat(ys({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,validateSpec:ys,objectElementValidators:{glyphs:Po,"*":()=>[]}})),a.constants&&(r=r.concat(Ks({key:"constants",value:a.constants}))),Dr(r)}function xa(a){return function(t){return a({...t,validateSpec:ys})}}function Dr(a){return[].concat(a).sort(((t,r)=>t.line-r.line))}function Ea(a){return function(...t){return Dr(a.apply(this,t))}}la.source=Ea(xa(Bo)),la.sprite=Ea(xa(gs)),la.glyphs=Ea(xa(Po)),la.light=Ea(xa(bl)),la.sky=Ea(xa(uu)),la.terrain=Ea(xa(Sn)),la.layer=Ea(xa(Ro)),la.filter=Ea(xa(rc)),la.paintProperty=Ea(xa(Zn)),la.layoutProperty=Ea(xa(lu));const nn=la,Yr=nn.light,uh=nn.sky,cu=nn.paintProperty,hu=nn.layoutProperty;function du(a,t){let r=!1;if(t&&t.length)for(const l of t)a.fire(new _n(new Error(l.message))),r=!0;return r}class ma{constructor(t,r,l){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(r=g[1])+2*(l=g[2]);for(let b=0;b<this.d*this.d;b++){const A=g[3+b],z=g[3+b+1];h.push(A===z?null:g.subarray(A,z))}const v=g[3+h.length+1];this.keys=g.subarray(g[3+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=r+2*l;for(let g=0;g<this.d*this.d;g++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=l,this.scale=r/t,this.uid=0;const m=l/r*t;this.min=-m,this.max=t+m}insert(t,r,l,h,m){this._forEachCell(r,l,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,l,h,m,g){this.cells[m].push(g)}query(t,r,l,h,m){const g=this.min,v=this.max;if(t<=g&&r<=g&&v<=l&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(t,r,l,h,this._queryCell,b,{},m),b}}_queryCell(t,r,l,h,m,g,v,b){const A=this.cells[m];if(A!==null){const z=this.keys,M=this.bboxes;for(let k=0;k<A.length;k++){const B=A[k];if(v[B]===void 0){const N=4*B;(b?b(M[N+0],M[N+1],M[N+2],M[N+3]):t<=M[N+2]&&r<=M[N+3]&&l>=M[N+0]&&h>=M[N+1])?(v[B]=!0,g.push(z[B])):v[B]=!1}}}}_forEachCell(t,r,l,h,m,g,v,b){const A=this._convertToCellCoord(t),z=this._convertToCellCoord(r),M=this._convertToCellCoord(l),k=this._convertToCellCoord(h);for(let B=A;B<=M;B++)for(let N=z;N<=k;N++){const F=this.d*N+B;if((!b||b(this._convertFromCellCoord(B),this._convertFromCellCoord(N),this._convertFromCellCoord(B+1),this._convertFromCellCoord(N+1)))&&m.call(this,t,r,l,h,F,g,v,b))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let l=0;for(let g=0;g<this.cells.length;g++)l+=this.cells[g].length;const h=new Int32Array(r+l+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=r;for(let g=0;g<t.length;g++){const v=t[g];h[3+g]=m,h.set(v,m),m+=v.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,r){const l=t.toArrayBuffer();return r&&r.push(l),{buffer:l}}static deserialize(t){return new ma(t.buffer)}}const hi={};function Be(a,t,r={}){if(hi[a])throw new Error(`${a} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),hi[a]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}Be("Object",Object),Be("TransferableGridIndex",ma),Be("Color",mi),Be("Error",Error),Be("AJAXError",Ot),Be("ResolvedImage",xn),Be("StylePropertyFunction",$s),Be("StyleExpression",ms,{omit:["_evaluator"]}),Be("ZoomDependentExpression",hr),Be("ZoomConstantExpression",qn),Be("CompoundExpression",hn,{omit:["_evaluate"]});for(const a in zo)zo[a]._classRegistryKey||Be(`Expression_${a}`,zo[a]);function fr(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Tn(a){return a.$name||a.constructor._classRegistryKey}function fu(a){return!(function(t){if(t===null||typeof t!="object")return!1;const r=Tn(t);return!(!r||r==="Object")})(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||fr(a)||He(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function Ln(a,t){if(fu(a))return(fr(a)||He(a))&&t&&t.push(a),ArrayBuffer.isView(a)&&t&&t.push(a.buffer),a instanceof ImageData&&t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const m=[];for(const g of a)m.push(Ln(g,t));return m}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const r=Tn(a);if(!r)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!hi[r])throw new Error(`${r} is not registered.`);const{klass:l}=hi[r],h=l.serialize?l.serialize(a,t):{};if(l.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in a){if(!a.hasOwnProperty(m)||hi[r].omit.indexOf(m)>=0)continue;const g=a[m];h[m]=hi[r].shallow.indexOf(m)>=0?g:Ln(g,t)}a instanceof Error&&(h.message=a.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(h.$name=r),h}function Qs(a){if(fu(a))return a;if(Array.isArray(a))return a.map(Qs);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const t=Tn(a)||"Object";if(!hi[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=hi[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(a);const l=Object.create(r.prototype);for(const h of Object.keys(a)){if(h==="$name")continue;const m=a[h];l[h]=hi[t].shallow.indexOf(h)>=0?m:Qs(m)}return l}class pu{constructor(){this.first=!0}update(t,r){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const $t={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Kr(a){for(const t of a)if(kr(t.charCodeAt(0)))return!0;return!1}function sc(a){for(const t of a)if(!Gn(t.charCodeAt(0)))return!1;return!0}function Ws(a){const t=a.map((r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}})).filter((r=>r));return new RegExp(t.join("|"),"u")}const oc=Ws(["Arab","Dupl","Mong","Ougr","Syrc"]);function Gn(a){return!oc.test(String.fromCodePoint(a))}const Ir=Ws(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function kr(a){return!(a!==746&&a!==747&&(a<4352||!($t["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||$t["CJK Compatibility"](a)||$t["CJK Strokes"](a)||!(!$t["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||$t["Enclosed CJK Letters and Months"](a)||$t["Ideographic Description Characters"](a)||$t.Kanbun(a)||$t.Katakana(a)&&a!==12540||!(!$t["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!$t["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||$t["Vertical Forms"](a)||$t["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Ir.test(String.fromCodePoint(a)))))}function Rr(a){return!(kr(a)||(function(t){return!!($t["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||$t["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||$t["Letterlike Symbols"](t)||$t["Number Forms"](t)||$t["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||$t["Control Pictures"](t)&&t!==9251||$t["Optical Character Recognition"](t)||$t["Enclosed Alphanumerics"](t)||$t["Geometric Shapes"](t)||$t["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||$t["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||$t["CJK Symbols and Punctuation"](t)||$t.Katakana(t)||$t["Private Use Area"](t)||$t["CJK Compatibility Forms"](t)||$t["Small Form Variants"](t)||$t["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(a))}const lc=Ws(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function wl(a){return lc.test(String.fromCodePoint(a))}function Oo(a,t){return!(!t&&wl(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||$t.Khmer(a))}function mu(a){for(const t of a)if(wl(t.charCodeAt(0)))return!0;return!1}const Ra=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Qt{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pu,this.transition={})}isSupportedScript(t){return(function(r,l){for(const h of r)if(!Oo(h.charCodeAt(0),l))return!1;return!0})(t,Ra.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*r}}}class Jr{constructor(t,r){this.property=t,this.value=r,this.expression=(function(l,h){if(ml(l))return new $s(l,h);if(Io(l)){const m=gl(l,h);if(m.result==="error")throw new Error(m.value.map((g=>`${g.key}: ${g.message}`)).join(", "));return m.value}{let m=l;return h.type==="color"&&typeof l=="string"?m=mi.parse(l):h.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(m=Un.parse(l)):m=Da.parse(l),{kind:"constant",evaluate:()=>m}}})(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,l){return this.property.possiblyEvaluate(this,t,r,l)}}class Sl{constructor(t){this.property=t,this.value=new Jr(t,void 0)}transitioned(t,r){return new ch(this.property,this.value,r,ot({},t.transition,this.transition),t.now)}untransitioned(){return new ch(this.property,this.value,null,{},0)}}class gu{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Pt(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Sl(this._values[t].property)),this._values[t].value=new Jr(this._values[t].property,r===null?void 0:Pt(r))}getTransition(t){return Pt(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Sl(this._values[t].property)),this._values[t].transition=Pt(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l);const h=this.getTransition(r);h!==void 0&&(t[`${r}-transition`]=h)}return t}transitioned(t,r){const l=new Tl(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,r._values[h]);return l}untransitioned(){const t=new Tl(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class ch{constructor(t,r,l,h,m){this.property=t,this.value=r,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,r,l){const h=t.now||0,m=this.value.possiblyEvaluate(t,r,l),g=this.prior;if(g){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return g.possiblyEvaluate(t,r,l);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,r,l),m,(function(b){if(b<=0)return 0;if(b>=1)return 1;const A=b*b,z=A*b;return 4*(b<.5?z:3*(b-A)+z-.75)})(v))}}return m}}class Tl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,l){const h=new Qr(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class aa{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Pt(this._values[t].value)}setValue(t,r){this._values[t]=new Jr(this._values[t].property,r===null?void 0:Pt(r))}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l)}return t}possiblyEvaluate(t,r,l){const h=new Qr(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,l);return h}}class Hn{constructor(t,r,l){this.property=t,this.value=r,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,l,h){return this.property.evaluate(this.value,this.parameters,t,r,l,h)}}class Qr{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class st{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,l){const h=Qa[this.specification.type];return h?h(t,r,l):t}}class wt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,l,h){return new Hn(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},l,h)}:t.expression,r)}interpolate(t,r,l){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Hn(this,{kind:"constant",value:void 0},t.parameters);const h=Qa[this.specification.type];if(h){const m=h(t.value.value,r.value.value,l);return new Hn(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,r,l,h,m,g){return t.kind==="constant"?t.value:t.evaluate(r,l,h,m,g)}}class Wr extends wt{possiblyEvaluate(t,r,l,h){if(t.value===void 0)return new Hn(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},l,h),g=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(g,g,g,r);return new Hn(this,{kind:"constant",value:v},r)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Hn(this,{kind:"constant",value:m},r)}return new Hn(this,t.expression,r)}evaluate(t,r,l,h,m,g){if(t.kind==="source"){const v=t.evaluate(r,l,h,m,g);return this._calculate(v,v,v,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},l,h),t.evaluate({zoom:Math.floor(r.zoom)},l,h),t.evaluate({zoom:Math.floor(r.zoom)+1},l,h),r):t.value}_calculate(t,r,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:l,to:r}}interpolate(t){return t}}class es{constructor(t){this.specification=t}possiblyEvaluate(t,r,l,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},l,h);return this._calculate(m,m,m,r)}return this._calculate(t.expression.evaluate(new Qt(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Qt(Math.floor(r.zoom),r)),t.expression.evaluate(new Qt(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:l,to:r}}interpolate(t){return t}}class uc{constructor(t){this.specification=t}possiblyEvaluate(t,r,l,h){return!!t.expression.evaluate(r,null,{},l,h)}interpolate(){return!1}}class p{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const l=t[r];l.specification.overridable&&this.overridableProperties.push(r);const h=this.defaultPropertyValues[r]=new Jr(l,void 0),m=this.defaultTransitionablePropertyValues[r]=new Sl(l);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}}}Be("DataDrivenProperty",wt),Be("DataConstantProperty",st),Be("CrossFadedDataDrivenProperty",Wr),Be("CrossFadedProperty",es),Be("ColorRampProperty",uc);const e="-transition";class s extends os{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new aa(r.layout)),r.paint)){this._transitionablePaint=new gu(r.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qr(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,l={}){r!=null&&this._validate(hu,`layers.${this.id}.layout.${t}`,t,r,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(e)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,l={}){if(r!=null&&this._validate(cu,`layers.${this.id}.paint.${t}`,t,r,l))return!1;if(t.endsWith(e))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",g=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const b=this._transitionablePaint._values[t].value;return b.isDataDriven()||g||m||this._handleOverridablePaintPropertyUpdate(t,v,b)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Si(t,((r,l)=>!(r===void 0||l==="layout"&&!Object.keys(r).length||l==="paint"&&!Object.keys(r).length)))}_validate(t,r,l,h,m={}){return(!m||m.validate!==!1)&&du(this,t.call(nn,{key:r,layerType:this.type,objectKey:l,value:h,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof Hn&&Do(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const u={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class c{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class f{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function x(a,t=1){let r=0,l=0;return{members:a.map((h=>{const m=u[h.type].BYTES_PER_ELEMENT,g=r=S(r,Math.max(t,m)),v=h.components||1;return l=Math.max(l,m),r+=m*v,{name:h.name,type:h.type,components:v,offset:g}})),size:S(r,Math.max(l,t)),alignment:t}}function S(a,t){return Math.ceil(a/t)*t}class T extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const h=2*t;return this.int16[h+0]=r,this.int16[h+1]=l,t}}T.prototype.bytesPerElement=4,Be("StructArrayLayout2i4",T);class E extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l)}emplace(t,r,l,h){const m=3*t;return this.int16[m+0]=r,this.int16[m+1]=l,this.int16[m+2]=h,t}}E.prototype.bytesPerElement=6,Be("StructArrayLayout3i6",E);class D extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,l,h)}emplace(t,r,l,h,m){const g=4*t;return this.int16[g+0]=r,this.int16[g+1]=l,this.int16[g+2]=h,this.int16[g+3]=m,t}}D.prototype.bytesPerElement=8,Be("StructArrayLayout4i8",D);class I extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,h,m,g)}emplace(t,r,l,h,m,g,v){const b=6*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.int16[b+2]=h,this.int16[b+3]=m,this.int16[b+4]=g,this.int16[b+5]=v,t}}I.prototype.bytesPerElement=12,Be("StructArrayLayout2i4i12",I);class P extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,h,m,g)}emplace(t,r,l,h,m,g,v){const b=4*t,A=8*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.uint8[A+4]=h,this.uint8[A+5]=m,this.uint8[A+6]=g,this.uint8[A+7]=v,t}}P.prototype.bytesPerElement=8,Be("StructArrayLayout2i4ub8",P);class j extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const h=2*t;return this.float32[h+0]=r,this.float32[h+1]=l,t}}j.prototype.bytesPerElement=8,Be("StructArrayLayout2f8",j);class q extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g,v,b,A,z){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,l,h,m,g,v,b,A,z)}emplace(t,r,l,h,m,g,v,b,A,z,M){const k=10*t;return this.uint16[k+0]=r,this.uint16[k+1]=l,this.uint16[k+2]=h,this.uint16[k+3]=m,this.uint16[k+4]=g,this.uint16[k+5]=v,this.uint16[k+6]=b,this.uint16[k+7]=A,this.uint16[k+8]=z,this.uint16[k+9]=M,t}}q.prototype.bytesPerElement=20,Be("StructArrayLayout10ui20",q);class X extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g,v,b,A,z,M,k){const B=this.length;return this.resize(B+1),this.emplace(B,t,r,l,h,m,g,v,b,A,z,M,k)}emplace(t,r,l,h,m,g,v,b,A,z,M,k,B){const N=12*t;return this.int16[N+0]=r,this.int16[N+1]=l,this.int16[N+2]=h,this.int16[N+3]=m,this.uint16[N+4]=g,this.uint16[N+5]=v,this.uint16[N+6]=b,this.uint16[N+7]=A,this.int16[N+8]=z,this.int16[N+9]=M,this.int16[N+10]=k,this.int16[N+11]=B,t}}X.prototype.bytesPerElement=24,Be("StructArrayLayout4i4ui4i24",X);class K extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l)}emplace(t,r,l,h){const m=3*t;return this.float32[m+0]=r,this.float32[m+1]=l,this.float32[m+2]=h,t}}K.prototype.bytesPerElement=12,Be("StructArrayLayout3f12",K);class J extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}J.prototype.bytesPerElement=4,Be("StructArrayLayout1ul4",J);class ee extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g,v,b,A){const z=this.length;return this.resize(z+1),this.emplace(z,t,r,l,h,m,g,v,b,A)}emplace(t,r,l,h,m,g,v,b,A,z){const M=10*t,k=5*t;return this.int16[M+0]=r,this.int16[M+1]=l,this.int16[M+2]=h,this.int16[M+3]=m,this.int16[M+4]=g,this.int16[M+5]=v,this.uint32[k+3]=b,this.uint16[M+8]=A,this.uint16[M+9]=z,t}}ee.prototype.bytesPerElement=20,Be("StructArrayLayout6i1ul2ui20",ee);class Z extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,h,m,g)}emplace(t,r,l,h,m,g,v){const b=6*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.int16[b+2]=h,this.int16[b+3]=m,this.int16[b+4]=g,this.int16[b+5]=v,t}}Z.prototype.bytesPerElement=12,Be("StructArrayLayout2i2i2i12",Z);class ne extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,l,h,m)}emplace(t,r,l,h,m,g){const v=4*t,b=8*t;return this.float32[v+0]=r,this.float32[v+1]=l,this.float32[v+2]=h,this.int16[b+6]=m,this.int16[b+7]=g,t}}ne.prototype.bytesPerElement=16,Be("StructArrayLayout2f1f2i16",ne);class oe extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,h,m,g)}emplace(t,r,l,h,m,g,v){const b=16*t,A=4*t,z=8*t;return this.uint8[b+0]=r,this.uint8[b+1]=l,this.float32[A+1]=h,this.float32[A+2]=m,this.int16[z+6]=g,this.int16[z+7]=v,t}}oe.prototype.bytesPerElement=16,Be("StructArrayLayout2ub2f2i16",oe);class fe extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l)}emplace(t,r,l,h){const m=3*t;return this.uint16[m+0]=r,this.uint16[m+1]=l,this.uint16[m+2]=h,t}}fe.prototype.bytesPerElement=6,Be("StructArrayLayout3ui6",fe);class De extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g,v,b,A,z,M,k,B,N,F,G,Y){const he=this.length;return this.resize(he+1),this.emplace(he,t,r,l,h,m,g,v,b,A,z,M,k,B,N,F,G,Y)}emplace(t,r,l,h,m,g,v,b,A,z,M,k,B,N,F,G,Y,he){const ae=24*t,le=12*t,Se=48*t;return this.int16[ae+0]=r,this.int16[ae+1]=l,this.uint16[ae+2]=h,this.uint16[ae+3]=m,this.uint32[le+2]=g,this.uint32[le+3]=v,this.uint32[le+4]=b,this.uint16[ae+10]=A,this.uint16[ae+11]=z,this.uint16[ae+12]=M,this.float32[le+7]=k,this.float32[le+8]=B,this.uint8[Se+36]=N,this.uint8[Se+37]=F,this.uint8[Se+38]=G,this.uint32[le+10]=Y,this.int16[ae+22]=he,t}}De.prototype.bytesPerElement=48,Be("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",De);class Oe extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,h,m,g,v,b,A,z,M,k,B,N,F,G,Y,he,ae,le,Se,Pe,Qe,St,Ve,Ke,ct,rt){const tt=this.length;return this.resize(tt+1),this.emplace(tt,t,r,l,h,m,g,v,b,A,z,M,k,B,N,F,G,Y,he,ae,le,Se,Pe,Qe,St,Ve,Ke,ct,rt)}emplace(t,r,l,h,m,g,v,b,A,z,M,k,B,N,F,G,Y,he,ae,le,Se,Pe,Qe,St,Ve,Ke,ct,rt,tt){const Me=32*t,at=16*t;return this.int16[Me+0]=r,this.int16[Me+1]=l,this.int16[Me+2]=h,this.int16[Me+3]=m,this.int16[Me+4]=g,this.int16[Me+5]=v,this.int16[Me+6]=b,this.int16[Me+7]=A,this.uint16[Me+8]=z,this.uint16[Me+9]=M,this.uint16[Me+10]=k,this.uint16[Me+11]=B,this.uint16[Me+12]=N,this.uint16[Me+13]=F,this.uint16[Me+14]=G,this.uint16[Me+15]=Y,this.uint16[Me+16]=he,this.uint16[Me+17]=ae,this.uint16[Me+18]=le,this.uint16[Me+19]=Se,this.uint16[Me+20]=Pe,this.uint16[Me+21]=Qe,this.uint16[Me+22]=St,this.uint32[at+12]=Ve,this.float32[at+13]=Ke,this.float32[at+14]=ct,this.uint16[Me+30]=rt,this.uint16[Me+31]=tt,t}}Oe.prototype.bytesPerElement=64,Be("StructArrayLayout8i15ui1ul2f2ui64",Oe);class Ge extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}Ge.prototype.bytesPerElement=4,Be("StructArrayLayout1f4",Ge);class We extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l)}emplace(t,r,l,h){const m=3*t;return this.uint16[6*t+0]=r,this.float32[m+1]=l,this.float32[m+2]=h,t}}We.prototype.bytesPerElement=12,Be("StructArrayLayout1ui2f12",We);class $e extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l)}emplace(t,r,l,h){const m=4*t;return this.uint32[2*t+0]=r,this.uint16[m+2]=l,this.uint16[m+3]=h,t}}$e.prototype.bytesPerElement=8,Be("StructArrayLayout1ul2ui8",$e);class Fe extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const h=2*t;return this.uint16[h+0]=r,this.uint16[h+1]=l,t}}Fe.prototype.bytesPerElement=4,Be("StructArrayLayout2ui4",Fe);class it extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}it.prototype.bytesPerElement=2,Be("StructArrayLayout1ui2",it);class It extends f{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,l,h)}emplace(t,r,l,h,m){const g=4*t;return this.float32[g+0]=r,this.float32[g+1]=l,this.float32[g+2]=h,this.float32[g+3]=m,t}}It.prototype.bytesPerElement=16,Be("StructArrayLayout4f16",It);class Ye extends c{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new me(this.anchorPointX,this.anchorPointY)}}Ye.prototype.size=20;class Je extends ee{get(t){return new Ye(this,t)}}Be("CollisionBoxArray",Je);class zt extends c{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}zt.prototype.size=48;class Ci extends De{get(t){return new zt(this,t)}}Be("PlacedSymbolArray",Ci);class Gt extends c{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Gt.prototype.size=64;class ii extends Oe{get(t){return new Gt(this,t)}}Be("SymbolInstanceArray",ii);class Ei extends Ge{getoffsetX(t){return this.float32[1*t+0]}}Be("GlyphOffsetArray",Ei);class La extends E{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Be("SymbolLineVertexArray",La);class Xn extends c{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Xn.prototype.size=12;class Pi extends We{get(t){return new Xn(this,t)}}Be("TextAnchorOffsetArray",Pi);class rn extends c{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}rn.prototype.size=8;class Gi extends $e{get(t){return new rn(this,t)}}Be("FeatureIndexArray",Gi);class Hi extends T{}class ga extends T{}class $n extends T{}class eo extends I{}class pr extends P{}class Na extends j{}class bi extends q{}class to extends X{}class mr extends K{}class Rt extends J{}class ri extends Z{}class Xi extends oe{}class An extends fe{}class ya extends Fe{}const _a=x([{name:"a_pos",components:2,type:"Int16"}],4),{members:sn}=_a;class Wt{constructor(t=[]){this.segments=t}prepareSegment(t,r,l,h){let m=this.segments[this.segments.length-1];return t>Wt.MAX_VERTEX_ARRAY_LENGTH&&Ti(`Max vertices per segment is ${Wt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>Wt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:r.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,l,h){return new Wt([{vertexOffset:t,primitiveOffset:r,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}function Yn(a,t){return 256*(a=Ht(Math.floor(a),0,255))+Ht(Math.floor(t),0,255)}Wt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Be("SegmentVector",Wt);const No=x([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var $i={exports:{}},yu={exports:{}};yu.exports=function(a,t){var r,l,h,m,g,v,b,A;for(l=a.length-(r=3&a.length),h=t,g=3432918353,v=461845907,A=0;A<l;)b=255&a.charCodeAt(A)|(255&a.charCodeAt(++A))<<8|(255&a.charCodeAt(++A))<<16|(255&a.charCodeAt(++A))<<24,++A,h=27492+(65535&(m=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(b=0,r){case 3:b^=(255&a.charCodeAt(A+2))<<16;case 2:b^=(255&a.charCodeAt(A+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&a.charCodeAt(A)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return h^=a.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var cc=yu.exports,hc={exports:{}};hc.exports=function(a,t){for(var r,l=a.length,h=t^l,m=0;l>=4;)r=1540483477*(65535&(r=255&a.charCodeAt(m)|(255&a.charCodeAt(++m))<<8|(255&a.charCodeAt(++m))<<16|(255&a.charCodeAt(++m))<<24))+((1540483477*(r>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),l-=4,++m;switch(l){case 3:h^=(255&a.charCodeAt(m+2))<<16;case 2:h^=(255&a.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&a.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var ts=cc,hh=hc.exports;$i.exports=ts,$i.exports.murmur3=ts,$i.exports.murmur2=hh;var Fo=Ue($i.exports);class io{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,l,h){this.ids.push(jo(t)),this.positions.push(r,l,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=jo(t);let l=0,h=this.ids.length-1;for(;l<h;){const g=l+h>>1;this.ids[g]>=r?h=g:l=g+1}const m=[];for(;this.ids[l]===r;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m}static serialize(t,r){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Fa(l,h,0,l.length-1),r&&r.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const r=new io;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function jo(a){const t=+a;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Fo(String(a))}function Fa(a,t,r,l){for(;r<l;){const h=a[r+l>>1];let m=r-1,g=l+1;for(;;){do m++;while(a[m]<h);do g--;while(a[g]>h);if(m>=g)break;Qi(a,m,g),Qi(t,3*m,3*g),Qi(t,3*m+1,3*g+1),Qi(t,3*m+2,3*g+2)}g-r<l-g?(Fa(a,t,r,g),r=g+1):(Fa(a,t,g+1,l),l=g)}}function Qi(a,t,r){const l=a[t];a[t]=a[r],a[r]=l}Be("FeaturePositionMap",io);class _s{constructor(t,r){this.gl=t.gl,this.location=r}}class Uo extends _s{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class dc extends _s{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class dh extends _s{constructor(t,r){super(t,r),this.current=mi.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const ao=new Float32Array(16);function _u(a){return[Yn(255*a.r,255*a.g),Yn(255*a.b,255*a.a)]}class Al{constructor(t,r,l){this.value=t,this.uniformNames=r.map((h=>`u_${h}`)),this.type=l}setUniform(t,r,l){t.set(l.constantOr(this.value))}getBinding(t,r,l){return this.type==="color"?new dh(t,r):new Uo(t,r)}}class Vo{constructor(t,r){this.uniformNames=r.map((l=>`u_${l}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,l,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,r,l){return l.substr(0,9)==="u_pattern"?new dc(t,r):new Uo(t,r)}}class vs{constructor(t,r,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map((m=>({name:`a_${m}`,type:"Float32",components:l==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(t,r,l,h,m){const g=this.paintVertexArray.length,v=this.expression.evaluate(new Qt(0),r,{},h,[],m);this.paintVertexArray.resize(t),this._setPaintValue(g,t,v)}updatePaintArray(t,r,l,h){const m=this.expression.evaluate({zoom:0},l,h);this._setPaintValue(t,r,m)}_setPaintValue(t,r,l){if(this.type==="color"){const h=_u(l);for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lr{constructor(t,r,l,h,m,g){this.expression=t,this.uniformNames=r.map((v=>`u_${v}_t`)),this.type=l,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map((v=>({name:`a_${v}`,type:"Float32",components:l==="color"?4:2,offset:0}))),this.paintVertexArray=new g}populatePaintArray(t,r,l,h,m){const g=this.expression.evaluate(new Qt(this.zoom),r,{},h,[],m),v=this.expression.evaluate(new Qt(this.zoom+1),r,{},h,[],m),b=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(b,t,g,v)}updatePaintArray(t,r,l,h){const m=this.expression.evaluate({zoom:this.zoom},l,h),g=this.expression.evaluate({zoom:this.zoom+1},l,h);this._setPaintValue(t,r,m,g)}_setPaintValue(t,r,l,h){if(this.type==="color"){const m=_u(l),g=_u(h);for(let v=t;v<r;v++)this.paintVertexArray.emplace(v,m[0],m[1],g[0],g[1])}else{for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const l=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=Ht(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,r,l){return new Uo(t,r)}}class no{constructor(t,r,l,h,m,g){this.expression=t,this.type=r,this.useIntegerZoom=l,this.zoom=h,this.layerId=g,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,r,l){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,r.patterns&&r.patterns[this.layerId],l)}updatePaintArray(t,r,l,h,m){this._setPaintValues(t,r,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(t,r,l,h){if(!h||!l)return;const{min:m,mid:g,max:v}=l,b=h[m],A=h[g],z=h[v];if(b&&A&&z)for(let M=t;M<r;M++)this.zoomInPaintVertexArray.emplace(M,A.tl[0],A.tl[1],A.br[0],A.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],A.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(M,A.tl[0],A.tl[1],A.br[0],A.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],A.pixelRatio,z.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,No.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,No.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Wh{constructor(t,r,l){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!l(m))continue;const g=t.paint.get(m);if(!(g instanceof Hn&&Do(g.property.specification)))continue;const v=rf(m,t.type),b=g.value,A=g.property.specification.type,z=g.property.useIntegerZoom,M=g.property.specification["property-type"],k=M==="cross-faded"||M==="cross-faded-data-driven";if(b.kind==="constant")this.binders[m]=k?new Vo(b.value,v):new Al(b.value,v,A),h.push(`/u_${m}`);else if(b.kind==="source"||k){const B=fh(m,A,"source");this.binders[m]=k?new no(b,A,z,r,B,t.id):new vs(b,v,A,B),h.push(`/a_${m}`)}else{const B=fh(m,A,"composite");this.binders[m]=new Lr(b,v,A,z,r,B),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof vs||r instanceof Lr?r.maxValue:0}populatePaintArrays(t,r,l,h,m){for(const g in this.binders){const v=this.binders[g];(v instanceof vs||v instanceof Lr||v instanceof no)&&v.populatePaintArray(t,r,l,h,m)}}setConstantPatternPositions(t,r){for(const l in this.binders){const h=this.binders[l];h instanceof Vo&&h.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,l,h,m){let g=!1;for(const v in t){const b=r.getPositions(v);for(const A of b){const z=l.feature(A.index);for(const M in this.binders){const k=this.binders[M];if((k instanceof vs||k instanceof Lr||k instanceof no)&&k.expression.isStateDependent===!0){const B=h.paint.get(M);k.expression=B.value,k.updatePaintArray(A.start,A.end,z,t[v],m),g=!0}}}}return g}defines(){const t=[];for(const r in this.binders){const l=this.binders[r];(l instanceof Al||l instanceof Vo)&&t.push(...l.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof vs||l instanceof Lr)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name);else if(l instanceof no)for(let h=0;h<No.members.length;h++)t.push(No.members[h].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof Al||l instanceof Vo||l instanceof Lr)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const l=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Al||m instanceof Vo||m instanceof Lr){for(const g of m.uniformNames)if(r[g]){const v=m.getBinding(t,r[g],g);l.push({name:g,property:h,binding:v})}}}return l}setUniforms(t,r,l,h){for(const{name:m,property:g,binding:v}of r)this.binders[g].setUniform(v,h,l.get(g),m)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const l=this.binders[r];if(t&&l instanceof no){const h=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(l instanceof vs||l instanceof Lr)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const r in this.binders){const l=this.binders[r];(l instanceof vs||l instanceof Lr||l instanceof no)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof vs||r instanceof Lr||r instanceof no)&&r.destroy()}}}class qo{constructor(t,r,l=(()=>!0)){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Wh(h,r,l);this.needsUpload=!1,this._featureMap=new io,this._bufferOffset=0}populatePaintArrays(t,r,l,h,m,g){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,r,h,m,g);r.id!==void 0&&this._featureMap.add(r.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,l,h){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,r,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function rf(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}function fh(a,t,r){const l={color:{source:j,composite:It},number:{source:Ge,composite:j}},h=(function(m){return{"line-pattern":{source:bi,composite:bi},"fill-pattern":{source:bi,composite:bi},"fill-extrusion-pattern":{source:bi,composite:bi}}[m]})(a);return h&&h[r]||l[t][r]}Be("ConstantBinder",Al),Be("CrossFadedConstantBinder",Vo),Be("SourceExpressionBinder",vs),Be("CrossFadedCompositeBinder",no),Be("CompositeExpressionBinder",Lr),Be("ProgramConfiguration",Wh,{omit:["_buffers"]}),Be("ProgramConfigurationSet",qo);const ba=8192,ed=Math.pow(2,14)-1,td=-ed-1;function Zo(a){const t=ba/a.extent,r=a.loadGeometry();for(let l=0;l<r.length;l++){const h=r[l];for(let m=0;m<h.length;m++){const g=h[m],v=Math.round(g.x*t),b=Math.round(g.y*t);g.x=Ht(v,td,ed),g.y=Ht(b,td,ed),(v<g.x||v>g.x+1||b<g.y||b>g.y+1)&&Ti("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Go(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?Zo(a):[]}}function vu(a,t,r,l,h){a.emplaceBack(2*t+(l+1)/2,2*r+(h+1)/2)}class ph{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ga,this.indexArray=new An,this.segments=new Wt,this.programConfigurations=new qo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,l){const h=this.layers[0],m=[];let g=null,v=!1;h.type==="circle"&&(g=h.layout.get("circle-sort-key"),v=!g.isConstant());for(const{feature:b,id:A,index:z,sourceLayerIndex:M}of t){const k=this.layers[0]._featureFilter.needGeometry,B=Go(b,k);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),B,l))continue;const N=v?g.evaluate(B,{},l):void 0,F={id:A,properties:b.properties,type:b.type,sourceLayerIndex:M,index:z,geometry:k?B.geometry:Zo(b),patterns:{},sortKey:N};m.push(F)}v&&m.sort(((b,A)=>b.sortKey-A.sortKey));for(const b of m){const{geometry:A,index:z,sourceLayerIndex:M}=b,k=t[z].feature;this.addFeature(b,A,z,l),r.featureIndex.insert(k,A,z,M,this.index)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,sn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,l,h){for(const m of r)for(const g of m){const v=g.x,b=g.y;if(v<0||v>=ba||b<0||b>=ba)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),z=A.vertexLength;vu(this.layoutVertexArray,v,b,-1,-1),vu(this.layoutVertexArray,v,b,1,-1),vu(this.layoutVertexArray,v,b,1,1),vu(this.layoutVertexArray,v,b,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},h)}}function id(a,t){for(let r=0;r<a.length;r++)if(ro(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(ro(a,t[r]))return!0;return!!nd(a,t)}function sf(a,t,r){return!!ro(a,t)||!!Ho(t,a,r)}function ad(a,t){if(a.length===1)return fc(t,a[0]);for(let r=0;r<t.length;r++){const l=t[r];for(let h=0;h<l.length;h++)if(ro(a,l[h]))return!0}for(let r=0;r<a.length;r++)if(fc(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(nd(a,t[r]))return!0;return!1}function of(a,t,r){if(a.length>1){if(nd(a,t))return!0;for(let l=0;l<t.length;l++)if(Ho(t[l],a,r))return!0}for(let l=0;l<a.length;l++)if(Ho(a[l],t,r))return!0;return!1}function nd(a,t){if(a.length===0||t.length===0)return!1;for(let r=0;r<a.length-1;r++){const l=a[r],h=a[r+1];for(let m=0;m<t.length-1;m++)if(lf(l,h,t[m],t[m+1]))return!0}return!1}function lf(a,t,r,l){return li(a,r,l)!==li(t,r,l)&&li(a,t,r)!==li(a,t,l)}function Ho(a,t,r){const l=r*r;if(t.length===1)return a.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(rd(a,t[h-1],t[h])<l)return!0;return!1}function rd(a,t,r){const l=t.distSqr(r);if(l===0)return a.distSqr(t);const h=((a.x-t.x)*(r.x-t.x)+(a.y-t.y)*(r.y-t.y))/l;return a.distSqr(h<0?t:h>1?r:r.sub(t)._mult(h)._add(t))}function fc(a,t){let r,l,h,m=!1;for(let g=0;g<a.length;g++){r=a[g];for(let v=0,b=r.length-1;v<r.length;b=v++)l=r[v],h=r[b],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(m=!m)}return m}function ro(a,t){let r=!1;for(let l=0,h=a.length-1;l<a.length;h=l++){const m=a[l],g=a[h];m.y>t.y!=g.y>t.y&&t.x<(g.x-m.x)*(t.y-m.y)/(g.y-m.y)+m.x&&(r=!r)}return r}function uf(a,t,r){const l=r[0],h=r[2];if(a.x<l.x&&t.x<l.x||a.x>h.x&&t.x>h.x||a.y<l.y&&t.y<l.y||a.y>h.y&&t.y>h.y)return!1;const m=li(a,t,r[0]);return m!==li(a,t,r[1])||m!==li(a,t,r[2])||m!==li(a,t,r[3])}function zl(a,t,r){const l=t.paint.get(a).value;return l.kind==="constant"?l.value:r.programConfigurations.get(t.id).getMaxValue(a)}function mh(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function pc(a,t,r,l,h){if(!t[0]&&!t[1])return a;const m=me.convert(t)._mult(h);r==="viewport"&&m._rotate(-l);const g=[];for(let v=0;v<a.length;v++)g.push(a[v].sub(m));return g}let sd,od;Be("CircleBucket",ph,{omit:["layers"]});var cf={get paint(){return od=od||new p({"circle-radius":new wt(xe.paint_circle["circle-radius"]),"circle-color":new wt(xe.paint_circle["circle-color"]),"circle-blur":new wt(xe.paint_circle["circle-blur"]),"circle-opacity":new wt(xe.paint_circle["circle-opacity"]),"circle-translate":new st(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new st(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new st(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new st(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new wt(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new wt(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new wt(xe.paint_circle["circle-stroke-opacity"])})},get layout(){return sd=sd||new p({"circle-sort-key":new wt(xe.layout_circle["circle-sort-key"])})}},fn=1e-6,Xo=typeof Float32Array<"u"?Float32Array:Array;function gh(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function ld(a,t,r){var l=t[0],h=t[1],m=t[2],g=t[3],v=t[4],b=t[5],A=t[6],z=t[7],M=t[8],k=t[9],B=t[10],N=t[11],F=t[12],G=t[13],Y=t[14],he=t[15],ae=r[0],le=r[1],Se=r[2],Pe=r[3];return a[0]=ae*l+le*v+Se*M+Pe*F,a[1]=ae*h+le*b+Se*k+Pe*G,a[2]=ae*m+le*A+Se*B+Pe*Y,a[3]=ae*g+le*z+Se*N+Pe*he,a[4]=(ae=r[4])*l+(le=r[5])*v+(Se=r[6])*M+(Pe=r[7])*F,a[5]=ae*h+le*b+Se*k+Pe*G,a[6]=ae*m+le*A+Se*B+Pe*Y,a[7]=ae*g+le*z+Se*N+Pe*he,a[8]=(ae=r[8])*l+(le=r[9])*v+(Se=r[10])*M+(Pe=r[11])*F,a[9]=ae*h+le*b+Se*k+Pe*G,a[10]=ae*m+le*A+Se*B+Pe*Y,a[11]=ae*g+le*z+Se*N+Pe*he,a[12]=(ae=r[12])*l+(le=r[13])*v+(Se=r[14])*M+(Pe=r[15])*F,a[13]=ae*h+le*b+Se*k+Pe*G,a[14]=ae*m+le*A+Se*B+Pe*Y,a[15]=ae*g+le*z+Se*N+Pe*he,a}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)});var El,hf=ld;function mc(a,t,r){var l=t[0],h=t[1],m=t[2],g=t[3];return a[0]=r[0]*l+r[4]*h+r[8]*m+r[12]*g,a[1]=r[1]*l+r[5]*h+r[9]*m+r[13]*g,a[2]=r[2]*l+r[6]*h+r[10]*m+r[14]*g,a[3]=r[3]*l+r[7]*h+r[11]*m+r[15]*g,a}El=new Xo(4),Xo!=Float32Array&&(El[0]=0,El[1]=0,El[2]=0,El[3]=0);class dp extends s{constructor(t){super(t,cf)}createBucket(t){return new ph(t)}queryRadius(t){const r=t;return zl("circle-radius",this,r)+zl("circle-stroke-width",this,r)+mh(this.paint.get("circle-translate"))}queryIntersectsFeature(t,r,l,h,m,g,v,b){const A=pc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,v),z=this.paint.get("circle-radius").evaluate(r,l)+this.paint.get("circle-stroke-width").evaluate(r,l),M=this.paint.get("circle-pitch-alignment")==="map",k=M?A:(function(N,F){return N.map((G=>yh(G,F)))})(A,b),B=M?z*v:z;for(const N of h)for(const F of N){const G=M?F:yh(F,b);let Y=B;const he=mc([],[F.x,F.y,0,1],b);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Y*=he[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Y*=g.cameraToCenterDistance/he[3]),sf(k,G,Y))return!0}return!1}}function yh(a,t){const r=mc([],[a.x,a.y,0,1],t);return new me(r[0]/r[3],r[1]/r[3])}class ud extends ph{}let cd;Be("HeatmapBucket",ud,{omit:["layers"]});var hd={get paint(){return cd=cd||new p({"heatmap-radius":new wt(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new wt(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new st(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new uc(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new st(xe.paint_heatmap["heatmap-opacity"])})}};function _h(a,{width:t,height:r},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*r*l)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*r*l}`)}else h=new Uint8Array(t*r*l);return a.width=t,a.height=r,a.data=h,a}function dd(a,{width:t,height:r},l){if(t===a.width&&r===a.height)return;const h=_h({},{width:t,height:r},l);fd(a,h,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,t),height:Math.min(a.height,r)},l),a.width=t,a.height=r,a.data=h.data}function fd(a,t,r,l,h,m){if(h.width===0||h.height===0)return t;if(h.width>a.width||h.height>a.height||r.x>a.width-h.width||r.y>a.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=a.data,v=t.data;if(g===v)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<h.height;b++){const A=((r.y+b)*a.width+r.x)*m,z=((l.y+b)*t.width+l.x)*m;for(let M=0;M<h.width*m;M++)v[z+M]=g[A+M]}return t}class gc{constructor(t,r){_h(this,t,1,r)}resize(t){dd(this,t,1)}clone(){return new gc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,h,m){fd(t,r,l,h,m,1)}}class Kn{constructor(t,r){_h(this,t,4,r)}resize(t){dd(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Kn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,h,m){fd(t,r,l,h,m,4)}}function xu(a){const t={},r=a.resolution||256,l=a.clips?a.clips.length:1,h=a.image||new Kn({width:r,height:l});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const m=(g,v,b)=>{t[a.evaluationKey]=b;const A=a.expression.evaluate(t);h.data[g+v+0]=Math.floor(255*A.r/A.a),h.data[g+v+1]=Math.floor(255*A.g/A.a),h.data[g+v+2]=Math.floor(255*A.b/A.a),h.data[g+v+3]=Math.floor(255*A.a)};if(a.clips)for(let g=0,v=0;g<l;++g,v+=4*r)for(let b=0,A=0;b<r;b++,A+=4){const z=b/(r-1),{start:M,end:k}=a.clips[g];m(v,A,M*(1-z)+k*z)}else for(let g=0,v=0;g<r;g++,v+=4)m(0,v,g/(r-1));return h}Be("AlphaImage",gc),Be("RGBAImage",Kn);const yc="big-fb";class vh extends s{createBucket(t){return new ud(t)}constructor(t){super(t,hd),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(yc)&&this.heatmapFbos.delete(yc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let pd;var df={get paint(){return pd=pd||new p({"hillshade-illumination-direction":new st(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new st(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new st(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new st(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new st(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new st(xe.paint_hillshade["hillshade-accent-color"])})}};class _c extends s{constructor(t){super(t,df)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const ff=x([{name:"a_pos",components:2,type:"Int16"}],4),{members:md}=ff;function gd(a,t,r=2){const l=t&&t.length,h=l?t[0]*r:a.length;let m=xh(a,0,h,r,!0);const g=[];if(!m||m.next===m.prev)return g;let v,b,A;if(l&&(m=(function(z,M,k,B){const N=[];for(let F=0,G=M.length;F<G;F++){const Y=xh(z,M[F]*B,F<G-1?M[F+1]*B:z.length,B,!1);Y===Y.next&&(Y.steiner=!0),N.push(vf(Y))}N.sort(yf);for(let F=0;F<N.length;F++)k=bh(N[F],k);return k})(a,t,m,r)),a.length>80*r){v=1/0,b=1/0;let z=-1/0,M=-1/0;for(let k=r;k<h;k+=r){const B=a[k],N=a[k+1];B<v&&(v=B),N<b&&(b=N),B>z&&(z=B),N>M&&(M=N)}A=Math.max(z-v,M-b),A=A!==0?32767/A:0}return bu(m,g,r,v,b,A,0),g}function xh(a,t,r,l,h){let m;if(h===(function(g,v,b,A){let z=0;for(let M=v,k=b-A;M<b;M+=A)z+=(g[k]-g[M])*(g[M+1]+g[k+1]),k=M;return z})(a,t,r,l)>0)for(let g=t;g<r;g+=l)m=Su(g/l|0,a[g],a[g+1],m);else for(let g=r-l;g>=t;g-=l)m=Su(g/l|0,a[g],a[g+1],m);return m&&wa(m,m.next)&&(Tu(m),m=m.next),m}function so(a,t){if(!a)return a;t||(t=a);let r,l=a;do if(r=!1,l.steiner||!wa(l,l.next)&&ua(l.prev,l,l.next)!==0)l=l.next;else{if(Tu(l),l=t=l.prev,l===l.next)break;r=!0}while(r||l!==t);return t}function bu(a,t,r,l,h,m,g){if(!a)return;!g&&m&&(function(b,A,z,M){let k=b;do k.z===0&&(k.z=vc(k.x,k.y,A,z,M)),k.prevZ=k.prev,k.nextZ=k.next,k=k.next;while(k!==b);k.prevZ.nextZ=null,k.prevZ=null,(function(B){let N,F=1;do{let G,Y=B;B=null;let he=null;for(N=0;Y;){N++;let ae=Y,le=0;for(let Pe=0;Pe<F&&(le++,ae=ae.nextZ,ae);Pe++);let Se=F;for(;le>0||Se>0&&ae;)le!==0&&(Se===0||!ae||Y.z<=ae.z)?(G=Y,Y=Y.nextZ,le--):(G=ae,ae=ae.nextZ,Se--),he?he.nextZ=G:B=G,G.prevZ=he,he=G;Y=ae}he.nextZ=null,F*=2}while(N>1)})(k)})(a,l,h,m);let v=a;for(;a.prev!==a.next;){const b=a.prev,A=a.next;if(m?Ml(a,l,h,m):pf(a))t.push(b.i,a.i,A.i),Tu(a),a=A.next,v=A.next;else if((a=A)===v){g?g===1?bu(a=mf(so(a),t),t,r,l,h,m,2):g===2&&gf(a,t,r,l,h,m):bu(so(a),t,r,l,h,m,1);break}}}function pf(a){const t=a.prev,r=a,l=a.next;if(ua(t,r,l)>=0)return!1;const h=t.x,m=r.x,g=l.x,v=t.y,b=r.y,A=l.y,z=h<m?h<g?h:g:m<g?m:g,M=v<b?v<A?v:A:b<A?b:A,k=h>m?h>g?h:g:m>g?m:g,B=v>b?v>A?v:A:b>A?b:A;let N=l.next;for(;N!==t;){if(N.x>=z&&N.x<=k&&N.y>=M&&N.y<=B&&Cl(h,v,m,b,g,A,N.x,N.y)&&ua(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function Ml(a,t,r,l){const h=a.prev,m=a,g=a.next;if(ua(h,m,g)>=0)return!1;const v=h.x,b=m.x,A=g.x,z=h.y,M=m.y,k=g.y,B=v<b?v<A?v:A:b<A?b:A,N=z<M?z<k?z:k:M<k?M:k,F=v>b?v>A?v:A:b>A?b:A,G=z>M?z>k?z:k:M>k?M:k,Y=vc(B,N,t,r,l),he=vc(F,G,t,r,l);let ae=a.prevZ,le=a.nextZ;for(;ae&&ae.z>=Y&&le&&le.z<=he;){if(ae.x>=B&&ae.x<=F&&ae.y>=N&&ae.y<=G&&ae!==h&&ae!==g&&Cl(v,z,b,M,A,k,ae.x,ae.y)&&ua(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,le.x>=B&&le.x<=F&&le.y>=N&&le.y<=G&&le!==h&&le!==g&&Cl(v,z,b,M,A,k,le.x,le.y)&&ua(le.prev,le,le.next)>=0))return!1;le=le.nextZ}for(;ae&&ae.z>=Y;){if(ae.x>=B&&ae.x<=F&&ae.y>=N&&ae.y<=G&&ae!==h&&ae!==g&&Cl(v,z,b,M,A,k,ae.x,ae.y)&&ua(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;le&&le.z<=he;){if(le.x>=B&&le.x<=F&&le.y>=N&&le.y<=G&&le!==h&&le!==g&&Cl(v,z,b,M,A,k,le.x,le.y)&&ua(le.prev,le,le.next)>=0)return!1;le=le.nextZ}return!0}function mf(a,t){let r=a;do{const l=r.prev,h=r.next.next;!wa(l,h)&&on(l,r,r.next,h)&&wu(l,h)&&wu(h,l)&&(t.push(l.i,r.i,h.i),Tu(r),Tu(r.next),r=a=h),r=r.next}while(r!==a);return so(r)}function gf(a,t,r,l,h,m){let g=a;do{let v=g.next.next;for(;v!==g.prev;){if(g.i!==v.i&&fp(g,v)){let b=yd(g,v);return g=so(g,g.next),b=so(b,b.next),bu(g,t,r,l,h,m,0),void bu(b,t,r,l,h,m,0)}v=v.next}g=g.next}while(g!==a)}function yf(a,t){return a.x-t.x}function bh(a,t){const r=(function(h,m){let g=m;const v=h.x,b=h.y;let A,z=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){const F=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(F<=v&&F>z&&(z=F,A=g.x<g.next.x?g:g.next,F===v))return A}g=g.next}while(g!==m);if(!A)return null;const M=A,k=A.x,B=A.y;let N=1/0;g=A;do{if(v>=g.x&&g.x>=k&&v!==g.x&&Cl(b<B?v:z,b,k,B,b<B?z:v,b,g.x,g.y)){const F=Math.abs(b-g.y)/(v-g.x);wu(g,h)&&(F<N||F===N&&(g.x>A.x||g.x===A.x&&_f(A,g)))&&(A=g,N=F)}g=g.next}while(g!==M);return A})(a,t);if(!r)return t;const l=yd(r,a);return so(l,l.next),so(r,r.next)}function _f(a,t){return ua(a.prev,a,t.prev)<0&&ua(t.next,a,a.next)<0}function vc(a,t,r,l,h){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*h|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function vf(a){let t=a,r=a;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==a);return r}function Cl(a,t,r,l,h,m,g,v){return(h-g)*(t-v)>=(a-g)*(m-v)&&(a-g)*(l-v)>=(r-g)*(t-v)&&(r-g)*(m-v)>=(h-g)*(l-v)}function fp(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!(function(r,l){let h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==l.i&&h.next.i!==l.i&&on(h,h.next,r,l))return!0;h=h.next}while(h!==r);return!1})(a,t)&&(wu(a,t)&&wu(t,a)&&(function(r,l){let h=r,m=!1;const g=(r.x+l.x)/2,v=(r.y+l.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&g<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==r);return m})(a,t)&&(ua(a.prev,a,t.prev)||ua(a,t.prev,t))||wa(a,t)&&ua(a.prev,a,a.next)>0&&ua(t.prev,t,t.next)>0)}function ua(a,t,r){return(t.y-a.y)*(r.x-t.x)-(t.x-a.x)*(r.y-t.y)}function wa(a,t){return a.x===t.x&&a.y===t.y}function on(a,t,r,l){const h=bc(ua(a,t,r)),m=bc(ua(a,t,l)),g=bc(ua(r,l,a)),v=bc(ua(r,l,t));return h!==m&&g!==v||!(h!==0||!xc(a,r,t))||!(m!==0||!xc(a,l,t))||!(g!==0||!xc(r,a,l))||!(v!==0||!xc(r,t,l))}function xc(a,t,r){return t.x<=Math.max(a.x,r.x)&&t.x>=Math.min(a.x,r.x)&&t.y<=Math.max(a.y,r.y)&&t.y>=Math.min(a.y,r.y)}function bc(a){return a>0?1:a<0?-1:0}function wu(a,t){return ua(a.prev,a,a.next)<0?ua(a,t,a.next)>=0&&ua(a,a.prev,t)>=0:ua(a,t,a.prev)<0||ua(a,a.next,t)<0}function yd(a,t){const r=Au(a.i,a.x,a.y),l=Au(t.i,t.x,t.y),h=a.next,m=t.prev;return a.next=t,t.prev=a,r.next=h,h.prev=r,l.next=r,r.prev=l,m.next=l,l.prev=m,l}function Su(a,t,r,l){const h=Au(a,t,r);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Tu(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Au(a,t,r){return{i:a,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function wh(a,t,r){const l=r.patternDependencies;let h=!1;for(const m of t){const g=m.paint.get(`${a}-pattern`);g.isConstant()||(h=!0);const v=g.constantOr(null);v&&(h=!0,l[v.to]=!0,l[v.from]=!0)}return h}function _d(a,t,r,l,h){const m=h.patternDependencies;for(const g of t){const v=g.paint.get(`${a}-pattern`).value;if(v.kind!=="constant"){let b=v.evaluate({zoom:l-1},r,{},h.availableImages),A=v.evaluate({zoom:l},r,{},h.availableImages),z=v.evaluate({zoom:l+1},r,{},h.availableImages);b=b&&b.name?b.name:b,A=A&&A.name?A.name:A,z=z&&z.name?z.name:z,m[b]=!0,m[A]=!0,m[z]=!0,r.patterns[g.id]={min:b,mid:A,max:z}}}return r}class zu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $n,this.indexArray=new An,this.indexArray2=new ya,this.programConfigurations=new qo(t.layers,t.zoom),this.segments=new Wt,this.segments2=new Wt,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,l){this.hasPattern=wh("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:b,index:A,sourceLayerIndex:z}of t){const M=this.layers[0]._featureFilter.needGeometry,k=Go(v,M);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),k,l))continue;const B=m?h.evaluate(k,{},l,r.availableImages):void 0,N={id:b,properties:v.properties,type:v.type,sourceLayerIndex:z,index:A,geometry:M?k.geometry:Zo(v),patterns:{},sortKey:B};g.push(N)}m&&g.sort(((v,b)=>v.sortKey-b.sortKey));for(const v of g){const{geometry:b,index:A,sourceLayerIndex:z}=v;if(this.hasPattern){const M=_d("fill",this.layers,v,this.zoom,r);this.patternFeatures.push(M)}else this.addFeature(v,b,A,l,{});r.featureIndex.insert(t[A].feature,b,A,z,this.index)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}addFeatures(t,r,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,md),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,l,h,m){for(const g of Kl(r,500)){let v=0;for(const B of g)v+=B.length;const b=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),A=b.vertexLength,z=[],M=[];for(const B of g){if(B.length===0)continue;B!==g[0]&&M.push(z.length/2);const N=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),F=N.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(F+B.length-1,F),z.push(B[0].x),z.push(B[0].y);for(let G=1;G<B.length;G++)this.layoutVertexArray.emplaceBack(B[G].x,B[G].y),this.indexArray2.emplaceBack(F+G-1,F+G),z.push(B[G].x),z.push(B[G].y);N.vertexLength+=B.length,N.primitiveLength+=B.length}const k=gd(z,M);for(let B=0;B<k.length;B+=3)this.indexArray.emplaceBack(A+k[B],A+k[B+1],A+k[B+2]);b.vertexLength+=v,b.primitiveLength+=k.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,h)}}let Sh,vd;Be("FillBucket",zu,{omit:["layers","patternFeatures"]});var xf={get paint(){return vd=vd||new p({"fill-antialias":new st(xe.paint_fill["fill-antialias"]),"fill-opacity":new wt(xe.paint_fill["fill-opacity"]),"fill-color":new wt(xe.paint_fill["fill-color"]),"fill-outline-color":new wt(xe.paint_fill["fill-outline-color"]),"fill-translate":new st(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new st(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Wr(xe.paint_fill["fill-pattern"])})},get layout(){return Sh=Sh||new p({"fill-sort-key":new wt(xe.layout_fill["fill-sort-key"])})}};class bf extends s{constructor(t){super(t,xf)}recalculate(t,r){super.recalculate(t,r);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new zu(t)}queryRadius(){return mh(this.paint.get("fill-translate"))}queryIntersectsFeature(t,r,l,h,m,g,v){return ad(pc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,v),h)}isTileClipped(){return!0}}const xd=x([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),bd=x([{name:"a_centroid",components:2,type:"Int16"}],4),{members:wd}=xd;var oo={},Sd=Ee,wc=$o;function $o(a,t,r,l,h){this.properties={},this.extent=r,this.type=0,this._pbf=a,this._geometry=-1,this._keys=l,this._values=h,a.readFields(wf,this,t)}function wf(a,t,r){a==1?t.id=r.readVarint():a==2?(function(l,h){for(var m=l.readVarint()+l.pos;l.pos<m;){var g=h._keys[l.readVarint()],v=h._values[l.readVarint()];h.properties[g]=v}})(r,t):a==3?t.type=r.readVarint():a==4&&(t._geometry=r.pos)}function Td(a){for(var t,r,l=0,h=0,m=a.length,g=m-1;h<m;g=h++)l+=((r=a[g]).x-(t=a[h]).x)*(t.y+r.y);return l}$o.types=["Unknown","Point","LineString","Polygon"],$o.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var t,r=a.readVarint()+a.pos,l=1,h=0,m=0,g=0,v=[];a.pos<r;){if(h<=0){var b=a.readVarint();l=7&b,h=b>>3}if(h--,l===1||l===2)m+=a.readSVarint(),g+=a.readSVarint(),l===1&&(t&&v.push(t),t=[]),t.push(new Sd(m,g));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&v.push(t),v},$o.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var t=a.readVarint()+a.pos,r=1,l=0,h=0,m=0,g=1/0,v=-1/0,b=1/0,A=-1/0;a.pos<t;){if(l<=0){var z=a.readVarint();r=7&z,l=z>>3}if(l--,r===1||r===2)(h+=a.readSVarint())<g&&(g=h),h>v&&(v=h),(m+=a.readSVarint())<b&&(b=m),m>A&&(A=m);else if(r!==7)throw new Error("unknown command "+r)}return[g,b,v,A]},$o.prototype.toGeoJSON=function(a,t,r){var l,h,m=this.extent*Math.pow(2,r),g=this.extent*a,v=this.extent*t,b=this.loadGeometry(),A=$o.types[this.type];function z(B){for(var N=0;N<B.length;N++){var F=B[N];B[N]=[360*(F.x+g)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(F.y+v)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(l=0;l<b.length;l++)M[l]=b[l][0];z(b=M);break;case 2:for(l=0;l<b.length;l++)z(b[l]);break;case 3:for(b=(function(B){var N=B.length;if(N<=1)return[B];for(var F,G,Y=[],he=0;he<N;he++){var ae=Td(B[he]);ae!==0&&(G===void 0&&(G=ae<0),G===ae<0?(F&&Y.push(F),F=[B[he]]):F.push(B[he]))}return F&&Y.push(F),Y})(b),l=0;l<b.length;l++)for(h=0;h<b[l].length;h++)z(b[l][h])}b.length===1?b=b[0]:A="Multi"+A;var k={type:"Feature",geometry:{type:A,coordinates:b},properties:this.properties};return"id"in this&&(k.id=this.id),k};var Sf=wc,xs=Th;function Th(a,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(pp,this,t),this.length=this._features.length}function pp(a,t,r){a===15?t.version=r.readVarint():a===1?t.name=r.readString():a===5?t.extent=r.readVarint():a===2?t._features.push(r.pos):a===3?t._keys.push(r.readString()):a===4&&t._values.push((function(l){for(var h=null,m=l.readVarint()+l.pos;l.pos<m;){var g=l.readVarint()>>3;h=g===1?l.readString():g===2?l.readFloat():g===3?l.readDouble():g===4?l.readVarint64():g===5?l.readVarint():g===6?l.readSVarint():g===7?l.readBoolean():null}return h})(r))}Th.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var t=this._pbf.readVarint()+this._pbf.pos;return new Sf(this._pbf,t,this.extent,this._keys,this._values)};var Tf=xs;function lo(a,t,r){if(a===3){var l=new Tf(r,r.readVarint()+r.pos);l.length&&(t[l.name]=l)}}oo.VectorTile=function(a,t){this.layers=a.readFields(lo,{},t)},oo.VectorTileFeature=wc,oo.VectorTileLayer=xs;const Ad=oo.VectorTileFeature.types,Ah=Math.pow(2,13);function Yo(a,t,r,l,h,m,g,v){a.emplaceBack(t,r,2*Math.floor(l*Ah)+g,h*Ah*2,m*Ah*2,Math.round(v))}class Dl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new eo,this.centroidVertexArray=new Hi,this.indexArray=new An,this.programConfigurations=new qo(t.layers,t.zoom),this.segments=new Wt,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,l){this.features=[],this.hasPattern=wh("fill-extrusion",this.layers,r);for(const{feature:h,id:m,index:g,sourceLayerIndex:v}of t){const b=this.layers[0]._featureFilter.needGeometry,A=Go(h,b);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),A,l))continue;const z={id:m,sourceLayerIndex:v,index:g,geometry:b?A.geometry:Zo(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(_d("fill-extrusion",this.layers,z,this.zoom,r)):this.addFeature(z,z.geometry,g,l,{}),r.featureIndex.insert(h,z.geometry,g,v,this.index,!0)}}addFeatures(t,r,l){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,r,l)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wd),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,bd.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,l,h,m){for(const g of Kl(r,500)){const v={x:0,y:0,vertexCount:0};let b=0;for(const N of g)b+=N.length;let A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const N of g){if(N.length===0||mp(N))continue;let F=0;for(let G=0;G<N.length;G++){const Y=N[G];if(G>=1){const he=N[G-1];if(!ca(Y,he)){A.vertexLength+4>Wt.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ae=Y.sub(he)._perp()._unit(),le=he.dist(Y);F+le>32768&&(F=0),Yo(this.layoutVertexArray,Y.x,Y.y,ae.x,ae.y,0,0,F),Yo(this.layoutVertexArray,Y.x,Y.y,ae.x,ae.y,0,1,F),v.x+=2*Y.x,v.y+=2*Y.y,v.vertexCount+=2,F+=le,Yo(this.layoutVertexArray,he.x,he.y,ae.x,ae.y,0,0,F),Yo(this.layoutVertexArray,he.x,he.y,ae.x,ae.y,0,1,F),v.x+=2*he.x,v.y+=2*he.y,v.vertexCount+=2;const Se=A.vertexLength;this.indexArray.emplaceBack(Se,Se+2,Se+1),this.indexArray.emplaceBack(Se+1,Se+2,Se+3),A.vertexLength+=4,A.primitiveLength+=2}}}}if(A.vertexLength+b>Wt.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),Ad[t.type]!=="Polygon")continue;const z=[],M=[],k=A.vertexLength;for(const N of g)if(N.length!==0){N!==g[0]&&M.push(z.length/2);for(let F=0;F<N.length;F++){const G=N[F];Yo(this.layoutVertexArray,G.x,G.y,0,0,1,1,0),v.x+=G.x,v.y+=G.y,v.vertexCount+=1,z.push(G.x),z.push(G.y)}}const B=gd(z,M);for(let N=0;N<B.length;N+=3)this.indexArray.emplaceBack(k+B[N],k+B[N+2],k+B[N+1]);A.primitiveLength+=B.length/3,A.vertexLength+=b;for(let N=0;N<v.vertexCount;N++){const F=Math.floor(v.x/v.vertexCount),G=Math.floor(v.y/v.vertexCount);this.centroidVertexArray.emplaceBack(F,G)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,h)}}function ca(a,t){return a.x===t.x&&(a.x<0||a.x>ba)||a.y===t.y&&(a.y<0||a.y>ba)}function mp(a){return a.every((t=>t.x<0))||a.every((t=>t.x>ba))||a.every((t=>t.y<0))||a.every((t=>t.y>ba))}let Af;Be("FillExtrusionBucket",Dl,{omit:["layers","features"]});var zf={get paint(){return Af=Af||new p({"fill-extrusion-opacity":new st(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new wt(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new st(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new st(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Wr(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new wt(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new wt(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new st(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Sc extends s{constructor(t){super(t,zf)}createBucket(t){return new Dl(t)}queryRadius(){return mh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,r,l,h,m,g,v,b){const A=pc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,v),z=this.paint.get("fill-extrusion-height").evaluate(r,l),M=this.paint.get("fill-extrusion-base").evaluate(r,l),k=(function(N,F,G,Y){const he=[];for(const ae of N){const le=[ae.x,ae.y,0,1];mc(le,le,F),he.push(new me(le[0]/le[3],le[1]/le[3]))}return he})(A,b),B=(function(N,F,G,Y){const he=[],ae=[],le=Y[8]*F,Se=Y[9]*F,Pe=Y[10]*F,Qe=Y[11]*F,St=Y[8]*G,Ve=Y[9]*G,Ke=Y[10]*G,ct=Y[11]*G;for(const rt of N){const tt=[],Me=[];for(const at of rt){const ut=at.x,kt=at.y,fi=Y[0]*ut+Y[4]*kt+Y[12],Bi=Y[1]*ut+Y[5]*kt+Y[13],qa=Y[2]*ut+Y[6]*kt+Y[14],mn=Y[3]*ut+Y[7]*kt+Y[15],Ya=qa+Pe,Za=mn+Qe,Mn=fi+St,Cn=Bi+Ve,Dn=qa+Ke,va=mn+ct,Ga=new me((fi+le)/Za,(Bi+Se)/Za);Ga.z=Ya/Za,tt.push(Ga);const gn=new me(Mn/va,Cn/va);gn.z=Dn/va,Me.push(gn)}he.push(tt),ae.push(Me)}return[he,ae]})(h,M,z,b);return(function(N,F,G){let Y=1/0;ad(G,F)&&(Y=zd(G,F[0]));for(let he=0;he<F.length;he++){const ae=F[he],le=N[he];for(let Se=0;Se<ae.length-1;Se++){const Pe=ae[Se],Qe=[Pe,ae[Se+1],le[Se+1],le[Se],Pe];id(G,Qe)&&(Y=Math.min(Y,zd(G,Qe)))}}return Y!==1/0&&Y})(B[0],B[1],k)}}function Br(a,t){return a.x*t.x+a.y*t.y}function zd(a,t){if(a.length===1){let r=0;const l=t[r++];let h;for(;!h||l.equals(h);)if(h=t[r++],!h)return 1/0;for(;r<t.length;r++){const m=t[r],g=a[0],v=h.sub(l),b=m.sub(l),A=g.sub(l),z=Br(v,v),M=Br(v,b),k=Br(b,b),B=Br(A,v),N=Br(A,b),F=z*k-M*M,G=(k*B-M*N)/F,Y=(z*N-M*B)/F,he=l.z*(1-G-Y)+h.z*G+m.z*Y;if(isFinite(he))return he}return 1/0}{let r=1/0;for(const l of t)r=Math.min(r,l.z);return r}}const Ef=x([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Tc}=Ef,bs=x([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Mf}=bs,Ed=oo.VectorTileFeature.types,Cf=Math.cos(Math.PI/180*37.5),zh=Math.pow(2,14)/.5;class Ac{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((r=>{this.gradients[r.id]={}})),this.layoutVertexArray=new pr,this.layoutVertexArray2=new Na,this.indexArray=new An,this.programConfigurations=new qo(t.layers,t.zoom),this.segments=new Wt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,l){this.hasPattern=wh("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),g=[];for(const{feature:v,id:b,index:A,sourceLayerIndex:z}of t){const M=this.layers[0]._featureFilter.needGeometry,k=Go(v,M);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),k,l))continue;const B=m?h.evaluate(k,{},l):void 0,N={id:b,properties:v.properties,type:v.type,sourceLayerIndex:z,index:A,geometry:M?k.geometry:Zo(v),patterns:{},sortKey:B};g.push(N)}m&&g.sort(((v,b)=>v.sortKey-b.sortKey));for(const v of g){const{geometry:b,index:A,sourceLayerIndex:z}=v;if(this.hasPattern){const M=_d("line",this.layers,v,this.zoom,r);this.patternFeatures.push(M)}else this.addFeature(v,b,A,l,{});r.featureIndex.insert(t[A].feature,b,A,z,this.index)}}update(t,r,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,l)}addFeatures(t,r,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Mf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Tc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,l,h,m){const g=this.layers[0].layout,v=g.get("line-join").evaluate(t,{}),b=g.get("line-cap"),A=g.get("line-miter-limit"),z=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const M of r)this.addLine(M,t,v,b,A,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,h)}addLine(t,r,l,h,m,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Y=0;Y<t.length-1;Y++)this.totalDistance+=t[Y].dist(t[Y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=Ed[r.type]==="Polygon";let b=t.length;for(;b>=2&&t[b-1].equals(t[b-2]);)b--;let A=0;for(;A<b-1&&t[A].equals(t[A+1]);)A++;if(b<(v?3:2))return;l==="bevel"&&(m=1.05);const z=this.overscaling<=16?15*ba/(512*this.overscaling):0,M=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let k,B,N,F,G;this.e1=this.e2=-1,v&&(k=t[b-2],G=t[A].sub(k)._unit()._perp());for(let Y=A;Y<b;Y++){if(N=Y===b-1?v?t[A+1]:void 0:t[Y+1],N&&t[Y].equals(N))continue;G&&(F=G),k&&(B=k),k=t[Y],G=N?N.sub(k)._unit()._perp():F,F=F||G;let he=F.add(G);he.x===0&&he.y===0||he._unit();const ae=F.x*G.x+F.y*G.y,le=he.x*G.x+he.y*G.y,Se=le!==0?1/le:1/0,Pe=2*Math.sqrt(2-2*le),Qe=le<Cf&&B&&N,St=F.x*G.y-F.y*G.x>0;if(Qe&&Y>A){const ct=k.dist(B);if(ct>2*z){const rt=k.sub(k.sub(B)._mult(z/ct)._round());this.updateDistance(B,rt),this.addCurrentVertex(rt,F,0,0,M),B=rt}}const Ve=B&&N;let Ke=Ve?l:v?"butt":h;if(Ve&&Ke==="round"&&(Se<g?Ke="miter":Se<=2&&(Ke="fakeround")),Ke==="miter"&&Se>m&&(Ke="bevel"),Ke==="bevel"&&(Se>2&&(Ke="flipbevel"),Se<m&&(Ke="miter")),B&&this.updateDistance(B,k),Ke==="miter")he._mult(Se),this.addCurrentVertex(k,he,0,0,M);else if(Ke==="flipbevel"){if(Se>100)he=G.mult(-1);else{const ct=Se*F.add(G).mag()/F.sub(G).mag();he._perp()._mult(ct*(St?-1:1))}this.addCurrentVertex(k,he,0,0,M),this.addCurrentVertex(k,he.mult(-1),0,0,M)}else if(Ke==="bevel"||Ke==="fakeround"){const ct=-Math.sqrt(Se*Se-1),rt=St?ct:0,tt=St?0:ct;if(B&&this.addCurrentVertex(k,F,rt,tt,M),Ke==="fakeround"){const Me=Math.round(180*Pe/Math.PI/20);for(let at=1;at<Me;at++){let ut=at/Me;if(ut!==.5){const fi=ut-.5;ut+=ut*fi*(ut-1)*((1.0904+ae*(ae*(3.55645-1.43519*ae)-3.2452))*fi*fi+(.848013+ae*(.215638*ae-1.06021)))}const kt=G.sub(F)._mult(ut)._add(F)._unit()._mult(St?-1:1);this.addHalfVertex(k,kt.x,kt.y,!1,St,0,M)}}N&&this.addCurrentVertex(k,G,-rt,-tt,M)}else if(Ke==="butt")this.addCurrentVertex(k,he,0,0,M);else if(Ke==="square"){const ct=B?1:-1;this.addCurrentVertex(k,he,ct,ct,M)}else Ke==="round"&&(B&&(this.addCurrentVertex(k,F,0,0,M),this.addCurrentVertex(k,F,1,1,M,!0)),N&&(this.addCurrentVertex(k,G,-1,-1,M,!0),this.addCurrentVertex(k,G,0,0,M)));if(Qe&&Y<b-1){const ct=k.dist(N);if(ct>2*z){const rt=k.add(N.sub(k)._mult(z/ct)._round());this.updateDistance(k,rt),this.addCurrentVertex(rt,G,0,0,M),k=rt}}}}addCurrentVertex(t,r,l,h,m,g=!1){const v=r.y*h-r.x,b=-r.y-r.x*h;this.addHalfVertex(t,r.x+r.y*l,r.y-r.x*l,g,!1,l,m),this.addHalfVertex(t,v,b,g,!0,-h,m),this.distance>zh/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,l,h,m,g))}addHalfVertex({x:t,y:r},l,h,m,g,v,b){const A=.5*(this.lineClips?this.scaledDistance*(zh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(r<<1)+(g?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),b.primitiveLength++),g?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let zc,Md;Be("LineBucket",Ac,{omit:["layers","patternFeatures"]});var ws={get paint(){return Md=Md||new p({"line-opacity":new wt(xe.paint_line["line-opacity"]),"line-color":new wt(xe.paint_line["line-color"]),"line-translate":new st(xe.paint_line["line-translate"]),"line-translate-anchor":new st(xe.paint_line["line-translate-anchor"]),"line-width":new wt(xe.paint_line["line-width"]),"line-gap-width":new wt(xe.paint_line["line-gap-width"]),"line-offset":new wt(xe.paint_line["line-offset"]),"line-blur":new wt(xe.paint_line["line-blur"]),"line-dasharray":new es(xe.paint_line["line-dasharray"]),"line-pattern":new Wr(xe.paint_line["line-pattern"]),"line-gradient":new uc(xe.paint_line["line-gradient"])})},get layout(){return zc=zc||new p({"line-cap":new st(xe.layout_line["line-cap"]),"line-join":new wt(xe.layout_line["line-join"]),"line-miter-limit":new st(xe.layout_line["line-miter-limit"]),"line-round-limit":new st(xe.layout_line["line-round-limit"]),"line-sort-key":new wt(xe.layout_line["line-sort-key"])})}};class ja extends wt{possiblyEvaluate(t,r){return r=new Qt(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,l,h){return r=ot({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,l,h)}}let Eu;class Df extends s{constructor(t){super(t,ws),this.gradientVersion=0,Eu||(Eu=new ja(ws.paint.properties["line-width"].specification),Eu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!(function(l){return l._styleExpression!==void 0})(r)&&r._styleExpression.expression instanceof Ls,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=Eu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Ac(t)}queryRadius(t){const r=t,l=Xa(zl("line-width",this,r),zl("line-gap-width",this,r)),h=zl("line-offset",this,r);return l/2+Math.abs(h)+mh(this.paint.get("line-translate"))}queryIntersectsFeature(t,r,l,h,m,g,v){const b=pc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,v),A=v/2*Xa(this.paint.get("line-width").evaluate(r,l),this.paint.get("line-gap-width").evaluate(r,l)),z=this.paint.get("line-offset").evaluate(r,l);return z&&(h=(function(M,k){const B=[];for(let N=0;N<M.length;N++){const F=M[N],G=[];for(let Y=0;Y<F.length;Y++){const he=F[Y-1],ae=F[Y],le=F[Y+1],Se=Y===0?new me(0,0):ae.sub(he)._unit()._perp(),Pe=Y===F.length-1?new me(0,0):le.sub(ae)._unit()._perp(),Qe=Se._add(Pe)._unit(),St=Qe.x*Pe.x+Qe.y*Pe.y;St!==0&&Qe._mult(1/St),G.push(Qe._mult(k)._add(ae))}B.push(G)}return B})(h,z*v)),(function(M,k,B){for(let N=0;N<k.length;N++){const F=k[N];if(M.length>=3){for(let G=0;G<F.length;G++)if(ro(M,F[G]))return!0}if(of(M,F,B))return!0}return!1})(b,h,A)}isTileClipped(){return!0}}function Xa(a,t){return t>0?t+2*a:a}const gp=x([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),If=x([{name:"a_projected_pos",components:3,type:"Float32"}],4);x([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const kf=x([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);x([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ha=x([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Jn=x([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function uo(a,t,r){return a.sections.forEach((l=>{l.text=(function(h,m,g){const v=m.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Ra.applyArabicShaping&&(h=Ra.applyArabicShaping(h)),h})(l.text,t,r)})),a}x([{name:"triangle",components:3,type:"Uint16"}]),x([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),x([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),x([{type:"Float32",name:"offsetX"}]),x([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),x([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Mu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ma=24,Cd=ei,Rf=function(a,t,r,l,h){var m,g,v=8*h-l-1,b=(1<<v)-1,A=b>>1,z=-7,M=h-1,k=-1,B=a[t+M];for(M+=k,m=B&(1<<-z)-1,B>>=-z,z+=v;z>0;m=256*m+a[t+M],M+=k,z-=8);for(g=m&(1<<-z)-1,m>>=-z,z+=l;z>0;g=256*g+a[t+M],M+=k,z-=8);if(m===0)m=1-A;else{if(m===b)return g?NaN:1/0*(B?-1:1);g+=Math.pow(2,l),m-=A}return(B?-1:1)*g*Math.pow(2,m-l)},Ec=function(a,t,r,l,h,m){var g,v,b,A=8*m-h-1,z=(1<<A)-1,M=z>>1,k=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=0,N=1,F=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,g=z):(g=Math.floor(Math.log(t)/Math.LN2),t*(b=Math.pow(2,-g))<1&&(g--,b*=2),(t+=g+M>=1?k/b:k*Math.pow(2,1-M))*b>=2&&(g++,b/=2),g+M>=z?(v=0,g=z):g+M>=1?(v=(t*b-1)*Math.pow(2,h),g+=M):(v=t*Math.pow(2,M-1)*Math.pow(2,h),g=0));h>=8;a[r+B]=255&v,B+=N,v/=256,h-=8);for(g=g<<h|v,A+=h;A>0;a[r+B]=255&g,B+=N,g/=256,A-=8);a[r+B-N]|=128*F};function ei(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}ei.Varint=0,ei.Fixed64=1,ei.Bytes=2,ei.Fixed32=5;var gr=4294967296,Dd=1/gr,Bn=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Ss(a){return a.type===ei.Bytes?a.readVarint()+a.pos:a.pos+1}function Qn(a,t,r){return r?4294967296*t+(a>>>0):4294967296*(t>>>0)+(a>>>0)}function Ko(a,t,r){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(l);for(var h=r.pos-1;h>=a;h--)r.buf[h+l]=r.buf[h]}function co(a,t){for(var r=0;r<a.length;r++)t.writeVarint(a[r])}function Id(a,t){for(var r=0;r<a.length;r++)t.writeSVarint(a[r])}function kd(a,t){for(var r=0;r<a.length;r++)t.writeFloat(a[r])}function is(a,t){for(var r=0;r<a.length;r++)t.writeDouble(a[r])}function Lf(a,t){for(var r=0;r<a.length;r++)t.writeBoolean(a[r])}function Cu(a,t){for(var r=0;r<a.length;r++)t.writeFixed32(a[r])}function Mc(a,t){for(var r=0;r<a.length;r++)t.writeSFixed32(a[r])}function Cc(a,t){for(var r=0;r<a.length;r++)t.writeFixed64(a[r])}function Du(a,t){for(var r=0;r<a.length;r++)t.writeSFixed64(a[r])}function Dc(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+16777216*a[t+3]}function Il(a,t,r){a[r]=t,a[r+1]=t>>>8,a[r+2]=t>>>16,a[r+3]=t>>>24}function Iu(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+(a[t+3]<<24)}ei.prototype={destroy:function(){this.buf=null},readFields:function(a,t,r){for(r=r||this.length;this.pos<r;){var l=this.readVarint(),h=l>>3,m=this.pos;this.type=7&l,a(h,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(a,t){return this.readFields(a,t,this.readVarint()+this.pos)},readFixed32:function(){var a=Dc(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Iu(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Dc(this.buf,this.pos)+Dc(this.buf,this.pos+4)*gr;return this.pos+=8,a},readSFixed64:function(){var a=Dc(this.buf,this.pos)+Iu(this.buf,this.pos+4)*gr;return this.pos+=8,a},readFloat:function(){var a=Rf(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Rf(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var t,r,l=this.buf;return t=127&(r=l[this.pos++]),r<128?t:(t|=(127&(r=l[this.pos++]))<<7,r<128?t:(t|=(127&(r=l[this.pos++]))<<14,r<128?t:(t|=(127&(r=l[this.pos++]))<<21,r<128?t:(function(h,m,g){var v,b,A=g.buf;if(v=(112&(b=A[g.pos++]))>>4,b<128||(v|=(127&(b=A[g.pos++]))<<3,b<128)||(v|=(127&(b=A[g.pos++]))<<10,b<128)||(v|=(127&(b=A[g.pos++]))<<17,b<128)||(v|=(127&(b=A[g.pos++]))<<24,b<128)||(v|=(1&(b=A[g.pos++]))<<31,b<128))return Qn(h,v,m);throw new Error("Expected varint not more than 10 bytes")})(t|=(15&(r=l[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,t=this.pos;return this.pos=a,a-t>=12&&Bn?(function(r,l,h){return Bn.decode(r.subarray(l,h))})(this.buf,t,a):(function(r,l,h){for(var m="",g=l;g<h;){var v,b,A,z=r[g],M=null,k=z>239?4:z>223?3:z>191?2:1;if(g+k>h)break;k===1?z<128&&(M=z):k===2?(192&(v=r[g+1]))==128&&(M=(31&z)<<6|63&v)<=127&&(M=null):k===3?(b=r[g+2],(192&(v=r[g+1]))==128&&(192&b)==128&&((M=(15&z)<<12|(63&v)<<6|63&b)<=2047||M>=55296&&M<=57343)&&(M=null)):k===4&&(b=r[g+2],A=r[g+3],(192&(v=r[g+1]))==128&&(192&b)==128&&(192&A)==128&&((M=(15&z)<<18|(63&v)<<12|(63&b)<<6|63&A)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,k=1):M>65535&&(M-=65536,m+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),m+=String.fromCharCode(M),g+=k}return m})(this.buf,t,a)},readBytes:function(){var a=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,a);return this.pos=a,t},readPackedVarint:function(a,t){if(this.type!==ei.Bytes)return a.push(this.readVarint(t));var r=Ss(this);for(a=a||[];this.pos<r;)a.push(this.readVarint(t));return a},readPackedSVarint:function(a){if(this.type!==ei.Bytes)return a.push(this.readSVarint());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==ei.Bytes)return a.push(this.readBoolean());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==ei.Bytes)return a.push(this.readFloat());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==ei.Bytes)return a.push(this.readDouble());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==ei.Bytes)return a.push(this.readFixed32());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==ei.Bytes)return a.push(this.readSFixed32());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==ei.Bytes)return a.push(this.readFixed64());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==ei.Bytes)return a.push(this.readSFixed64());var t=Ss(this);for(a=a||[];this.pos<t;)a.push(this.readSFixed64());return a},skip:function(a){var t=7&a;if(t===ei.Varint)for(;this.buf[this.pos++]>127;);else if(t===ei.Bytes)this.pos=this.readVarint()+this.pos;else if(t===ei.Fixed32)this.pos+=4;else{if(t!==ei.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(a,t){this.writeVarint(a<<3|t)},realloc:function(a){for(var t=this.length||16;t<this.pos+a;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Il(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Il(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Il(this.buf,-1&a,this.pos),Il(this.buf,Math.floor(a*Dd),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Il(this.buf,-1&a,this.pos),Il(this.buf,Math.floor(a*Dd),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?(function(t,r){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),(function(m,g,v){v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,v.buf[v.pos]=127&(m>>>=7)})(l,0,r),(function(m,g){var v=(7&m)<<4;g.buf[g.pos++]|=v|((m>>>=3)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m)))))})(h,r)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var t=this.pos;this.pos=(function(l,h,m){for(var g,v,b=0;b<h.length;b++){if((g=h.charCodeAt(b))>55295&&g<57344){if(!v){g>56319||b+1===h.length?(l[m++]=239,l[m++]=191,l[m++]=189):v=g;continue}if(g<56320){l[m++]=239,l[m++]=191,l[m++]=189,v=g;continue}g=v-55296<<10|g-56320|65536,v=null}else v&&(l[m++]=239,l[m++]=191,l[m++]=189,v=null);g<128?l[m++]=g:(g<2048?l[m++]=g>>6|192:(g<65536?l[m++]=g>>12|224:(l[m++]=g>>18|240,l[m++]=g>>12&63|128),l[m++]=g>>6&63|128),l[m++]=63&g|128)}return m})(this.buf,a,this.pos);var r=this.pos-t;r>=128&&Ko(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(a){this.realloc(4),Ec(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Ec(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var t=a.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=a[r]},writeRawMessage:function(a,t){this.pos++;var r=this.pos;a(t,this);var l=this.pos-r;l>=128&&Ko(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeMessage:function(a,t,r){this.writeTag(a,ei.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(a,t){t.length&&this.writeMessage(a,co,t)},writePackedSVarint:function(a,t){t.length&&this.writeMessage(a,Id,t)},writePackedBoolean:function(a,t){t.length&&this.writeMessage(a,Lf,t)},writePackedFloat:function(a,t){t.length&&this.writeMessage(a,kd,t)},writePackedDouble:function(a,t){t.length&&this.writeMessage(a,is,t)},writePackedFixed32:function(a,t){t.length&&this.writeMessage(a,Cu,t)},writePackedSFixed32:function(a,t){t.length&&this.writeMessage(a,Mc,t)},writePackedFixed64:function(a,t){t.length&&this.writeMessage(a,Cc,t)},writePackedSFixed64:function(a,t){t.length&&this.writeMessage(a,Du,t)},writeBytesField:function(a,t){this.writeTag(a,ei.Bytes),this.writeBytes(t)},writeFixed32Field:function(a,t){this.writeTag(a,ei.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(a,t){this.writeTag(a,ei.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(a,t){this.writeTag(a,ei.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(a,t){this.writeTag(a,ei.Fixed64),this.writeSFixed64(t)},writeVarintField:function(a,t){this.writeTag(a,ei.Varint),this.writeVarint(t)},writeSVarintField:function(a,t){this.writeTag(a,ei.Varint),this.writeSVarint(t)},writeStringField:function(a,t){this.writeTag(a,ei.Bytes),this.writeString(t)},writeFloatField:function(a,t){this.writeTag(a,ei.Fixed32),this.writeFloat(t)},writeDoubleField:function(a,t){this.writeTag(a,ei.Fixed64),this.writeDouble(t)},writeBooleanField:function(a,t){this.writeVarintField(a,!!t)}};var Eh=Ue(Cd);const ku=3;function Bf(a,t,r){a===1&&r.readMessage(yp,t)}function yp(a,t,r){if(a===3){const{id:l,bitmap:h,width:m,height:g,left:v,top:b,advance:A}=r.readMessage(_p,{});t.push({id:l,bitmap:new gc({width:m+2*ku,height:g+2*ku},h),metrics:{width:m,height:g,left:v,top:b,advance:A}})}}function _p(a,t,r){a===1?t.id=r.readVarint():a===2?t.bitmap=r.readBytes():a===3?t.width=r.readVarint():a===4?t.height=r.readVarint():a===5?t.left=r.readSVarint():a===6?t.top=r.readSVarint():a===7&&(t.advance=r.readVarint())}const Di=ku;function Wi(a){let t=0,r=0;for(const g of a)t+=g.w*g.h,r=Math.max(r,g.w);a.sort(((g,v)=>v.h-g.h));const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let h=0,m=0;for(const g of a)for(let v=l.length-1;v>=0;v--){const b=l[v];if(!(g.w>b.w||g.h>b.h)){if(g.x=b.x,g.y=b.y,m=Math.max(m,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===b.w&&g.h===b.h){const A=l.pop();v<l.length&&(l[v]=A)}else g.h===b.h?(b.x+=g.w,b.w-=g.w):g.w===b.w?(b.y+=g.h,b.h-=g.h):(l.push({x:b.x+g.w,y:b.y,w:b.w-g.w,h:g.h}),b.y+=g.h,b.h-=g.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}const Nt=1;class di{constructor(t,{pixelRatio:r,version:l,stretchX:h,stretchY:m,content:g,textFitWidth:v,textFitHeight:b}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=h,this.stretchY=m,this.content=g,this.version=l,this.textFitWidth=v,this.textFitHeight=b}get tl(){return[this.paddedRect.x+Nt,this.paddedRect.y+Nt]}get br(){return[this.paddedRect.x+this.paddedRect.w-Nt,this.paddedRect.y+this.paddedRect.h-Nt]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Nt)/this.pixelRatio,(this.paddedRect.h-2*Nt)/this.pixelRatio]}}class Oi{constructor(t,r){const l={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,l,m),this.addImages(r,h,m);const{w:g,h:v}=Wi(m),b=new Kn({width:g||1,height:v||1});for(const A in t){const z=t[A],M=l[A].paddedRect;Kn.copy(z.data,b,{x:0,y:0},{x:M.x+Nt,y:M.y+Nt},z.data)}for(const A in r){const z=r[A],M=h[A].paddedRect,k=M.x+Nt,B=M.y+Nt,N=z.data.width,F=z.data.height;Kn.copy(z.data,b,{x:0,y:0},{x:k,y:B},z.data),Kn.copy(z.data,b,{x:0,y:F-1},{x:k,y:B-1},{width:N,height:1}),Kn.copy(z.data,b,{x:0,y:0},{x:k,y:B+F},{width:N,height:1}),Kn.copy(z.data,b,{x:N-1,y:0},{x:k-1,y:B},{width:1,height:F}),Kn.copy(z.data,b,{x:0,y:0},{x:k+N,y:B},{width:1,height:F})}this.image=b,this.iconPositions=l,this.patternPositions=h}addImages(t,r,l){for(const h in t){const m=t[h],g={x:0,y:0,w:m.data.width+2*Nt,h:m.data.height+2*Nt};l.push(g),r[h]=new di(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),r),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),r)}patchUpdatedImage(t,r,l){if(!t||!r||t.version===r.version)return;t.version=r.version;const[h,m]=t.tl;l.update(r.data,void 0,{x:h,y:m})}}var Ua;Be("ImagePosition",di),Be("ImageAtlas",Oi),O.ah=void 0,(Ua=O.ah||(O.ah={}))[Ua.none=0]="none",Ua[Ua.horizontal=1]="horizontal",Ua[Ua.vertical=2]="vertical",Ua[Ua.horizontalOnly=3]="horizontalOnly";const Pr=-17;class Ts{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const l=new Ts;return l.scale=t||1,l.fontStack=r,l}static forImage(t){const r=new Ts;return r.imageName=t,r}}class Jo{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const l=new Jo;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?l.addImageSection(m):l.addTextSection(m,r)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let r="";for(let l=0;l<t.length;l++){const h=t.charCodeAt(l+1)||null,m=t.charCodeAt(l-1)||null;r+=h&&Rr(h)&&!Mu[t[l+1]]||m&&Rr(m)&&!Mu[t[l-1]]||!Mu[t[l]]?t[l]:Mu[t[l]]}return r})(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&da[this.text.charCodeAt(l)];l++)t++;let r=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&da[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const l=new Jo;return l.text=this.text.substring(t,r),l.sectionIndex=this.sectionIndex.slice(t,r),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,r)=>Math.max(t,this.sections[r].scale)),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(Ts.forText(t.scale,t.fontStack||r));const l=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(l)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void Ti("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Ts.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Ti("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Or(a,t,r,l,h,m,g,v,b,A,z,M,k,B,N){const F=Jo.fromFeature(a,h);let G;M===O.ah.vertical&&F.verticalizePunctuation();const{processBidirectionalText:Y,processStyledBidirectionalText:he}=Ra;if(Y&&F.sections.length===1){G=[];const Se=Y(F.toString(),Ic(F,A,m,t,l,B));for(const Pe of Se){const Qe=new Jo;Qe.text=Pe,Qe.sections=F.sections;for(let St=0;St<Pe.length;St++)Qe.sectionIndex.push(0);G.push(Qe)}}else if(he){G=[];const Se=he(F.text,F.sectionIndex,Ic(F,A,m,t,l,B));for(const Pe of Se){const Qe=new Jo;Qe.text=Pe[0],Qe.sectionIndex=Pe[1],Qe.sections=F.sections,G.push(Qe)}}else G=(function(Se,Pe){const Qe=[],St=Se.text;let Ve=0;for(const Ke of Pe)Qe.push(Se.substring(Ve,Ke)),Ve=Ke;return Ve<St.length&&Qe.push(Se.substring(Ve,St.length)),Qe})(F,Ic(F,A,m,t,l,B));const ae=[],le={positionedLines:ae,text:F.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:M,iconsInText:!1,verticalizable:!1};return(function(Se,Pe,Qe,St,Ve,Ke,ct,rt,tt,Me,at,ut){let kt=0,fi=Pr,Bi=0,qa=0;const mn=rt==="right"?1:rt==="left"?0:.5;let Ya=0;for(const va of Ve){va.trim();const Ga=va.getMaxScale(),gn=(Ga-1)*Ma,Ka={positionedGlyphs:[],lineOffset:0};Se.positionedLines[Ya]=Ka;const Ba=Ka.positionedGlyphs;let Ca=0;if(!va.length()){fi+=Ke,++Ya;continue}for(let On=0;On<va.length();On++){const si=va.getSection(On),Mi=va.getSectionIndex(On),Yi=va.getCharCode(On);let yn=0,ta=null,nl=null,vr=null,ns=Ma;const xr=!(tt===O.ah.horizontal||!at&&!kr(Yi)||at&&(da[Yi]||(Za=Yi,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Za)))));if(si.imageName){const br=St[si.imageName];if(!br)continue;vr=si.imageName,Se.iconsInText=Se.iconsInText||!0,nl=br.paddedRect;const Ha=br.displaySize;si.scale=si.scale*Ma/ut,ta={width:Ha[0],height:Ha[1],left:Nt,top:-Di,advance:xr?Ha[1]:Ha[0]},yn=gn+(Ma-Ha[1]*si.scale),ns=ta.advance;const fo=xr?Ha[0]*si.scale-Ma*Ga:Ha[1]*si.scale-Ma*Ga;fo>0&&fo>Ca&&(Ca=fo)}else{const br=Qe[si.fontStack],Ha=br&&br[Yi];if(Ha&&Ha.rect)nl=Ha.rect,ta=Ha.metrics;else{const fo=Pe[si.fontStack],Nl=fo&&fo[Yi];if(!Nl)continue;ta=Nl.metrics}yn=(Ga-si.scale)*Ma}xr?(Se.verticalizable=!0,Ba.push({glyph:Yi,imageName:vr,x:kt,y:fi+yn,vertical:xr,scale:si.scale,fontStack:si.fontStack,sectionIndex:Mi,metrics:ta,rect:nl}),kt+=ns*si.scale+Me):(Ba.push({glyph:Yi,imageName:vr,x:kt,y:fi+yn,vertical:xr,scale:si.scale,fontStack:si.fontStack,sectionIndex:Mi,metrics:ta,rect:nl}),kt+=ta.advance*si.scale+Me)}Ba.length!==0&&(Bi=Math.max(kt-Me,Bi),Pf(Ba,0,Ba.length-1,mn,Ca)),kt=0;const er=Ke*Ga+Ca;Ka.lineOffset=Math.max(Ca,gn),fi+=er,qa=Math.max(er,qa),++Ya}var Za;const Mn=fi-Pr,{horizontalAlign:Cn,verticalAlign:Dn}=Bu(ct);(function(va,Ga,gn,Ka,Ba,Ca,er,On,si){const Mi=(Ga-gn)*Ba;let Yi=0;Yi=Ca!==er?-On*Ka-Pr:(-Ka*si+.5)*er;for(const yn of va)for(const ta of yn.positionedGlyphs)ta.x+=Mi,ta.y+=Yi})(Se.positionedLines,mn,Cn,Dn,Bi,qa,Ke,Mn,Ve.length),Se.top+=-Dn*Mn,Se.bottom=Se.top+Mn,Se.left+=-Cn*Bi,Se.right=Se.left+Bi})(le,t,r,l,G,g,v,b,M,A,k,N),!(function(Se){for(const Pe of Se)if(Pe.positionedGlyphs.length!==0)return!1;return!0})(ae)&&le}const da={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Qo={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},kl={40:!0};function Mh(a,t,r,l,h,m){if(t.imageName){const g=l[t.imageName];return g?g.displaySize[0]*t.scale*Ma/m+h:0}{const g=r[t.fontStack],v=g&&g[a];return v?v.metrics.advance*t.scale+h:0}}function Wn(a,t,r,l){const h=Math.pow(a-t,2);return l?a<t?h/2:2*h:h+Math.abs(r)*r}function Ru(a,t,r){let l=0;return a===10&&(l-=1e4),r&&(l+=150),a!==40&&a!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Lu(a,t,r,l,h,m){let g=null,v=Wn(t,r,h,m);for(const b of l){const A=Wn(t-b.x,r,h,m)+b.badness;A<=v&&(g=b,v=A)}return{index:a,x:t,priorBreak:g,badness:v}}function Pn(a){return a?Pn(a.priorBreak).concat(a.index):[]}function Ic(a,t,r,l,h,m){if(!a)return[];const g=[],v=(function(M,k,B,N,F,G){let Y=0;for(let he=0;he<M.length();he++){const ae=M.getSection(he);Y+=Mh(M.getCharCode(he),ae,N,F,k,G)}return Y/Math.max(1,Math.ceil(Y/B))})(a,t,r,l,h,m),b=a.text.indexOf("")>=0;let A=0;for(let M=0;M<a.length();M++){const k=a.getSection(M),B=a.getCharCode(M);if(da[B]||(A+=Mh(B,k,l,h,t,m)),M<a.length()-1){const N=!((z=B)<11904)&&(!!$t["CJK Compatibility Forms"](z)||!!$t["CJK Compatibility"](z)||!!$t["CJK Strokes"](z)||!!$t["CJK Symbols and Punctuation"](z)||!!$t["Enclosed CJK Letters and Months"](z)||!!$t["Halfwidth and Fullwidth Forms"](z)||!!$t["Ideographic Description Characters"](z)||!!$t["Vertical Forms"](z)||Ir.test(String.fromCodePoint(z)));(Qo[B]||N||k.imageName||M!==a.length()-2&&kl[a.getCharCode(M+1)])&&g.push(Lu(M+1,A,v,g,Ru(B,a.getCharCode(M+1),N&&b),!1))}}var z;return Pn(Lu(a.length(),A,v,g,0,!0))}function Bu(a){let t=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Pf(a,t,r,l,h){if(!l&&!h)return;const m=a[r],g=(a[r].x+m.metrics.advance*m.scale)*l;for(let v=t;v<=r;v++)a[v].x-=g,a[v].y+=h}function Ch(a,t,r){const{horizontalAlign:l,verticalAlign:h}=Bu(r),m=t[0]-a.displaySize[0]*l,g=t[1]-a.displaySize[1]*h;return{image:a,top:g,bottom:g+a.displaySize[1],left:m,right:m+a.displaySize[0]}}function kc(a){var t,r;let l=a.left,h=a.top,m=a.right-l,g=a.bottom-h;const v=(t=a.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",b=(r=a.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",A=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(b==="proportional"){if(v==="stretchOnly"&&m/g<A||v==="proportional"){const z=Math.ceil(g*A);l*=z/m,m=z}}else if(v==="proportional"&&b==="stretchOnly"&&A!==0&&m/g>A){const z=Math.ceil(m/A);h*=z/g,g=z}return{x1:l,y1:h,x2:l+m,y2:h+g}}function ho(a,t,r,l,h,m){const g=a.image;let v;if(g.content){const G=g.content,Y=g.pixelRatio||1;v=[G[0]/Y,G[1]/Y,g.displaySize[0]-G[2]/Y,g.displaySize[1]-G[3]/Y]}const b=t.left*m,A=t.right*m;let z,M,k,B;r==="width"||r==="both"?(B=h[0]+b-l[3],M=h[0]+A+l[1]):(B=h[0]+(b+A-g.displaySize[0])/2,M=B+g.displaySize[0]);const N=t.top*m,F=t.bottom*m;return r==="height"||r==="both"?(z=h[1]+N-l[0],k=h[1]+F+l[2]):(z=h[1]+(N+F-g.displaySize[1])/2,k=z+g.displaySize[1]),{image:g,top:z,right:M,bottom:k,left:B,collisionPadding:v}}const Sa=255,pn=128,yr=Sa*pn;function As(a,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Qt(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=r;let m=0;for(;m<l.length&&l[m]<=a;)m++;m=Math.max(0,m-1);let g=m;for(;g<l.length&&l[g]<a+1;)g++;g=Math.min(l.length-1,g);const v=l[m],b=l[g];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:b,minSize:r.evaluate(new Qt(v)),maxSize:r.evaluate(new Qt(b)),interpolationType:h}}}function Rc(a,t,r){let l="never";const h=a.get(t);return h?l=h:a.get(r)&&(l="always"),l}const Rd=oo.VectorTileFeature.types,Of=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Wo(a,t,r,l,h,m,g,v,b,A,z,M,k){const B=v?Math.min(yr,Math.round(v[0])):0,N=v?Math.min(yr,Math.round(v[1])):0;a.emplaceBack(t,r,Math.round(32*l),Math.round(32*h),m,g,(B<<1)+(b?1:0),N,16*A,16*z,256*M,256*k)}function Lc(a,t,r){a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r)}function _r(a){for(const t of a.sections)if(mu(t.text))return!0;return!1}class Dh{constructor(t){this.layoutVertexArray=new to,this.indexArray=new An,this.programConfigurations=t,this.segments=new Wt,this.dynamicLayoutVertexArray=new mr,this.opacityVertexArray=new Rt,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ci}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gp.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,If.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Of,!0),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Be("SymbolBuffers",Dh);class zn{constructor(t,r,l){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new l,this.segments=new Wt,this.collisionVertexArray=new Xi}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,kf.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Be("CollisionBuffers",zn);class Rl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((g=>g.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=gh([]),this.placementViewportMatrix=gh([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=As(this.zoom,r["text-size"]),this.iconSizeData=As(this.zoom,r["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=Rc(l,"text-overlap","text-allow-overlap")!=="never"||Rc(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map((g=>O.ah[g]))),this.stateDependentLayerIds=this.layers.filter((g=>g.isStateDependent())).map((g=>g.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Dh(new qo(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Dh(new qo(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new Ei,this.lineVertexArray=new La,this.symbolInstances=new ii,this.textAnchorOffsets=new Pi}calculateGlyphDependencies(t,r,l,h,m){for(let g=0;g<t.length;g++)if(r[t.charCodeAt(g)]=!0,(l||h)&&m){const v=Mu[t.charAt(g)];v&&(r[v.charCodeAt(0)]=!0)}}populate(t,r,l){const h=this.layers[0],m=h.layout,g=m.get("text-font"),v=m.get("text-field"),b=m.get("icon-image"),A=(v.value.kind!=="constant"||v.value.value instanceof vn&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),z=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,M=m.get("symbol-sort-key");if(this.features=[],!A&&!z)return;const k=r.iconDependencies,B=r.glyphDependencies,N=r.availableImages,F=new Qt(this.zoom);for(const{feature:G,id:Y,index:he,sourceLayerIndex:ae}of t){const le=h._featureFilter.needGeometry,Se=Go(G,le);if(!h._featureFilter.filter(F,Se,l))continue;let Pe,Qe;if(le||(Se.geometry=Zo(G)),A){const Ve=h.getValueAndResolveTokens("text-field",Se,l,N),Ke=vn.factory(Ve),ct=this.hasRTLText=this.hasRTLText||_r(Ke);(!ct||Ra.getRTLTextPluginStatus()==="unavailable"||ct&&Ra.isParsed())&&(Pe=uo(Ke,h,Se))}if(z){const Ve=h.getValueAndResolveTokens("icon-image",Se,l,N);Qe=Ve instanceof xn?Ve:xn.fromString(Ve)}if(!Pe&&!Qe)continue;const St=this.sortFeaturesByKey?M.evaluate(Se,{},l):void 0;if(this.features.push({id:Y,text:Pe,icon:Qe,index:he,sourceLayerIndex:ae,geometry:Se.geometry,properties:G.properties,type:Rd[G.type],sortKey:St}),Qe&&(k[Qe.name]=!0),Pe){const Ve=g.evaluate(Se,{},l).join(","),Ke=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(O.ah.vertical)>=0;for(const ct of Pe.sections)if(ct.image)k[ct.image.name]=!0;else{const rt=Kr(Pe.toString()),tt=ct.fontStack||Ve,Me=B[tt]=B[tt]||{};this.calculateGlyphDependencies(ct.text,Me,Ke,this.allowVerticalPlacement,rt)}}}m.get("symbol-placement")==="line"&&(this.features=(function(G){const Y={},he={},ae=[];let le=0;function Se(Ve){ae.push(G[Ve]),le++}function Pe(Ve,Ke,ct){const rt=he[Ve];return delete he[Ve],he[Ke]=rt,ae[rt].geometry[0].pop(),ae[rt].geometry[0]=ae[rt].geometry[0].concat(ct[0]),rt}function Qe(Ve,Ke,ct){const rt=Y[Ke];return delete Y[Ke],Y[Ve]=rt,ae[rt].geometry[0].shift(),ae[rt].geometry[0]=ct[0].concat(ae[rt].geometry[0]),rt}function St(Ve,Ke,ct){const rt=ct?Ke[0][Ke[0].length-1]:Ke[0][0];return`${Ve}:${rt.x}:${rt.y}`}for(let Ve=0;Ve<G.length;Ve++){const Ke=G[Ve],ct=Ke.geometry,rt=Ke.text?Ke.text.toString():null;if(!rt){Se(Ve);continue}const tt=St(rt,ct),Me=St(rt,ct,!0);if(tt in he&&Me in Y&&he[tt]!==Y[Me]){const at=Qe(tt,Me,ct),ut=Pe(tt,Me,ae[at].geometry);delete Y[tt],delete he[Me],he[St(rt,ae[ut].geometry,!0)]=ut,ae[at].geometry=null}else tt in he?Pe(tt,Me,ct):Me in Y?Qe(tt,Me,ct):(Se(Ve),Y[tt]=le-1,he[Me]=le-1)}return ae.filter((Ve=>Ve.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((G,Y)=>G.sortKey-Y.sortKey))}update(t,r,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const l=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(r[t.segment+1]),m=t.dist(r[t.segment]);const g={};for(let v=t.segment+1;v<r.length;v++)g[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:h},v<r.length-1&&(h+=r[v+1].dist(r[v]));for(let v=t.segment||0;v>=0;v--)g[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=r[v-1].dist(r[v]));for(let v=0;v<r.length;v++){const b=g[v];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,r,l,h,m,g,v,b,A,z,M,k){const B=t.indexArray,N=t.layoutVertexArray,F=t.segments.prepareSegment(4*r.length,N,B,this.canOverlap?g.sortKey:void 0),G=this.glyphOffsetArray.length,Y=F.vertexLength,he=this.allowVerticalPlacement&&v===O.ah.vertical?Math.PI/2:0,ae=g.text&&g.text.sections;for(let le=0;le<r.length;le++){const{tl:Se,tr:Pe,bl:Qe,br:St,tex:Ve,pixelOffsetTL:Ke,pixelOffsetBR:ct,minFontScaleX:rt,minFontScaleY:tt,glyphOffset:Me,isSDF:at,sectionIndex:ut}=r[le],kt=F.vertexLength,fi=Me[1];Wo(N,b.x,b.y,Se.x,fi+Se.y,Ve.x,Ve.y,l,at,Ke.x,Ke.y,rt,tt),Wo(N,b.x,b.y,Pe.x,fi+Pe.y,Ve.x+Ve.w,Ve.y,l,at,ct.x,Ke.y,rt,tt),Wo(N,b.x,b.y,Qe.x,fi+Qe.y,Ve.x,Ve.y+Ve.h,l,at,Ke.x,ct.y,rt,tt),Wo(N,b.x,b.y,St.x,fi+St.y,Ve.x+Ve.w,Ve.y+Ve.h,l,at,ct.x,ct.y,rt,tt),Lc(t.dynamicLayoutVertexArray,b,he),B.emplaceBack(kt,kt+1,kt+2),B.emplaceBack(kt+1,kt+2,kt+3),F.vertexLength+=4,F.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Me[0]),le!==r.length-1&&ut===r[le+1].sectionIndex||t.programConfigurations.populatePaintArrays(N.length,g,g.index,{},k,ae&&ae[ut])}t.placedSymbolArray.emplaceBack(b.x,b.y,G,this.glyphOffsetArray.length-G,Y,A,z,b.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],v,0,!1,0,M)}_addCollisionDebugVertex(t,r,l,h,m,g){return r.emplaceBack(0,0),t.emplaceBack(l.x,l.y,h,m,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,r,l,h,m,g,v){const b=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),A=b.vertexLength,z=m.layoutVertexArray,M=m.collisionVertexArray,k=v.anchorX,B=v.anchorY;this._addCollisionDebugVertex(z,M,g,k,B,new me(t,r)),this._addCollisionDebugVertex(z,M,g,k,B,new me(l,r)),this._addCollisionDebugVertex(z,M,g,k,B,new me(l,h)),this._addCollisionDebugVertex(z,M,g,k,B,new me(t,h)),b.vertexLength+=4;const N=m.indexArray;N.emplaceBack(A,A+1),N.emplaceBack(A+1,A+2),N.emplaceBack(A+2,A+3),N.emplaceBack(A+3,A),b.primitiveLength+=4}addDebugCollisionBoxes(t,r,l,h){for(let m=t;m<r;m++){const g=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,h?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zn(ri,ha.members,ya),this.iconCollisionBox=new zn(ri,ha.members,ya);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,l,h,m,g,v,b,A){const z={};for(let M=r;M<l;M++){const k=t.get(M);z.textBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY},z.textFeatureIndex=k.featureIndex;break}for(let M=h;M<m;M++){const k=t.get(M);z.verticalTextBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY},z.verticalTextFeatureIndex=k.featureIndex;break}for(let M=g;M<v;M++){const k=t.get(M);z.iconBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY},z.iconFeatureIndex=k.featureIndex;break}for(let M=b;M<A;M++){const k=t.get(M);z.verticalIconBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY},z.verticalIconFeatureIndex=k.featureIndex;break}return z}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const l=t.placedSymbolArray.get(r),h=l.vertexStartIndex+4*l.numGlyphs;for(let m=l.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),l=Math.cos(t),h=[],m=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const b=this.symbolInstances.get(v);h.push(0|Math.round(r*b.anchorX+l*b.anchorY)),m.push(b.featureIndex)}return g.sort(((v,b)=>h[v]-h[b]||m[b]-m[v])),g}addToSortKeyRanges(t,r){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===r?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const l=this.symbolInstances.get(r);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach(((h,m,g)=>{h>=0&&g.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)})),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Ld,Nf;Be("SymbolBucket",Rl,{omit:["layers","collisionBoxArray","features","compareText"]}),Rl.MAX_GLYPHS=65535,Rl.addDynamicAttributes=Lc;var zs={get paint(){return Nf=Nf||new p({"icon-opacity":new wt(xe.paint_symbol["icon-opacity"]),"icon-color":new wt(xe.paint_symbol["icon-color"]),"icon-halo-color":new wt(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new wt(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new wt(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new st(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new st(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new wt(xe.paint_symbol["text-opacity"]),"text-color":new wt(xe.paint_symbol["text-color"],{runtimeType:Ki,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new wt(xe.paint_symbol["text-halo-color"]),"text-halo-width":new wt(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new wt(xe.paint_symbol["text-halo-blur"]),"text-translate":new st(xe.paint_symbol["text-translate"]),"text-translate-anchor":new st(xe.paint_symbol["text-translate-anchor"])})},get layout(){return Ld=Ld||new p({"symbol-placement":new st(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new st(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new st(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new wt(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new st(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new st(xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new st(xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new st(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new st(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new st(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new wt(xe.layout_symbol["icon-size"]),"icon-text-fit":new st(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new st(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new wt(xe.layout_symbol["icon-image"]),"icon-rotate":new wt(xe.layout_symbol["icon-rotate"]),"icon-padding":new wt(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new st(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new wt(xe.layout_symbol["icon-offset"]),"icon-anchor":new wt(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new st(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new st(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new st(xe.layout_symbol["text-rotation-alignment"]),"text-field":new wt(xe.layout_symbol["text-field"]),"text-font":new wt(xe.layout_symbol["text-font"]),"text-size":new wt(xe.layout_symbol["text-size"]),"text-max-width":new wt(xe.layout_symbol["text-max-width"]),"text-line-height":new st(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new wt(xe.layout_symbol["text-letter-spacing"]),"text-justify":new wt(xe.layout_symbol["text-justify"]),"text-radial-offset":new wt(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new st(xe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new wt(xe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new wt(xe.layout_symbol["text-anchor"]),"text-max-angle":new st(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new st(xe.layout_symbol["text-writing-mode"]),"text-rotate":new wt(xe.layout_symbol["text-rotate"]),"text-padding":new st(xe.layout_symbol["text-padding"]),"text-keep-upright":new st(xe.layout_symbol["text-keep-upright"]),"text-transform":new wt(xe.layout_symbol["text-transform"]),"text-offset":new wt(xe.layout_symbol["text-offset"]),"text-allow-overlap":new st(xe.layout_symbol["text-allow-overlap"]),"text-overlap":new st(xe.layout_symbol["text-overlap"]),"text-ignore-placement":new st(xe.layout_symbol["text-ignore-placement"]),"text-optional":new st(xe.layout_symbol["text-optional"])})}};class Bc{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:us,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Be("FormatSectionOverride",Bc,{omit:["defaultValue"]});class Pu extends s{constructor(t){super(t,zs)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const m of l)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,l,h){const m=this.layout.get(t).evaluate(r,{},l,h),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||Io(g.value)||!m?m:(function(v,b){return b.replace(/{([^{}]+)}/g,((A,z)=>v&&z in v?String(v[z]):""))})(r.properties,m)}createBucket(t){return new Rl(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of zs.paint.overridableProperties){if(!Pu.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),l=new Bc(r),h=new ms(l,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new qn("source",h):new hr("composite",h,r.value.zoomStops),this.paint._values[t]=new Hn(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,l){return!(!this.layout||r.isDataDriven()||l.isDataDriven())&&Pu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const l=t.get("text-field"),h=zs.paint.properties[r];let m=!1;const g=v=>{for(const b of v)if(h.overrides&&h.overrides.hasOverride(b))return void(m=!0)};if(l.value.kind==="constant"&&l.value.value instanceof vn)g(l.value.value.sections);else if(l.value.kind==="source"){const v=A=>{m||(A instanceof Ia&&sa(A.value)===jn?g(A.value.sections):A instanceof Ps?g(A.sections):A.eachChild(v))},b=l.value;b._styleExpression&&v(b._styleExpression.expression)}return m}}let Ll;var Ff={get paint(){return Ll=Ll||new p({"background-color":new st(xe.paint_background["background-color"]),"background-pattern":new es(xe.paint_background["background-pattern"]),"background-opacity":new st(xe.paint_background["background-opacity"])})}};class jf extends s{constructor(t){super(t,Ff)}}let Bd;var Uf={get paint(){return Bd=Bd||new p({"raster-opacity":new st(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new st(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new st(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new st(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new st(xe.paint_raster["raster-saturation"]),"raster-contrast":new st(xe.paint_raster["raster-contrast"]),"raster-resampling":new st(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new st(xe.paint_raster["raster-fade-duration"])})}};class Ih extends s{constructor(t){super(t,Uf)}}class Pd extends s{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class vp{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Od=63710088e-1;class el{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new el(Zt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,l=this.lat*r,h=t.lat*r,m=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*r);return Od*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof el)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new el(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new el(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Nd=2*Math.PI*Od;function Fd(a){return Nd*Math.cos(a*Math.PI/180)}function Bl(a){return(180+a)/360}function Pc(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function jd(a,t){return a/Fd(t)}function kh(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class Ou{constructor(t,r,l=0){this.x=+t,this.y=+r,this.z=+l}static fromLngLat(t,r=0){const l=el.convert(t);return new Ou(Bl(l.lng),Pc(l.lat),jd(r,l.lat))}toLngLat(){return new el(360*this.x-180,kh(this.y))}toAltitude(){return this.z*Fd(kh(this.y))}meterInMercatorCoordinateUnits(){return 1/Nd*(t=kh(this.y),1/Math.cos(t*Math.PI/180));var t}}function Ud(a,t,r){var l=2*Math.PI*6378137/256/Math.pow(2,r);return[a*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class Rh{constructor(t,r,l){if(!(function(h,m,g){return!(h<0||h>25||g<0||g>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))})(t,r,l))throw new Error(`x=${r}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=l,this.key=Nu(0,t,t,r,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,l){const h=(g=this.y,v=this.z,b=Ud(256*(m=this.x),256*(g=Math.pow(2,v)-g-1),v),A=Ud(256*(m+1),256*(g+1),v),b[0]+","+b[1]+","+A[0]+","+A[1]);var m,g,v,b,A;const z=(function(M,k,B){let N,F="";for(let G=M;G>0;G--)N=1<<G-1,F+=(k&N?1:0)+(B&N?2:0);return F})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new me((t.x*r-this.x)*ba,(t.y*r-this.y)*ba)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Vd{constructor(t,r){this.wrap=t,this.canonical=r,this.key=Nu(t,r.z,r.z,r.x,r.y)}}class En{constructor(t,r,l,h,m){if(t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=r,this.canonical=new Rh(l,+h,+m),this.key=Nu(r,t,l,h,m)}clone(){return new En(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new En(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new En(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?Nu(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Nu(this.wrap*+r,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new En(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new En(r,this.wrap,r,l,h),new En(r,this.wrap,r,l+1,h),new En(r,this.wrap,r,l,h+1),new En(r,this.wrap,r,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new En(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new En(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Ou(t.x-this.wrap,t.y))}}function Nu(a,t,r,l,h){(a*=2)<0&&(a=-1*a-1);const m=1<<r;return(m*m*a+m*h+l).toString(36)+r.toString(36)+t.toString(36)}Be("CanonicalTileID",Rh),Be("OverscaledTileID",En,{omit:["posMatrix"]});class qd{constructor(t,r,l,h=1,m=1,g=1,v=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Ti(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const b=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=g,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let A=0;A<b;A++)this.data[this._idx(-1,A)]=this.data[this._idx(0,A)],this.data[this._idx(b,A)]=this.data[this._idx(b-1,A)],this.data[this._idx(A,-1)]=this.data[this._idx(A,0)],this.data[this._idx(A,b)]=this.data[this._idx(A,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let A=0;A<b;A++)for(let z=0;z<b;z++){const M=this.get(A,z);M>this.max&&(this.max=M),M<this.min&&(this.min=M)}}get(t,r){const l=new Uint8Array(this.data.buffer),h=4*this._idx(t,r);return this.unpack(l[h],l[h+1],l[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,l){return t*this.redFactor+r*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Kn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,m=r*this.dim+this.dim,g=l*this.dim,v=l*this.dim+this.dim;switch(r){case-1:h=m-1;break;case 1:m=h+1}switch(l){case-1:g=v-1;break;case 1:v=g+1}const b=-r*this.dim,A=-l*this.dim;for(let z=g;z<v;z++)for(let M=h;M<m;M++)this.data[this._idx(M,z)]=t.data[this._idx(M+b,z+A)]}}Be("DEMData",qd);class Ni{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const l=t[r];this._stringToNumber[l]=r,this._numberToString[r]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Lh{constructor(t,r,l,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=l,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class Vf{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ma(ba,16,0),this.grid3D=new ma(ba,16,0),this.featureIndexArray=new Gi,this.promoteId=r}insert(t,r,l,h,m,g){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,m);const b=g?this.grid3D:this.grid;for(let A=0;A<r.length;A++){const z=r[A],M=[1/0,1/0,-1/0,-1/0];for(let k=0;k<z.length;k++){const B=z[k];M[0]=Math.min(M[0],B.x),M[1]=Math.min(M[1],B.y),M[2]=Math.max(M[2],B.x),M[3]=Math.max(M[3],B.y)}M[0]<ba&&M[1]<ba&&M[2]>=0&&M[3]>=0&&b.insert(v,M[0],M[1],M[2],M[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new oo.VectorTile(new Eh(this.rawTileData)).layers,this.sourceLayerCoder=new Ni(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,l,h){this.loadVTLayers();const m=t.params||{},g=ba/t.tileSize/t.scale,v=ru(m.filter),b=t.queryGeometry,A=t.queryPadding*g,z=qf(b),M=this.grid.query(z.minX-A,z.minY-A,z.maxX+A,z.maxY+A),k=qf(t.cameraQueryGeometry),B=this.grid3D.query(k.minX-A,k.minY-A,k.maxX+A,k.maxY+A,((G,Y,he,ae)=>(function(le,Se,Pe,Qe,St){for(const Ke of le)if(Se<=Ke.x&&Pe<=Ke.y&&Qe>=Ke.x&&St>=Ke.y)return!0;const Ve=[new me(Se,Pe),new me(Se,St),new me(Qe,St),new me(Qe,Pe)];if(le.length>2){for(const Ke of Ve)if(ro(le,Ke))return!0}for(let Ke=0;Ke<le.length-1;Ke++)if(uf(le[Ke],le[Ke+1],Ve))return!0;return!1})(t.cameraQueryGeometry,G-A,Y-A,he+A,ae+A)));for(const G of B)M.push(G);M.sort(xp);const N={};let F;for(let G=0;G<M.length;G++){const Y=M[G];if(Y===F)continue;F=Y;const he=this.featureIndexArray.get(Y);let ae=null;this.loadMatchingFeature(N,he.bucketIndex,he.sourceLayerIndex,he.featureIndex,v,m.layers,m.availableImages,r,l,h,((le,Se,Pe)=>(ae||(ae=Zo(le)),Se.queryIntersectsFeature(b,le,Pe,ae,this.z,t.transform,g,t.pixelPosMatrix))))}return N}loadMatchingFeature(t,r,l,h,m,g,v,b,A,z,M){const k=this.bucketLayerIDs[r];if(g&&!(function(G,Y){for(let he=0;he<G.length;he++)if(Y.indexOf(G[he])>=0)return!0;return!1})(g,k))return;const B=this.sourceLayerCoder.decode(l),N=this.vtLayers[B].feature(h);if(m.needGeometry){const G=Go(N,!0);if(!m.filter(new Qt(this.tileID.overscaledZ),G,this.tileID.canonical))return}else if(!m.filter(new Qt(this.tileID.overscaledZ),N))return;const F=this.getId(N,B);for(let G=0;G<k.length;G++){const Y=k[G];if(g&&g.indexOf(Y)<0)continue;const he=b[Y];if(!he)continue;let ae={};F&&z&&(ae=z.getState(he.sourceLayer||"_geojsonTileLayer",F));const le=ot({},A[Y]);le.paint=Zd(le.paint,he.paint,N,ae,v),le.layout=Zd(le.layout,he.layout,N,ae,v);const Se=!M||M(N,he,ae);if(!Se)continue;const Pe=new Lh(N,this.z,this.x,this.y,F);Pe.layer=le;let Qe=t[Y];Qe===void 0&&(Qe=t[Y]=[]),Qe.push({featureIndex:h,feature:Pe,intersectionZ:Se})}}lookupSymbolFeatures(t,r,l,h,m,g,v,b){const A={};this.loadVTLayers();const z=ru(m);for(const M of t)this.loadMatchingFeature(A,l,h,M,z,g,v,b,r);return A}hasLayer(t){for(const r of this.bucketLayerIDs)for(const l of r)if(t===l)return!0;return!1}getId(t,r){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof l=="boolean"&&(l=Number(l))),l}}function Zd(a,t,r,l,h){return vi(a,((m,g)=>{const v=t instanceof Qr?t.get(g):null;return v&&v.evaluate?v.evaluate(r,l,h):v}))}function qf(a){let t=1/0,r=1/0,l=-1/0,h=-1/0;for(const m of a)t=Math.min(t,m.x),r=Math.min(r,m.y),l=Math.max(l,m.x),h=Math.max(h,m.y);return{minX:t,minY:r,maxX:l,maxY:h}}function xp(a,t){return t-a}function Zf(a,t,r,l,h){const m=[];for(let g=0;g<a.length;g++){const v=a[g];let b;for(let A=0;A<v.length-1;A++){let z=v[A],M=v[A+1];z.x<t&&M.x<t||(z.x<t?z=new me(t,z.y+(t-z.x)/(M.x-z.x)*(M.y-z.y))._round():M.x<t&&(M=new me(t,z.y+(t-z.x)/(M.x-z.x)*(M.y-z.y))._round()),z.y<r&&M.y<r||(z.y<r?z=new me(z.x+(r-z.y)/(M.y-z.y)*(M.x-z.x),r)._round():M.y<r&&(M=new me(z.x+(r-z.y)/(M.y-z.y)*(M.x-z.x),r)._round()),z.x>=l&&M.x>=l||(z.x>=l?z=new me(l,z.y+(l-z.x)/(M.x-z.x)*(M.y-z.y))._round():M.x>=l&&(M=new me(l,z.y+(l-z.x)/(M.x-z.x)*(M.y-z.y))._round()),z.y>=h&&M.y>=h||(z.y>=h?z=new me(z.x+(h-z.y)/(M.y-z.y)*(M.x-z.x),h)._round():M.y>=h&&(M=new me(z.x+(h-z.y)/(M.y-z.y)*(M.x-z.x),h)._round()),b&&z.equals(b[b.length-1])||(b=[z],m.push(b)),b.push(M)))))}}return m}Be("FeatureIndex",Vf,{omit:["rawTileData","sourceLayerCoder"]});class as extends me{constructor(t,r,l,h){super(t,r),this.angle=l,h!==void 0&&(this.segment=h)}clone(){return new as(this.x,this.y,this.angle,this.segment)}}function Pl(a,t,r,l,h){if(t.segment===void 0||r===0)return!0;let m=t,g=t.segment+1,v=0;for(;v>-r/2;){if(g--,g<0)return!1;v-=a[g].dist(m),m=a[g]}v+=a[g].dist(a[g+1]),g++;const b=[];let A=0;for(;v<r/2;){const z=a[g],M=a[g+1];if(!M)return!1;let k=a[g-1].angleTo(z)-z.angleTo(M);for(k=Math.abs((k+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:k}),A+=k;v-b[0].distance>l;)A-=b.shift().angleDelta;if(A>h)return!1;g++,v+=z.dist(M)}return!0}function Bh(a){let t=0;for(let r=0;r<a.length-1;r++)t+=a[r].dist(a[r+1]);return t}function Oc(a,t,r){return a?.6*t*r:0}function Ph(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function tl(a,t,r,l,h,m){const g=Oc(r,h,m),v=Ph(r,l)*m;let b=0;const A=Bh(a)/2;for(let z=0;z<a.length-1;z++){const M=a[z],k=a[z+1],B=M.dist(k);if(b+B>A){const N=(A-b)/B,F=Qa.number(M.x,k.x,N),G=Qa.number(M.y,k.y,N),Y=new as(F,G,k.angleTo(M),z);return Y._round(),!g||Pl(a,Y,v,g,t)?Y:void 0}b+=B}}function Es(a,t,r,l,h,m,g,v,b){const A=Oc(l,m,g),z=Ph(l,h),M=z*g,k=a[0].x===0||a[0].x===b||a[0].y===0||a[0].y===b;return t-M<t/4&&(t=M+t/4),Fu(a,k?t/2*v%t:(z/2+2*m)*g*v%t,t,A,r,M,k,!1,b)}function Fu(a,t,r,l,h,m,g,v,b){const A=m/2,z=Bh(a);let M=0,k=t-r,B=[];for(let N=0;N<a.length-1;N++){const F=a[N],G=a[N+1],Y=F.dist(G),he=G.angleTo(F);for(;k+r<M+Y;){k+=r;const ae=(k-M)/Y,le=Qa.number(F.x,G.x,ae),Se=Qa.number(F.y,G.y,ae);if(le>=0&&le<b&&Se>=0&&Se<b&&k-A>=0&&k+A<=z){const Pe=new as(le,Se,he,N);Pe._round(),l&&!Pl(a,Pe,m,l,h)||B.push(Pe)}}M+=Y}return v||B.length||g||(B=Fu(a,M/2,r,l,h,m,g,!0,b)),B}Be("Anchor",as);const ju=Nt;function Gd(a,t,r,l){const h=[],m=a.image,g=m.pixelRatio,v=m.paddedRect.w-2*ju,b=m.paddedRect.h-2*ju;let A={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const z=m.stretchX||[[0,v]],M=m.stretchY||[[0,b]],k=(Me,at)=>Me+at[1]-at[0],B=z.reduce(k,0),N=M.reduce(k,0),F=v-B,G=b-N;let Y=0,he=B,ae=0,le=N,Se=0,Pe=F,Qe=0,St=G;if(m.content&&l){const Me=m.content,at=Me[2]-Me[0],ut=Me[3]-Me[1];(m.textFitWidth||m.textFitHeight)&&(A=kc(a)),Y=Nc(z,0,Me[0]),ae=Nc(M,0,Me[1]),he=Nc(z,Me[0],Me[2]),le=Nc(M,Me[1],Me[3]),Se=Me[0]-Y,Qe=Me[1]-ae,Pe=at-he,St=ut-le}const Ve=A.x1,Ke=A.y1,ct=A.x2-Ve,rt=A.y2-Ke,tt=(Me,at,ut,kt)=>{const fi=Fc(Me.stretch-Y,he,ct,Ve),Bi=Oh(Me.fixed-Se,Pe,Me.stretch,B),qa=Fc(at.stretch-ae,le,rt,Ke),mn=Oh(at.fixed-Qe,St,at.stretch,N),Ya=Fc(ut.stretch-Y,he,ct,Ve),Za=Oh(ut.fixed-Se,Pe,ut.stretch,B),Mn=Fc(kt.stretch-ae,le,rt,Ke),Cn=Oh(kt.fixed-Qe,St,kt.stretch,N),Dn=new me(fi,qa),va=new me(Ya,qa),Ga=new me(Ya,Mn),gn=new me(fi,Mn),Ka=new me(Bi/g,mn/g),Ba=new me(Za/g,Cn/g),Ca=t*Math.PI/180;if(Ca){const si=Math.sin(Ca),Mi=Math.cos(Ca),Yi=[Mi,-si,si,Mi];Dn._matMult(Yi),va._matMult(Yi),gn._matMult(Yi),Ga._matMult(Yi)}const er=Me.stretch+Me.fixed,On=at.stretch+at.fixed;return{tl:Dn,tr:va,bl:gn,br:Ga,tex:{x:m.paddedRect.x+ju+er,y:m.paddedRect.y+ju+On,w:ut.stretch+ut.fixed-er,h:kt.stretch+kt.fixed-On},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ka,pixelOffsetBR:Ba,minFontScaleX:Pe/g/ct,minFontScaleY:St/g/rt,isSDF:r}};if(l&&(m.stretchX||m.stretchY)){const Me=Hd(z,F,B),at=Hd(M,G,N);for(let ut=0;ut<Me.length-1;ut++){const kt=Me[ut],fi=Me[ut+1];for(let Bi=0;Bi<at.length-1;Bi++)h.push(tt(kt,at[Bi],fi,at[Bi+1]))}}else h.push(tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return h}function Nc(a,t,r){let l=0;for(const h of a)l+=Math.max(t,Math.min(r,h[1]))-Math.max(t,Math.min(r,h[0]));return l}function Hd(a,t,r){const l=[{fixed:-ju,stretch:0}];for(const[h,m]of a){const g=l[l.length-1];l.push({fixed:h-g.stretch,stretch:g.stretch}),l.push({fixed:h-g.stretch,stretch:g.stretch+(m-h)})}return l.push({fixed:t+ju,stretch:r}),l}function Fc(a,t,r,l){return a/t*r+l}function Oh(a,t,r,l){return a-t*r/l}class Uu{constructor(t,r,l,h,m,g,v,b,A,z){var M;if(this.boxStartIndex=t.length,A){let k=g.top,B=g.bottom;const N=g.collisionPadding;N&&(k-=N[1],B+=N[3]);let F=B-k;F>0&&(F=Math.max(10,F),this.circleDiameter=F)}else{const k=!((M=g.image)===null||M===void 0)&&M.content&&(g.image.textFitWidth||g.image.textFitHeight)?kc(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};k.y1=k.y1*v-b[0],k.y2=k.y2*v+b[2],k.x1=k.x1*v-b[3],k.x2=k.x2*v+b[1];const B=g.collisionPadding;if(B&&(k.x1-=B[0]*v,k.y1-=B[1]*v,k.x2+=B[2]*v,k.y2+=B[3]*v),z){const N=new me(k.x1,k.y1),F=new me(k.x2,k.y1),G=new me(k.x1,k.y2),Y=new me(k.x2,k.y2),he=z*Math.PI/180;N._rotate(he),F._rotate(he),G._rotate(he),Y._rotate(he),k.x1=Math.min(N.x,F.x,G.x,Y.x),k.x2=Math.max(N.x,F.x,G.x,Y.x),k.y1=Math.min(N.y,F.y,G.y,Y.y),k.y2=Math.max(N.y,F.y,G.y,Y.y)}t.emplaceBack(r.x,r.y,k.x1,k.y1,k.x2,k.y2,l,h,m)}this.boxEndIndex=t.length}}class Gf{constructor(t=[],r=((l,h)=>l<h?-1:l>h?1:0)){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:l}=this,h=r[t];for(;t>0;){const m=t-1>>1,g=r[m];if(l(h,g)>=0)break;r[t]=g,t=m}r[t]=h}_down(t){const{data:r,compare:l}=this,h=this.length>>1,m=r[t];for(;t<h;){let g=1+(t<<1);const v=g+1;if(v<this.length&&l(r[v],r[g])<0&&(g=v),l(r[g],m)>=0)break;r[t]=r[g],t=g}r[t]=m}}function Hf(a,t=1,r=!1){let l=1/0,h=1/0,m=-1/0,g=-1/0;const v=a[0];for(let B=0;B<v.length;B++){const N=v[B];(!B||N.x<l)&&(l=N.x),(!B||N.y<h)&&(h=N.y),(!B||N.x>m)&&(m=N.x),(!B||N.y>g)&&(g=N.y)}const b=Math.min(m-l,g-h);let A=b/2;const z=new Gf([],bp);if(b===0)return new me(l,h);for(let B=l;B<m;B+=b)for(let N=h;N<g;N+=b)z.push(new il(B+A,N+A,A,a));let M=(function(B){let N=0,F=0,G=0;const Y=B[0];for(let he=0,ae=Y.length,le=ae-1;he<ae;le=he++){const Se=Y[he],Pe=Y[le],Qe=Se.x*Pe.y-Pe.x*Se.y;F+=(Se.x+Pe.x)*Qe,G+=(Se.y+Pe.y)*Qe,N+=3*Qe}return new il(F/N,G/N,0,B)})(a),k=z.length;for(;z.length;){const B=z.pop();(B.d>M.d||!M.d)&&(M=B,r&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,k)),B.max-M.d<=t||(A=B.h/2,z.push(new il(B.p.x-A,B.p.y-A,A,a)),z.push(new il(B.p.x+A,B.p.y-A,A,a)),z.push(new il(B.p.x-A,B.p.y+A,A,a)),z.push(new il(B.p.x+A,B.p.y+A,A,a)),k+=4)}return r&&(console.log(`num probes: ${k}`),console.log(`best distance: ${M.d}`)),M.p}function bp(a,t){return t.max-a.max}function il(a,t,r,l){this.p=new me(a,t),this.h=r,this.d=(function(h,m){let g=!1,v=1/0;for(let b=0;b<m.length;b++){const A=m[b];for(let z=0,M=A.length,k=M-1;z<M;k=z++){const B=A[z],N=A[k];B.y>h.y!=N.y>h.y&&h.x<(N.x-B.x)*(h.y-B.y)/(N.y-B.y)+B.x&&(g=!g),v=Math.min(v,rd(h,B,N))}}return(g?1:-1)*Math.sqrt(v)})(this.p,l),this.max=this.d+this.h*Math.SQRT2}var Va;O.aq=void 0,(Va=O.aq||(O.aq={}))[Va.center=1]="center",Va[Va.left=2]="left",Va[Va.right=3]="right",Va[Va.top=4]="top",Va[Va.bottom=5]="bottom",Va[Va["top-left"]=6]="top-left",Va[Va["top-right"]=7]="top-right",Va[Va["bottom-left"]=8]="bottom-left",Va[Va["bottom-right"]=9]="bottom-right";const al=7,Xd=Number.POSITIVE_INFINITY;function Vu(a,t){return t[1]!==Xd?(function(r,l,h){let m=0,g=0;switch(l=Math.abs(l),h=Math.abs(h),r){case"top-right":case"top-left":case"top":g=h-al;break;case"bottom-right":case"bottom-left":case"bottom":g=-h+al}switch(r){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,g]})(a,t[0],t[1]):(function(r,l){let h=0,m=0;l<0&&(l=0);const g=l/Math.SQRT2;switch(r){case"top-right":case"top-left":m=g-al;break;case"bottom-right":case"bottom-left":m=-g+al;break;case"bottom":m=-l+al;break;case"top":m=l-al}switch(r){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=l;break;case"right":h=-l}return[h,m]})(a,t[0])}function Xf(a,t,r){var l;const h=a.layout,m=(l=h.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},r);if(m){const v=m.values,b=[];for(let A=0;A<v.length;A+=2){const z=b[A]=v[A],M=v[A+1].map((k=>k*Ma));z.startsWith("top")?M[1]-=al:z.startsWith("bottom")&&(M[1]+=al),b[A+1]=M}return new Un(b)}const g=h.get("text-variable-anchor");if(g){let v;v=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},r)*Ma,Xd]:h.get("text-offset").evaluate(t,{},r).map((A=>A*Ma));const b=[];for(const A of g)b.push(A,Vu(A,v));return new Un(b)}return null}function Nh(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function gi(a,t,r,l,h,m,g,v,b,A,z){let M=m.textMaxSize.evaluate(t,{});M===void 0&&(M=g);const k=a.layers[0].layout,B=k.get("icon-offset").evaluate(t,{},z),N=jc(r.horizontal),F=g/24,G=a.tilePixelRatio*F,Y=a.tilePixelRatio*M/24,he=a.tilePixelRatio*v,ae=a.tilePixelRatio*k.get("symbol-spacing"),le=k.get("text-padding")*a.tilePixelRatio,Se=(function(Me,at,ut,kt=1){const fi=Me.get("icon-padding").evaluate(at,{},ut),Bi=fi&&fi.values;return[Bi[0]*kt,Bi[1]*kt,Bi[2]*kt,Bi[3]*kt]})(k,t,z,a.tilePixelRatio),Pe=k.get("text-max-angle")/180*Math.PI,Qe=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point",St=k.get("icon-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",Ve=k.get("symbol-placement"),Ke=ae/2,ct=k.get("icon-text-fit");let rt;l&&ct!=="none"&&(a.allowVerticalPlacement&&r.vertical&&(rt=ho(l,r.vertical,ct,k.get("icon-text-fit-padding"),B,F)),N&&(l=ho(l,N,ct,k.get("icon-text-fit-padding"),B,F)));const tt=(Me,at)=>{at.x<0||at.x>=ba||at.y<0||at.y>=ba||(function(ut,kt,fi,Bi,qa,mn,Ya,Za,Mn,Cn,Dn,va,Ga,gn,Ka,Ba,Ca,er,On,si,Mi,Yi,yn,ta,nl){const vr=ut.addToLineVertexArray(kt,fi);let ns,xr,br,Ha,fo=0,Nl=0,Yf=0,Hc=0,Zu=-1,Gu=-1;const po={};let Hu=Fo("");if(ut.allowVerticalPlacement&&Bi.vertical){const ln=Za.layout.get("text-rotate").evaluate(Mi,{},ta)+90;br=new Uu(Mn,kt,Cn,Dn,va,Bi.vertical,Ga,gn,Ka,ln),Ya&&(Ha=new Uu(Mn,kt,Cn,Dn,va,Ya,Ca,er,Ka,ln))}if(qa){const ln=Za.layout.get("icon-rotate").evaluate(Mi,{}),Nn=Za.layout.get("icon-text-fit")!=="none",tr=Gd(qa,ln,yn,Nn),un=Ya?Gd(Ya,ln,yn,Nn):void 0;xr=new Uu(Mn,kt,Cn,Dn,va,qa,Ca,er,!1,ln),fo=4*tr.length;const ir=ut.iconSizeData;let ar=null;ir.kind==="source"?(ar=[pn*Za.layout.get("icon-size").evaluate(Mi,{})],ar[0]>yr&&Ti(`${ut.layerIds[0]}: Value for "icon-size" is >= ${Sa}. Reduce your "icon-size".`)):ir.kind==="composite"&&(ar=[pn*Yi.compositeIconSizes[0].evaluate(Mi,{},ta),pn*Yi.compositeIconSizes[1].evaluate(Mi,{},ta)],(ar[0]>yr||ar[1]>yr)&&Ti(`${ut.layerIds[0]}: Value for "icon-size" is >= ${Sa}. Reduce your "icon-size".`)),ut.addSymbols(ut.icon,tr,ar,si,On,Mi,O.ah.none,kt,vr.lineStartIndex,vr.lineLength,-1,ta),Zu=ut.icon.placedSymbolArray.length-1,un&&(Nl=4*un.length,ut.addSymbols(ut.icon,un,ar,si,On,Mi,O.ah.vertical,kt,vr.lineStartIndex,vr.lineLength,-1,ta),Gu=ut.icon.placedSymbolArray.length-1)}const Kf=Object.keys(Bi.horizontal);for(const ln of Kf){const Nn=Bi.horizontal[ln];if(!ns){Hu=Fo(Nn.text);const un=Za.layout.get("text-rotate").evaluate(Mi,{},ta);ns=new Uu(Mn,kt,Cn,Dn,va,Nn,Ga,gn,Ka,un)}const tr=Nn.positionedLines.length===1;if(Yf+=Fh(ut,kt,Nn,mn,Za,Ka,Mi,Ba,vr,Bi.vertical?O.ah.horizontal:O.ah.horizontalOnly,tr?Kf:[ln],po,Zu,Yi,ta),tr)break}Bi.vertical&&(Hc+=Fh(ut,kt,Bi.vertical,mn,Za,Ka,Mi,Ba,vr,O.ah.vertical,["vertical"],po,Gu,Yi,ta));const Jf=ns?ns.boxStartIndex:ut.collisionBoxArray.length,Qf=ns?ns.boxEndIndex:ut.collisionBoxArray.length,Wf=br?br.boxStartIndex:ut.collisionBoxArray.length,ep=br?br.boxEndIndex:ut.collisionBoxArray.length,Jd=xr?xr.boxStartIndex:ut.collisionBoxArray.length,tp=xr?xr.boxEndIndex:ut.collisionBoxArray.length,ip=Ha?Ha.boxStartIndex:ut.collisionBoxArray.length,Uh=Ha?Ha.boxEndIndex:ut.collisionBoxArray.length;let rs=-1;const Vh=(ln,Nn)=>ln&&ln.circleDiameter?Math.max(ln.circleDiameter,Nn):Nn;rs=Vh(ns,rs),rs=Vh(br,rs),rs=Vh(xr,rs),rs=Vh(Ha,rs);const qh=rs>-1?1:0;qh&&(rs*=nl/Ma),ut.glyphOffsetArray.length>=Rl.MAX_GLYPHS&&Ti("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mi.sortKey!==void 0&&ut.addToSortKeyRanges(ut.symbolInstances.length,Mi.sortKey);const Qd=Xf(Za,Mi,ta),[Zh,Wd]=(function(ln,Nn){const tr=ln.length,un=Nn==null?void 0:Nn.values;if((un==null?void 0:un.length)>0)for(let ir=0;ir<un.length;ir+=2){const ar=un[ir+1];ln.emplaceBack(O.aq[un[ir]],ar[0],ar[1])}return[tr,ln.length]})(ut.textAnchorOffsets,Qd);ut.symbolInstances.emplaceBack(kt.x,kt.y,po.right>=0?po.right:-1,po.center>=0?po.center:-1,po.left>=0?po.left:-1,po.vertical||-1,Zu,Gu,Hu,Jf,Qf,Wf,ep,Jd,tp,ip,Uh,Cn,Yf,Hc,fo,Nl,qh,0,Ga,rs,Zh,Wd)})(a,at,Me,r,l,h,rt,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,G,[le,le,le,le],Qe,b,he,Se,St,B,t,m,A,z,g)};if(Ve==="line")for(const Me of Zf(t.geometry,0,0,ba,ba)){const at=Es(Me,ae,Pe,r.vertical||N,l,24,Y,a.overscaling,ba);for(const ut of at)N&&$d(a,N.text,Ke,ut)||tt(Me,ut)}else if(Ve==="line-center"){for(const Me of t.geometry)if(Me.length>1){const at=tl(Me,Pe,r.vertical||N,l,24,Y);at&&tt(Me,at)}}else if(t.type==="Polygon")for(const Me of Kl(t.geometry,0)){const at=Hf(Me,16);tt(Me[0],new as(at.x,at.y,0))}else if(t.type==="LineString")for(const Me of t.geometry)tt(Me,new as(Me[0].x,Me[0].y,0));else if(t.type==="Point")for(const Me of t.geometry)for(const at of Me)tt([at],new as(at.x,at.y,0))}function Fh(a,t,r,l,h,m,g,v,b,A,z,M,k,B,N){const F=(function(he,ae,le,Se,Pe,Qe,St,Ve){const Ke=Se.layout.get("text-rotate").evaluate(Qe,{})*Math.PI/180,ct=[];for(const rt of ae.positionedLines)for(const tt of rt.positionedGlyphs){if(!tt.rect)continue;const Me=tt.rect||{};let at=Di+1,ut=!0,kt=1,fi=0;const Bi=(Pe||Ve)&&tt.vertical,qa=tt.metrics.advance*tt.scale/2;if(Ve&&ae.verticalizable&&(fi=rt.lineOffset/2-(tt.imageName?-(Ma-tt.metrics.width*tt.scale)/2:(tt.scale-1)*Ma)),tt.imageName){const si=St[tt.imageName];ut=si.sdf,kt=si.pixelRatio,at=Nt/kt}const mn=Pe?[tt.x+qa,tt.y]:[0,0];let Ya=Pe?[0,0]:[tt.x+qa+le[0],tt.y+le[1]-fi],Za=[0,0];Bi&&(Za=Ya,Ya=[0,0]);const Mn=tt.metrics.isDoubleResolution?2:1,Cn=(tt.metrics.left-at)*tt.scale-qa+Ya[0],Dn=(-tt.metrics.top-at)*tt.scale+Ya[1],va=Cn+Me.w/Mn*tt.scale/kt,Ga=Dn+Me.h/Mn*tt.scale/kt,gn=new me(Cn,Dn),Ka=new me(va,Dn),Ba=new me(Cn,Ga),Ca=new me(va,Ga);if(Bi){const si=new me(-qa,qa-Pr),Mi=-Math.PI/2,Yi=Ma/2-qa,yn=new me(5-Pr-Yi,-(tt.imageName?Yi:0)),ta=new me(...Za);gn._rotateAround(Mi,si)._add(yn)._add(ta),Ka._rotateAround(Mi,si)._add(yn)._add(ta),Ba._rotateAround(Mi,si)._add(yn)._add(ta),Ca._rotateAround(Mi,si)._add(yn)._add(ta)}if(Ke){const si=Math.sin(Ke),Mi=Math.cos(Ke),Yi=[Mi,-si,si,Mi];gn._matMult(Yi),Ka._matMult(Yi),Ba._matMult(Yi),Ca._matMult(Yi)}const er=new me(0,0),On=new me(0,0);ct.push({tl:gn,tr:Ka,bl:Ba,br:Ca,tex:Me,writingMode:ae.writingMode,glyphOffset:mn,sectionIndex:tt.sectionIndex,isSDF:ut,pixelOffsetTL:er,pixelOffsetBR:On,minFontScaleX:0,minFontScaleY:0})}return ct})(0,r,v,h,m,g,l,a.allowVerticalPlacement),G=a.textSizeData;let Y=null;G.kind==="source"?(Y=[pn*h.layout.get("text-size").evaluate(g,{})],Y[0]>yr&&Ti(`${a.layerIds[0]}: Value for "text-size" is >= ${Sa}. Reduce your "text-size".`)):G.kind==="composite"&&(Y=[pn*B.compositeTextSizes[0].evaluate(g,{},N),pn*B.compositeTextSizes[1].evaluate(g,{},N)],(Y[0]>yr||Y[1]>yr)&&Ti(`${a.layerIds[0]}: Value for "text-size" is >= ${Sa}. Reduce your "text-size".`)),a.addSymbols(a.text,F,Y,v,m,g,A,t,b.lineStartIndex,b.lineLength,k,N);for(const he of z)M[he]=a.text.placedSymbolArray.length-1;return 4*F.length}function jc(a){for(const t in a)return a[t];return null}function $d(a,t,r,l){const h=a.compareText;if(t in h){const m=h[t];for(let g=m.length-1;g>=0;g--)if(l.dist(m[g])<r)return!0}else h[t]=[];return h[t].push(l),!1}const Yd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Uc{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,l]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=l>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=Yd[15&l];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Uc(v,g,m,t)}constructor(t,r=64,l=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=Yd.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${l}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+b,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+b),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+b,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=r,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Ol(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:v}=this,b=[0,m.length-1,0],A=[];for(;b.length;){const z=b.pop()||0,M=b.pop()||0,k=b.pop()||0;if(M-k<=v){for(let G=k;G<=M;G++){const Y=g[2*G],he=g[2*G+1];Y>=t&&Y<=l&&he>=r&&he<=h&&A.push(m[G])}continue}const B=k+M>>1,N=g[2*B],F=g[2*B+1];N>=t&&N<=l&&F>=r&&F<=h&&A.push(m[B]),(z===0?t<=N:r<=F)&&(b.push(k),b.push(B-1),b.push(1-z)),(z===0?l>=N:h>=F)&&(b.push(B+1),b.push(M),b.push(1-z))}return A}within(t,r,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:g}=this,v=[0,h.length-1,0],b=[],A=l*l;for(;v.length;){const z=v.pop()||0,M=v.pop()||0,k=v.pop()||0;if(M-k<=g){for(let G=k;G<=M;G++)$f(m[2*G],m[2*G+1],t,r)<=A&&b.push(h[G]);continue}const B=k+M>>1,N=m[2*B],F=m[2*B+1];$f(N,F,t,r)<=A&&b.push(h[B]),(z===0?t-l<=N:r-l<=F)&&(v.push(k),v.push(B-1),v.push(1-z)),(z===0?t+l>=N:r+l>=F)&&(v.push(B+1),v.push(M),v.push(1-z))}return b}}function Ol(a,t,r,l,h,m){if(h-l<=r)return;const g=l+h>>1;Vc(a,t,g,l,h,m),Ol(a,t,r,l,g-1,1-m),Ol(a,t,r,g+1,h,1-m)}function Vc(a,t,r,l,h,m){for(;h>l;){if(h-l>600){const A=h-l+1,z=r-l+1,M=Math.log(A),k=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*k*(A-k)/A)*(z-A/2<0?-1:1);Vc(a,t,r,Math.max(l,Math.floor(r-z*k/A+B)),Math.min(h,Math.floor(r+(A-z)*k/A+B)),m)}const g=t[2*r+m];let v=l,b=h;for(qc(a,t,l,r),t[2*h+m]>g&&qc(a,t,l,h);v<b;){for(qc(a,t,v,b),v++,b--;t[2*v+m]<g;)v++;for(;t[2*b+m]>g;)b--}t[2*l+m]===g?qc(a,t,l,b):(b++,qc(a,t,b,h)),b<=r&&(l=b+1),r<=b&&(h=b-1)}}function qc(a,t,r,l){jh(a,r,l),jh(t,2*r,2*l),jh(t,2*r+1,2*l+1)}function jh(a,t,r){const l=a[t];a[t]=a[r],a[r]=l}function $f(a,t,r,l){const h=a-r,m=t-l;return h*h+m*m}var Kd;O.bg=void 0,(Kd=O.bg||(O.bg={})).create="create",Kd.load="load",Kd.fullLoad="fullLoad";let Zc=null,qu=[];const Fi=1e3/60,Gc="loadTime",$a="fullLoadTime",wp={mark(a){performance.mark(a)},frame(a){const t=a;Zc!=null&&qu.push(t-Zc),Zc=t},clearMetrics(){Zc=null,qu=[],performance.clearMeasures(Gc),performance.clearMeasures($a);for(const a in O.bg)performance.clearMarks(O.bg[a])},getPerformanceMetrics(){performance.measure(Gc,O.bg.create,O.bg.load),performance.measure($a,O.bg.create,O.bg.fullLoad);const a=performance.getEntriesByName(Gc)[0].duration,t=performance.getEntriesByName($a)[0].duration,r=qu.length,l=1/(qu.reduce(((m,g)=>m+g),0)/r/1e3),h=qu.filter((m=>m>Fi)).reduce(((m,g)=>m+(g-Fi)/Fi),0);return{loadTime:a,fullLoadTime:t,fps:l,percentDroppedFrames:h/(r+h)*100,totalFrames:r}}};O.$=class extends D{},O.A=Xo,O.B=uh,O.C=function(a){if(ge==null){const t=a.navigator?a.navigator.userAgent:null;ge=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ge},O.D=st,O.E=os,O.F=class{constructor(a,t){this.target=a,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new vp((()=>this.process())),this.subscription=(function(r,l,h,m){return r.addEventListener(l,h,!1),{unsubscribe:()=>{r.removeEventListener(l,h,!1)}}})(this.target,"message",(r=>this.receive(r))),this.globalScope=mt(self)?a:window}registerMessageHandler(a,t){this.messageHandlers[a]=t}sendAsync(a,t){return new Promise(((r,l)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[h]={resolve:r,reject:l},t&&t.signal.addEventListener("abort",(()=>{delete this.resolveRejects[h];const v={id:h,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(v)}),{once:!0});const m=[],g=Object.assign(Object.assign({},a),{id:h,sourceMapId:this.mapId,origin:location.origin,data:Ln(a.data,m)});this.target.postMessage(g,{transfer:m})}))}receive(a){const t=a.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const l=this.abortControllers[r];return delete this.abortControllers[r],void(l&&l.abort())}if(mt(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(a,t)}processTask(a,t){return y(this,void 0,void 0,(function*(){if(t.type==="<response>"){const h=this.resolveRejects[a];return delete this.resolveRejects[a],h?void(t.error?h.reject(Qs(t.error)):h.resolve(Qs(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=Qs(t.data),l=new AbortController;this.abortControllers[a]=l;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,r,l);this.completeTask(a,null,h)}catch(h){this.completeTask(a,h)}}))}completeTask(a,t,r){const l=[];delete this.abortControllers[a];const h={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Ln(t):null,data:Ln(r,l)};this.target.postMessage(h,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},O.G=Lt,O.H=function(){var a=new Xo(16);return Xo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},O.I=di,O.J=function(a,t,r){var l,h,m,g,v,b,A,z,M,k,B,N,F=r[0],G=r[1],Y=r[2];return t===a?(a[12]=t[0]*F+t[4]*G+t[8]*Y+t[12],a[13]=t[1]*F+t[5]*G+t[9]*Y+t[13],a[14]=t[2]*F+t[6]*G+t[10]*Y+t[14],a[15]=t[3]*F+t[7]*G+t[11]*Y+t[15]):(h=t[1],m=t[2],g=t[3],v=t[4],b=t[5],A=t[6],z=t[7],M=t[8],k=t[9],B=t[10],N=t[11],a[0]=l=t[0],a[1]=h,a[2]=m,a[3]=g,a[4]=v,a[5]=b,a[6]=A,a[7]=z,a[8]=M,a[9]=k,a[10]=B,a[11]=N,a[12]=l*F+v*G+M*Y+t[12],a[13]=h*F+b*G+k*Y+t[13],a[14]=m*F+A*G+B*Y+t[14],a[15]=g*F+z*G+N*Y+t[15]),a},O.K=function(a,t,r){var l=r[0],h=r[1],m=r[2];return a[0]=t[0]*l,a[1]=t[1]*l,a[2]=t[2]*l,a[3]=t[3]*l,a[4]=t[4]*h,a[5]=t[5]*h,a[6]=t[6]*h,a[7]=t[7]*h,a[8]=t[8]*m,a[9]=t[9]*m,a[10]=t[10]*m,a[11]=t[11]*m,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},O.L=ld,O.M=function(a,t){const r={};for(let l=0;l<t.length;l++){const h=t[l];h in a&&(r[h]=a[h])}return r},O.N=el,O.O=Bl,O.P=me,O.Q=Pc,O.R=Kn,O.S=En,O.T=gu,O.U=Ct,O.V=qt,O.W=Ne,O.X=ba,O.Y=x,O.Z=Ou,O._=y,O.a=et,O.a$=function(a,t){var r=a[0],l=a[1],h=a[2],m=a[3],g=a[4],v=a[5],b=a[6],A=a[7],z=a[8],M=a[9],k=a[10],B=a[11],N=a[12],F=a[13],G=a[14],Y=a[15],he=t[0],ae=t[1],le=t[2],Se=t[3],Pe=t[4],Qe=t[5],St=t[6],Ve=t[7],Ke=t[8],ct=t[9],rt=t[10],tt=t[11],Me=t[12],at=t[13],ut=t[14],kt=t[15];return Math.abs(r-he)<=fn*Math.max(1,Math.abs(r),Math.abs(he))&&Math.abs(l-ae)<=fn*Math.max(1,Math.abs(l),Math.abs(ae))&&Math.abs(h-le)<=fn*Math.max(1,Math.abs(h),Math.abs(le))&&Math.abs(m-Se)<=fn*Math.max(1,Math.abs(m),Math.abs(Se))&&Math.abs(g-Pe)<=fn*Math.max(1,Math.abs(g),Math.abs(Pe))&&Math.abs(v-Qe)<=fn*Math.max(1,Math.abs(v),Math.abs(Qe))&&Math.abs(b-St)<=fn*Math.max(1,Math.abs(b),Math.abs(St))&&Math.abs(A-Ve)<=fn*Math.max(1,Math.abs(A),Math.abs(Ve))&&Math.abs(z-Ke)<=fn*Math.max(1,Math.abs(z),Math.abs(Ke))&&Math.abs(M-ct)<=fn*Math.max(1,Math.abs(M),Math.abs(ct))&&Math.abs(k-rt)<=fn*Math.max(1,Math.abs(k),Math.abs(rt))&&Math.abs(B-tt)<=fn*Math.max(1,Math.abs(B),Math.abs(tt))&&Math.abs(N-Me)<=fn*Math.max(1,Math.abs(N),Math.abs(Me))&&Math.abs(F-at)<=fn*Math.max(1,Math.abs(F),Math.abs(at))&&Math.abs(G-ut)<=fn*Math.max(1,Math.abs(G),Math.abs(ut))&&Math.abs(Y-kt)<=fn*Math.max(1,Math.abs(Y),Math.abs(kt))},O.a0=Wt,O.a1=Rh,O.a2=je,O.a3=a=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((r=>{t.onloadstart=()=>{r(t)};for(const l of a){const h=window.document.createElement("source");rr(l)||(t.crossOrigin="Anonymous"),h.src=l,t.appendChild(h)}}))},O.a4=function(){return ni++},O.a5=Je,O.a6=Rl,O.a7=ru,O.a8=Go,O.a9=Lh,O.aA=function(a){if(a.type==="custom")return new Pd(a);switch(a.type){case"background":return new jf(a);case"circle":return new dp(a);case"fill":return new bf(a);case"fill-extrusion":return new Sc(a);case"heatmap":return new vh(a);case"hillshade":return new _c(a);case"line":return new Df(a);case"raster":return new Ih(a);case"symbol":return new Pu(a)}},O.aB=Pt,O.aC=function(a,t){if(!a)return[{command:"setStyle",args:[t]}];let r=[];try{if(!pi(a.version,t.version))return[{command:"setStyle",args:[t]}];pi(a.center,t.center)||r.push({command:"setCenter",args:[t.center]}),pi(a.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),pi(a.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),pi(a.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),pi(a.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),pi(a.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),pi(a.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),pi(a.light,t.light)||r.push({command:"setLight",args:[t.light]}),pi(a.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),pi(a.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),pi(a.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const l={},h=[];(function(g,v,b,A){let z;for(z in v=v||{},g=g||{})Object.prototype.hasOwnProperty.call(g,z)&&(Object.prototype.hasOwnProperty.call(v,z)||ls(z,b,A));for(z in v)Object.prototype.hasOwnProperty.call(v,z)&&(Object.prototype.hasOwnProperty.call(g,z)?pi(g[z],v[z])||(g[z].type==="geojson"&&v[z].type==="geojson"&&Pa(g,v,z)?ea(b,{command:"setGeoJSONSourceData",args:[z,v[z].data]}):Fr(z,v,b,A)):Ds(z,v,b))})(a.sources,t.sources,h,l);const m=[];a.layers&&a.layers.forEach((g=>{"source"in g&&l[g.source]?r.push({command:"removeLayer",args:[g.id]}):m.push(g)})),r=r.concat(h),(function(g,v,b){v=v||[];const A=(g=g||[]).map(go),z=v.map(go),M=g.reduce(yo,{}),k=v.reduce(yo,{}),B=A.slice(),N=Object.create(null);let F,G,Y,he,ae;for(let le=0,Se=0;le<A.length;le++)F=A[le],Object.prototype.hasOwnProperty.call(k,F)?Se++:(ea(b,{command:"removeLayer",args:[F]}),B.splice(B.indexOf(F,Se),1));for(let le=0,Se=0;le<z.length;le++)F=z[z.length-1-le],B[B.length-1-le]!==F&&(Object.prototype.hasOwnProperty.call(M,F)?(ea(b,{command:"removeLayer",args:[F]}),B.splice(B.lastIndexOf(F,B.length-Se),1)):Se++,he=B[B.length-le],ea(b,{command:"addLayer",args:[k[F],he]}),B.splice(B.length-le,0,F),N[F]=!0);for(let le=0;le<z.length;le++)if(F=z[le],G=M[F],Y=k[F],!N[F]&&!pi(G,Y))if(pi(G.source,Y.source)&&pi(G["source-layer"],Y["source-layer"])&&pi(G.type,Y.type)){for(ae in Fn(G.layout,Y.layout,b,F,null,"setLayoutProperty"),Fn(G.paint,Y.paint,b,F,null,"setPaintProperty"),pi(G.filter,Y.filter)||ea(b,{command:"setFilter",args:[F,Y.filter]}),pi(G.minzoom,Y.minzoom)&&pi(G.maxzoom,Y.maxzoom)||ea(b,{command:"setLayerZoomRange",args:[F,Y.minzoom,Y.maxzoom]}),G)Object.prototype.hasOwnProperty.call(G,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?Fn(G[ae],Y[ae],b,F,ae.slice(6),"setPaintProperty"):pi(G[ae],Y[ae])||ea(b,{command:"setLayerProperty",args:[F,ae,Y[ae]]}));for(ae in Y)Object.prototype.hasOwnProperty.call(Y,ae)&&!Object.prototype.hasOwnProperty.call(G,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?Fn(G[ae],Y[ae],b,F,ae.slice(6),"setPaintProperty"):pi(G[ae],Y[ae])||ea(b,{command:"setLayerProperty",args:[F,ae,Y[ae]]}))}else ea(b,{command:"removeLayer",args:[F]}),he=B[B.lastIndexOf(F)+1],ea(b,{command:"addLayer",args:[Y,he]})})(m,t.layers,r)}catch(l){console.warn("Unable to compute style diff:",l),r=[{command:"setStyle",args:[t]}]}return r},O.aD=function(a){const t=[],r=a.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},O.aE=function a(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let l=0;l<t.length;l++)if(!a(t[l],r[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const l in t)if(!a(t[l],r[l]))return!1;return!0}return t===r},O.aF=vi,O.aG=Si,O.aH=class extends _s{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},O.aI=Uo,O.aJ=class extends _s{constructor(a,t){super(a,t),this.current=ao}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},O.aK=dc,O.aL=dh,O.aM=mi,O.aN=class extends _s{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},O.aO=class extends _s{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},O.aP=function(a,t,r,l,h,m,g){var v=1/(t-r),b=1/(l-h),A=1/(m-g);return a[0]=-2*v,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*A,a[11]=0,a[12]=(t+r)*v,a[13]=(h+l)*b,a[14]=(g+m)*A,a[15]=1,a},O.aQ=hf,O.aR=class extends ne{},O.aS=Jn,O.aT=class extends fe{},O.aU=yc,O.aV=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},O.aW=xu,O.aX=Hi,O.aY=An,O.aZ=class extends it{},O.a_=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},O.aa=function(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((r,l,h,m)=>{const g=h||m;return t[l]=!g||g.toLowerCase(),""})),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},O.ab=function(a,t){const r=[];for(const l in a)l in t||r.push(l);return r},O.ac=Ht,O.ad=function(a,t,r){var l=Math.sin(r),h=Math.cos(r),m=t[0],g=t[1],v=t[2],b=t[3],A=t[4],z=t[5],M=t[6],k=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=m*h+A*l,a[1]=g*h+z*l,a[2]=v*h+M*l,a[3]=b*h+k*l,a[4]=A*h-m*l,a[5]=z*h-g*l,a[6]=M*h-v*l,a[7]=k*h-b*l,a},O.ae=function(a){var t=new Xo(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},O.af=mc,O.ag=function(a,t){let r=0,l=0;if(a.kind==="constant")l=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:g}=a,v=h?Ht(ka.interpolationFactor(h,t,m,g),0,1):0;a.kind==="camera"?l=Qa.number(a.minSize,a.maxSize,v):r=v}return{uSizeT:r,uSize:l}},O.ai=function(a,{uSize:t,uSizeT:r},{lowerSize:l,upperSize:h}){return a.kind==="source"?l/pn:a.kind==="composite"?Qa.number(l/pn,h/pn,r):t},O.aj=Lc,O.ak=function(a,t,r,l){const h=t.y-a.y,m=t.x-a.x,g=l.y-r.y,v=l.x-r.x,b=g*m-v*h;if(b===0)return null;const A=(v*(a.y-r.y)-g*(a.x-r.x))/b;return new me(a.x+A*m,a.y+A*h)},O.al=Zf,O.am=id,O.an=gh,O.ao=function(a){let t=1/0,r=1/0,l=-1/0,h=-1/0;for(const m of a)t=Math.min(t,m.x),r=Math.min(r,m.y),l=Math.max(l,m.x),h=Math.max(h,m.y);return[t,r,l,h]},O.ap=Ma,O.ar=Rc,O.as=function(a,t){var r=t[0],l=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=t[6],A=t[7],z=t[8],M=t[9],k=t[10],B=t[11],N=t[12],F=t[13],G=t[14],Y=t[15],he=r*v-l*g,ae=r*b-h*g,le=r*A-m*g,Se=l*b-h*v,Pe=l*A-m*v,Qe=h*A-m*b,St=z*F-M*N,Ve=z*G-k*N,Ke=z*Y-B*N,ct=M*G-k*F,rt=M*Y-B*F,tt=k*Y-B*G,Me=he*tt-ae*rt+le*ct+Se*Ke-Pe*Ve+Qe*St;return Me?(a[0]=(v*tt-b*rt+A*ct)*(Me=1/Me),a[1]=(h*rt-l*tt-m*ct)*Me,a[2]=(F*Qe-G*Pe+Y*Se)*Me,a[3]=(k*Pe-M*Qe-B*Se)*Me,a[4]=(b*Ke-g*tt-A*Ve)*Me,a[5]=(r*tt-h*Ke+m*Ve)*Me,a[6]=(G*le-N*Qe-Y*ae)*Me,a[7]=(z*Qe-k*le+B*ae)*Me,a[8]=(g*rt-v*Ke+A*St)*Me,a[9]=(l*Ke-r*rt-m*St)*Me,a[10]=(N*Pe-F*le+Y*he)*Me,a[11]=(M*le-z*Pe-B*he)*Me,a[12]=(v*Ve-g*ct-b*St)*Me,a[13]=(r*ct-l*Ve+h*St)*Me,a[14]=(F*ae-N*Se-G*he)*Me,a[15]=(z*Se-M*ae+k*he)*Me,a):null},O.at=Nh,O.au=Bu,O.av=Uc,O.aw=function(){const a={},t=xe.$version;for(const r in xe.$root){const l=xe.$root[r];if(l.required){let h=null;h=r==="version"?t:l.type==="array"?[]:{},h!=null&&(a[r]=h)}}return a},O.ax=pu,O.ay=qi,O.az=function(a){a=a.slice();const t=Object.create(null);for(let r=0;r<a.length;r++)t[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=mo(a[r],t[a[r].ref]));return a},O.b=He,O.b0=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},O.b1=function(a,t,r){return a[0]=t[0]*r[0],a[1]=t[1]*r[1],a[2]=t[2]*r[2],a[3]=t[3]*r[3],a},O.b2=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]*t[3]},O.b3=Zt,O.b4=Vd,O.b5=jd,O.b6=function(a,t,r,l,h){var m,g=1/Math.tan(t/2);return a[0]=g/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=g,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,h!=null&&h!==1/0?(a[10]=(h+l)*(m=1/(l-h)),a[14]=2*h*l*m):(a[10]=-1,a[14]=-2*l),a},O.b7=function(a,t,r){var l=Math.sin(r),h=Math.cos(r),m=t[4],g=t[5],v=t[6],b=t[7],A=t[8],z=t[9],M=t[10],k=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=m*h+A*l,a[5]=g*h+z*l,a[6]=v*h+M*l,a[7]=b*h+k*l,a[8]=A*h-m*l,a[9]=z*h-g*l,a[10]=M*h-v*l,a[11]=k*h-b*l,a},O.b8=dt,O.b9=ft,O.bA=Cd,O.bB=function(a){return a.message===be},O.bC=Xs,O.bD=Ra,O.ba=function(a){return a*Math.PI/180},O.bb=function(a,t){const{x:r,y:l}=Ou.fromLngLat(t);return!(a<0||a>25||l<0||l>=1||r<0||r>=1)},O.bc=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},O.bd=class extends E{},O.be=Od,O.bf=wp,O.bh=Ot,O.bi=function(a,t){et.REGISTERED_PROTOCOLS[a]=t},O.bj=function(a){delete et.REGISTERED_PROTOCOLS[a]},O.bk=function(a,t){const r={};for(let h=0;h<a.length;h++){const m=t&&t[a[h].id]||kn(a[h]);t&&(t[a[h].id]=m);let g=r[m];g||(g=r[m]=[]),g.push(a[h])}const l=[];for(const h in r)l.push(r[h]);return l},O.bl=Be,O.bm=Ni,O.bn=Vf,O.bo=Oi,O.bp=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=ba/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const t=a.bucket.layers[0],r=t.layout,l=t._unevaluatedLayout._values,h={layoutIconSize:l["icon-size"].possiblyEvaluate(new Qt(a.bucket.zoom+1),a.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Qt(a.bucket.zoom+1),a.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Qt(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:A,maxZoom:z}=a.bucket.textSizeData;h.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Qt(A),a.canonical),l["text-size"].possiblyEvaluate(new Qt(z),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:A,maxZoom:z}=a.bucket.iconSizeData;h.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Qt(A),a.canonical),l["icon-size"].possiblyEvaluate(new Qt(z),a.canonical)]}const m=r.get("text-line-height")*Ma,g=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",v=r.get("text-keep-upright"),b=r.get("text-size");for(const A of a.bucket.features){const z=r.get("text-font").evaluate(A,{},a.canonical).join(","),M=b.evaluate(A,{},a.canonical),k=h.layoutTextSize.evaluate(A,{},a.canonical),B=h.layoutIconSize.evaluate(A,{},a.canonical),N={horizontal:{},vertical:void 0},F=A.text;let G,Y=[0,0];if(F){const le=F.toString(),Se=r.get("text-letter-spacing").evaluate(A,{},a.canonical)*Ma,Pe=sc(le)?Se:0,Qe=r.get("text-anchor").evaluate(A,{},a.canonical),St=Xf(t,A,a.canonical);if(!St){const rt=r.get("text-radial-offset").evaluate(A,{},a.canonical);Y=rt?Vu(Qe,[rt*Ma,Xd]):r.get("text-offset").evaluate(A,{},a.canonical).map((tt=>tt*Ma))}let Ve=g?"center":r.get("text-justify").evaluate(A,{},a.canonical);const Ke=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(A,{},a.canonical)*Ma:1/0,ct=()=>{a.bucket.allowVerticalPlacement&&Kr(le)&&(N.vertical=Or(F,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,m,Qe,"left",Pe,Y,O.ah.vertical,!0,k,M))};if(!g&&St){const rt=new Set;if(Ve==="auto")for(let Me=0;Me<St.values.length;Me+=2)rt.add(Nh(St.values[Me]));else rt.add(Ve);let tt=!1;for(const Me of rt)if(!N.horizontal[Me])if(tt)N.horizontal[Me]=N.horizontal[0];else{const at=Or(F,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,m,"center",Me,Pe,Y,O.ah.horizontal,!1,k,M);at&&(N.horizontal[Me]=at,tt=at.positionedLines.length===1)}ct()}else{Ve==="auto"&&(Ve=Nh(Qe));const rt=Or(F,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,m,Qe,Ve,Pe,Y,O.ah.horizontal,!1,k,M);rt&&(N.horizontal[Ve]=rt),ct(),Kr(le)&&g&&v&&(N.vertical=Or(F,a.glyphMap,a.glyphPositions,a.imagePositions,z,Ke,m,Qe,Ve,Pe,Y,O.ah.vertical,!1,k,M))}}let he=!1;if(A.icon&&A.icon.name){const le=a.imageMap[A.icon.name];le&&(G=Ch(a.imagePositions[A.icon.name],r.get("icon-offset").evaluate(A,{},a.canonical),r.get("icon-anchor").evaluate(A,{},a.canonical)),he=!!le.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=he:a.bucket.sdfIcons!==he&&Ti("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(le.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const ae=jc(N.horizontal)||N.vertical;a.bucket.iconsInText=!!ae&&ae.iconsInText,(ae||G)&&gi(a.bucket,A,N,G,a.imageMap,h,k,B,Y,he,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},O.bq=Ac,O.br=zu,O.bs=Dl,O.bt=oo,O.bu=Eh,O.bv=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},O.bw=function(a,t,r,l,h){return y(this,void 0,void 0,(function*(){if(qt())try{return yield Ne(a,t,r,l,h)}catch{}return(function(m,g,v,b,A){const z=m.width,M=m.height;nt&&Q||(nt=new OffscreenCanvas(z,M),Q=nt.getContext("2d",{willReadFrequently:!0})),nt.width=z,nt.height=M,Q.drawImage(m,0,0,z,M);const k=Q.getImageData(g,v,b,A);return Q.clearRect(0,0,z,M),k.data})(a,t,r,l,h)}))},O.bx=qd,O.by=Ue,O.bz=Ee,O.c=qe,O.d=a=>y(void 0,void 0,void 0,(function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),O.e=ot,O.f=a=>new Promise(((t,r)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame((()=>{l.src=gt}))},l.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(a)],{type:"image/png"});l.src=a.byteLength?URL.createObjectURL(h):gt})),O.g=lt,O.h=(a,t)=>Ai(ot(a,{type:"json"}),t),O.i=mt,O.j=_n,O.k=Nr,O.l=(a,t)=>Ai(ot(a,{type:"arrayBuffer"}),t),O.m=Ai,O.n=function(a){return new Eh(a).readFields(Bf,[])},O.o=gc,O.p=Wi,O.q=p,O.r=Yr,O.s=rr,O.t=du,O.u=nn,O.v=xe,O.w=Ti,O.x=function([a,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:a*Math.cos(t)*Math.sin(r),y:a*Math.sin(t)*Math.sin(r),z:a*Math.cos(r)}},O.y=Qa,O.z=Qt})),_t("worker",["./shared"],(function(O){class y{constructor(L){this.keyCache={},L&&this.replace(L)}replace(L){this._layerConfigs={},this._layers={},this.update(L,[])}update(L,R){for(const H of L){this._layerConfigs[H.id]=H;const ie=this._layers[H.id]=O.aA(H);ie._featureFilter=O.a7(ie.filter),this.keyCache[H.id]&&delete this.keyCache[H.id]}for(const H of R)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const V=O.bk(Object.values(this._layerConfigs),this.keyCache);for(const H of V){const ie=H.map((ye=>this._layers[ye.id])),re=ie[0];if(re.visibility==="none")continue;const ce=re.source||"";let W=this.familiesBySource[ce];W||(W=this.familiesBySource[ce]={});const Ae=re.sourceLayer||"_geojsonTileLayer";let ke=W[Ae];ke||(ke=W[Ae]=[]),ke.push(ie)}}}class Ue{constructor(L){const R={},V=[];for(const ce in L){const W=L[ce],Ae=R[ce]={};for(const ke in W){const ye=W[+ke];if(!ye||ye.bitmap.width===0||ye.bitmap.height===0)continue;const Ze={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};V.push(Ze),Ae[ke]={rect:Ze,metrics:ye.metrics}}}const{w:H,h:ie}=O.p(V),re=new O.o({width:H||1,height:ie||1});for(const ce in L){const W=L[ce];for(const Ae in W){const ke=W[+Ae];if(!ke||ke.bitmap.width===0||ke.bitmap.height===0)continue;const ye=R[ce][Ae].rect;O.o.copy(ke.bitmap,re,{x:0,y:0},{x:ye.x+1,y:ye.y+1},ke.bitmap)}}this.image=re,this.positions=R}}O.bl("GlyphAtlas",Ue);class Ee{constructor(L){this.tileID=new O.S(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId,this.inFlightDependencies=[]}parse(L,R,V,H){return O._(this,void 0,void 0,(function*(){this.status="parsing",this.data=L,this.collisionBoxArray=new O.a5;const ie=new O.bm(Object.keys(L.layers).sort()),re=new O.bn(this.tileID,this.promoteId);re.bucketLayerIDs=[];const ce={},W={featureIndex:re,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},Ae=R.familiesBySource[this.source];for(const Kt in Ae){const zi=L.layers[Kt];if(!zi)continue;zi.version===1&&O.w(`Vector tile source "${this.source}" layer "${Kt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ri=ie.encode(Kt),Ta=[];for(let pa=0;pa<zi.length;pa++){const Aa=zi.feature(pa),Ar=re.getId(Aa,Kt);Ta.push({feature:Aa,id:Ar,index:pa,sourceLayerIndex:Ri})}for(const pa of Ae[Kt]){const Aa=pa[0];Aa.source!==this.source&&O.w(`layer.source = ${Aa.source} does not equal this.source = ${this.source}`),Aa.minzoom&&this.zoom<Math.floor(Aa.minzoom)||Aa.maxzoom&&this.zoom>=Aa.maxzoom||Aa.visibility!=="none"&&(ht(pa,this.zoom,V),(ce[Aa.id]=Aa.createBucket({index:re.bucketLayerIDs.length,layers:pa,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ri,sourceID:this.source})).populate(Ta,W,this.tileID.canonical),re.bucketLayerIDs.push(pa.map((Ar=>Ar.id))))}}const ke=O.aF(W.glyphDependencies,(Kt=>Object.keys(Kt).map(Number)));this.inFlightDependencies.forEach((Kt=>Kt==null?void 0:Kt.abort())),this.inFlightDependencies=[];let ye=Promise.resolve({});if(Object.keys(ke).length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),ye=H.sendAsync({type:"GG",data:{stacks:ke,source:this.source,tileID:this.tileID,type:"glyphs"}},Kt)}const Ze=Object.keys(W.iconDependencies);let pt=Promise.resolve({});if(Ze.length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),pt=H.sendAsync({type:"GI",data:{icons:Ze,source:this.source,tileID:this.tileID,type:"icons"}},Kt)}const bt=Object.keys(W.patternDependencies);let Yt=Promise.resolve({});if(bt.length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),Yt=H.sendAsync({type:"GI",data:{icons:bt,source:this.source,tileID:this.tileID,type:"patterns"}},Kt)}const[yt,jt,Xt]=yield Promise.all([ye,pt,Yt]),fa=new Ue(yt),ra=new O.bo(jt,Xt);for(const Kt in ce){const zi=ce[Kt];zi instanceof O.a6?(ht(zi.layers,this.zoom,V),O.bp({bucket:zi,glyphMap:yt,glyphPositions:fa.positions,imageMap:jt,imagePositions:ra.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):zi.hasPattern&&(zi instanceof O.bq||zi instanceof O.br||zi instanceof O.bs)&&(ht(zi.layers,this.zoom,V),zi.addFeatures(W,this.tileID.canonical,ra.patternPositions))}return this.status="done",{buckets:Object.values(ce).filter((Kt=>!Kt.isEmpty())),featureIndex:re,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fa.image,imageAtlas:ra,glyphMap:this.returnDependencies?yt:null,iconMap:this.returnDependencies?jt:null,glyphPositions:this.returnDependencies?fa.positions:null}}))}}function ht($,L,R){const V=new O.z(L);for(const H of $)H.recalculate(V,R)}class me{constructor(L,R,V){this.actor=L,this.layerIndex=R,this.availableImages=V,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(L,R){return O._(this,void 0,void 0,(function*(){const V=yield O.l(L.request,R);try{return{vectorTile:new O.bt.VectorTile(new O.bu(V.data)),rawData:V.data,cacheControl:V.cacheControl,expires:V.expires}}catch(H){const ie=new Uint8Array(V.data);let re=`Unable to parse the tile at ${L.request.url}, `;throw re+=ie[0]===31&&ie[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${H.message}`,new Error(re)}}))}loadTile(L){return O._(this,void 0,void 0,(function*(){const R=L.uid,V=!!(L&&L.request&&L.request.collectResourceTiming)&&new O.bv(L.request),H=new Ee(L);this.loading[R]=H;const ie=new AbortController;H.abort=ie;try{const re=yield this.loadVectorTile(L,ie);if(delete this.loading[R],!re)return null;const ce=re.rawData,W={};re.expires&&(W.expires=re.expires),re.cacheControl&&(W.cacheControl=re.cacheControl);const Ae={};if(V){const ye=V.finish();ye&&(Ae.resourceTiming=JSON.parse(JSON.stringify(ye)))}H.vectorTile=re.vectorTile;const ke=H.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[R]=H,this.fetching[R]={rawTileData:ce,cacheControl:W,resourceTiming:Ae};try{const ye=yield ke;return O.e({rawTileData:ce.slice(0)},ye,W,Ae)}finally{delete this.fetching[R]}}catch(re){throw delete this.loading[R],H.status="done",this.loaded[R]=H,re}}))}reloadTile(L){return O._(this,void 0,void 0,(function*(){const R=L.uid;if(!this.loaded||!this.loaded[R])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const V=this.loaded[R];if(V.showCollisionBoxes=L.showCollisionBoxes,V.status==="parsing"){const H=yield V.parse(V.vectorTile,this.layerIndex,this.availableImages,this.actor);let ie;if(this.fetching[R]){const{rawTileData:re,cacheControl:ce,resourceTiming:W}=this.fetching[R];delete this.fetching[R],ie=O.e({rawTileData:re.slice(0)},H,ce,W)}else ie=H;return ie}if(V.status==="done"&&V.vectorTile)return V.parse(V.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(L){return O._(this,void 0,void 0,(function*(){const R=this.loading,V=L.uid;R&&R[V]&&R[V].abort&&(R[V].abort.abort(),delete R[V])}))}removeTile(L){return O._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[L.uid]&&delete this.loaded[L.uid]}))}}class pe{constructor(){this.loaded={}}loadTile(L){return O._(this,void 0,void 0,(function*(){const{uid:R,encoding:V,rawImageData:H,redFactor:ie,greenFactor:re,blueFactor:ce,baseShift:W}=L,Ae=H.width+2,ke=H.height+2,ye=O.b(H)?new O.R({width:Ae,height:ke},yield O.bw(H,-1,-1,Ae,ke)):H,Ze=new O.bx(R,ye,V,ie,re,ce,W);return this.loaded=this.loaded||{},this.loaded[R]=Ze,Ze}))}removeTile(L){const R=this.loaded,V=L.uid;R&&R[V]&&delete R[V]}}function Ii($,L){if($.length!==0){ki($[0],L);for(var R=1;R<$.length;R++)ki($[R],!L)}}function ki($,L){for(var R=0,V=0,H=0,ie=$.length,re=ie-1;H<ie;re=H++){var ce=($[H][0]-$[re][0])*($[re][1]+$[H][1]),W=R+ce;V+=Math.abs(R)>=Math.abs(ce)?R-W+ce:ce-W+R,R=W}R+V>=0!=!!L&&$.reverse()}var ti=O.by((function $(L,R){var V,H=L&&L.type;if(H==="FeatureCollection")for(V=0;V<L.features.length;V++)$(L.features[V],R);else if(H==="GeometryCollection")for(V=0;V<L.geometries.length;V++)$(L.geometries[V],R);else if(H==="Feature")$(L.geometry,R);else if(H==="Polygon")Ii(L.coordinates,R);else if(H==="MultiPolygon")for(V=0;V<L.coordinates.length;V++)Ii(L.coordinates[V],R);return L}));const Ut=O.bt.VectorTileFeature.prototype.toGeoJSON;var Ct={exports:{}},qt=O.bz,dt=O.bt.VectorTileFeature,ft=Ht;function Ht($,L){this.options=L||{},this.features=$,this.length=$.length}function Zt($,L){this.id=typeof $.id=="number"?$.id:void 0,this.type=$.type,this.rawGeometry=$.type===1?[$.geometry]:$.geometry,this.properties=$.tags,this.extent=L||4096}Ht.prototype.feature=function($){return new Zt(this.features[$],this.options.extent)},Zt.prototype.loadGeometry=function(){var $=this.rawGeometry;this.geometry=[];for(var L=0;L<$.length;L++){for(var R=$[L],V=[],H=0;H<R.length;H++)V.push(new qt(R[H][0],R[H][1]));this.geometry.push(V)}return this.geometry},Zt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $=this.geometry,L=1/0,R=-1/0,V=1/0,H=-1/0,ie=0;ie<$.length;ie++)for(var re=$[ie],ce=0;ce<re.length;ce++){var W=re[ce];L=Math.min(L,W.x),R=Math.max(R,W.x),V=Math.min(V,W.y),H=Math.max(H,W.y)}return[L,V,R,H]},Zt.prototype.toGeoJSON=dt.prototype.toGeoJSON;var ot=O.bA,ni=ft;function vi($){var L=new ot;return(function(R,V){for(var H in R.layers)V.writeMessage(3,Si,R.layers[H])})($,L),L.finish()}function Si($,L){var R;L.writeVarintField(15,$.version||1),L.writeStringField(1,$.name||""),L.writeVarintField(5,$.extent||4096);var V={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<$.length;R++)V.feature=$.feature(R),L.writeMessage(2,Pt,V);var H=V.keys;for(R=0;R<H.length;R++)L.writeStringField(3,H[R]);var ie=V.values;for(R=0;R<ie.length;R++)L.writeMessage(4,ge,ie[R])}function Pt($,L){var R=$.feature;R.id!==void 0&&L.writeVarintField(1,R.id),L.writeMessage(2,Vi,$),L.writeVarintField(3,R.type),L.writeMessage(4,mt,R)}function Vi($,L){var R=$.feature,V=$.keys,H=$.values,ie=$.keycache,re=$.valuecache;for(var ce in R.properties){var W=R.properties[ce],Ae=ie[ce];if(W!==null){Ae===void 0&&(V.push(ce),ie[ce]=Ae=V.length-1),L.writeVarint(Ae);var ke=typeof W;ke!=="string"&&ke!=="boolean"&&ke!=="number"&&(W=JSON.stringify(W));var ye=ke+":"+W,Ze=re[ye];Ze===void 0&&(H.push(W),re[ye]=Ze=H.length-1),L.writeVarint(Ze)}}}function Ti($,L){return(L<<3)+(7&$)}function li($){return $<<1^$>>31}function mt($,L){for(var R=$.loadGeometry(),V=$.type,H=0,ie=0,re=R.length,ce=0;ce<re;ce++){var W=R[ce],Ae=1;V===1&&(Ae=W.length),L.writeVarint(Ti(1,Ae));for(var ke=V===3?W.length-1:W.length,ye=0;ye<ke;ye++){ye===1&&V!==1&&L.writeVarint(Ti(2,ke-1));var Ze=W[ye].x-H,pt=W[ye].y-ie;L.writeVarint(li(Ze)),L.writeVarint(li(pt)),H+=Ze,ie+=pt}V===3&&L.writeVarint(Ti(7,1))}}function ge($,L){var R=typeof $;R==="string"?L.writeStringField(1,$):R==="boolean"?L.writeBooleanField(7,$):R==="number"&&($%1!=0?L.writeDoubleField(3,$):$<0?L.writeSVarintField(6,$):L.writeVarintField(5,$))}Ct.exports=vi,Ct.exports.fromVectorTileJs=vi,Ct.exports.fromGeojsonVt=function($,L){L=L||{};var R={};for(var V in $)R[V]=new ni($[V].features,L),R[V].name=V,R[V].version=L.version,R[V].extent=L.extent;return vi({layers:R})},Ct.exports.GeoJSONWrapper=ni;var He=O.by(Ct.exports);const gt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$=>$},Ne=Math.fround||(nt=new Float32Array(1),$=>(nt[0]=+$,nt[0]));var nt;const Q=3,be=5,qe=6;class et{constructor(L){this.options=Object.assign(Object.create(gt),L),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(L){const{log:R,minZoom:V,maxZoom:H}=this.options;R&&console.time("total time");const ie=`prepare ${L.length} points`;R&&console.time(ie),this.points=L;const re=[];for(let W=0;W<L.length;W++){const Ae=L[W];if(!Ae.geometry)continue;const[ke,ye]=Ae.geometry.coordinates,Ze=Ne(Ot(ke)),pt=Ne(qi(ye));re.push(Ze,pt,1/0,W,-1,1),this.options.reduce&&re.push(0)}let ce=this.trees[H+1]=this._createTree(re);R&&console.timeEnd(ie);for(let W=H;W>=V;W--){const Ae=+Date.now();ce=this.trees[W]=this._createTree(this._cluster(ce,W)),R&&console.log("z%d: %d clusters in %dms",W,ce.numItems,+Date.now()-Ae)}return R&&console.timeEnd("total time"),this}getClusters(L,R){let V=((L[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,L[1]));let ie=L[2]===180?180:((L[2]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)V=-180,ie=180;else if(V>ie){const ye=this.getClusters([V,H,180,re],R),Ze=this.getClusters([-180,H,ie,re],R);return ye.concat(Ze)}const ce=this.trees[this._limitZoom(R)],W=ce.range(Ot(V),qi(re),Ot(ie),qi(H)),Ae=ce.data,ke=[];for(const ye of W){const Ze=this.stride*ye;ke.push(Ae[Ze+be]>1?lt(Ae,Ze,this.clusterProps):this.points[Ae[Ze+Q]])}return ke}getChildren(L){const R=this._getOriginId(L),V=this._getOriginZoom(L),H="No cluster with the specified id.",ie=this.trees[V];if(!ie)throw new Error(H);const re=ie.data;if(R*this.stride>=re.length)throw new Error(H);const ce=this.options.radius/(this.options.extent*Math.pow(2,V-1)),W=ie.within(re[R*this.stride],re[R*this.stride+1],ce),Ae=[];for(const ke of W){const ye=ke*this.stride;re[ye+4]===L&&Ae.push(re[ye+be]>1?lt(re,ye,this.clusterProps):this.points[re[ye+Q]])}if(Ae.length===0)throw new Error(H);return Ae}getLeaves(L,R,V){const H=[];return this._appendLeaves(H,L,R=R||10,V=V||0,0),H}getTile(L,R,V){const H=this.trees[this._limitZoom(L)],ie=Math.pow(2,L),{extent:re,radius:ce}=this.options,W=ce/re,Ae=(V-W)/ie,ke=(V+1+W)/ie,ye={features:[]};return this._addTileFeatures(H.range((R-W)/ie,Ae,(R+1+W)/ie,ke),H.data,R,V,ie,ye),R===0&&this._addTileFeatures(H.range(1-W/ie,Ae,1,ke),H.data,ie,V,ie,ye),R===ie-1&&this._addTileFeatures(H.range(0,Ae,W/ie,ke),H.data,-1,V,ie,ye),ye.features.length?ye:null}getClusterExpansionZoom(L){let R=this._getOriginZoom(L)-1;for(;R<=this.options.maxZoom;){const V=this.getChildren(L);if(R++,V.length!==1)break;L=V[0].properties.cluster_id}return R}_appendLeaves(L,R,V,H,ie){const re=this.getChildren(R);for(const ce of re){const W=ce.properties;if(W&&W.cluster?ie+W.point_count<=H?ie+=W.point_count:ie=this._appendLeaves(L,W.cluster_id,V,H,ie):ie<H?ie++:L.push(ce),L.length===V)break}return ie}_createTree(L){const R=new O.av(L.length/this.stride|0,this.options.nodeSize,Float32Array);for(let V=0;V<L.length;V+=this.stride)R.add(L[V],L[V+1]);return R.finish(),R.data=L,R}_addTileFeatures(L,R,V,H,ie,re){for(const ce of L){const W=ce*this.stride,Ae=R[W+be]>1;let ke,ye,Ze;if(Ae)ke=Lt(R,W,this.clusterProps),ye=R[W],Ze=R[W+1];else{const Yt=this.points[R[W+Q]];ke=Yt.properties;const[yt,jt]=Yt.geometry.coordinates;ye=Ot(yt),Ze=qi(jt)}const pt={type:1,geometry:[[Math.round(this.options.extent*(ye*ie-V)),Math.round(this.options.extent*(Ze*ie-H))]],tags:ke};let bt;bt=Ae||this.options.generateId?R[W+Q]:this.points[R[W+Q]].id,bt!==void 0&&(pt.id=bt),re.features.push(pt)}}_limitZoom(L){return Math.max(this.options.minZoom,Math.min(Math.floor(+L),this.options.maxZoom+1))}_cluster(L,R){const{radius:V,extent:H,reduce:ie,minPoints:re}=this.options,ce=V/(H*Math.pow(2,R)),W=L.data,Ae=[],ke=this.stride;for(let ye=0;ye<W.length;ye+=ke){if(W[ye+2]<=R)continue;W[ye+2]=R;const Ze=W[ye],pt=W[ye+1],bt=L.within(W[ye],W[ye+1],ce),Yt=W[ye+be];let yt=Yt;for(const jt of bt){const Xt=jt*ke;W[Xt+2]>R&&(yt+=W[Xt+be])}if(yt>Yt&&yt>=re){let jt,Xt=Ze*Yt,fa=pt*Yt,ra=-1;const Kt=((ye/ke|0)<<5)+(R+1)+this.points.length;for(const zi of bt){const Ri=zi*ke;if(W[Ri+2]<=R)continue;W[Ri+2]=R;const Ta=W[Ri+be];Xt+=W[Ri]*Ta,fa+=W[Ri+1]*Ta,W[Ri+4]=Kt,ie&&(jt||(jt=this._map(W,ye,!0),ra=this.clusterProps.length,this.clusterProps.push(jt)),ie(jt,this._map(W,Ri)))}W[ye+4]=Kt,Ae.push(Xt/yt,fa/yt,1/0,Kt,-1,yt),ie&&Ae.push(ra)}else{for(let jt=0;jt<ke;jt++)Ae.push(W[ye+jt]);if(yt>1)for(const jt of bt){const Xt=jt*ke;if(!(W[Xt+2]<=R)){W[Xt+2]=R;for(let fa=0;fa<ke;fa++)Ae.push(W[Xt+fa])}}}}return Ae}_getOriginId(L){return L-this.points.length>>5}_getOriginZoom(L){return(L-this.points.length)%32}_map(L,R,V){if(L[R+be]>1){const re=this.clusterProps[L[R+qe]];return V?Object.assign({},re):re}const H=this.points[L[R+Q]].properties,ie=this.options.map(H);return V&&ie===H?Object.assign({},ie):ie}}function lt($,L,R){return{type:"Feature",id:$[L+Q],properties:Lt($,L,R),geometry:{type:"Point",coordinates:[(V=$[L],360*(V-.5)),Ai($[L+1])]}};var V}function Lt($,L,R){const V=$[L+be],H=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V,ie=$[L+qe],re=ie===-1?{}:Object.assign({},R[ie]);return Object.assign(re,{cluster:!0,cluster_id:$[L+Q],point_count:V,point_count_abbreviated:H})}function Ot($){return $/360+.5}function qi($){const L=Math.sin($*Math.PI/180),R=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return R<0?0:R>1?1:R}function Ai($){const L=(180-360*$)*Math.PI/180;return 360*Math.atan(Math.exp(L))/Math.PI-90}function rr($,L,R,V){let H=V;const ie=L+(R-L>>1);let re,ce=R-L;const W=$[L],Ae=$[L+1],ke=$[R],ye=$[R+1];for(let Ze=L+3;Ze<R;Ze+=3){const pt=ss($[Ze],$[Ze+1],W,Ae,ke,ye);if(pt>H)re=Ze,H=pt;else if(pt===H){const bt=Math.abs(Ze-ie);bt<ce&&(re=Ze,ce=bt)}}H>V&&(re-L>3&&rr($,L,re,V),$[re+2]=H,R-re>3&&rr($,re,R,V))}function ss($,L,R,V,H,ie){let re=H-R,ce=ie-V;if(re!==0||ce!==0){const W=(($-R)*re+(L-V)*ce)/(re*re+ce*ce);W>1?(R=H,V=ie):W>0&&(R+=re*W,V+=ce*W)}return re=$-R,ce=L-V,re*re+ce*ce}function sr($,L,R,V){const H={id:$??null,type:L,geometry:R,tags:V,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(L==="Point"||L==="MultiPoint"||L==="LineString")Nr(H,R);else if(L==="Polygon")Nr(H,R[0]);else if(L==="MultiLineString")for(const ie of R)Nr(H,ie);else if(L==="MultiPolygon")for(const ie of R)Nr(H,ie[0]);return H}function Nr($,L){for(let R=0;R<L.length;R+=3)$.minX=Math.min($.minX,L[R]),$.minY=Math.min($.minY,L[R+1]),$.maxX=Math.max($.maxX,L[R]),$.maxY=Math.max($.maxY,L[R+1])}function _n($,L,R,V){if(!L.geometry)return;const H=L.geometry.coordinates;if(H&&H.length===0)return;const ie=L.geometry.type,re=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2);let ce=[],W=L.id;if(R.promoteId?W=L.properties[R.promoteId]:R.generateId&&(W=V||0),ie==="Point")os(H,ce);else if(ie==="MultiPoint")for(const Ae of H)os(Ae,ce);else if(ie==="LineString")xe(H,ce,re,!1);else if(ie==="MultiLineString"){if(R.lineMetrics){for(const Ae of H)ce=[],xe(Ae,ce,re,!1),$.push(sr(W,"LineString",ce,L.properties));return}Cs(H,ce,re,!1)}else if(ie==="Polygon")Cs(H,ce,re,!0);else{if(ie!=="MultiPolygon"){if(ie==="GeometryCollection"){for(const Ae of L.geometry.geometries)_n($,{id:W,geometry:Ae,properties:L.properties},R,V);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ae of H){const ke=[];Cs(Ae,ke,re,!0),ce.push(ke)}}$.push(sr(W,ie,ce,L.properties))}function os($,L){L.push(mo($[0]),pi($[1]),0)}function xe($,L,R,V){let H,ie,re=0;for(let W=0;W<$.length;W++){const Ae=mo($[W][0]),ke=pi($[W][1]);L.push(Ae,ke,0),W>0&&(re+=V?(H*ke-Ae*ie)/2:Math.sqrt(Math.pow(Ae-H,2)+Math.pow(ke-ie,2))),H=Ae,ie=ke}const ce=L.length-3;L[2]=1,rr(L,0,ce,R),L[ce+2]=1,L.size=Math.abs(re),L.start=0,L.end=L.size}function Cs($,L,R,V){for(let H=0;H<$.length;H++){const ie=[];xe($[H],ie,R,V),L.push(ie)}}function mo($){return $/360+.5}function pi($){const L=Math.sin($*Math.PI/180),R=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return R<0?0:R>1?1:R}function ea($,L,R,V,H,ie,re,ce){if(V/=L,ie>=(R/=L)&&re<V)return $;if(re<R||ie>=V)return null;const W=[];for(const Ae of $){const ke=Ae.geometry;let ye=Ae.type;const Ze=H===0?Ae.minX:Ae.minY,pt=H===0?Ae.maxX:Ae.maxY;if(Ze>=R&&pt<V){W.push(Ae);continue}if(pt<R||Ze>=V)continue;let bt=[];if(ye==="Point"||ye==="MultiPoint")Ds(ke,bt,R,V,H);else if(ye==="LineString")ls(ke,bt,R,V,H,!1,ce.lineMetrics);else if(ye==="MultiLineString")Pa(ke,bt,R,V,H,!1);else if(ye==="Polygon")Pa(ke,bt,R,V,H,!0);else if(ye==="MultiPolygon")for(const Yt of ke){const yt=[];Pa(Yt,yt,R,V,H,!0),yt.length&&bt.push(yt)}if(bt.length){if(ce.lineMetrics&&ye==="LineString"){for(const Yt of bt)W.push(sr(Ae.id,ye,Yt,Ae.tags));continue}ye!=="LineString"&&ye!=="MultiLineString"||(bt.length===1?(ye="LineString",bt=bt[0]):ye="MultiLineString"),ye!=="Point"&&ye!=="MultiPoint"||(ye=bt.length===3?"Point":"MultiPoint"),W.push(sr(Ae.id,ye,bt,Ae.tags))}}return W.length?W:null}function Ds($,L,R,V,H){for(let ie=0;ie<$.length;ie+=3){const re=$[ie+H];re>=R&&re<=V&&Fn(L,$[ie],$[ie+1],$[ie+2])}}function ls($,L,R,V,H,ie,re){let ce=Fr($);const W=H===0?go:yo;let Ae,ke,ye=$.start;for(let yt=0;yt<$.length-3;yt+=3){const jt=$[yt],Xt=$[yt+1],fa=$[yt+2],ra=$[yt+3],Kt=$[yt+4],zi=H===0?jt:Xt,Ri=H===0?ra:Kt;let Ta=!1;re&&(Ae=Math.sqrt(Math.pow(jt-ra,2)+Math.pow(Xt-Kt,2))),zi<R?Ri>R&&(ke=W(ce,jt,Xt,ra,Kt,R),re&&(ce.start=ye+Ae*ke)):zi>V?Ri<V&&(ke=W(ce,jt,Xt,ra,Kt,V),re&&(ce.start=ye+Ae*ke)):Fn(ce,jt,Xt,fa),Ri<R&&zi>=R&&(ke=W(ce,jt,Xt,ra,Kt,R),Ta=!0),Ri>V&&zi<=V&&(ke=W(ce,jt,Xt,ra,Kt,V),Ta=!0),!ie&&Ta&&(re&&(ce.end=ye+Ae*ke),L.push(ce),ce=Fr($)),re&&(ye+=Ae)}let Ze=$.length-3;const pt=$[Ze],bt=$[Ze+1],Yt=H===0?pt:bt;Yt>=R&&Yt<=V&&Fn(ce,pt,bt,$[Ze+2]),Ze=ce.length-3,ie&&Ze>=3&&(ce[Ze]!==ce[0]||ce[Ze+1]!==ce[1])&&Fn(ce,ce[0],ce[1],ce[2]),ce.length&&L.push(ce)}function Fr($){const L=[];return L.size=$.size,L.start=$.start,L.end=$.end,L}function Pa($,L,R,V,H,ie){for(const re of $)ls(re,L,R,V,H,ie,!1)}function Fn($,L,R,V){$.push(L,R,V)}function go($,L,R,V,H,ie){const re=(ie-L)/(V-L);return Fn($,ie,R+(H-R)*re,1),re}function yo($,L,R,V,H,ie){const re=(ie-R)/(H-R);return Fn($,L+(V-L)*re,ie,1),re}function je($,L){const R=[];for(let V=0;V<$.length;V++){const H=$[V],ie=H.type;let re;if(ie==="Point"||ie==="MultiPoint"||ie==="LineString")re=wr(H.geometry,L);else if(ie==="MultiLineString"||ie==="Polygon"){re=[];for(const ce of H.geometry)re.push(wr(ce,L))}else if(ie==="MultiPolygon"){re=[];for(const ce of H.geometry){const W=[];for(const Ae of ce)W.push(wr(Ae,L));re.push(W)}}R.push(sr(H.id,ie,re,H.tags))}return R}function wr($,L){const R=[];R.size=$.size,$.start!==void 0&&(R.start=$.start,R.end=$.end);for(let V=0;V<$.length;V+=3)R.push($[V]+L,$[V+1],$[V+2]);return R}function Ja($,L){if($.transformed)return $;const R=1<<$.z,V=$.x,H=$.y;for(const ie of $.features){const re=ie.geometry,ce=ie.type;if(ie.geometry=[],ce===1)for(let W=0;W<re.length;W+=2)ie.geometry.push(Sr(re[W],re[W+1],L,R,V,H));else for(let W=0;W<re.length;W++){const Ae=[];for(let ke=0;ke<re[W].length;ke+=2)Ae.push(Sr(re[W][ke],re[W][ke+1],L,R,V,H));ie.geometry.push(Ae)}}return $.transformed=!0,$}function Sr($,L,R,V,H,ie){return[Math.round(R*($*V-H)),Math.round(R*(L*V-ie))]}function us($,L,R,V,H){const ie=L===H.maxZoom?0:H.tolerance/((1<<L)*H.extent),re={features:[],numPoints:0,numSimplified:0,numFeatures:$.length,source:null,x:R,y:V,z:L,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ce of $)Xe(re,ce,ie,H);return re}function Xe($,L,R,V){const H=L.geometry,ie=L.type,re=[];if($.minX=Math.min($.minX,L.minX),$.minY=Math.min($.minY,L.minY),$.maxX=Math.max($.maxX,L.maxX),$.maxY=Math.max($.maxY,L.maxY),ie==="Point"||ie==="MultiPoint")for(let ce=0;ce<H.length;ce+=3)re.push(H[ce],H[ce+1]),$.numPoints++,$.numSimplified++;else if(ie==="LineString")Dt(re,H,$,R,!1,!1);else if(ie==="MultiLineString"||ie==="Polygon")for(let ce=0;ce<H.length;ce++)Dt(re,H[ce],$,R,ie==="Polygon",ce===0);else if(ie==="MultiPolygon")for(let ce=0;ce<H.length;ce++){const W=H[ce];for(let Ae=0;Ae<W.length;Ae++)Dt(re,W[Ae],$,R,!0,Ae===0)}if(re.length){let ce=L.tags||null;if(ie==="LineString"&&V.lineMetrics){ce={};for(const Ae in L.tags)ce[Ae]=L.tags[Ae];ce.mapbox_clip_start=H.start/H.size,ce.mapbox_clip_end=H.end/H.size}const W={geometry:re,type:ie==="Polygon"||ie==="MultiPolygon"?3:ie==="LineString"||ie==="MultiLineString"?2:1,tags:ce};L.id!==null&&(W.id=L.id),$.features.push(W)}}function Dt($,L,R,V,H,ie){const re=V*V;if(V>0&&L.size<(H?re:V))return void(R.numPoints+=L.length/3);const ce=[];for(let W=0;W<L.length;W+=3)(V===0||L[W+2]>re)&&(R.numSimplified++,ce.push(L[W],L[W+1])),R.numPoints++;H&&(function(W,Ae){let ke=0;for(let ye=0,Ze=W.length,pt=Ze-2;ye<Ze;pt=ye,ye+=2)ke+=(W[ye]-W[pt])*(W[ye+1]+W[pt+1]);if(ke>0===Ae)for(let ye=0,Ze=W.length;ye<Ze/2;ye+=2){const pt=W[ye],bt=W[ye+1];W[ye]=W[Ze-2-ye],W[ye+1]=W[Ze-1-ye],W[Ze-2-ye]=pt,W[Ze-1-ye]=bt}})(ce,ie),$.push(ce)}const xt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ki{constructor(L,R){const V=(R=this.options=(function(ie,re){for(const ce in re)ie[ce]=re[ce];return ie})(Object.create(xt),R)).debug;if(V&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");let H=(function(ie,re){const ce=[];if(ie.type==="FeatureCollection")for(let W=0;W<ie.features.length;W++)_n(ce,ie.features[W],re,W);else _n(ce,ie.type==="Feature"?ie:{geometry:ie},re);return ce})(L,R);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),H=(function(ie,re){const ce=re.buffer/re.extent;let W=ie;const Ae=ea(ie,1,-1-ce,ce,0,-1,2,re),ke=ea(ie,1,1-ce,2+ce,0,-1,2,re);return(Ae||ke)&&(W=ea(ie,1,-ce,1+ce,0,-1,2,re)||[],Ae&&(W=je(Ae,1).concat(W)),ke&&(W=W.concat(je(ke,-1)))),W})(H,R),H.length&&this.splitTile(H,0,0,0),V&&(H.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(L,R,V,H,ie,re,ce){const W=[L,R,V,H],Ae=this.options,ke=Ae.debug;for(;W.length;){H=W.pop(),V=W.pop(),R=W.pop(),L=W.pop();const ye=1<<R,Ze=or(R,V,H);let pt=this.tiles[Ze];if(!pt&&(ke>1&&console.time("creation"),pt=this.tiles[Ze]=us(L,R,V,H,Ae),this.tileCoords.push({z:R,x:V,y:H}),ke)){ke>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,V,H,pt.numFeatures,pt.numPoints,pt.numSimplified),console.timeEnd("creation"));const Ta=`z${R}`;this.stats[Ta]=(this.stats[Ta]||0)+1,this.total++}if(pt.source=L,ie==null){if(R===Ae.indexMaxZoom||pt.numPoints<=Ae.indexMaxPoints)continue}else{if(R===Ae.maxZoom||R===ie)continue;if(ie!=null){const Ta=ie-R;if(V!==re>>Ta||H!==ce>>Ta)continue}}if(pt.source=null,L.length===0)continue;ke>1&&console.time("clipping");const bt=.5*Ae.buffer/Ae.extent,Yt=.5-bt,yt=.5+bt,jt=1+bt;let Xt=null,fa=null,ra=null,Kt=null,zi=ea(L,ye,V-bt,V+yt,0,pt.minX,pt.maxX,Ae),Ri=ea(L,ye,V+Yt,V+jt,0,pt.minX,pt.maxX,Ae);L=null,zi&&(Xt=ea(zi,ye,H-bt,H+yt,1,pt.minY,pt.maxY,Ae),fa=ea(zi,ye,H+Yt,H+jt,1,pt.minY,pt.maxY,Ae),zi=null),Ri&&(ra=ea(Ri,ye,H-bt,H+yt,1,pt.minY,pt.maxY,Ae),Kt=ea(Ri,ye,H+Yt,H+jt,1,pt.minY,pt.maxY,Ae),Ri=null),ke>1&&console.timeEnd("clipping"),W.push(Xt||[],R+1,2*V,2*H),W.push(fa||[],R+1,2*V,2*H+1),W.push(ra||[],R+1,2*V+1,2*H),W.push(Kt||[],R+1,2*V+1,2*H+1)}}getTile(L,R,V){L=+L,R=+R,V=+V;const H=this.options,{extent:ie,debug:re}=H;if(L<0||L>24)return null;const ce=1<<L,W=or(L,R=R+ce&ce-1,V);if(this.tiles[W])return Ja(this.tiles[W],ie);re>1&&console.log("drilling down to z%d-%d-%d",L,R,V);let Ae,ke=L,ye=R,Ze=V;for(;!Ae&&ke>0;)ke--,ye>>=1,Ze>>=1,Ae=this.tiles[or(ke,ye,Ze)];return Ae&&Ae.source?(re>1&&(console.log("found parent tile z%d-%d-%d",ke,ye,Ze),console.time("drilling down")),this.splitTile(Ae.source,ke,ye,Ze,L,R,V),re>1&&console.timeEnd("drilling down"),this.tiles[W]?Ja(this.tiles[W],ie):null):null}}function or($,L,R){return 32*((1<<$)*R+L)+$}function Ft($,L){return L?$.properties[L]:$.id}function Tr($,L){if($==null)return!0;if($.type==="Feature")return Ft($,L)!=null;if($.type==="FeatureCollection"){const R=new Set;for(const V of $.features){const H=Ft(V,L);if(H==null||R.has(H))return!1;R.add(H)}return!0}return!1}function jn($,L){const R=new Map;if($!=null)if($.type==="Feature")R.set(Ft($,L),$);else for(const V of $.features)R.set(Ft(V,L),V);return R}class lr extends me{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(L,R){return O._(this,void 0,void 0,(function*(){const V=L.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const H=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!H)return null;const ie=new class{constructor(ce){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=O.X,this.length=ce.length,this._features=ce}feature(ce){return new class{constructor(W){this._feature=W,this.extent=O.X,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))}loadGeometry(){if(this._feature.type===1){const W=[];for(const Ae of this._feature.geometry)W.push([new O.P(Ae[0],Ae[1])]);return W}{const W=[];for(const Ae of this._feature.geometry){const ke=[];for(const ye of Ae)ke.push(new O.P(ye[0],ye[1]));W.push(ke)}return W}}toGeoJSON(W,Ae,ke){return Ut.call(this,W,Ae,ke)}}(this._features[ce])}}(H.features);let re=He(ie);return re.byteOffset===0&&re.byteLength===re.buffer.byteLength||(re=new Uint8Array(re)),{vectorTile:ie,rawData:re.buffer}}))}loadData(L){return O._(this,void 0,void 0,(function*(){var R;(R=this._pendingRequest)===null||R===void 0||R.abort();const V=!!(L&&L.request&&L.request.collectResourceTiming)&&new O.bv(L.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(L,this._pendingRequest),this._geoJSONIndex=L.cluster?new et((function({superclusterOptions:re,clusterProperties:ce}){if(!ce||!re)return re;const W={},Ae={},ke={accumulated:null,zoom:0},ye={properties:null},Ze=Object.keys(ce);for(const pt of Ze){const[bt,Yt]=ce[pt],yt=O.bC(Yt),jt=O.bC(typeof bt=="string"?[bt,["accumulated"],["get",pt]]:bt);W[pt]=yt.value,Ae[pt]=jt.value}return re.map=pt=>{ye.properties=pt;const bt={};for(const Yt of Ze)bt[Yt]=W[Yt].evaluate(ke,ye);return bt},re.reduce=(pt,bt)=>{ye.properties=bt;for(const Yt of Ze)ke.accumulated=pt[Yt],pt[Yt]=Ae[Yt].evaluate(ke,ye)},re})(L)).load((yield this._pendingData).features):(H=yield this._pendingData,new Ki(H,L.geojsonVtOptions)),this.loaded={};const ie={};if(V){const re=V.finish();re&&(ie.resourceTiming={},ie.resourceTiming[L.source]=JSON.parse(JSON.stringify(re)))}return ie}catch(ie){if(delete this._pendingRequest,O.bB(ie))return{abandoned:!0};throw ie}var H}))}getData(){return O._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(L){const R=this.loaded;return R&&R[L.uid]?super.reloadTile(L):this.loadTile(L)}loadAndProcessGeoJSON(L,R){return O._(this,void 0,void 0,(function*(){let V=yield this.loadGeoJSON(L,R);if(delete this._pendingRequest,typeof V!="object")throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(ti(V,!0),L.filter){const H=O.bC(L.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(H.result==="error")throw new Error(H.value.map((re=>`${re.key}: ${re.message}`)).join(", "));V={type:"FeatureCollection",features:V.features.filter((re=>H.value.evaluate({zoom:0},re)))}}return V}))}loadGeoJSON(L,R){return O._(this,void 0,void 0,(function*(){const{promoteId:V}=L;if(L.request){const H=yield O.h(L.request,R);return this._dataUpdateable=Tr(H.data,V)?jn(H.data,V):void 0,H.data}if(typeof L.data=="string")try{const H=JSON.parse(L.data);return this._dataUpdateable=Tr(H,V)?jn(H,V):void 0,H}catch{throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`)}if(!L.dataDiff)throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${L.source}`);return(function(H,ie,re){var ce,W,Ae,ke;if(ie.removeAll&&H.clear(),ie.remove)for(const ye of ie.remove)H.delete(ye);if(ie.add)for(const ye of ie.add){const Ze=Ft(ye,re);Ze!=null&&H.set(Ze,ye)}if(ie.update)for(const ye of ie.update){let Ze=H.get(ye.id);if(Ze==null)continue;const pt=!ye.removeAllProperties&&(((ce=ye.removeProperties)===null||ce===void 0?void 0:ce.length)>0||((W=ye.addOrUpdateProperties)===null||W===void 0?void 0:W.length)>0);if((ye.newGeometry||ye.removeAllProperties||pt)&&(Ze=Object.assign({},Ze),H.set(ye.id,Ze),pt&&(Ze.properties=Object.assign({},Ze.properties))),ye.newGeometry&&(Ze.geometry=ye.newGeometry),ye.removeAllProperties)Ze.properties={};else if(((Ae=ye.removeProperties)===null||Ae===void 0?void 0:Ae.length)>0)for(const bt of ye.removeProperties)Object.prototype.hasOwnProperty.call(Ze.properties,bt)&&delete Ze.properties[bt];if(((ke=ye.addOrUpdateProperties)===null||ke===void 0?void 0:ke.length)>0)for(const{key:bt,value:Yt}of ye.addOrUpdateProperties)Ze.properties[bt]=Yt}})(this._dataUpdateable,L.dataDiff,V),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(L){return O._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(L){return this._geoJSONIndex.getClusterExpansionZoom(L.clusterId)}getClusterChildren(L){return this._geoJSONIndex.getChildren(L.clusterId)}getClusterLeaves(L){return this._geoJSONIndex.getLeaves(L.clusterId,L.limit,L.offset)}}class In{constructor(L){this.self=L,this.actor=new O.F(L),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(R,V)=>{if(this.externalWorkerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.externalWorkerSourceTypes[R]=V},this.self.addProtocol=O.bi,this.self.removeProtocol=O.bj,this.self.registerRTLTextPlugin=R=>{if(O.bD.isParsed())throw new Error("RTL text plugin already registered.");O.bD.setMethods(R)},this.actor.registerMessageHandler("LDT",((R,V)=>this._getDEMWorkerSource(R,V.source).loadTile(V))),this.actor.registerMessageHandler("RDT",((R,V)=>O._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(R,V.source).removeTile(V)})))),this.actor.registerMessageHandler("GCEZ",((R,V)=>O._(this,void 0,void 0,(function*(){return this._getWorkerSource(R,V.type,V.source).getClusterExpansionZoom(V)})))),this.actor.registerMessageHandler("GCC",((R,V)=>O._(this,void 0,void 0,(function*(){return this._getWorkerSource(R,V.type,V.source).getClusterChildren(V)})))),this.actor.registerMessageHandler("GCL",((R,V)=>O._(this,void 0,void 0,(function*(){return this._getWorkerSource(R,V.type,V.source).getClusterLeaves(V)})))),this.actor.registerMessageHandler("LD",((R,V)=>this._getWorkerSource(R,V.type,V.source).loadData(V))),this.actor.registerMessageHandler("GD",((R,V)=>this._getWorkerSource(R,V.type,V.source).getData())),this.actor.registerMessageHandler("LT",((R,V)=>this._getWorkerSource(R,V.type,V.source).loadTile(V))),this.actor.registerMessageHandler("RT",((R,V)=>this._getWorkerSource(R,V.type,V.source).reloadTile(V))),this.actor.registerMessageHandler("AT",((R,V)=>this._getWorkerSource(R,V.type,V.source).abortTile(V))),this.actor.registerMessageHandler("RMT",((R,V)=>this._getWorkerSource(R,V.type,V.source).removeTile(V))),this.actor.registerMessageHandler("RS",((R,V)=>O._(this,void 0,void 0,(function*(){if(!this.workerSources[R]||!this.workerSources[R][V.type]||!this.workerSources[R][V.type][V.source])return;const H=this.workerSources[R][V.type][V.source];delete this.workerSources[R][V.type][V.source],H.removeSource!==void 0&&H.removeSource(V)})))),this.actor.registerMessageHandler("RM",(R=>O._(this,void 0,void 0,(function*(){delete this.layerIndexes[R],delete this.availableImages[R],delete this.workerSources[R],delete this.demWorkerSources[R]})))),this.actor.registerMessageHandler("SR",((R,V)=>O._(this,void 0,void 0,(function*(){this.referrer=V})))),this.actor.registerMessageHandler("SRPS",((R,V)=>this._syncRTLPluginState(R,V))),this.actor.registerMessageHandler("IS",((R,V)=>O._(this,void 0,void 0,(function*(){this.self.importScripts(V)})))),this.actor.registerMessageHandler("SI",((R,V)=>this._setImages(R,V))),this.actor.registerMessageHandler("UL",((R,V)=>O._(this,void 0,void 0,(function*(){this._getLayerIndex(R).update(V.layers,V.removedIds)})))),this.actor.registerMessageHandler("SL",((R,V)=>O._(this,void 0,void 0,(function*(){this._getLayerIndex(R).replace(V)}))))}_setImages(L,R){return O._(this,void 0,void 0,(function*(){this.availableImages[L]=R;for(const V in this.workerSources[L]){const H=this.workerSources[L][V];for(const ie in H)H[ie].availableImages=R}}))}_syncRTLPluginState(L,R){return O._(this,void 0,void 0,(function*(){if(O.bD.isParsed())return O.bD.getState();if(R.pluginStatus!=="loading")return O.bD.setState(R),R;const V=R.pluginURL;if(this.self.importScripts(V),O.bD.isParsed()){const H={pluginStatus:"loaded",pluginURL:V};return O.bD.setState(H),H}throw O.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${V}`)}))}_getAvailableImages(L){let R=this.availableImages[L];return R||(R=[]),R}_getLayerIndex(L){let R=this.layerIndexes[L];return R||(R=this.layerIndexes[L]=new y),R}_getWorkerSource(L,R,V){if(this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][R]||(this.workerSources[L][R]={}),!this.workerSources[L][R][V]){const H={sendAsync:(ie,re)=>(ie.targetMapId=L,this.actor.sendAsync(ie,re))};switch(R){case"vector":this.workerSources[L][R][V]=new me(H,this._getLayerIndex(L),this._getAvailableImages(L));break;case"geojson":this.workerSources[L][R][V]=new lr(H,this._getLayerIndex(L),this._getAvailableImages(L));break;default:this.workerSources[L][R][V]=new this.externalWorkerSourceTypes[R](H,this._getLayerIndex(L),this._getAvailableImages(L))}}return this.workerSources[L][R][V]}_getDEMWorkerSource(L,R){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][R]||(this.demWorkerSources[L][R]=new pe),this.demWorkerSources[L][R]}}return O.i(self)&&(self.worker=new In(self)),In})),_t("index",["exports","./shared"],(function(O,y){var Ue="4.7.1";let Ee,ht;const me={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:p=>new Promise(((e,s)=>{const u=requestAnimationFrame(e);p.signal.addEventListener("abort",(()=>{cancelAnimationFrame(u),s(y.c())}))})),getImageData(p,e=0){return this.getImageCanvasContext(p).getImageData(-e,-e,p.width+2*e,p.height+2*e)},getImageCanvasContext(p){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=p.width,e.height=p.height,s.drawImage(p,0,0,p.width,p.height),s},resolveURL:p=>(Ee||(Ee=document.createElement("a")),Ee.href=p,Ee.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ht==null&&(ht=matchMedia("(prefers-reduced-motion: reduce)")),ht.matches)}};class pe{static testProp(e){if(!pe.docStyle)return e[0];for(let s=0;s<e.length;s++)if(e[s]in pe.docStyle)return e[s];return e[0]}static create(e,s,u){const c=window.document.createElement(e);return s!==void 0&&(c.className=s),u&&u.appendChild(c),c}static createNS(e,s){return window.document.createElementNS(e,s)}static disableDrag(){pe.docStyle&&pe.selectProp&&(pe.userSelect=pe.docStyle[pe.selectProp],pe.docStyle[pe.selectProp]="none")}static enableDrag(){pe.docStyle&&pe.selectProp&&(pe.docStyle[pe.selectProp]=pe.userSelect)}static setTransform(e,s){e.style[pe.transformProp]=s}static addEventListener(e,s,u,c={}){e.addEventListener(s,u,"passive"in c?c:c.capture)}static removeEventListener(e,s,u,c={}){e.removeEventListener(s,u,"passive"in c?c:c.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",pe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",pe.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",pe.suppressClickInternal,!0)}),0)}static getScale(e){const s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}static getPoint(e,s,u){const c=s.boundingClientRect;return new y.P((u.clientX-c.left)/s.x-e.clientLeft,(u.clientY-c.top)/s.y-e.clientTop)}static mousePos(e,s){const u=pe.getScale(e);return pe.getPoint(e,u,s)}static touchPos(e,s){const u=[],c=pe.getScale(e);for(let f=0;f<s.length;f++)u.push(pe.getPoint(e,c,s[f]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}pe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,pe.selectProp=pe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),pe.transformProp=pe.testProp(["transform","WebkitTransform"]);const Ii={supported:!1,testSupport:function(p){!Ut&&ti&&(Ct?qt(p):ki=p)}};let ki,ti,Ut=!1,Ct=!1;function qt(p){const e=p.createTexture();p.bindTexture(p.TEXTURE_2D,e);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,ti),p.isContextLost())return;Ii.supported=!0}catch{}p.deleteTexture(e),Ut=!0}var dt;typeof document<"u"&&(ti=document.createElement("img"),ti.onload=()=>{ki&&qt(ki),ki=null,Ct=!0},ti.onerror=()=>{Ut=!0,ki=null},ti.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(p){let e,s,u,c;p.resetRequestQueue=()=>{e=[],s=0,u=0,c={}},p.addThrottleControl=T=>{const E=u++;return c[E]=T,E},p.removeThrottleControl=T=>{delete c[T],x()},p.getImage=(T,E,D=!0)=>new Promise(((I,P)=>{Ii.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),y.e(T,{type:"image"}),e.push({abortController:E,requestParameters:T,supportImageRefresh:D,state:"queued",onError:j=>{P(j)},onSuccess:j=>{I(j)}}),x()}));const f=T=>y._(this,void 0,void 0,(function*(){T.state="running";const{requestParameters:E,supportImageRefresh:D,onError:I,onSuccess:P,abortController:j}=T,q=D===!1&&!y.i(self)&&!y.g(E.url)&&(!E.headers||Object.keys(E.headers).reduce(((J,ee)=>J&&ee==="accept"),!0));s++;const X=q?S(E,j):y.m(E,j);try{const J=yield X;delete T.abortController,T.state="completed",J.data instanceof HTMLImageElement||y.b(J.data)?P(J):J.data&&P({data:yield(K=J.data,typeof createImageBitmap=="function"?y.d(K):y.f(K)),cacheControl:J.cacheControl,expires:J.expires})}catch(J){delete T.abortController,I(J)}finally{s--,x()}var K})),x=()=>{const T=(()=>{for(const E of Object.keys(c))if(c[E]())return!0;return!1})()?y.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:y.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let E=s;E<T&&e.length>0;E++){const D=e.shift();D.abortController.signal.aborted?E--:f(D)}},S=(T,E)=>new Promise(((D,I)=>{const P=new Image,j=T.url,q=T.credentials;q&&q==="include"?P.crossOrigin="use-credentials":(q&&q==="same-origin"||!y.s(j))&&(P.crossOrigin="anonymous"),E.signal.addEventListener("abort",(()=>{P.src="",I(y.c())})),P.fetchPriority="high",P.onload=()=>{P.onerror=P.onload=null,D({data:P})},P.onerror=()=>{P.onerror=P.onload=null,E.signal.aborted||I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},P.src=j}))})(dt||(dt={})),dt.resetRequestQueue();class ft{constructor(e){this._transformRequestFn=e}transformRequest(e,s){return this._transformRequestFn&&this._transformRequestFn(e,s)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ht(p){var e=new y.A(3);return e[0]=p[0],e[1]=p[1],e[2]=p[2],e}var Zt,ot=function(p,e,s){return p[0]=e[0]-s[0],p[1]=e[1]-s[1],p[2]=e[2]-s[2],p};Zt=new y.A(3),y.A!=Float32Array&&(Zt[0]=0,Zt[1]=0,Zt[2]=0);var ni=function(p){var e=p[0],s=p[1];return e*e+s*s};function vi(p){const e=[];if(typeof p=="string")e.push({id:"default",url:p});else if(p&&p.length>0){const s=[];for(const{id:u,url:c}of p){const f=`${u}${c}`;s.indexOf(f)===-1&&(s.push(f),e.push({id:u,url:c}))}}return e}function Si(p,e,s){const u=p.split("?");return u[0]+=`${e}${s}`,u.join("?")}(function(){var p=new y.A(2);y.A!=Float32Array&&(p[0]=0,p[1]=0)})();class Pt{constructor(e,s,u,c){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(s,c)}update(e,s,u){const{width:c,height:f}=e,x=!(this.size&&this.size[0]===c&&this.size[1]===f||u),{context:S}=this,{gl:T}=S;if(this.useMipmap=!!(s&&s.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!s||s.premultiply!==!1)),x)this.size=[c,f],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||y.b(e)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,c,f,0,this.format,T.UNSIGNED_BYTE,e.data);else{const{x:E,y:D}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||y.b(e)?T.texSubImage2D(T.TEXTURE_2D,0,E,D,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,E,D,c,f,T.RGBA,T.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(e,s,u){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),u!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=f.LINEAR),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,u||e),this.filter=e),s!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Vi(p){const{userImage:e}=p;return!!(e&&e.render&&e.render())&&(p.data.replace(new Uint8Array(e.data.buffer)),!0)}class Ti extends y.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new y.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:s,promiseResolve:u}of this.requestors)u(this._getImagesForIds(s));this.requestors=[]}}getImage(e){const s=this.images[e];if(s&&!s.data&&s.spriteData){const u=s.spriteData;s.data=new y.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),s.spriteData=null}return s}addImage(e,s){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,s)&&(this.images[e]=s)}_validate(e,s){let u=!0;const c=s.data||s.spriteData;return this._validateStretch(s.stretchX,c&&c.width)||(this.fire(new y.j(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(s.stretchY,c&&c.height)||(this.fire(new y.j(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(s.content,s)||(this.fire(new y.j(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,s){if(!e)return!0;let u=0;for(const c of e){if(c[0]<u||c[1]<c[0]||s<c[1])return!1;u=c[1]}return!0}_validateContent(e,s){if(!e)return!0;if(e.length!==4)return!1;const u=s.spriteData,c=u&&u.width||s.data.width,f=u&&u.height||s.data.height;return!(e[0]<0||c<e[0]||e[1]<0||f<e[1]||e[2]<0||c<e[2]||e[3]<0||f<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,s,u=!0){const c=this.getImage(e);if(u&&(c.data.width!==s.data.width||c.data.height!==s.data.height))throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=c.version+1,this.images[e]=s,this.updatedImages[e]=!0}removeImage(e){const s=this.images[e];delete this.images[e],delete this.patterns[e],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((s,u)=>{let c=!0;if(!this.isLoaded())for(const f of e)this.images[f]||(c=!1);this.isLoaded()||c?s(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:s})}))}_getImagesForIds(e){const s={};for(const u of e){let c=this.getImage(u);c||(this.fire(new y.k("styleimagemissing",{id:u})),c=this.getImage(u)),c?s[u]={data:c.data.clone(),pixelRatio:c.pixelRatio,sdf:c.sdf,version:c.version,stretchX:c.stretchX,stretchY:c.stretchY,content:c.content,textFitWidth:c.textFitWidth,textFitHeight:c.textFitHeight,hasRenderCallback:!!(c.userImage&&c.userImage.render)}:y.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:e,height:s}=this.atlasImage;return{width:e,height:s}}getPattern(e){const s=this.patterns[e],u=this.getImage(e);if(!u)return null;if(s&&s.position.version===u.version)return s.position;if(s)s.position.version=u.version;else{const c={w:u.data.width+2,h:u.data.height+2,x:0,y:0},f=new y.I(c,u);this.patterns[e]={bin:c,position:f}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const s=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Pt(e,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const f in this.patterns)e.push(this.patterns[f].bin);const{w:s,h:u}=y.p(e),c=this.atlasImage;c.resize({width:s||1,height:u||1});for(const f in this.patterns){const{bin:x}=this.patterns[f],S=x.x+1,T=x.y+1,E=this.getImage(f).data,D=E.width,I=E.height;y.R.copy(E,c,{x:0,y:0},{x:S,y:T},{width:D,height:I}),y.R.copy(E,c,{x:0,y:I-1},{x:S,y:T-1},{width:D,height:1}),y.R.copy(E,c,{x:0,y:0},{x:S,y:T+I},{width:D,height:1}),y.R.copy(E,c,{x:D-1,y:0},{x:S-1,y:T},{width:1,height:I}),y.R.copy(E,c,{x:0,y:0},{x:S+D,y:T},{width:1,height:I})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const s of e){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const u=this.getImage(s);u||y.w(`Image with ID: "${s}" was not found`),Vi(u)&&this.updateImage(s,u)}}}const li=1e20;function mt(p,e,s,u,c,f,x,S,T){for(let E=e;E<e+u;E++)ge(p,s*f+E,f,c,x,S,T);for(let E=s;E<s+c;E++)ge(p,E*f+e,1,u,x,S,T)}function ge(p,e,s,u,c,f,x){f[0]=0,x[0]=-li,x[1]=li,c[0]=p[e];for(let S=1,T=0,E=0;S<u;S++){c[S]=p[e+S*s];const D=S*S;do{const I=f[T];E=(c[S]-c[I]+D-I*I)/(S-I)/2}while(E<=x[T]&&--T>-1);T++,f[T]=S,x[T]=E,x[T+1]=li}for(let S=0,T=0;S<u;S++){for(;x[T+1]<S;)T++;const E=f[T],D=S-E;p[e+S*s]=c[E]+D*D}}class He{constructor(e,s){this.requestManager=e,this.localIdeographFontFamily=s,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return y._(this,void 0,void 0,(function*(){const s=[];for(const f in e)for(const x of e[f])s.push(this._getAndCacheGlyphsPromise(f,x));const u=yield Promise.all(s),c={};for(const{stack:f,id:x,glyph:S}of u)c[f]||(c[f]={}),c[f][x]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return c}))}_getAndCacheGlyphsPromise(e,s){return y._(this,void 0,void 0,(function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let c=u.glyphs[s];if(c!==void 0)return{stack:e,id:s,glyph:c};if(c=this._tinySDF(u,e,s),c)return u.glyphs[s]=c,{stack:e,id:s,glyph:c};const f=Math.floor(s/256);if(256*f>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[f])return{stack:e,id:s,glyph:c};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[f]){const S=He.loadGlyphRange(e,f,this.url,this.requestManager);u.requests[f]=S}const x=yield u.requests[f];for(const S in x)this._doesCharSupportLocalGlyph(+S)||(u.glyphs[+S]=x[+S]);return u.ranges[f]=!0,{stack:e,id:s,glyph:x[s]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,s,u){const c=this.localIdeographFontFamily;if(!c||!this._doesCharSupportLocalGlyph(u))return;let f=e.tinySDF;if(!f){let S="400";/bold/i.test(s)?S="900":/medium/i.test(s)?S="500":/light/i.test(s)&&(S="200"),f=e.tinySDF=new He.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:c,fontWeight:S})}const x=f.draw(String.fromCharCode(u));return{id:u,bitmap:new y.o({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}He.loadGlyphRange=function(p,e,s,u){return y._(this,void 0,void 0,(function*(){const c=256*e,f=c+255,x=u.transformRequest(s.replace("{fontstack}",p).replace("{range}",`${c}-${f}`),"Glyphs"),S=yield y.l(x,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${e}, ${c}-${f}`);const T={};for(const E of y.n(S.data))T[E.id]=E;return T}))},He.TinySDF=class{constructor({fontSize:p=24,buffer:e=3,radius:s=8,cutoff:u=.25,fontFamily:c="sans-serif",fontWeight:f="normal",fontStyle:x="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=s;const S=this.size=p+4*e,T=this._createCanvas(S),E=this.ctx=T.getContext("2d",{willReadFrequently:!0});E.font=`${x} ${f} ${p}px ${c}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(p){const e=document.createElement("canvas");return e.width=e.height=p,e}draw(p){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:c,actualBoundingBoxRight:f}=this.ctx.measureText(p),x=Math.ceil(s),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-c))),T=Math.min(this.size-this.buffer,x+Math.ceil(u)),E=S+2*this.buffer,D=T+2*this.buffer,I=Math.max(E*D,0),P=new Uint8ClampedArray(I),j={data:P,width:E,height:D,glyphWidth:S,glyphHeight:T,glyphTop:x,glyphLeft:0,glyphAdvance:e};if(S===0||T===0)return j;const{ctx:q,buffer:X,gridInner:K,gridOuter:J}=this;q.clearRect(X,X,S,T),q.fillText(p,X,X+x);const ee=q.getImageData(X,X,S,T);J.fill(li,0,I),K.fill(0,0,I);for(let Z=0;Z<T;Z++)for(let ne=0;ne<S;ne++){const oe=ee.data[4*(Z*S+ne)+3]/255;if(oe===0)continue;const fe=(Z+X)*E+ne+X;if(oe===1)J[fe]=0,K[fe]=li;else{const De=.5-oe;J[fe]=De>0?De*De:0,K[fe]=De<0?De*De:0}}mt(J,0,0,E,D,E,this.f,this.v,this.z),mt(K,X,X,S,T,E,this.f,this.v,this.z);for(let Z=0;Z<I;Z++){const ne=Math.sqrt(J[Z])-Math.sqrt(K[Z]);P[Z]=Math.round(255-255*(ne/this.radius+this.cutoff))}return j}};class gt{constructor(){this.specification=y.v.light.position}possiblyEvaluate(e,s){return y.x(e.expression.evaluate(s))}interpolate(e,s,u){return{x:y.y.number(e.x,s.x,u),y:y.y.number(e.y,s.y,u),z:y.y.number(e.z,s.z,u)}}}let Ne;class nt extends y.E{constructor(e){super(),Ne=Ne||new y.q({anchor:new y.D(y.v.light.anchor),position:new gt,color:new y.D(y.v.light.color),intensity:new y.D(y.v.light.intensity)}),this._transitionable=new y.T(Ne),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,s={}){if(!this._validate(y.r,e,s))for(const u in e){const c=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),c):this._transitionable.setValue(u,c)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,u){return(!u||u.validate!==!1)&&y.t(this,e.call(y.u,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:y.v}))}}const Q=new y.q({"sky-color":new y.D(y.v.sky["sky-color"]),"horizon-color":new y.D(y.v.sky["horizon-color"]),"fog-color":new y.D(y.v.sky["fog-color"]),"fog-ground-blend":new y.D(y.v.sky["fog-ground-blend"]),"horizon-fog-blend":new y.D(y.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new y.D(y.v.sky["sky-horizon-blend"]),"atmosphere-blend":new y.D(y.v.sky["atmosphere-blend"])});class be extends y.E{constructor(e){super(),this._transitionable=new y.T(Q),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new y.z(0))}setSky(e,s={}){if(!this._validate(y.B,e,s)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const u in e){const c=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),c):this._transitionable.setValue(u,c)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,u={}){return(u==null?void 0:u.validate)!==!1&&y.t(this,e.call(y.u,y.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:y.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class qe{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,s){const u=e.join(",")+String(s);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,s)),this.dashEntry[u]}getDashRanges(e,s,u){const c=[];let f=e.length%2==1?-e[e.length-1]*u:0,x=e[0]*u,S=!0;c.push({left:f,right:x,isDash:S,zeroLength:e[0]===0});let T=e[0];for(let E=1;E<e.length;E++){S=!S;const D=e[E];f=T*u,T+=D,x=T*u,c.push({left:f,right:x,isDash:S,zeroLength:D===0})}return c}addRoundDash(e,s,u){const c=s/2;for(let f=-u;f<=u;f++){const x=this.width*(this.nextRow+u+f);let S=0,T=e[S];for(let E=0;E<this.width;E++){E/T.right>1&&(T=e[++S]);const D=Math.abs(E-T.left),I=Math.abs(E-T.right),P=Math.min(D,I);let j;const q=f/u*(c+1);if(T.isDash){const X=c-Math.abs(q);j=Math.sqrt(P*P+X*X)}else j=c-Math.sqrt(P*P+q*q);this.data[x+E]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(e){for(let S=e.length-1;S>=0;--S){const T=e[S],E=e[S+1];T.zeroLength?e.splice(S,1):E&&E.isDash===T.isDash&&(E.left=T.left,e.splice(S,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const c=this.width*this.nextRow;let f=0,x=e[f];for(let S=0;S<this.width;S++){S/x.right>1&&(x=e[++f]);const T=Math.abs(S-x.left),E=Math.abs(S-x.right),D=Math.min(T,E);this.data[c+S]=Math.max(0,Math.min(255,(x.isDash?D:-D)+128))}}addDash(e,s){const u=s?7:0,c=2*u+1;if(this.nextRow+c>this.height)return y.w("LineAtlas out of space"),null;let f=0;for(let S=0;S<e.length;S++)f+=e[S];if(f!==0){const S=this.width/f,T=this.getDashRanges(e,this.width,S);s?this.addRoundDash(T,S,u):this.addRegularDash(T)}const x={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:f};return this.nextRow+=c,this.dirty=!0,x}bind(e){const s=e.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const et="maplibre_preloaded_worker_pool";class lt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<lt.workerCount;)this.workers.push(new Worker(y.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((s=>{s.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[et]}numActive(){return Object.keys(this.active).length}}const Lt=Math.floor(me.hardwareConcurrency/2);let Ot,qi;function Ai(){return Ot||(Ot=new lt),Ot}lt.workerCount=y.C(globalThis)?Math.max(Math.min(Lt,3),1):1;class rr{constructor(e,s){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=s;const u=this.workerPool.acquire(s);for(let c=0;c<u.length;c++){const f=new y.F(u[c],s);f.name=`Worker ${c}`,this.actors.push(f)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,s){const u=[];for(const c of this.actors)u.push(c.sendAsync({type:e,data:s}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((s=>{s.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,s){for(const u of this.actors)u.registerMessageHandler(e,s)}}function ss(){return qi||(qi=new rr(Ai(),y.G),qi.registerMessageHandler("GR",((p,e,s)=>y.m(e,s)))),qi}function sr(p,e){const s=y.H();return y.J(s,s,[1,1,0]),y.K(s,s,[.5*p.width,.5*p.height,1]),y.L(s,s,p.calculatePosMatrix(e.toUnwrapped()))}function Nr(p,e,s,u,c,f){const x=(function(I,P,j){if(I)for(const q of I){const X=P[q];if(X&&X.source===j&&X.type==="fill-extrusion")return!0}else for(const q in P){const X=P[q];if(X.source===j&&X.type==="fill-extrusion")return!0}return!1})(c&&c.layers,e,p.id),S=f.maxPitchScaleFactor(),T=p.tilesIn(u,S,x);T.sort(_n);const E=[];for(const I of T)E.push({wrappedTileID:I.tileID.wrapped().key,queryResults:I.tile.queryRenderedFeatures(e,s,p._state,I.queryGeometry,I.cameraQueryGeometry,I.scale,c,f,S,sr(p.transform,I.tileID))});const D=(function(I){const P={},j={};for(const q of I){const X=q.queryResults,K=q.wrappedTileID,J=j[K]=j[K]||{};for(const ee in X){const Z=X[ee],ne=J[ee]=J[ee]||{},oe=P[ee]=P[ee]||[];for(const fe of Z)ne[fe.featureIndex]||(ne[fe.featureIndex]=!0,oe.push(fe))}}return P})(E);for(const I in D)D[I].forEach((P=>{const j=P.feature,q=p.getFeatureState(j.layer["source-layer"],j.id);j.source=j.layer.source,j.layer["source-layer"]&&(j.sourceLayer=j.layer["source-layer"]),j.state=q}));return D}function _n(p,e){const s=p.tileID,u=e.tileID;return s.overscaledZ-u.overscaledZ||s.canonical.y-u.canonical.y||s.wrap-u.wrap||s.canonical.x-u.canonical.x}function os(p,e,s){return y._(this,void 0,void 0,(function*(){let u=p;if(p.url?u=(yield y.h(e.transformRequest(p.url,"Source"),s)).data:yield me.frameAsync(s),!u)return null;const c=y.M(y.e(u,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(c.vectorLayerIds=u.vector_layers.map((f=>f.id))),c}))}class xe{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof y.N?new y.N(e.lng,e.lat):y.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof y.N?new y.N(e.lng,e.lat):y.N.convert(e),this}extend(e){const s=this._sw,u=this._ne;let c,f;if(e instanceof y.N)c=e,f=e;else{if(!(e instanceof xe))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(xe.convert(e)):this.extend(y.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(y.N.convert(e)):this;if(c=e._sw,f=e._ne,!c||!f)return this}return s||u?(s.lng=Math.min(c.lng,s.lng),s.lat=Math.min(c.lat,s.lat),u.lng=Math.max(f.lng,u.lng),u.lat=Math.max(f.lat,u.lat)):(this._sw=new y.N(c.lng,c.lat),this._ne=new y.N(f.lng,f.lat)),this}getCenter(){return new y.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new y.N(this.getWest(),this.getNorth())}getSouthEast(){return new y.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:u}=y.N.convert(e);let c=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&c}static convert(e){return e instanceof xe?e:e&&new xe(e)}static fromLngLat(e,s=0){const u=360*s/40075017,c=u/Math.cos(Math.PI/180*e.lat);return new xe(new y.N(e.lng-c,e.lat-u),new y.N(e.lng+c,e.lat+u))}adjustAntiMeridian(){const e=new y.N(this._sw.lng,this._sw.lat),s=new y.N(this._ne.lng,this._ne.lat);return new xe(e,e.lng>s.lng?new y.N(s.lng+360,s.lat):s)}}class Cs{constructor(e,s,u){this.bounds=xe.convert(this.validateBounds(e)),this.minzoom=s||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const s=Math.pow(2,e.z),u=Math.floor(y.O(this.bounds.getWest())*s),c=Math.floor(y.Q(this.bounds.getNorth())*s),f=Math.ceil(y.O(this.bounds.getEast())*s),x=Math.ceil(y.Q(this.bounds.getSouth())*s);return e.x>=u&&e.x<f&&e.y>=c&&e.y<x}}class mo extends y.E{constructor(e,s,u,c){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,y.e(this,y.M(s,["url","scheme","tileSize","promoteId"])),this._options=y.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c)}load(){return y._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new y.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield os(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(y.e(this,e),e.bounds&&(this.tileBounds=new Cs(e.bounds,this.minzoom,this.maxzoom)),this.fire(new y.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new y.j(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return y.e({},this._options)}loadTile(e){return y._(this,void 0,void 0,(function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(s,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let c="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((f,x)=>{e.reloadPromise={resolve:f,reject:x}}))}else e.actor=this.dispatcher.getActor(),c="LT";e.abortController=new AbortController;try{const f=yield e.actor.sendAsync({type:c,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,f)}catch(f){if(delete e.abortController,e.aborted)return;if(f&&f.status!==404)throw f;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,s){if(s&&s.resourceTiming&&(e.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&e.setExpiryData(s),e.loadVectorData(s,this.map.painter),e.reloadPromise){const u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return y._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return y._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class pi extends y.E{constructor(e,s,u,c){super(),this.id=e,this.dispatcher=u,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=y.e({type:"raster"},s),y.e(this,y.M(s,["url","scheme","tileSize"]))}load(){return y._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new y.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield os(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(y.e(this,e),e.bounds&&(this.tileBounds=new Cs(e.bounds,this.minzoom,this.maxzoom)),this.fire(new y.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new y.j(e))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return y.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return y._(this,void 0,void 0,(function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const u=yield dt.getImage(this.map._requestManager.transformRequest(s,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const c=this.map.painter.context,f=c.gl,x=u.data;e.texture=this.map.painter.getTileTexture(x.width),e.texture?e.texture.update(x,{useMipmap:!0}):(e.texture=new Pt(c,x,f.RGBA,{useMipmap:!0}),e.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}}))}abortTile(e){return y._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return y._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class ea extends pi{constructor(e,s,u,c){super(e,s,u,c),this.type="raster-dem",this.maxzoom=22,this._options=y.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(e){return y._(this,void 0,void 0,(function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(s,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const c=yield dt.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){const f=c.data;this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const x=y.b(f)&&y.U()?f:yield this.readImageNow(f),S={type:this.type,uid:e.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const T=yield e.actor.sendAsync({type:"LDT",data:S});e.dem=T,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}}))}readImageNow(e){return y._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&y.V()){const s=e.width+2,u=e.height+2;try{return new y.R({width:s,height:u},yield y.W(e,-1,-1,s,u))}catch{}}return me.getImageData(e,1)}))}_getNeighboringTiles(e){const s=e.canonical,u=Math.pow(2,s.z),c=(s.x-1+u)%u,f=s.x===0?e.wrap-1:e.wrap,x=(s.x+1+u)%u,S=s.x+1===u?e.wrap+1:e.wrap,T={};return T[new y.S(e.overscaledZ,f,s.z,c,s.y).key]={backfilled:!1},T[new y.S(e.overscaledZ,S,s.z,x,s.y).key]={backfilled:!1},s.y>0&&(T[new y.S(e.overscaledZ,f,s.z,c,s.y-1).key]={backfilled:!1},T[new y.S(e.overscaledZ,e.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},T[new y.S(e.overscaledZ,S,s.z,x,s.y-1).key]={backfilled:!1}),s.y+1<u&&(T[new y.S(e.overscaledZ,f,s.z,c,s.y+1).key]={backfilled:!1},T[new y.S(e.overscaledZ,e.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},T[new y.S(e.overscaledZ,S,s.z,x,s.y+1).key]={backfilled:!1}),T}unloadTile(e){return y._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class Ds extends y.E{constructor(e,s,u,c){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(c),this._data=s.data,this._options=y.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const f=y.X/this.tileSize;s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&y.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=y.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*f,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*f,extent:y.X,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:y.X,radius:(s.clusterRadius||50)*f,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return y._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return y._(this,void 0,void 0,(function*(){const e=y.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,s,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:s,offset:u}})}_updateWorkerData(e){return y._(this,void 0,void 0,(function*(){const s=y.e({type:this.type},this.workerOptions);e?s.dataDiff=e:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(me.resolveURL(this._data),"Source"),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new y.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:s});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new y.k("dataabort",{dataType:"source"}));let c=null;u.resourceTiming&&u.resourceTiming[this.id]&&(c=u.resourceTiming[this.id].slice(0));const f={dataType:"source"};this._collectResourceTiming&&c&&c.length>0&&y.e(f,{resourceTiming:c}),this.fire(new y.k("data",Object.assign(Object.assign({},f),{sourceDataType:"metadata"}))),this.fire(new y.k("data",Object.assign(Object.assign({},f),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new y.k("dataabort",{dataType:"source"}));this.fire(new y.j(u))}}))}loaded(){return this._pendingLoads===0}loadTile(e){return y._(this,void 0,void 0,(function*(){const s=e.actor?"RT":"LT";e.actor=this.actor;const u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const c=yield this.actor.sendAsync({type:s,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(c,this.map.painter,s==="RT")}))}abortTile(e){return y._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return y._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return y.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ls=y.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Fr extends y.E{constructor(e,s,u,c){super(),this.id=e,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(c),this.options=s}load(e){return y._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new y.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield dt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,e&&(this.coordinates=e),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new y.j(s))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new y.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const s=e.map(y.Z.fromLngLat);this.tileID=(function(c){let f=1/0,x=1/0,S=-1/0,T=-1/0;for(const P of c)f=Math.min(f,P.x),x=Math.min(x,P.y),S=Math.max(S,P.x),T=Math.max(T,P.y);const E=Math.max(S-f,T-x),D=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),I=Math.pow(2,D);return new y.a1(D,Math.floor((f+S)/2*I),Math.floor((x+T)/2*I))})(s),this.minzoom=this.maxzoom=this.tileID.z;const u=s.map((c=>this.tileID.getTilePoint(c)._round()));return this._boundsArray=new y.$,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,y.X,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,y.X),this._boundsArray.emplaceBack(u[2].x,u[2].y,y.X,y.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new y.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,ls.members)),this.boundsSegments||(this.boundsSegments=y.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Pt(e,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let u=!1;for(const c in this.tiles){const f=this.tiles[c];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,u=!0)}u&&this.fire(new y.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return y._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Pa extends Fr{constructor(e,s,u,c){super(e,s,u,c),this.roundZoom=!0,this.type="video",this.options=s}load(){return y._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const s of e.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield y.a3(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new y.j(s))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const s=this.video.seekable;e<s.start(0)||e>s.end(0)?this.fire(new y.j(new y.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,ls.members)),this.boundsSegments||(this.boundsSegments=y.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new Pt(e,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let u=!1;for(const c in this.tiles){const f=this.tiles[c];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,u=!0)}u&&this.fire(new y.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Fn extends Fr{constructor(e,s,u,c){super(e,s,u,c),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some((f=>!Array.isArray(f)||f.length!==2||f.some((x=>typeof x!="number"))))||this.fire(new y.j(new y.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new y.j(new y.a2(`sources.${e}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new y.j(new y.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new y.j(new y.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new y.j(new y.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return y._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new y.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,u=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,ls.members)),this.boundsSegments||(this.boundsSegments=y.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Pt(s,this.canvas,u.RGBA,{premultiply:!0});let c=!1;for(const f in this.tiles){const x=this.tiles[f];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new y.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const go={},yo=p=>{switch(p){case"geojson":return Ds;case"image":return Fr;case"raster":return pi;case"raster-dem":return ea;case"vector":return mo;case"video":return Pa;case"canvas":return Fn}return go[p]},je="RTLPluginLoaded";class wr extends y.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ss()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((s=>{throw this.status="error",s}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return y._(this,arguments,void 0,(function*(s,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=me.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return y._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new y.k(je))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ja=null;function Sr(){return Ja||(Ja=new wr),Ja}class us{constructor(e,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=y.a4(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,s,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(c,f){const x={};if(!f)return x;for(const S of c){const T=S.layerIds.map((E=>f.getLayer(E))).filter(Boolean);if(T.length!==0){S.layers=T,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map((E=>T.filter((D=>D.id===E))[0])));for(const E of T)x[E.id]=S}}return x})(e.buckets,s.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const f=this.buckets[c];if(f instanceof y.a6){if(this.hasSymbolBuckets=!0,!u)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const f=this.buckets[c];if(f instanceof y.a6&&f.hasRTLText){this.hasRTLText=!0,Sr().lazyLoad();break}}this.queryPadding=0;for(const c in this.buckets){const f=this.buckets[c];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(c).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new y.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const c=this.buckets[u];c.uploadPending()&&c.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pt(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pt(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,u,c,f,x,S,T,E,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:f,scale:x,tileSize:this.tileSize,pixelPosMatrix:D,transform:T,params:S,queryPadding:this.queryPadding*E},e,s,u):{}}querySourceFeatures(e,s){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const c=u.loadVTLayers(),f=s&&s.sourceLayer?s.sourceLayer:"",x=c._geojsonTileLayer||c[f];if(!x)return;const S=y.a7(s&&s.filter),{z:T,x:E,y:D}=this.tileID.canonical,I={z:T,x:E,y:D};for(let P=0;P<x.length;P++){const j=x.feature(P);if(S.needGeometry){const K=y.a8(j,!0);if(!S.filter(new y.z(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!S.filter(new y.z(this.tileID.overscaledZ),j))continue;const q=u.getId(j,f),X=new y.a9(j,T,E,D,q);X.tile=I,e.push(X)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const u=y.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let c=!1;if(this.expirationTime>u)c=!1;else if(s)if(this.expirationTime<s)c=!0;else{const f=this.expirationTime-s;f?this.expirationTime=u+Math.max(f,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const c in this.buckets){if(!s.style.hasLayer(c))continue;const f=this.buckets[c],x=f.layers[0].sourceLayer||"_geojsonTileLayer",S=u[x],T=e[x];if(!S||!T||Object.keys(T).length===0)continue;f.update(T,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=s&&s.style&&s.style.getLayer(c);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(f)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<me.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=me.now()+e}setDependencies(e,s){const u={};for(const c of s)u[c]=!0;this.dependencies[e]=u}hasDependency(e,s){for(const u of e){const c=this.dependencies[u];if(c){for(const f of s)if(c[f])return!0}}return!1}}class Xe{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,u){const c=e.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const f={value:s,timeout:void 0};if(u!==void 0&&(f.timeout=setTimeout((()=>{this.remove(e,f)}),u)),this.data[c].push(f),this.order.push(c),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const u=e.wrapped().key,c=s===void 0?0:this.data[u].indexOf(s),f=this.data[u][c];return this.data[u].splice(c,1),f.timeout&&clearTimeout(f.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(f.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const u in this.data)for(const c of this.data[u])e(c.value)||s.push(c);for(const u of s)this.remove(u.value.tileID,u)}}class Dt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,u){const c=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][c]=this.stateChanges[e][c]||{},y.e(this.stateChanges[e][c],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const f in this.state[e])f!==c&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][c]===null){this.deletedStates[e][c]={};for(const f in this.state[e][c])u[f]||(this.deletedStates[e][c][f]=null)}else for(const f in u)this.deletedStates[e]&&this.deletedStates[e][c]&&this.deletedStates[e][c][f]===null&&delete this.deletedStates[e][c][f]}removeFeatureState(e,s,u){if(this.deletedStates[e]===null)return;const c=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&s!==void 0)this.deletedStates[e][c]!==null&&(this.deletedStates[e][c]=this.deletedStates[e][c]||{},this.deletedStates[e][c][u]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][c])for(u in this.deletedStates[e][c]={},this.stateChanges[e][c])this.deletedStates[e][c][u]=null;else this.deletedStates[e][c]=null;else this.deletedStates[e]=null}getState(e,s){const u=String(s),c=y.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const f=this.deletedStates[e][s];if(f===null)return{};for(const x in f)delete c[x]}return c}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const u={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const f={};for(const x in this.stateChanges[c])this.state[c][x]||(this.state[c][x]={}),y.e(this.state[c][x],this.stateChanges[c][x]),f[x]=this.state[c][x];u[c]=f}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const f={};if(this.deletedStates[c]===null)for(const x in this.state[c])f[x]={},this.state[c][x]={};else for(const x in this.deletedStates[c]){if(this.deletedStates[c][x]===null)this.state[c][x]={};else for(const S of Object.keys(this.deletedStates[c][x]))delete this.state[c][x][S];f[x]=this.state[c][x]}u[c]=u[c]||{},y.e(u[c],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const c in e)e[c].setFeatureState(u,s)}}class xt extends y.E{constructor(e,s,u){super(),this.id=e,this.dispatcher=u,this.on("data",(c=>this._dataHandler(c))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((c,f,x,S)=>{const T=new(yo(f.type))(c,f,x,S);if(T.id!==c)throw new Error(`Expected Source id to be ${c} instead of ${T.id}`);return T})(e,s,u,this),this._tiles={},this._cache=new Xe(0,(c=>this._unloadTile(c))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Dt,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,s,u){return y._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,s,u)}catch(c){e.state="errored",c.status!==404?this._source.fire(new y.j(c,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new y.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const u=this._tiles[s];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(Ki).map((e=>e.key))}getRenderableIds(e){const s=[];for(const u in this._tiles)this._isIdRenderable(u,e)&&s.push(this._tiles[u]);return e?s.sort(((u,c)=>{const f=u.tileID,x=c.tileID,S=new y.P(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),T=new y.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-x.overscaledZ||T.y-S.y||T.x-S.x})).map((u=>u.tileID.key)):s.map((u=>u.tileID)).sort(Ki).map((u=>u.key))}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,s){return y._(this,void 0,void 0,(function*(){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=s),yield this._loadTile(u,e,s))}))}_tileLoaded(e,s,u){e.timeAdded=me.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new y.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const s=this.getRenderableIds();for(let c=0;c<s.length;c++){const f=s[c];if(e.neighboringTiles&&e.neighboringTiles[f]){const x=this.getTileByID(f);u(e,x),u(x,e)}}function u(c,f){c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0;let x=f.tileID.canonical.x-c.tileID.canonical.x;const S=f.tileID.canonical.y-c.tileID.canonical.y,T=Math.pow(2,c.tileID.canonical.z),E=f.tileID.key;x===0&&S===0||Math.abs(S)>1||(Math.abs(x)>1&&(Math.abs(x+T)===1?x+=T:Math.abs(x-T)===1&&(x-=T)),f.dem&&c.dem&&(c.dem.backfillBorder(f.dem,x,S),c.neighboringTiles&&c.neighboringTiles[E]&&(c.neighboringTiles[E].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,u,c){for(const f in this._tiles){let x=this._tiles[f];if(c[f]||!x.hasData()||x.tileID.overscaledZ<=s||x.tileID.overscaledZ>u)continue;let S=x.tileID;for(;x&&x.tileID.overscaledZ>s+1;){const E=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[E.key],x&&x.hasData()&&(S=E)}let T=S;for(;T.overscaledZ>s;)if(T=T.scaledTo(T.overscaledZ-1),e[T.key]){c[S.key]=S;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=s?u:null}for(let u=e.overscaledZ-1;u>=s;u--){const c=e.scaledTo(u),f=this._getLoadedTile(c);if(f)return f}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const s=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,c=Math.floor(s*u*(this._maxTileCacheZoomLevels===null?y.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(f)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const u={};for(const c in this._tiles){const f=this._tiles[c];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+s),u[f.tileID.key]=f}this._tiles=u;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(c,this._tiles[c])}}_updateCoveredAndRetainedTiles(e,s,u,c,f,x){const S={},T={},E=Object.keys(e),D=me.now();for(const I of E){const P=e[I],j=this._tiles[I];if(!j||j.fadeEndTime!==0&&j.fadeEndTime<=D)continue;const q=this.findLoadedParent(P,s),X=this.findLoadedSibling(P),K=q||X||null;K&&(this._addTile(K.tileID),S[K.tileID.key]=K.tileID),T[I]=P}this._retainLoadedChildren(T,c,u,e);for(const I in S)e[I]||(this._coveredTiles[I]=!0,e[I]=S[I]);if(x){const I={},P={};for(const j of f)this._tiles[j.key].hasData()?I[j.key]=j:P[j.key]=j;for(const j in P){const q=P[j].children(this._source.maxzoom);this._tiles[q[0].key]&&this._tiles[q[1].key]&&this._tiles[q[2].key]&&this._tiles[q[3].key]&&(I[q[0].key]=e[q[0].key]=q[0],I[q[1].key]=e[q[1].key]=q[1],I[q[2].key]=e[q[2].key]=q[2],I[q[3].key]=e[q[3].key]=q[3],delete P[j])}for(const j in P){const q=P[j],X=this.findLoadedParent(q,this._source.minzoom),K=this.findLoadedSibling(q),J=X||K||null;if(J){I[J.tileID.key]=e[J.tileID.key]=J.tileID;for(const ee in I)I[ee].isChildOf(J.tileID)&&delete I[ee]}}for(const j in this._tiles)I[j]||(this._coveredTiles[j]=!0)}}update(e,s){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=s,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((D=>new y.S(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y))):(u=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(u=u.filter((D=>this._source.hasTile(D))))):u=[];const c=e.coveringZoomLevel(this._source),f=Math.max(c-xt.maxOverzooming,this._source.minzoom),x=Math.max(c+xt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const D={};for(const I of u)if(I.canonical.z>this._source.minzoom){const P=I.scaledTo(I.canonical.z-1);D[P.key]=P;const j=I.scaledTo(Math.max(this._source.minzoom,Math.min(I.canonical.z,5)));D[j.key]=j}u=u.concat(Object.values(D))}const S=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new y.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(u,c);or(this._source.type)&&this._updateCoveredAndRetainedTiles(T,f,x,c,u,s);for(const D in T)this._tiles[D].clearFadeHold();const E=y.ab(this._tiles,T);for(const D of E){const I=this._tiles[D];I.hasSymbolBuckets&&!I.holdingForFade()?I.setHoldDuration(this.map._fadeDuration):I.hasSymbolBuckets&&!I.symbolFadeFinished()||this._removeTile(D)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,s){var u;const c={},f={},x=Math.max(s-xt.maxOverzooming,this._source.minzoom),S=Math.max(s+xt.maxUnderzooming,this._source.minzoom),T={};for(const E of e){const D=this._addTile(E);c[E.key]=E,D.hasData()||s<this._source.maxzoom&&(T[E.key]=E)}this._retainLoadedChildren(T,s,S,c);for(const E of e){let D=this._tiles[E.key];if(D.hasData())continue;if(s+1>this._source.maxzoom){const P=E.children(this._source.maxzoom)[0],j=this.getTile(P);if(j&&j.hasData()){c[P.key]=P;continue}}else{const P=E.children(this._source.maxzoom);if(c[P[0].key]&&c[P[1].key]&&c[P[2].key]&&c[P[3].key])continue}let I=D.wasRequested();for(let P=E.overscaledZ-1;P>=x;--P){const j=E.scaledTo(P);if(f[j.key])break;if(f[j.key]=!0,D=this.getTile(j),!D&&I&&(D=this._addTile(j)),D){const q=D.hasData();if((q||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||I)&&(c[j.key]=j),I=D.wasRequested(),q)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let u,c=this._tiles[e].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){u=this._loadedParentTiles[c.key];break}s.push(c.key);const f=c.scaledTo(c.overscaledZ-1);if(u=this._getLoadedTile(f),u)break;c=f}for(const f of s)this._loadedParentTiles[f]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const s=this._tiles[e].tileID,u=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=u}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const u=s;return s||(s=new us(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(s,e.key,s.state)),s.uses++,this._tiles[e.key]=s,u||this._source.fire(new y.k("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=s.getExpiryTimeout();u&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),u))}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(e){const s=e.sourceDataType;e.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&s==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,s,u){const c=[],f=this.transform;if(!f)return c;const x=u?f.getCameraQueryGeometry(e):e,S=e.map((q=>f.pointCoordinate(q,this.terrain))),T=x.map((q=>f.pointCoordinate(q,this.terrain))),E=this.getIds();let D=1/0,I=1/0,P=-1/0,j=-1/0;for(const q of T)D=Math.min(D,q.x),I=Math.min(I,q.y),P=Math.max(P,q.x),j=Math.max(j,q.y);for(let q=0;q<E.length;q++){const X=this._tiles[E[q]];if(X.holdingForFade())continue;const K=X.tileID,J=Math.pow(2,f.zoom-X.tileID.overscaledZ),ee=s*X.queryPadding*y.X/X.tileSize/J,Z=[K.getTilePoint(new y.Z(D,I)),K.getTilePoint(new y.Z(P,j))];if(Z[0].x-ee<y.X&&Z[0].y-ee<y.X&&Z[1].x+ee>=0&&Z[1].y+ee>=0){const ne=S.map((fe=>K.getTilePoint(fe))),oe=T.map((fe=>K.getTilePoint(fe)));c.push({tile:X,tileID:K,queryGeometry:ne,cameraQueryGeometry:oe,scale:J})}}return c}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map((u=>this._tiles[u].tileID));for(const u of s)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(or(this._source.type)){const e=me.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=e)return!0}return!1}setFeatureState(e,s,u){this._state.updateState(e=e||"_geojsonTileLayer",s,u)}removeFeatureState(e,s,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,u)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,u){const c=this._tiles[e];c&&c.setDependencies(s,u)}reloadTilesForDependencies(e,s){for(const u in this._tiles)this._tiles[u].hasDependency(e,s)&&this._reloadTile(u,"reloading");this._cache.filter((u=>!u.hasDependency(e,s)))}}function Ki(p,e){const s=Math.abs(2*p.wrap)-+(p.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return p.overscaledZ-e.overscaledZ||u-s||e.canonical.y-p.canonical.y||e.canonical.x-p.canonical.x}function or(p){return p==="raster"||p==="image"||p==="video"}xt.maxOverzooming=10,xt.maxUnderzooming=3;class Ft{constructor(e,s){this.reset(e,s)}reset(e,s){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=y.ac(e,0,1);let s=1,u=this._distances[s];const c=e*this.paddedLength+this.padding;for(;u<c&&s<this._distances.length;)u=this._distances[++s];const f=s-1,x=this._distances[f],S=u-x,T=S>0?(c-x)/S:0;return this.points[f].mult(1-T).add(this.points[s].mult(T))}}function Tr(p,e){let s=!0;return p==="always"||p!=="never"&&e!=="never"||(s=!1),s}class jn{constructor(e,s,u){const c=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(s/u);for(let x=0;x<this.xCellCount*this.yCellCount;x++)c.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=s,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,s,u,c,f){this._forEachCell(s,u,c,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(c),this.bboxes.push(f)}insertCircle(e,s,u,c){this._forEachCell(s-c,u-c,s+c,u+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(s),this.circles.push(u),this.circles.push(c)}_insertBoxCell(e,s,u,c,f,x){this.boxCells[f].push(x)}_insertCircleCell(e,s,u,c,f,x){this.circleCells[f].push(x)}_query(e,s,u,c,f,x,S){if(u<0||e>this.width||c<0||s>this.height)return[];const T=[];if(e<=0&&s<=0&&this.width<=u&&this.height<=c){if(f)return[{key:null,x1:e,y1:s,x2:u,y2:c}];for(let E=0;E<this.boxKeys.length;E++)T.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const D=this.circles[3*E],I=this.circles[3*E+1],P=this.circles[3*E+2];T.push({key:this.circleKeys[E],x1:D-P,y1:I-P,x2:D+P,y2:I+P})}}else this._forEachCell(e,s,u,c,this._queryCell,T,{hitTest:f,overlapMode:x,seenUids:{box:{},circle:{}}},S);return T}query(e,s,u,c){return this._query(e,s,u,c,!1,null)}hitTest(e,s,u,c,f,x){return this._query(e,s,u,c,!0,f,x).length>0}hitTestCircle(e,s,u,c,f){const x=e-u,S=e+u,T=s-u,E=s+u;if(S<0||x>this.width||E<0||T>this.height)return!1;const D=[];return this._forEachCell(x,T,S,E,this._queryCellCircle,D,{hitTest:!0,overlapMode:c,circle:{x:e,y:s,radius:u},seenUids:{box:{},circle:{}}},f),D.length>0}_queryCell(e,s,u,c,f,x,S,T){const{seenUids:E,hitTest:D,overlapMode:I}=S,P=this.boxCells[f];if(P!==null){const q=this.bboxes;for(const X of P)if(!E.box[X]){E.box[X]=!0;const K=4*X,J=this.boxKeys[X];if(e<=q[K+2]&&s<=q[K+3]&&u>=q[K+0]&&c>=q[K+1]&&(!T||T(J))&&(!D||!Tr(I,J.overlapMode))&&(x.push({key:J,x1:q[K],y1:q[K+1],x2:q[K+2],y2:q[K+3]}),D))return!0}}const j=this.circleCells[f];if(j!==null){const q=this.circles;for(const X of j)if(!E.circle[X]){E.circle[X]=!0;const K=3*X,J=this.circleKeys[X];if(this._circleAndRectCollide(q[K],q[K+1],q[K+2],e,s,u,c)&&(!T||T(J))&&(!D||!Tr(I,J.overlapMode))){const ee=q[K],Z=q[K+1],ne=q[K+2];if(x.push({key:J,x1:ee-ne,y1:Z-ne,x2:ee+ne,y2:Z+ne}),D)return!0}}}return!1}_queryCellCircle(e,s,u,c,f,x,S,T){const{circle:E,seenUids:D,overlapMode:I}=S,P=this.boxCells[f];if(P!==null){const q=this.bboxes;for(const X of P)if(!D.box[X]){D.box[X]=!0;const K=4*X,J=this.boxKeys[X];if(this._circleAndRectCollide(E.x,E.y,E.radius,q[K+0],q[K+1],q[K+2],q[K+3])&&(!T||T(J))&&!Tr(I,J.overlapMode))return x.push(!0),!0}}const j=this.circleCells[f];if(j!==null){const q=this.circles;for(const X of j)if(!D.circle[X]){D.circle[X]=!0;const K=3*X,J=this.circleKeys[X];if(this._circlesCollide(q[K],q[K+1],q[K+2],E.x,E.y,E.radius)&&(!T||T(J))&&!Tr(I,J.overlapMode))return x.push(!0),!0}}}_forEachCell(e,s,u,c,f,x,S,T){const E=this._convertToXCellCoord(e),D=this._convertToYCellCoord(s),I=this._convertToXCellCoord(u),P=this._convertToYCellCoord(c);for(let j=E;j<=I;j++)for(let q=D;q<=P;q++)if(f.call(this,e,s,u,c,this.xCellCount*q+j,x,S,T))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,s,u,c,f,x){const S=c-e,T=f-s,E=u+x;return E*E>S*S+T*T}_circleAndRectCollide(e,s,u,c,f,x,S){const T=(x-c)/2,E=Math.abs(e-(c+T));if(E>T+u)return!1;const D=(S-f)/2,I=Math.abs(s-(f+D));if(I>D+u)return!1;if(E<=T||I<=D)return!0;const P=E-T,j=I-D;return P*P+j*j<=u*u}}function lr(p,e,s,u,c){const f=y.H();return e?(y.K(f,f,[1/c,1/c,1]),s||y.ad(f,f,u.angle)):y.L(f,u.labelPlaneMatrix,p),f}function In(p,e,s,u,c){if(e){const f=y.ae(p);return y.K(f,f,[c,c,1]),s||y.ad(f,f,-u.angle),f}return u.glCoordMatrix}function $(p,e,s,u){let c;u?(c=[p,e,u(p,e),1],y.af(c,c,s)):(c=[p,e,0,1],Yt(c,c,s));const f=c[3];return{point:new y.P(c[0]/f,c[1]/f),signedDistanceFromCamera:f,isOccluded:!1}}function L(p,e){return .5+p/e*.5}function R(p,e){return p.x>=-e[0]&&p.x<=e[0]&&p.y>=-e[1]&&p.y<=e[1]}function V(p,e,s,u,c,f,x,S,T,E,D,I,P,j,q){const X=u?p.textSizeData:p.iconSizeData,K=y.ag(X,s.transform.zoom),J=[256/s.width*2+1,256/s.height*2+1],ee=u?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;ee.clear();const Z=p.lineVertexArray,ne=u?p.text.placedSymbolArray:p.icon.placedSymbolArray,oe=s.transform.width/s.transform.height;let fe=!1;for(let De=0;De<ne.length;De++){const Oe=ne.get(De);if(Oe.hidden||Oe.writingMode===y.ah.vertical&&!fe){bt(Oe.numGlyphs,ee);continue}fe=!1;const Ge=$(Oe.anchorX,Oe.anchorY,e,q);if(!R(Ge.point,J)){bt(Oe.numGlyphs,ee);continue}const We=L(s.transform.cameraToCenterDistance,Ge.signedDistanceFromCamera),$e=y.ai(X,K,Oe),Fe=x?$e/We:$e*We,it={getElevation:q,labelPlaneMatrix:c,lineVertexArray:Z,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:E,tileAnchorPoint:new y.P(Oe.anchorX,Oe.anchorY),unwrappedTileID:D,width:I,height:P,translation:j},It=re(it,Oe,Fe,!1,S,e,f,p.glyphOffsetArray,ee,oe,T);fe=It.useVertical,(It.notEnoughRoom||fe||It.needsFlipping&&re(it,Oe,Fe,!0,S,e,f,p.glyphOffsetArray,ee,oe,T).notEnoughRoom)&&bt(Oe.numGlyphs,ee)}u?p.text.dynamicLayoutVertexBuffer.updateData(ee):p.icon.dynamicLayoutVertexBuffer.updateData(ee)}function H(p,e,s,u,c,f,x,S){const T=f.glyphStartIndex+f.numGlyphs,E=f.lineStartIndex,D=f.lineStartIndex+f.lineLength,I=e.getoffsetX(f.glyphStartIndex),P=e.getoffsetX(T-1),j=Ze(p*I,s,u,c,f.segment,E,D,S,x);if(!j)return null;const q=Ze(p*P,s,u,c,f.segment,E,D,S,x);return q?S.projectionCache.anyProjectionOccluded?null:{first:j,last:q}:null}function ie(p,e,s,u){return p===y.ah.horizontal&&Math.abs(s.y-e.y)>Math.abs(s.x-e.x)*u?{useVertical:!0}:(p===y.ah.vertical?e.y<s.y:e.x>s.x)?{needsFlipping:!0}:null}function re(p,e,s,u,c,f,x,S,T,E,D){const I=s/24,P=e.lineOffsetX*I,j=e.lineOffsetY*I;let q;if(e.numGlyphs>1){const X=e.glyphStartIndex+e.numGlyphs,K=e.lineStartIndex,J=e.lineStartIndex+e.lineLength,ee=H(I,S,P,j,u,e,D,p);if(!ee)return{notEnoughRoom:!0};const Z=$(ee.first.point.x,ee.first.point.y,x,p.getElevation).point,ne=$(ee.last.point.x,ee.last.point.y,x,p.getElevation).point;if(c&&!u){const oe=ie(e.writingMode,Z,ne,E);if(oe)return oe}q=[ee.first];for(let oe=e.glyphStartIndex+1;oe<X-1;oe++)q.push(Ze(I*S.getoffsetX(oe),P,j,u,e.segment,K,J,p,D));q.push(ee.last)}else{if(c&&!u){const K=$(p.tileAnchorPoint.x,p.tileAnchorPoint.y,f,p.getElevation).point,J=e.lineStartIndex+e.segment+1,ee=new y.P(p.lineVertexArray.getx(J),p.lineVertexArray.gety(J)),Z=$(ee.x,ee.y,f,p.getElevation),ne=Z.signedDistanceFromCamera>0?Z.point:(function(fe,De,Oe,Ge,We,$e){return ce(fe,De,Oe,1,We,$e)})(p.tileAnchorPoint,ee,K,0,f,p),oe=ie(e.writingMode,K,ne,E);if(oe)return oe}const X=Ze(I*S.getoffsetX(e.glyphStartIndex),P,j,u,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,p,D);if(!X||p.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};q=[X]}for(const X of q)y.aj(T,X.point,X.angle);return{}}function ce(p,e,s,u,c,f){const x=p.add(p.sub(e)._unit()),S=c!==void 0?$(x.x,x.y,c,f.getElevation).point:Ae(x.x,x.y,f).point,T=s.sub(S);return s.add(T._mult(u/T.mag()))}function W(p,e,s){const u=e.projectionCache;if(u.projections[p])return u.projections[p];const c=new y.P(e.lineVertexArray.getx(p),e.lineVertexArray.gety(p)),f=Ae(c.x,c.y,e);if(f.signedDistanceFromCamera>0)return u.projections[p]=f.point,u.anyProjectionOccluded=u.anyProjectionOccluded||f.isOccluded,f.point;const x=p-s.direction;return(function(S,T,E,D,I){return ce(S,T,E,D,void 0,I)})(s.distanceFromAnchor===0?e.tileAnchorPoint:new y.P(e.lineVertexArray.getx(x),e.lineVertexArray.gety(x)),c,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,e)}function Ae(p,e,s){const u=p+s.translation[0],c=e+s.translation[1];let f;return!s.pitchWithMap&&s.projection.useSpecialProjectionForSymbols?(f=s.projection.projectTileCoordinates(u,c,s.unwrappedTileID,s.getElevation),f.point.x=(.5*f.point.x+.5)*s.width,f.point.y=(.5*-f.point.y+.5)*s.height):(f=$(u,c,s.labelPlaneMatrix,s.getElevation),f.isOccluded=!1),f}function ke(p,e,s){return p._unit()._perp()._mult(e*s)}function ye(p,e,s,u,c,f,x,S,T){if(S.projectionCache.offsets[p])return S.projectionCache.offsets[p];const E=s.add(e);if(p+T.direction<u||p+T.direction>=c)return S.projectionCache.offsets[p]=E,E;const D=W(p+T.direction,S,T),I=ke(D.sub(s),x,T.direction),P=s.add(I),j=D.add(I);return S.projectionCache.offsets[p]=y.ak(f,E,P,j)||E,S.projectionCache.offsets[p]}function Ze(p,e,s,u,c,f,x,S,T){const E=u?p-e:p+e;let D=E>0?1:-1,I=0;u&&(D*=-1,I=Math.PI),D<0&&(I+=Math.PI);let P,j=D>0?f+c:f+c+1;S.projectionCache.cachedAnchorPoint?P=S.projectionCache.cachedAnchorPoint:(P=Ae(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=P);let q,X,K=P,J=P,ee=0,Z=0;const ne=Math.abs(E),oe=[];let fe;for(;ee+Z<=ne;){if(j+=D,j<f||j>=x)return null;ee+=Z,J=K,X=q;const Ge={absOffsetX:ne,direction:D,distanceFromAnchor:ee,previousVertex:J};if(K=W(j,S,Ge),s===0)oe.push(J),fe=K.sub(J);else{let We;const $e=K.sub(J);We=$e.mag()===0?ke(W(j+D,S,Ge).sub(K),s,D):ke($e,s,D),X||(X=J.add(We)),q=ye(j,We,K,f,x,X,s,S,Ge),oe.push(X),fe=q.sub(X)}Z=fe.mag()}const De=fe._mult((ne-ee)/Z)._add(X||J),Oe=I+Math.atan2(K.y-J.y,K.x-J.x);return oe.push(De),{point:De,angle:T?Oe:0,path:oe}}const pt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function bt(p,e){for(let s=0;s<p;s++){const u=e.length;e.resize(u+4),e.float32.set(pt,3*u)}}function Yt(p,e,s){const u=e[0],c=e[1];return p[0]=s[0]*u+s[4]*c+s[12],p[1]=s[1]*u+s[5]*c+s[13],p[3]=s[3]*u+s[7]*c+s[15],p}const yt=100;class jt{constructor(e,s,u=new jn(e.width+200,e.height+200,25),c=new jn(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=s,this.grid=u,this.ignoredGrid=c,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+yt,this.screenBottomBoundary=e.height+yt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,s,u,c,f,x,S,T,E,D,I){const P=e.anchorPointX+T[0],j=e.anchorPointY+T[1],q=this.projectAndGetPerspectiveRatio(c,P,j,f,D),X=u*q.perspectiveRatio;let K;if(x||S)K=this._projectCollisionBox(e,X,c,f,x,S,T,q,D,I);else{const oe=q.point.x+(I?I.x*X:0),fe=q.point.y+(I?I.y*X:0);K={allPointsOccluded:!1,box:[oe+e.x1*X,fe+e.y1*X,oe+e.x2*X,fe+e.y2*X]}}const[J,ee,Z,ne]=K.box;return this.mapProjection.useSpecialProjectionForSymbols&&(x?K.allPointsOccluded:this.mapProjection.isOccluded(P,j,f))||q.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(J,ee,Z,ne)||s!=="always"&&this.grid.hitTest(J,ee,Z,ne,s,E)?{box:[J,ee,Z,ne],placeable:!1,offscreen:!1}:{box:[J,ee,Z,ne],placeable:!0,offscreen:this.isOffscreen(J,ee,Z,ne)}}placeCollisionCircles(e,s,u,c,f,x,S,T,E,D,I,P,j,q,X,K){const J=[],ee=new y.P(s.anchorX,s.anchorY),Z=this.getPerspectiveRatio(x,ee.x,ee.y,S,K),ne=(I?f/Z:f*Z)/y.ap,oe={getElevation:K,labelPlaneMatrix:T,lineVertexArray:u,pitchWithMap:I,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ee,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:X},fe=H(ne,c,s.lineOffsetX*ne,s.lineOffsetY*ne,!1,s,!1,oe);let De=!1,Oe=!1,Ge=!0;if(fe){const We=.5*j*Z+q,$e=new y.P(-100,-100),Fe=new y.P(this.screenRightBoundary,this.screenBottomBoundary),it=new Ft,It=fe.first,Ye=fe.last;let Je=[];for(let Gt=It.path.length-1;Gt>=1;Gt--)Je.push(It.path[Gt]);for(let Gt=1;Gt<Ye.path.length;Gt++)Je.push(Ye.path[Gt]);const zt=2.5*We;if(E){const Gt=this.projectPathToScreenSpace(Je,oe,E);Je=Gt.some((ii=>ii.signedDistanceFromCamera<=0))?[]:Gt.map((ii=>ii.point))}let Ci=[];if(Je.length>0){const Gt=Je[0].clone(),ii=Je[0].clone();for(let Ei=1;Ei<Je.length;Ei++)Gt.x=Math.min(Gt.x,Je[Ei].x),Gt.y=Math.min(Gt.y,Je[Ei].y),ii.x=Math.max(ii.x,Je[Ei].x),ii.y=Math.max(ii.y,Je[Ei].y);Ci=Gt.x>=$e.x&&ii.x<=Fe.x&&Gt.y>=$e.y&&ii.y<=Fe.y?[Je]:ii.x<$e.x||Gt.x>Fe.x||ii.y<$e.y||Gt.y>Fe.y?[]:y.al([Je],$e.x,$e.y,Fe.x,Fe.y)}for(const Gt of Ci){it.reset(Gt,.25*We);let ii=0;ii=it.length<=.5*We?1:Math.ceil(it.paddedLength/zt)+1;for(let Ei=0;Ei<ii;Ei++){const La=Ei/Math.max(ii-1,1),Xn=it.lerp(La),Pi=Xn.x+yt,rn=Xn.y+yt;J.push(Pi,rn,We,0);const Gi=Pi-We,Hi=rn-We,ga=Pi+We,$n=rn+We;if(Ge=Ge&&this.isOffscreen(Gi,Hi,ga,$n),Oe=Oe||this.isInsideGrid(Gi,Hi,ga,$n),e!=="always"&&this.grid.hitTestCircle(Pi,rn,We,e,P)&&(De=!0,!D))return{circles:[],offscreen:!1,collisionDetected:De}}}}return{circles:!D&&De||!Oe||Z<this.perspectiveRatioCutoff?[]:J,offscreen:Ge,collisionDetected:De}}projectPathToScreenSpace(e,s,u){return e.map((c=>$(c.x,c.y,u,s.getElevation)))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let u=1/0,c=1/0,f=-1/0,x=-1/0;for(const D of e){const I=new y.P(D.x+yt,D.y+yt);u=Math.min(u,I.x),c=Math.min(c,I.y),f=Math.max(f,I.x),x=Math.max(x,I.y),s.push(I)}const S=this.grid.query(u,c,f,x).concat(this.ignoredGrid.query(u,c,f,x)),T={},E={};for(const D of S){const I=D.key;if(T[I.bucketInstanceId]===void 0&&(T[I.bucketInstanceId]={}),T[I.bucketInstanceId][I.featureIndex])continue;const P=[new y.P(D.x1,D.y1),new y.P(D.x2,D.y1),new y.P(D.x2,D.y2),new y.P(D.x1,D.y2)];y.am(s,P)&&(T[I.bucketInstanceId][I.featureIndex]=!0,E[I.bucketInstanceId]===void 0&&(E[I.bucketInstanceId]=[]),E[I.bucketInstanceId].push(I.featureIndex))}return E}insertCollisionBox(e,s,u,c,f,x){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:f,collisionGroupID:x,overlapMode:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,s,u,c,f,x){const S=u?this.ignoredGrid:this.grid,T={bucketInstanceId:c,featureIndex:f,collisionGroupID:x,overlapMode:s};for(let E=0;E<e.length;E+=4)S.insertCircle(T,e[E],e[E+1],e[E+2])}projectAndGetPerspectiveRatio(e,s,u,c,f){let x;f?(x=[s,u,f(s,u),1],y.af(x,x,e)):(x=[s,u,0,1],Yt(x,x,e));const S=x[3];return{point:new y.P((x[0]/S+1)/2*this.transform.width+yt,(-x[1]/S+1)/2*this.transform.height+yt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/S*.5,isOccluded:!1,signedDistanceFromCamera:S}}getPerspectiveRatio(e,s,u,c,f){const x=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(s,u,c,f):$(s,u,e,f);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(e,s,u,c){return u<yt||e>=this.screenRightBoundary||c<yt||s>this.screenBottomBoundary}isInsideGrid(e,s,u,c){return u>=0&&e<this.gridRightBoundary&&c>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const e=y.an([]);return y.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,s,u,c,f,x,S,T,E,D){let I=new y.P(1,0),P=new y.P(0,1);const j=new y.P(e.anchorPointX+S[0],e.anchorPointY+S[1]);if(x&&!f){const Ge=this.projectAndGetPerspectiveRatio(u,j.x+1,j.y,c,E).point.sub(T.point).unit(),We=Math.atan(Ge.y/Ge.x)+(Ge.x<0?Math.PI:0),$e=Math.sin(We),Fe=Math.cos(We);I=new y.P(Fe,$e),P=new y.P(-$e,Fe)}else if(!x&&f){const Ge=-this.transform.angle,We=Math.sin(Ge),$e=Math.cos(Ge);I=new y.P($e,We),P=new y.P(-We,$e)}let q=T.point,X=s;if(f){q=j;const Ge=this.transform.zoom-Math.floor(this.transform.zoom);X=Math.pow(2,-Ge),X*=this.mapProjection.getPitchedTextCorrection(this.transform,j,c),D||(X*=y.ac(.5+T.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}D&&(q=q.add(I.mult(D.x*X)).add(P.mult(D.y*X)));const K=e.x1*X,J=e.x2*X,ee=(K+J)/2,Z=e.y1*X,ne=e.y2*X,oe=(Z+ne)/2,fe=[{offsetX:K,offsetY:Z},{offsetX:ee,offsetY:Z},{offsetX:J,offsetY:Z},{offsetX:J,offsetY:oe},{offsetX:J,offsetY:ne},{offsetX:ee,offsetY:ne},{offsetX:K,offsetY:ne},{offsetX:K,offsetY:oe}];let De=[];for(const{offsetX:Ge,offsetY:We}of fe)De.push(new y.P(q.x+I.x*Ge+P.x*We,q.y+I.y*Ge+P.y*We));let Oe=!1;if(f){const Ge=De.map((We=>this.projectAndGetPerspectiveRatio(u,We.x,We.y,c,E)));Oe=Ge.some((We=>!We.isOccluded)),De=Ge.map((We=>We.point))}else Oe=!0;return{box:y.ao(De),allPointsOccluded:!Oe}}}function Xt(p,e,s){return e*(y.X/(p.tileSize*Math.pow(2,s-p.tileID.overscaledZ)))}class fa{constructor(e,s,u,c){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?s:-s))):c&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class ra{constructor(e,s,u,c,f){this.text=new fa(e?e.text:null,s,u,f),this.icon=new fa(e?e.icon:null,s,c,f)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Kt{constructor(e,s,u){this.text=e,this.icon=s,this.skipFade=u}}class zi{constructor(){this.invProjMatrix=y.H(),this.viewportMatrix=y.H(),this.circles=[]}}class Ri{constructor(e,s,u,c,f){this.bucketInstanceId=e,this.featureIndex=s,this.sourceLayerIndex=u,this.bucketIndex=c,this.tileID=f}}class Ta{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const s=++this.maxGroupID;this.collisionGroups[e]={ID:s,predicate:u=>u.collisionGroupID===s}}return this.collisionGroups[e]}}function pa(p,e,s,u,c){const{horizontalAlign:f,verticalAlign:x}=y.au(p);return new y.P(-(f-.5)*e+u[0]*c,-(x-.5)*s+u[1]*c)}class Aa{constructor(e,s,u,c,f,x){this.transform=e.clone(),this.terrain=u,this.collisionIndex=new jt(this.transform,s),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Ta(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const s=this.terrain;return s?(u,c)=>s.getElevation(e,u,c):null}getBucketParts(e,s,u,c){const f=u.getBucket(s),x=u.latestFeatureIndex;if(!f||!x||s.id!==f.layerIds[0])return;const S=u.collisionBoxArray,T=f.layers[0].layout,E=f.layers[0].paint,D=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),I=u.tileSize/y.X,P=u.tileID.toUnwrapped(),j=this.transform.calculatePosMatrix(P),q=T.get("text-pitch-alignment")==="map",X=T.get("text-rotation-alignment")==="map",K=Xt(u,1,this.transform.zoom),J=this.collisionIndex.mapProjection.translatePosition(this.transform,u,E.get("text-translate"),E.get("text-translate-anchor")),ee=this.collisionIndex.mapProjection.translatePosition(this.transform,u,E.get("icon-translate"),E.get("icon-translate-anchor")),Z=lr(j,q,X,this.transform,K);let ne=null;if(q){const fe=In(j,q,X,this.transform,K);ne=y.L([],this.transform.labelPlaneMatrix,fe)}this.retainedQueryData[f.bucketInstanceId]=new Ri(f.bucketInstanceId,x,f.sourceLayerIndex,f.index,u.tileID);const oe={bucket:f,layout:T,translationText:J,translationIcon:ee,posMatrix:j,unwrappedTileID:P,textLabelPlaneMatrix:Z,labelToScreenMatrix:ne,scale:D,textPixelRatio:I,holdingForFade:u.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:y.ag(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(c)for(const fe of f.sortKeyRanges){const{sortKey:De,symbolInstanceStart:Oe,symbolInstanceEnd:Ge}=fe;e.push({sortKey:De,symbolInstanceStart:Oe,symbolInstanceEnd:Ge,parameters:oe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(e,s,u,c,f,x,S,T,E,D,I,P,j,q,X,K,J,ee,Z){const ne=y.aq[e.textAnchor],oe=[e.textOffset0,e.textOffset1],fe=pa(ne,u,c,oe,f),De=this.collisionIndex.placeCollisionBox(s,P,T,E,D,S,x,K,I.predicate,Z,fe);if((!ee||this.collisionIndex.placeCollisionBox(ee,P,T,E,D,S,x,J,I.predicate,Z,fe).placeable)&&De.placeable){let Oe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(Oe=this.prevPlacement.variableOffsets[j.crossTileID].anchor),j.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:oe,width:u,height:c,anchor:ne,textBoxScale:f,prevAnchor:Oe},this.markUsedJustification(q,ne,j,X),q.allowVerticalPlacement&&(this.markUsedOrientation(q,X,j),this.placedOrientations[j.crossTileID]=X),{shift:fe,placedGlyphBoxes:De}}}placeLayerBucketPart(e,s,u){const{bucket:c,layout:f,translationText:x,translationIcon:S,posMatrix:T,unwrappedTileID:E,textLabelPlaneMatrix:D,labelToScreenMatrix:I,textPixelRatio:P,holdingForFade:j,collisionBoxArray:q,partiallyEvaluatedTextSize:X,collisionGroup:K}=e.parameters,J=f.get("text-optional"),ee=f.get("icon-optional"),Z=y.ar(f,"text-overlap","text-allow-overlap"),ne=Z==="always",oe=y.ar(f,"icon-overlap","icon-allow-overlap"),fe=oe==="always",De=f.get("text-rotation-alignment")==="map",Oe=f.get("text-pitch-alignment")==="map",Ge=f.get("icon-text-fit")!=="none",We=f.get("symbol-z-order")==="viewport-y",$e=ne&&(fe||!c.hasIconData()||ee),Fe=fe&&(ne||!c.hasTextData()||J);!c.collisionArrays&&q&&c.deserializeCollisionBoxes(q);const it=this._getTerrainElevationFunc(this.retainedQueryData[c.bucketInstanceId].tileID),It=(Ye,Je,zt)=>{var Ci,Gt;if(s[Ye.crossTileID])return;if(j)return void(this.placements[Ye.crossTileID]=new Kt(!1,!1,!1));let ii=!1,Ei=!1,La=!0,Xn=null,Pi={box:null,placeable:!1,offscreen:null},rn={placeable:!1},Gi=null,Hi=null,ga=null,$n=0,eo=0,pr=0;Je.textFeatureIndex?$n=Je.textFeatureIndex:Ye.useRuntimeCollisionCircles&&($n=Ye.featureIndex),Je.verticalTextFeatureIndex&&(eo=Je.verticalTextFeatureIndex);const Na=Je.textBox;if(Na){const Rt=ya=>{let _a=y.ah.horizontal;if(c.allowVerticalPlacement&&!ya&&this.prevPlacement){const sn=this.prevPlacement.placedOrientations[Ye.crossTileID];sn&&(this.placedOrientations[Ye.crossTileID]=sn,_a=sn,this.markUsedOrientation(c,_a,Ye))}return _a},ri=(ya,_a)=>{if(c.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&Je.verticalTextBox){for(const sn of c.writingModes)if(sn===y.ah.vertical?(Pi=_a(),rn=Pi):Pi=ya(),Pi&&Pi.placeable)break}else Pi=ya()},Xi=Ye.textAnchorOffsetStartIndex,An=Ye.textAnchorOffsetEndIndex;if(An===Xi){const ya=(_a,sn)=>{const Wt=this.collisionIndex.placeCollisionBox(_a,Z,P,T,E,Oe,De,x,K.predicate,it);return Wt&&Wt.placeable&&(this.markUsedOrientation(c,sn,Ye),this.placedOrientations[Ye.crossTileID]=sn),Wt};ri((()=>ya(Na,y.ah.horizontal)),(()=>{const _a=Je.verticalTextBox;return c.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&_a?ya(_a,y.ah.vertical):{box:null,offscreen:null}})),Rt(Pi&&Pi.placeable)}else{let ya=y.aq[(Gt=(Ci=this.prevPlacement)===null||Ci===void 0?void 0:Ci.variableOffsets[Ye.crossTileID])===null||Gt===void 0?void 0:Gt.anchor];const _a=(Wt,Yn,No)=>{const $i=Wt.x2-Wt.x1,yu=Wt.y2-Wt.y1,cc=Ye.textBoxScale,hc=Ge&&oe==="never"?Yn:null;let ts=null,hh=Z==="never"?1:2,Fo="never";ya&&hh++;for(let io=0;io<hh;io++){for(let jo=Xi;jo<An;jo++){const Fa=c.textAnchorOffsets.get(jo);if(ya&&Fa.textAnchor!==ya)continue;const Qi=this.attemptAnchorPlacement(Fa,Wt,$i,yu,cc,De,Oe,P,T,E,K,Fo,Ye,c,No,x,S,hc,it);if(Qi&&(ts=Qi.placedGlyphBoxes,ts&&ts.placeable))return ii=!0,Xn=Qi.shift,ts}ya?ya=null:Fo=Z}return u&&!ts&&(ts={box:this.collisionIndex.placeCollisionBox(Na,"always",P,T,E,Oe,De,x,K.predicate,it,new y.P(0,0)).box,offscreen:!1,placeable:!1}),ts};ri((()=>_a(Na,Je.iconBox,y.ah.horizontal)),(()=>{const Wt=Je.verticalTextBox;return c.allowVerticalPlacement&&(!Pi||!Pi.placeable)&&Ye.numVerticalGlyphVertices>0&&Wt?_a(Wt,Je.verticalIconBox,y.ah.vertical):{box:null,occluded:!0,offscreen:null}})),Pi&&(ii=Pi.placeable,La=Pi.offscreen);const sn=Rt(Pi&&Pi.placeable);if(!ii&&this.prevPlacement){const Wt=this.prevPlacement.variableOffsets[Ye.crossTileID];Wt&&(this.variableOffsets[Ye.crossTileID]=Wt,this.markUsedJustification(c,Wt.anchor,Ye,sn))}}}if(Gi=Pi,ii=Gi&&Gi.placeable,La=Gi&&Gi.offscreen,Ye.useRuntimeCollisionCircles){const Rt=c.text.placedSymbolArray.get(Ye.centerJustifiedTextSymbolIndex),ri=y.ai(c.textSizeData,X,Rt),Xi=f.get("text-padding");Hi=this.collisionIndex.placeCollisionCircles(Z,Rt,c.lineVertexArray,c.glyphOffsetArray,ri,T,E,D,I,u,Oe,K.predicate,Ye.collisionCircleDiameter,Xi,x,it),Hi.circles.length&&Hi.collisionDetected&&!u&&y.w("Collisions detected, but collision boxes are not shown"),ii=ne||Hi.circles.length>0&&!Hi.collisionDetected,La=La&&Hi.offscreen}if(Je.iconFeatureIndex&&(pr=Je.iconFeatureIndex),Je.iconBox){const Rt=ri=>this.collisionIndex.placeCollisionBox(ri,oe,P,T,E,Oe,De,S,K.predicate,it,Ge&&Xn?Xn:void 0);rn&&rn.placeable&&Je.verticalIconBox?(ga=Rt(Je.verticalIconBox),Ei=ga.placeable):(ga=Rt(Je.iconBox),Ei=ga.placeable),La=La&&ga.offscreen}const bi=J||Ye.numHorizontalGlyphVertices===0&&Ye.numVerticalGlyphVertices===0,to=ee||Ye.numIconVertices===0;bi||to?to?bi||(Ei=Ei&&ii):ii=Ei&&ii:Ei=ii=Ei&&ii;const mr=Ei&&ga.placeable;if(ii&&Gi.placeable&&this.collisionIndex.insertCollisionBox(Gi.box,Z,f.get("text-ignore-placement"),c.bucketInstanceId,rn&&rn.placeable&&eo?eo:$n,K.ID),mr&&this.collisionIndex.insertCollisionBox(ga.box,oe,f.get("icon-ignore-placement"),c.bucketInstanceId,pr,K.ID),Hi&&ii&&this.collisionIndex.insertCollisionCircles(Hi.circles,Z,f.get("text-ignore-placement"),c.bucketInstanceId,$n,K.ID),u&&this.storeCollisionData(c.bucketInstanceId,zt,Je,Gi,ga,Hi),Ye.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(c.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ye.crossTileID]=new Kt(ii||$e,Ei||Fe,La||c.justReloaded),s[Ye.crossTileID]=!0};if(We){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ye=c.getSortedSymbolIndexes(this.transform.angle);for(let Je=Ye.length-1;Je>=0;--Je){const zt=Ye[Je];It(c.symbolInstances.get(zt),c.collisionArrays[zt],zt)}}else for(let Ye=e.symbolInstanceStart;Ye<e.symbolInstanceEnd;Ye++)It(c.symbolInstances.get(Ye),c.collisionArrays[Ye],Ye);if(u&&c.bucketInstanceId in this.collisionCircleArrays){const Ye=this.collisionCircleArrays[c.bucketInstanceId];y.as(Ye.invProjMatrix,T),Ye.viewportMatrix=this.collisionIndex.getViewportMatrix()}c.justReloaded=!1}storeCollisionData(e,s,u,c,f,x){if(u.textBox||u.iconBox){let S,T;this.collisionBoxArrays.has(e)?S=this.collisionBoxArrays.get(e):(S=new Map,this.collisionBoxArrays.set(e,S)),S.has(s)?T=S.get(s):(T={text:null,icon:null},S.set(s,T)),u.textBox&&(T.text=c.box),u.iconBox&&(T.icon=f.box)}if(x){let S=this.collisionCircleArrays[e];S===void 0&&(S=this.collisionCircleArrays[e]=new zi);for(let T=0;T<x.circles.length;T+=4)S.circles.push(x.circles[T+0]),S.circles.push(x.circles[T+1]),S.circles.push(x.circles[T+2]),S.circles.push(x.collisionDetected?1:0)}}markUsedJustification(e,s,u,c){let f;f=c===y.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[y.at(s)];const x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const S of x)S>=0&&(e.text.placedSymbolArray.get(S).crossTileID=f>=0&&S!==f?0:u.crossTileID)}markUsedOrientation(e,s,u){const c=s===y.ah.horizontal||s===y.ah.horizontalOnly?s:0,f=s===y.ah.vertical?s:0,x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const S of x)e.text.placedSymbolArray.get(S).placedOrientation=c;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=f)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let u=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const c=s?s.symbolFadeChange(e):1,f=s?s.opacities:{},x=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(const T in this.placements){const E=this.placements[T],D=f[T];D?(this.opacities[T]=new ra(D,c,E.text,E.icon),u=u||E.text!==D.text.placed||E.icon!==D.icon.placed):(this.opacities[T]=new ra(null,c,E.text,E.icon,E.skipFade),u=u||E.text||E.icon)}for(const T in f){const E=f[T];if(!this.opacities[T]){const D=new ra(E,c,!1,!1);D.isHidden()||(this.opacities[T]=D,u=u||E.text.placed||E.icon.placed)}}for(const T in x)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=x[T]);for(const T in S)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=S[T]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:e)}updateLayerOpacities(e,s){const u={};for(const c of s){const f=c.getBucket(e);f&&c.latestFeatureIndex&&e.id===f.layerIds[0]&&this.updateBucketOpacities(f,c.tileID,u,c.collisionBoxArray)}}updateBucketOpacities(e,s,u,c){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const f=e.layers[0],x=f.layout,S=new ra(null,0,!1,!1,!0),T=x.get("text-allow-overlap"),E=x.get("icon-allow-overlap"),D=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),I=x.get("text-rotation-alignment")==="map",P=x.get("text-pitch-alignment")==="map",j=x.get("icon-text-fit")!=="none",q=new ra(null,0,T&&(E||!e.hasIconData()||x.get("icon-optional")),E&&(T||!e.hasTextData()||x.get("text-optional")),!0);!e.collisionArrays&&c&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(c);const X=(J,ee,Z)=>{for(let ne=0;ne<ee/4;ne++)J.opacityVertexArray.emplaceBack(Z);J.hasVisibleVertices=J.hasVisibleVertices||Z!==Is},K=this.collisionBoxArrays.get(e.bucketInstanceId);for(let J=0;J<e.symbolInstances.length;J++){const ee=e.symbolInstances.get(J),{numHorizontalGlyphVertices:Z,numVerticalGlyphVertices:ne,crossTileID:oe}=ee;let fe=this.opacities[oe];u[oe]?fe=S:fe||(fe=q,this.opacities[oe]=fe),u[oe]=!0;const De=ee.numIconVertices>0,Oe=this.placedOrientations[ee.crossTileID],Ge=Oe===y.ah.vertical,We=Oe===y.ah.horizontal||Oe===y.ah.horizontalOnly;if(Z>0||ne>0){const Fe=xn(fe.text);X(e.text,Z,Ge?Is:Fe),X(e.text,ne,We?Is:Fe);const it=fe.text.isHidden();[ee.rightJustifiedTextSymbolIndex,ee.centerJustifiedTextSymbolIndex,ee.leftJustifiedTextSymbolIndex].forEach((Je=>{Je>=0&&(e.text.placedSymbolArray.get(Je).hidden=it||Ge?1:0)})),ee.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ee.verticalPlacedTextSymbolIndex).hidden=it||We?1:0);const It=this.variableOffsets[ee.crossTileID];It&&this.markUsedJustification(e,It.anchor,ee,Oe);const Ye=this.placedOrientations[ee.crossTileID];Ye&&(this.markUsedJustification(e,"left",ee,Ye),this.markUsedOrientation(e,Ye,ee))}if(De){const Fe=xn(fe.icon),it=!(j&&ee.verticalPlacedIconSymbolIndex&&Ge);ee.placedIconSymbolIndex>=0&&(X(e.icon,ee.numIconVertices,it?Fe:Is),e.icon.placedSymbolArray.get(ee.placedIconSymbolIndex).hidden=fe.icon.isHidden()),ee.verticalPlacedIconSymbolIndex>=0&&(X(e.icon,ee.numVerticalIconVertices,it?Is:Fe),e.icon.placedSymbolArray.get(ee.verticalPlacedIconSymbolIndex).hidden=fe.icon.isHidden())}const $e=K&&K.has(J)?K.get(J):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Fe=e.collisionArrays[J];if(Fe){let it=new y.P(0,0);if(Fe.textBox||Fe.verticalTextBox){let It=!0;if(D){const Ye=this.variableOffsets[oe];Ye?(it=pa(Ye.anchor,Ye.width,Ye.height,Ye.textOffset,Ye.textBoxScale),I&&it._rotate(P?this.transform.angle:-this.transform.angle)):It=!1}if(Fe.textBox||Fe.verticalTextBox){let Ye;Fe.textBox&&(Ye=Ge),Fe.verticalTextBox&&(Ye=We),Ar(e.textCollisionBox.collisionVertexArray,fe.text.placed,!It||Ye,$e.text,it.x,it.y)}}if(Fe.iconBox||Fe.verticalIconBox){const It=!!(!We&&Fe.verticalIconBox);let Ye;Fe.iconBox&&(Ye=It),Fe.verticalIconBox&&(Ye=!It),Ar(e.iconCollisionBox.collisionVertexArray,fe.icon.placed,Ye,$e.icon,j?it.x:0,j?it.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const J=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=J.invProjMatrix,e.placementViewportMatrix=J.viewportMatrix,e.collisionCircleArray=J.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,s){const u=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function Ar(p,e,s,u,c,f){u&&u.length!==0||(u=[0,0,0,0]);const x=u[0]-yt,S=u[1]-yt,T=u[2]-yt,E=u[3]-yt;p.emplaceBack(e?1:0,s?1:0,c||0,f||0,x,S),p.emplaceBack(e?1:0,s?1:0,c||0,f||0,T,S),p.emplaceBack(e?1:0,s?1:0,c||0,f||0,T,E),p.emplaceBack(e?1:0,s?1:0,c||0,f||0,x,E)}const mi=Math.pow(2,25),za=Math.pow(2,24),Fl=Math.pow(2,17),vn=Math.pow(2,16),Da=Math.pow(2,9),_o=Math.pow(2,8),Un=Math.pow(2,1);function xn(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const e=p.placed?1:0,s=Math.floor(127*p.opacity);return s*mi+e*za+s*Fl+e*vn+s*Da+e*_o+s*Un+e}const Is=0;function ks(){return{isOccluded:(p,e,s)=>!1,getPitchedTextCorrection:(p,e,s)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(p,e,s,u){throw new Error("Not implemented.")},translatePosition:(p,e,s,u)=>(function(c,f,x,S,T=!1){if(!x[0]&&!x[1])return[0,0];const E=T?S==="map"?c.angle:0:S==="viewport"?-c.angle:0;if(E){const D=Math.sin(E),I=Math.cos(E);x=[x[0]*I-x[1]*D,x[0]*D+x[1]*I]}return[T?x[0]:Xt(f,x[0],c.zoom),T?x[1]:Xt(f,x[1],c.zoom)]})(p,e,s,u),getCircleRadiusCorrection:p=>1}}class sa{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,s,u,c,f){const x=this._bucketParts;for(;this._currentTileIndex<e.length;)if(s.getBucketParts(x,c,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort(((S,T)=>S.sortKey-T.sortKey)));this._currentPartIndex<x.length;)if(s.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,f())return!0;return!1}}class cs{constructor(e,s,u,c,f,x,S,T){this.placement=new Aa(e,ks(),s,x,S,T),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=f,this._done=!1}isDone(){return this._done}continuePlacement(e,s,u){const c=me.now(),f=()=>!this._forceFullPlacement&&me.now()-c>2;for(;this._currentPlacementIndex>=0;){const x=s[e[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=S)&&(!x.maxzoom||x.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new sa(x)),this._inProgressLayer.continuePlacement(u[x.source],this.placement,this._showCollisionBoxes,x,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Ia=512/y.X/2;class xi{constructor(e,s,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};const c=new Map;for(let f=0;f<s.length;f++){const x=s.get(f),S=x.key,T=c.get(S);T?T.push(x):c.set(S,[x])}for(const[f,x]of c){const S={positions:x.map((T=>({x:Math.floor(T.anchorX*Ia),y:Math.floor(T.anchorY*Ia)}))),crossTileIDs:x.map((T=>T.crossTileID))};if(S.positions.length>128){const T=new y.av(S.positions.length,16,Uint16Array);for(const{x:E,y:D}of S.positions)T.add(E,D);T.finish(),delete S.positions,S.index=T}this._symbolsByKey[f]=S}}getScaledCoordinates(e,s){const{x:u,y:c,z:f}=this.tileID.canonical,{x,y:S,z:T}=s.canonical,E=Ia/Math.pow(2,T-f),D=(S*y.X+e.anchorY)*E,I=c*y.X*Ia;return{x:Math.floor((x*y.X+e.anchorX)*E-u*y.X*Ia),y:Math.floor(D-I)}}findMatches(e,s,u){const c=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let f=0;f<e.length;f++){const x=e.get(f);if(x.crossTileID)continue;const S=this._symbolsByKey[x.key];if(!S)continue;const T=this.getScaledCoordinates(x,s);if(S.index){const E=S.index.range(T.x-c,T.y-c,T.x+c,T.y+c).sort();for(const D of E){const I=S.crossTileIDs[D];if(!u[I]){u[I]=!0,x.crossTileID=I;break}}}else if(S.positions)for(let E=0;E<S.positions.length;E++){const D=S.positions[E],I=S.crossTileIDs[E];if(Math.abs(D.x-T.x)<=c&&Math.abs(D.y-T.y)<=c&&!u[I]){u[I]=!0,x.crossTileID=I;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class rl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ur{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const s=Math.round((e-this.lng)/360);if(s!==0)for(const u in this.indexes){const c=this.indexes[u],f={};for(const x in c){const S=c[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),f[S.tileID.key]=S}this.indexes[u]=f}this.lng=e}addBucket(e,s,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let f=0;f<s.symbolInstances.length;f++)s.symbolInstances.get(f).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const c=this.usedCrossTileIDs[e.overscaledZ];for(const f in this.indexes){const x=this.indexes[f];if(Number(f)>e.overscaledZ)for(const S in x){const T=x[S];T.tileID.isChildOf(e)&&T.findMatches(s.symbolInstances,e,c)}else{const S=x[e.scaledTo(Number(f)).key];S&&S.findMatches(s.symbolInstances,e,c)}}for(let f=0;f<s.symbolInstances.length;f++){const x=s.symbolInstances.get(f);x.crossTileID||(x.crossTileID=u.generate(),c[x.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new xi(e,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(e,s){for(const u of s.getCrossTileIDsLists())for(const c of u)delete this.usedCrossTileIDs[e][c]}removeStaleBuckets(e){let s=!1;for(const u in this.indexes){const c=this.indexes[u];for(const f in c)e[c[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,c[f]),delete c[f],s=!0)}return s}}class sl{constructor(){this.layerIndexes={},this.crossTileIDs=new rl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,s,u){let c=this.layerIndexes[e.id];c===void 0&&(c=this.layerIndexes[e.id]=new ur);let f=!1;const x={};c.handleWrapJump(u);for(const S of s){const T=S.getBucket(e);T&&e.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(S.tileID,T,this.crossTileIDs)&&(f=!0),x[T.bucketInstanceId]=!0)}return c.removeStaleBuckets(x)&&(f=!0),f}pruneUnusedLayers(e){const s={};e.forEach((u=>{s[u]=!0}));for(const u in this.layerIndexes)s[u]||delete this.layerIndexes[u]}}const Vn=(p,e)=>y.t(p,e&&e.filter((s=>s.identifier!=="source.canvas"))),jl=y.aw();class Ul extends y.E{constructor(e,s={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const c=this.sourceCaches[u].getSource().type;c!=="vector"&&c!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new rr(Ai(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((u,c)=>this.getGlyphs(u,c))),this.dispatcher.registerMessageHandler("GI",((u,c)=>this.getImages(u,c))),this.imageManager=new Ti,this.imageManager.setEventedParent(this),this.glyphManager=new He(e._requestManager,s.localIdeographFontFamily),this.lineAtlas=new qe(256,512),this.crossTileSymbolIndex=new sl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new y.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",y.ay()),Sr().on(je,this._rtlPluginLoaded),this.on("data",(u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const c=this.sourceCaches[u.sourceId];if(!c)return;const f=c.getSource();if(f&&f.vectorLayerIds)for(const x in this._layers){const S=this._layers[x];S.source===f.id&&this._validateLayer(S)}}))}loadURL(e,s={},u){this.fire(new y.k("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const c=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const f=this._loadStyleRequest;y.h(c,this._loadStyleRequest).then((x=>{this._loadStyleRequest=null,this._load(x.data,s,u)})).catch((x=>{this._loadStyleRequest=null,x&&!f.signal.aborted&&this.fire(new y.j(x))}))}loadJSON(e,s={},u){this.fire(new y.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,me.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(e,s,u)})).catch((()=>{}))}loadEmpty(){this.fire(new y.k("dataloading",{dataType:"style"})),this._load(jl,{validate:!1})}_load(e,s,u){var c;const f=s.transformStyle?s.transformStyle(u,e):e;if(!s.validate||!Vn(this,y.u(f))){this._loaded=!0,this.stylesheet=f;for(const x in f.sources)this.addSource(x,f.sources[x],{validate:!1});f.sprite?this._loadSprite(f.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(f.glyphs),this._createLayers(),this.light=new nt(this.stylesheet.light),this.sky=new be(this.stylesheet.sky),this.map.setTerrain((c=this.stylesheet.terrain)!==null&&c!==void 0?c:null),this.fire(new y.k("data",{dataType:"style"})),this.fire(new y.k("style.load"))}}_createLayers(){const e=y.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map((s=>s.id)),this._layers={},this._serializedLayers=null;for(const s of e){const u=y.aA(s);u.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=u}}_loadSprite(e,s=!1,u=void 0){let c;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(f,x,S,T){return y._(this,void 0,void 0,(function*(){const E=vi(f),D=S>1?"@2x":"",I={},P={};for(const{id:j,url:q}of E){const X=x.transformRequest(Si(q,D,".json"),"SpriteJSON");I[j]=y.h(X,T);const K=x.transformRequest(Si(q,D,".png"),"SpriteImage");P[j]=dt.getImage(K,T)}return yield Promise.all([...Object.values(I),...Object.values(P)]),(function(j,q){return y._(this,void 0,void 0,(function*(){const X={};for(const K in j){X[K]={};const J=me.getImageCanvasContext((yield q[K]).data),ee=(yield j[K]).data;for(const Z in ee){const{width:ne,height:oe,x:fe,y:De,sdf:Oe,pixelRatio:Ge,stretchX:We,stretchY:$e,content:Fe,textFitWidth:it,textFitHeight:It}=ee[Z];X[K][Z]={data:null,pixelRatio:Ge,sdf:Oe,stretchX:We,stretchY:$e,content:Fe,textFitWidth:it,textFitHeight:It,spriteData:{width:ne,height:oe,x:fe,y:De,context:J}}}}return X}))})(I,P)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((f=>{if(this._spriteRequest=null,f)for(const x in f){this._spritesImagesIds[x]=[];const S=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter((T=>!(T in f))):[];for(const T of S)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in f[x]){const E=x==="default"?T:`${x}:${T}`;this._spritesImagesIds[x].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,f[x][T],!1):this.imageManager.addImage(E,f[x][T]),s&&(this._changedImages[E]=!0)}}})).catch((f=>{this._spriteRequest=null,c=f,this.fire(new y.j(c))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.k("data",{dataType:"style"})),u&&u(c)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.k("data",{dataType:"style"}))}_validateLayer(e){const s=this.sourceCaches[e.source];if(!s)return;const u=e.sourceLayer;if(!u)return;const c=s.getSource();(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(u)===-1)&&this.fire(new y.j(new Error(`Source layer "${u}" does not exist on source "${c.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,s=!1){const u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(s?y.aB(u):u);const c=[];for(const f of e)if(u[f]){const x=s?y.aB(u[f]):u[f];c.push(x)}return c}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const s=Object.keys(this._layers);for(const u of s){const c=this._layers[u];c.type!=="custom"&&(e[u]=c.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const s=this._changed;if(s){const c=Object.keys(this._updatedLayers),f=Object.keys(this._removedLayers);(c.length||f.length)&&this._updateWorkerLayers(c,f);for(const x in this._updatedSources){const S=this._updatedSources[x];if(S==="reload")this._reloadSource(x);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const u={};for(const c in this.sourceCaches){const f=this.sourceCaches[c];u[c]=f.used,f.used=!1}for(const c of this._order){const f=this._layers[c];f.recalculate(e,this._availableImages),!f.isHidden(e.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}for(const c in u){const f=this.sourceCaches[c];!!u[c]!=!!f.used&&f.fire(new y.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:c}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,s&&this.fire(new y.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,s={}){var u;this._checkLoaded();const c=this.serialize();if(e=s.transformStyle?s.transformStyle(c,e):e,((u=s.validate)===null||u===void 0||u)&&Vn(this,y.u(e)))return!1;(e=y.aB(e)).layers=y.az(e.layers);const f=y.aC(c,e),x=this._getOperationsToPerform(f);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const S of x.operations)S();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const s=[],u=[];for(const c of e)switch(c.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":s.push((()=>this.addLayer.apply(this,c.args)));break;case"removeLayer":s.push((()=>this.removeLayer.apply(this,c.args)));break;case"setPaintProperty":s.push((()=>this.setPaintProperty.apply(this,c.args)));break;case"setLayoutProperty":s.push((()=>this.setLayoutProperty.apply(this,c.args)));break;case"setFilter":s.push((()=>this.setFilter.apply(this,c.args)));break;case"addSource":s.push((()=>this.addSource.apply(this,c.args)));break;case"removeSource":s.push((()=>this.removeSource.apply(this,c.args)));break;case"setLayerZoomRange":s.push((()=>this.setLayerZoomRange.apply(this,c.args)));break;case"setLight":s.push((()=>this.setLight.apply(this,c.args)));break;case"setGeoJSONSourceData":s.push((()=>this.setGeoJSONSourceData.apply(this,c.args)));break;case"setGlyphs":s.push((()=>this.setGlyphs.apply(this,c.args)));break;case"setSprite":s.push((()=>this.setSprite.apply(this,c.args)));break;case"setSky":s.push((()=>this.setSky.apply(this,c.args)));break;case"setTerrain":s.push((()=>this.map.setTerrain.apply(this,c.args)));break;case"setTransition":s.push((()=>{}));break;default:u.push(c.command)}return{operations:s,unimplemented:u}}addImage(e,s){if(this.getImage(e))return this.fire(new y.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,s),this._afterImageUpdated(e)}updateImage(e,s){this.imageManager.updateImage(e,s)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new y.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,s,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(y.u.source,`sources.${e}`,s,null,u))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const c=this.sourceCaches[e]=new xt(e,s,this.dispatcher);c.style=this,c.setEventedParent(this,(()=>({isSourceLoaded:c.loaded(),source:c.serialize(),sourceId:e}))),c.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===e)return this.fire(new y.j(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));const s=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],s.fire(new y.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,s){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(s),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,s,u={}){this._checkLoaded();const c=e.id;if(this.getLayer(c))return void this.fire(new y.j(new Error(`Layer "${c}" already exists on this map.`)));let f;if(e.type==="custom"){if(Vn(this,y.aD(e)))return;f=y.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(c,e.source),e=y.aB(e),e=y.e(e,{source:c})),this._validate(y.u.layer,`layers.${c}`,e,{arrayIndex:-1},u))return;f=y.aA(e),this._validateLayer(f),f.setEventedParent(this,{layer:{id:c}})}const x=s?this._order.indexOf(s):this._order.length;if(s&&x===-1)this.fire(new y.j(new Error(`Cannot add layer "${c}" before non-existing layer "${s}".`)));else{if(this._order.splice(x,0,c),this._layerOrderChanged=!0,this._layers[c]=f,this._removedLayers[c]&&f.source&&f.type!=="custom"){const S=this._removedLayers[c];delete this._removedLayers[c],S.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}moveLayer(e,s){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new y.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===s)return;const u=this._order.indexOf(e);this._order.splice(u,1);const c=s?this._order.indexOf(s):this._order.length;s&&c===-1?this.fire(new y.j(new Error(`Cannot move layer "${e}" before non-existing layer "${s}".`))):(this._order.splice(c,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const s=this._layers[e];if(!s)return void this.fire(new y.j(new Error(`Cannot remove non-existing layer "${e}".`)));s.setEventedParent(null);const u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=s,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],s.onRemove&&s.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,s,u){this._checkLoaded();const c=this.getLayer(e);c?c.minzoom===s&&c.maxzoom===u||(s!=null&&(c.minzoom=s),u!=null&&(c.maxzoom=u),this._updateLayer(c)):this.fire(new y.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,s,u={}){this._checkLoaded();const c=this.getLayer(e);if(c){if(!y.aE(c.filter,s))return s==null?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(y.u.filter,`layers.${c.id}.filter`,s,null,u)||(c.filter=y.aB(s),this._updateLayer(c)))}else this.fire(new y.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return y.aB(this.getLayer(e).filter)}setLayoutProperty(e,s,u,c={}){this._checkLoaded();const f=this.getLayer(e);f?y.aE(f.getLayoutProperty(s),u)||(f.setLayoutProperty(s,u,c),this._updateLayer(f)):this.fire(new y.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,s){const u=this.getLayer(e);if(u)return u.getLayoutProperty(s);this.fire(new y.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,s,u,c={}){this._checkLoaded();const f=this.getLayer(e);f?y.aE(f.getPaintProperty(s),u)||(f.setPaintProperty(s,u,c)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new y.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,s){return this.getLayer(e).getPaintProperty(s)}setFeatureState(e,s){this._checkLoaded();const u=e.source,c=e.sourceLayer,f=this.sourceCaches[u];if(f===void 0)return void this.fire(new y.j(new Error(`The source '${u}' does not exist in the map's style.`)));const x=f.getSource().type;x==="geojson"&&c?this.fire(new y.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||c?(e.id===void 0&&this.fire(new y.j(new Error("The feature id parameter must be provided."))),f.setFeatureState(c,e.id,s)):this.fire(new y.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,s){this._checkLoaded();const u=e.source,c=this.sourceCaches[u];if(c===void 0)return void this.fire(new y.j(new Error(`The source '${u}' does not exist in the map's style.`)));const f=c.getSource().type,x=f==="vector"?e.sourceLayer:void 0;f!=="vector"||x?s&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new y.j(new Error("A feature id is required to remove its specific state property."))):c.removeFeatureState(x,e.id,s):this.fire(new y.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const s=e.source,u=e.sourceLayer,c=this.sourceCaches[s];if(c!==void 0)return c.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new y.j(new Error("The feature id parameter must be provided."))),c.getFeatureState(u,e.id)):void this.fire(new y.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new y.j(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return y.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=y.aF(this.sourceCaches,(f=>f.serialize())),s=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,c=this.stylesheet;return y.aG({version:c.version,name:c.name,metadata:c.metadata,light:c.light,sky:c.sky,center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,sprite:c.sprite,glyphs:c.glyphs,transition:c.transition,sources:e,layers:s,terrain:u},(f=>f!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const s=x=>this._layers[x].type==="fill-extrusion",u={},c=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(s(S)){u[S]=x;for(const T of e){const E=T[S];if(E)for(const D of E)c.push(D)}}}c.sort(((x,S)=>S.intersectionZ-x.intersectionZ));const f=[];for(let x=this._order.length-1;x>=0;x--){const S=this._order[x];if(s(S))for(let T=c.length-1;T>=0;T--){const E=c[T].feature;if(u[E.layer.id]<x)break;f.push(E),c.pop()}else for(const T of e){const E=T[S];if(E)for(const D of E)f.push(D.feature)}}return f}queryRenderedFeatures(e,s,u){s&&s.filter&&this._validate(y.u.filter,"queryRenderedFeatures.filter",s.filter,null,s);const c={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new y.j(new Error("parameters.layers must be an Array."))),[];for(const S of s.layers){const T=this._layers[S];if(!T)return this.fire(new y.j(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];c[T.source]=!0}}const f=[];s.availableImages=this._availableImages;const x=this._serializedAllLayers();for(const S in this.sourceCaches)s.layers&&!c[S]||f.push(Nr(this.sourceCaches[S],this._layers,x,e,s,u));return this.placement&&f.push((function(S,T,E,D,I,P,j){const q={},X=P.queryRenderedSymbols(D),K=[];for(const J of Object.keys(X).map(Number))K.push(j[J]);K.sort(_n);for(const J of K){const ee=J.featureIndex.lookupSymbolFeatures(X[J.bucketInstanceId],T,J.bucketIndex,J.sourceLayerIndex,I.filter,I.layers,I.availableImages,S);for(const Z in ee){const ne=q[Z]=q[Z]||[],oe=ee[Z];oe.sort(((fe,De)=>{const Oe=J.featureSortOrder;if(Oe){const Ge=Oe.indexOf(fe.featureIndex);return Oe.indexOf(De.featureIndex)-Ge}return De.featureIndex-fe.featureIndex}));for(const fe of oe)ne.push(fe)}}for(const J in q)q[J].forEach((ee=>{const Z=ee.feature,ne=E[S[J].source].getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=ne}));return q})(this._layers,x,this.sourceCaches,e,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)}querySourceFeatures(e,s){s&&s.filter&&this._validate(y.u.filter,"querySourceFeatures.filter",s.filter,null,s);const u=this.sourceCaches[e];return u?(function(c,f){const x=c.getRenderableIds().map((E=>c.getTileByID(E))),S=[],T={};for(let E=0;E<x.length;E++){const D=x[E],I=D.tileID.canonical.key;T[I]||(T[I]=!0,D.querySourceFeatures(S,f))}return S})(u,s):[]}getLight(){return this.light.getLight()}setLight(e,s={}){this._checkLoaded();const u=this.light.getLight();let c=!1;for(const x in e)if(!y.aE(e[x],u[x])){c=!0;break}if(!c)return;const f={now:me.now(),transition:y.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,s),this.light.updateTransitions(f)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,s={}){const u=this.getSky();let c=!1;if(!e&&!u)return;if(e&&!u)c=!0;else if(!e&&u)c=!0;else for(const x in e)if(!y.aE(e[x],u[x])){c=!0;break}if(!c)return;const f={now:me.now(),transition:y.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,s),this.sky.updateTransitions(f)}_validate(e,s,u,c,f={}){return(!f||f.validate!==!1)&&Vn(this,e.call(y.u,y.e({key:s,style:this.serialize(),value:u,styleSpec:y.v},c)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Sr().off(je,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const u=this.sourceCaches[s];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const s in this.sourceCaches)this.sourceCaches[s].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,s,u,c,f=!1){let x=!1,S=!1;const T={};for(const E of this._order){const D=this._layers[E];if(D.type!=="symbol")continue;if(!T[D.source]){const P=this.sourceCaches[D.source];T[D.source]=P.getRenderableIds(!0).map((j=>P.getTileByID(j))).sort(((j,q)=>q.tileID.overscaledZ-j.tileID.overscaledZ||(j.tileID.isLessThan(q.tileID)?-1:1)))}const I=this.crossTileSymbolIndex.addLayer(D,T[D.source],e.center.lng);x=x||I}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((f=f||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(me.now(),e.zoom))&&(this.pauseablePlacement=new cs(e,this.map.terrain,this._order,f,s,u,c,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(me.now()),S=!0),x&&this.pauseablePlacement.placement.setStale()),S||x)for(const E of this._order){const D=this._layers[E];D.type==="symbol"&&this.placement.updateLayerOpacities(D,T[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(me.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,s){return y._(this,void 0,void 0,(function*(){const u=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const c=this.sourceCaches[s.source];return c&&c.setDependencies(s.tileID.key,s.type,s.icons),u}))}getGlyphs(e,s){return y._(this,void 0,void 0,(function*(){const u=yield this.glyphManager.getGlyphs(s.stacks),c=this.sourceCaches[s.source];return c&&c.setDependencies(s.tileID.key,s.type,[""]),u}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,s={}){this._checkLoaded(),e&&this._validate(y.u.glyphs,"glyphs",e,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,s,u={},c){this._checkLoaded();const f=[{id:e,url:s}],x=[...vi(this.stylesheet.sprite),...f];this._validate(y.u.sprite,"sprite",x,null,u)||(this.stylesheet.sprite=x,this._loadSprite(f,!0,c))}removeSprite(e){this._checkLoaded();const s=vi(this.stylesheet.sprite);if(s.find((u=>u.id===e))){if(this._spritesImagesIds[e])for(const u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;s.splice(s.findIndex((u=>u.id===e)),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.k("data",{dataType:"style"}))}else this.fire(new y.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return vi(this.stylesheet.sprite)}setSprite(e,s={},u){this._checkLoaded(),e&&this._validate(y.u.sprite,"sprite",e,null,s)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var Oa=y.Y([{name:"a_pos",type:"Int16",components:2}]);const zr={prelude:yi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:yi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:yi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:yi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:yi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:yi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:yi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:yi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:yi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:yi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:yi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:yi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:yi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:yi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:yi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:yi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:yi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:yi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:yi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:yi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:yi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function yi(p,e){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/attribute ([\w]+) ([\w]+)/g),c=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),f=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=f?f.concat(c):c,S={};return{fragmentSource:p=p.replace(s,((T,E,D,I,P)=>(S[P]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${P}
varying ${D} ${I} ${P};
#else
uniform ${D} ${I} u_${P};
#endif
`:`
#ifdef HAS_UNIFORM_u_${P}
    ${D} ${I} ${P} = u_${P};
#endif
`))),vertexSource:e=e.replace(s,((T,E,D,I,P)=>{const j=I==="float"?"vec2":"vec4",q=P.match(/color/)?"color":j;return S[P]?E==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${D} ${j} a_${P};
varying ${D} ${I} ${P};
#else
uniform ${D} ${I} u_${P};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = a_${P};
#else
    ${D} ${I} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = unpack_mix_${q}(a_${P}, u_${P}_t);
#else
    ${D} ${I} ${P} = u_${P};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${D} ${j} a_${P};
#else
uniform ${D} ${I} u_${P};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${D} ${I} ${P} = a_${P};
#else
    ${D} ${I} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${D} ${I} ${P} = unpack_mix_${q}(a_${P}, u_${P}_t);
#else
    ${D} ${I} ${P} = u_${P};
#endif
`})),staticAttributes:u,staticUniforms:x}}class ol{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,s,u,c,f,x,S,T,E){this.context=e;let D=this.boundPaintVertexBuffers.length!==c.length;for(let I=0;!D&&I<c.length;I++)this.boundPaintVertexBuffers[I]!==c[I]&&(D=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==u||D||this.boundIndexBuffer!==f||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==E?this.freshBind(s,u,c,f,x,S,T,E):(e.bindVertexArray.set(this.vao),S&&S.bind(),f&&f.dynamicDraw&&f.bind(),T&&T.bind(),E&&E.bind())}freshBind(e,s,u,c,f,x,S,T){const E=e.numAttributes,D=this.context,I=D.gl;this.vao&&this.destroy(),this.vao=D.createVertexArray(),D.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=c,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=T,s.enableAttributes(I,e);for(const P of u)P.enableAttributes(I,e);x&&x.enableAttributes(I,e),S&&S.enableAttributes(I,e),T&&T.enableAttributes(I,e),s.bind(),s.setVertexAttribPointers(I,e,f);for(const P of u)P.bind(),P.setVertexAttribPointers(I,e,f);x&&(x.bind(),x.setVertexAttribPointers(I,e,f)),c&&c.bind(),S&&(S.bind(),S.setVertexAttribPointers(I,e,f)),T&&(T.bind(),T.setVertexAttribPointers(I,e,f)),D.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const hs=(p,e,s,u,c)=>({u_matrix:p,u_texture:0,u_ele_delta:e,u_fog_matrix:s,u_fog_color:u?u.properties.get("fog-color"):y.aM.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?u.calculateFogBlendOpacity(c):0,u_horizon_color:u?u.properties.get("horizon-color"):y.aM.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1});function Rs(p){const e=[];for(let s=0;s<p.length;s++){if(p[s]===null)continue;const u=p[s].split(" ");e.push(u.pop())}return e}class Vl{constructor(e,s,u,c,f,x){const S=e.gl;this.program=S.createProgram();const T=Rs(s.staticAttributes),E=u?u.getBinderAttributes():[],D=T.concat(E),I=zr.prelude.staticUniforms?Rs(zr.prelude.staticUniforms):[],P=s.staticUniforms?Rs(s.staticUniforms):[],j=u?u.getBinderUniforms():[],q=I.concat(P).concat(j),X=[];for(const fe of q)X.indexOf(fe)<0&&X.push(fe);const K=u?u.defines():[];f&&K.push("#define OVERDRAW_INSPECTOR;"),x&&K.push("#define TERRAIN3D;");const J=K.concat(zr.prelude.fragmentSource,s.fragmentSource).join(`
`),ee=K.concat(zr.prelude.vertexSource,s.vertexSource).join(`
`),Z=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(Z,J),S.compileShader(Z),!S.getShaderParameter(Z,S.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${S.getShaderInfoLog(Z)}`);S.attachShader(this.program,Z);const ne=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(ne,ee),S.compileShader(ne),!S.getShaderParameter(ne,S.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${S.getShaderInfoLog(ne)}`);S.attachShader(this.program,ne),this.attributes={};const oe={};this.numAttributes=D.length;for(let fe=0;fe<this.numAttributes;fe++)D[fe]&&(S.bindAttribLocation(this.program,fe,D[fe]),this.attributes[D[fe]]=fe);if(S.linkProgram(this.program),!S.getProgramParameter(this.program,S.LINK_STATUS))throw new Error(`Program failed to link: ${S.getProgramInfoLog(this.program)}`);S.deleteShader(ne),S.deleteShader(Z);for(let fe=0;fe<X.length;fe++){const De=X[fe];if(De&&!oe[De]){const Oe=S.getUniformLocation(this.program,De);Oe&&(oe[De]=Oe)}}this.fixedUniforms=c(e,oe),this.terrainUniforms=((fe,De)=>({u_depth:new y.aH(fe,De.u_depth),u_terrain:new y.aH(fe,De.u_terrain),u_terrain_dim:new y.aI(fe,De.u_terrain_dim),u_terrain_matrix:new y.aJ(fe,De.u_terrain_matrix),u_terrain_unpack:new y.aK(fe,De.u_terrain_unpack),u_terrain_exaggeration:new y.aI(fe,De.u_terrain_exaggeration)}))(e,oe),this.binderUniforms=u?u.getUniforms(e,oe):[]}draw(e,s,u,c,f,x,S,T,E,D,I,P,j,q,X,K,J,ee){const Z=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(c),e.setColorMode(f),e.setCullFace(x),T){e.activeTexture.set(Z.TEXTURE2),Z.bindTexture(Z.TEXTURE_2D,T.depthTexture),e.activeTexture.set(Z.TEXTURE3),Z.bindTexture(Z.TEXTURE_2D,T.texture);for(const oe in this.terrainUniforms)this.terrainUniforms[oe].set(T[oe])}for(const oe in this.fixedUniforms)this.fixedUniforms[oe].set(S[oe]);X&&X.setUniforms(e,this.binderUniforms,j,{zoom:q});let ne=0;switch(s){case Z.LINES:ne=2;break;case Z.TRIANGLES:ne=3;break;case Z.LINE_STRIP:ne=1}for(const oe of P.get()){const fe=oe.vaos||(oe.vaos={});(fe[E]||(fe[E]=new ol)).bind(e,this,D,X?X.getPaintVertexBuffers():[],I,oe.vertexOffset,K,J,ee),Z.drawElements(s,oe.primitiveLength*ne,Z.UNSIGNED_SHORT,oe.primitiveOffset*ne*2)}}}function jr(p,e,s){const u=1/Xt(s,1,e.transform.tileZoom),c=Math.pow(2,s.tileID.overscaledZ),f=s.tileSize*Math.pow(2,e.transform.tileZoom)/c,x=f*(s.tileID.canonical.x+s.tileID.wrap*c),S=f*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[u,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[x>>16,S>>16],u_pixel_coord_lower:[65535&x,65535&S]}}const ll=(p,e,s,u)=>{const c=e.style.light,f=c.properties.get("position"),x=[f.x,f.y,f.z],S=(function(){var E=new y.A(9);return y.A!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E})();c.properties.get("anchor")==="viewport"&&(function(E,D){var I=Math.sin(D),P=Math.cos(D);E[0]=P,E[1]=I,E[2]=0,E[3]=-I,E[4]=P,E[5]=0,E[6]=0,E[7]=0,E[8]=1})(S,-e.transform.angle),(function(E,D,I){var P=D[0],j=D[1],q=D[2];E[0]=P*I[0]+j*I[3]+q*I[6],E[1]=P*I[1]+j*I[4]+q*I[7],E[2]=P*I[2]+j*I[5]+q*I[8]})(x,x,S);const T=c.properties.get("color");return{u_matrix:p,u_lightpos:x,u_lightintensity:c.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+s,u_opacity:u}},ul=(p,e,s,u,c,f,x)=>y.e(ll(p,e,s,u),jr(f,e,x),{u_height_factor:-Math.pow(2,c.overscaledZ)/x.tileSize/8}),Ls=p=>({u_matrix:p}),ql=(p,e,s,u)=>y.e(Ls(p),jr(s,e,u)),Hh=(p,e)=>({u_matrix:p,u_world:e}),Xc=(p,e,s,u,c)=>y.e(ql(p,e,s,u),{u_world:c}),Zl=(p,e,s,u)=>{const c=p.transform;let f,x;if(u.paint.get("circle-pitch-alignment")==="map"){const S=Xt(s,1,c.zoom);f=!0,x=[S,S]}else f=!1,x=c.pixelsToGLUnits;return{u_camera_to_center_distance:c.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:p.translatePosMatrix(e.posMatrix,s,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:x}},cn=(p,e,s)=>({u_matrix:p,u_inv_matrix:e,u_camera_to_center_distance:s.cameraToCenterDistance,u_viewport_size:[s.width,s.height]}),Bs=(p,e,s=1)=>({u_matrix:p,u_color:e,u_overlay:0,u_overlay_scale:s}),Qa=p=>({u_matrix:p}),ka=(p,e,s,u)=>({u_matrix:p,u_extrude_scale:Xt(e,1,s),u_intensity:u}),Ur=(p,e,s,u)=>{const c=y.H();y.aP(c,0,p.width,p.height,0,0,1);const f=p.context.gl;return{u_matrix:c,u_world:[f.drawingBufferWidth,f.drawingBufferHeight],u_image:s,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}};function cl(p,e){const s=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new y.Z(0,u/s).toLngLat().lat,new y.Z(0,(u+1)/s).toLngLat().lat]}const vo=(p,e,s,u)=>{const c=p.transform;return{u_matrix:xo(p,e,s,u),u_ratio:1/Xt(e,1,c.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},Yu=(p,e,s,u,c)=>y.e(vo(p,e,s,c),{u_image:0,u_image_height:u}),Er=(p,e,s,u,c)=>{const f=p.transform,x=Gl(e,f);return{u_matrix:xo(p,e,s,c),u_texsize:e.imageAtlasTexture.size,u_ratio:1/Xt(e,1,f.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[x,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Vr=(p,e,s,u,c,f)=>{const x=p.lineAtlas,S=Gl(e,p.transform),T=s.layout.get("line-cap")==="round",E=x.getDash(u.from,T),D=x.getDash(u.to,T),I=E.width*c.fromScale,P=D.width*c.toScale;return y.e(vo(p,e,s,f),{u_patternscale_a:[S/I,-E.height/2],u_patternscale_b:[S/P,-D.height/2],u_sdfgamma:x.width/(256*Math.min(I,P)*p.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:D.y,u_mix:c.t})};function Gl(p,e){return 1/Xt(p,1,e.tileZoom)}function xo(p,e,s,u){return p.translatePosMatrix(u?u.posMatrix:e.tileID.posMatrix,e,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const ds=(p,e,s,u,c)=>{return{u_matrix:p,u_tl_parent:e,u_scale_parent:s,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(x=c.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(f=c.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:Ku(c.paint.get("raster-hue-rotate"))};var f,x};function Ku(p){p*=Math.PI/180;const e=Math.sin(p),s=Math.cos(p);return[(2*s+1)/3,(-Math.sqrt(3)*e-s+1)/3,(Math.sqrt(3)*e-s+1)/3]}const hl=(p,e,s,u,c,f,x,S,T,E,D,I,P,j)=>{const q=x.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:q.width/q.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:T,u_coord_matrix:E,u_is_text:+I,u_pitch_with_map:+u,u_is_along_line:c,u_is_variable_anchor:f,u_texsize:P,u_texture:0,u_translation:D,u_pitched_scale:j}},bo=(p,e,s,u,c,f,x,S,T,E,D,I,P,j,q)=>{const X=x.transform;return y.e(hl(p,e,s,u,c,f,x,S,T,E,D,I,P,q),{u_gamma_scale:u?Math.cos(X._pitch)*X.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},wo=(p,e,s,u,c,f,x,S,T,E,D,I,P,j)=>y.e(bo(p,e,s,u,c,f,x,S,T,E,D,!0,I,!0,j),{u_texsize_icon:P,u_texture_icon:1}),Ps=(p,e,s)=>({u_matrix:p,u_opacity:e,u_color:s}),Hl=(p,e,s,u,c,f)=>y.e((function(x,S,T,E){const D=T.imageManager.getPattern(x.from.toString()),I=T.imageManager.getPattern(x.to.toString()),{width:P,height:j}=T.imageManager.getPixelSize(),q=Math.pow(2,E.tileID.overscaledZ),X=E.tileSize*Math.pow(2,T.transform.tileZoom)/q,K=X*(E.tileID.canonical.x+E.tileID.wrap*q),J=X*E.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:D.tl,u_pattern_br_a:D.br,u_pattern_tl_b:I.tl,u_pattern_br_b:I.br,u_texsize:[P,j],u_mix:S.t,u_pattern_size_a:D.displaySize,u_pattern_size_b:I.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/Xt(E,1,T.transform.tileZoom),u_pixel_coord_upper:[K>>16,J>>16],u_pixel_coord_lower:[65535&K,65535&J]}})(u,f,s,c),{u_matrix:p,u_opacity:e}),Wa={fillExtrusion:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_lightpos:new y.aN(p,e.u_lightpos),u_lightintensity:new y.aI(p,e.u_lightintensity),u_lightcolor:new y.aN(p,e.u_lightcolor),u_vertical_gradient:new y.aI(p,e.u_vertical_gradient),u_opacity:new y.aI(p,e.u_opacity)}),fillExtrusionPattern:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_lightpos:new y.aN(p,e.u_lightpos),u_lightintensity:new y.aI(p,e.u_lightintensity),u_lightcolor:new y.aN(p,e.u_lightcolor),u_vertical_gradient:new y.aI(p,e.u_vertical_gradient),u_height_factor:new y.aI(p,e.u_height_factor),u_image:new y.aH(p,e.u_image),u_texsize:new y.aO(p,e.u_texsize),u_pixel_coord_upper:new y.aO(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new y.aO(p,e.u_pixel_coord_lower),u_scale:new y.aN(p,e.u_scale),u_fade:new y.aI(p,e.u_fade),u_opacity:new y.aI(p,e.u_opacity)}),fill:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix)}),fillPattern:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_image:new y.aH(p,e.u_image),u_texsize:new y.aO(p,e.u_texsize),u_pixel_coord_upper:new y.aO(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new y.aO(p,e.u_pixel_coord_lower),u_scale:new y.aN(p,e.u_scale),u_fade:new y.aI(p,e.u_fade)}),fillOutline:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_world:new y.aO(p,e.u_world)}),fillOutlinePattern:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_world:new y.aO(p,e.u_world),u_image:new y.aH(p,e.u_image),u_texsize:new y.aO(p,e.u_texsize),u_pixel_coord_upper:new y.aO(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new y.aO(p,e.u_pixel_coord_lower),u_scale:new y.aN(p,e.u_scale),u_fade:new y.aI(p,e.u_fade)}),circle:(p,e)=>({u_camera_to_center_distance:new y.aI(p,e.u_camera_to_center_distance),u_scale_with_map:new y.aH(p,e.u_scale_with_map),u_pitch_with_map:new y.aH(p,e.u_pitch_with_map),u_extrude_scale:new y.aO(p,e.u_extrude_scale),u_device_pixel_ratio:new y.aI(p,e.u_device_pixel_ratio),u_matrix:new y.aJ(p,e.u_matrix)}),collisionBox:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_pixel_extrude_scale:new y.aO(p,e.u_pixel_extrude_scale)}),collisionCircle:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_inv_matrix:new y.aJ(p,e.u_inv_matrix),u_camera_to_center_distance:new y.aI(p,e.u_camera_to_center_distance),u_viewport_size:new y.aO(p,e.u_viewport_size)}),debug:(p,e)=>({u_color:new y.aL(p,e.u_color),u_matrix:new y.aJ(p,e.u_matrix),u_overlay:new y.aH(p,e.u_overlay),u_overlay_scale:new y.aI(p,e.u_overlay_scale)}),clippingMask:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix)}),heatmap:(p,e)=>({u_extrude_scale:new y.aI(p,e.u_extrude_scale),u_intensity:new y.aI(p,e.u_intensity),u_matrix:new y.aJ(p,e.u_matrix)}),heatmapTexture:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_world:new y.aO(p,e.u_world),u_image:new y.aH(p,e.u_image),u_color_ramp:new y.aH(p,e.u_color_ramp),u_opacity:new y.aI(p,e.u_opacity)}),hillshade:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_image:new y.aH(p,e.u_image),u_latrange:new y.aO(p,e.u_latrange),u_light:new y.aO(p,e.u_light),u_shadow:new y.aL(p,e.u_shadow),u_highlight:new y.aL(p,e.u_highlight),u_accent:new y.aL(p,e.u_accent)}),hillshadePrepare:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_image:new y.aH(p,e.u_image),u_dimension:new y.aO(p,e.u_dimension),u_zoom:new y.aI(p,e.u_zoom),u_unpack:new y.aK(p,e.u_unpack)}),line:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_ratio:new y.aI(p,e.u_ratio),u_device_pixel_ratio:new y.aI(p,e.u_device_pixel_ratio),u_units_to_pixels:new y.aO(p,e.u_units_to_pixels)}),lineGradient:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_ratio:new y.aI(p,e.u_ratio),u_device_pixel_ratio:new y.aI(p,e.u_device_pixel_ratio),u_units_to_pixels:new y.aO(p,e.u_units_to_pixels),u_image:new y.aH(p,e.u_image),u_image_height:new y.aI(p,e.u_image_height)}),linePattern:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_texsize:new y.aO(p,e.u_texsize),u_ratio:new y.aI(p,e.u_ratio),u_device_pixel_ratio:new y.aI(p,e.u_device_pixel_ratio),u_image:new y.aH(p,e.u_image),u_units_to_pixels:new y.aO(p,e.u_units_to_pixels),u_scale:new y.aN(p,e.u_scale),u_fade:new y.aI(p,e.u_fade)}),lineSDF:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_ratio:new y.aI(p,e.u_ratio),u_device_pixel_ratio:new y.aI(p,e.u_device_pixel_ratio),u_units_to_pixels:new y.aO(p,e.u_units_to_pixels),u_patternscale_a:new y.aO(p,e.u_patternscale_a),u_patternscale_b:new y.aO(p,e.u_patternscale_b),u_sdfgamma:new y.aI(p,e.u_sdfgamma),u_image:new y.aH(p,e.u_image),u_tex_y_a:new y.aI(p,e.u_tex_y_a),u_tex_y_b:new y.aI(p,e.u_tex_y_b),u_mix:new y.aI(p,e.u_mix)}),raster:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_tl_parent:new y.aO(p,e.u_tl_parent),u_scale_parent:new y.aI(p,e.u_scale_parent),u_buffer_scale:new y.aI(p,e.u_buffer_scale),u_fade_t:new y.aI(p,e.u_fade_t),u_opacity:new y.aI(p,e.u_opacity),u_image0:new y.aH(p,e.u_image0),u_image1:new y.aH(p,e.u_image1),u_brightness_low:new y.aI(p,e.u_brightness_low),u_brightness_high:new y.aI(p,e.u_brightness_high),u_saturation_factor:new y.aI(p,e.u_saturation_factor),u_contrast_factor:new y.aI(p,e.u_contrast_factor),u_spin_weights:new y.aN(p,e.u_spin_weights)}),symbolIcon:(p,e)=>({u_is_size_zoom_constant:new y.aH(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new y.aH(p,e.u_is_size_feature_constant),u_size_t:new y.aI(p,e.u_size_t),u_size:new y.aI(p,e.u_size),u_camera_to_center_distance:new y.aI(p,e.u_camera_to_center_distance),u_pitch:new y.aI(p,e.u_pitch),u_rotate_symbol:new y.aH(p,e.u_rotate_symbol),u_aspect_ratio:new y.aI(p,e.u_aspect_ratio),u_fade_change:new y.aI(p,e.u_fade_change),u_matrix:new y.aJ(p,e.u_matrix),u_label_plane_matrix:new y.aJ(p,e.u_label_plane_matrix),u_coord_matrix:new y.aJ(p,e.u_coord_matrix),u_is_text:new y.aH(p,e.u_is_text),u_pitch_with_map:new y.aH(p,e.u_pitch_with_map),u_is_along_line:new y.aH(p,e.u_is_along_line),u_is_variable_anchor:new y.aH(p,e.u_is_variable_anchor),u_texsize:new y.aO(p,e.u_texsize),u_texture:new y.aH(p,e.u_texture),u_translation:new y.aO(p,e.u_translation),u_pitched_scale:new y.aI(p,e.u_pitched_scale)}),symbolSDF:(p,e)=>({u_is_size_zoom_constant:new y.aH(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new y.aH(p,e.u_is_size_feature_constant),u_size_t:new y.aI(p,e.u_size_t),u_size:new y.aI(p,e.u_size),u_camera_to_center_distance:new y.aI(p,e.u_camera_to_center_distance),u_pitch:new y.aI(p,e.u_pitch),u_rotate_symbol:new y.aH(p,e.u_rotate_symbol),u_aspect_ratio:new y.aI(p,e.u_aspect_ratio),u_fade_change:new y.aI(p,e.u_fade_change),u_matrix:new y.aJ(p,e.u_matrix),u_label_plane_matrix:new y.aJ(p,e.u_label_plane_matrix),u_coord_matrix:new y.aJ(p,e.u_coord_matrix),u_is_text:new y.aH(p,e.u_is_text),u_pitch_with_map:new y.aH(p,e.u_pitch_with_map),u_is_along_line:new y.aH(p,e.u_is_along_line),u_is_variable_anchor:new y.aH(p,e.u_is_variable_anchor),u_texsize:new y.aO(p,e.u_texsize),u_texture:new y.aH(p,e.u_texture),u_gamma_scale:new y.aI(p,e.u_gamma_scale),u_device_pixel_ratio:new y.aI(p,e.u_device_pixel_ratio),u_is_halo:new y.aH(p,e.u_is_halo),u_translation:new y.aO(p,e.u_translation),u_pitched_scale:new y.aI(p,e.u_pitched_scale)}),symbolTextAndIcon:(p,e)=>({u_is_size_zoom_constant:new y.aH(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new y.aH(p,e.u_is_size_feature_constant),u_size_t:new y.aI(p,e.u_size_t),u_size:new y.aI(p,e.u_size),u_camera_to_center_distance:new y.aI(p,e.u_camera_to_center_distance),u_pitch:new y.aI(p,e.u_pitch),u_rotate_symbol:new y.aH(p,e.u_rotate_symbol),u_aspect_ratio:new y.aI(p,e.u_aspect_ratio),u_fade_change:new y.aI(p,e.u_fade_change),u_matrix:new y.aJ(p,e.u_matrix),u_label_plane_matrix:new y.aJ(p,e.u_label_plane_matrix),u_coord_matrix:new y.aJ(p,e.u_coord_matrix),u_is_text:new y.aH(p,e.u_is_text),u_pitch_with_map:new y.aH(p,e.u_pitch_with_map),u_is_along_line:new y.aH(p,e.u_is_along_line),u_is_variable_anchor:new y.aH(p,e.u_is_variable_anchor),u_texsize:new y.aO(p,e.u_texsize),u_texsize_icon:new y.aO(p,e.u_texsize_icon),u_texture:new y.aH(p,e.u_texture),u_texture_icon:new y.aH(p,e.u_texture_icon),u_gamma_scale:new y.aI(p,e.u_gamma_scale),u_device_pixel_ratio:new y.aI(p,e.u_device_pixel_ratio),u_is_halo:new y.aH(p,e.u_is_halo),u_translation:new y.aO(p,e.u_translation),u_pitched_scale:new y.aI(p,e.u_pitched_scale)}),background:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_opacity:new y.aI(p,e.u_opacity),u_color:new y.aL(p,e.u_color)}),backgroundPattern:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_opacity:new y.aI(p,e.u_opacity),u_image:new y.aH(p,e.u_image),u_pattern_tl_a:new y.aO(p,e.u_pattern_tl_a),u_pattern_br_a:new y.aO(p,e.u_pattern_br_a),u_pattern_tl_b:new y.aO(p,e.u_pattern_tl_b),u_pattern_br_b:new y.aO(p,e.u_pattern_br_b),u_texsize:new y.aO(p,e.u_texsize),u_mix:new y.aI(p,e.u_mix),u_pattern_size_a:new y.aO(p,e.u_pattern_size_a),u_pattern_size_b:new y.aO(p,e.u_pattern_size_b),u_scale_a:new y.aI(p,e.u_scale_a),u_scale_b:new y.aI(p,e.u_scale_b),u_pixel_coord_upper:new y.aO(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new y.aO(p,e.u_pixel_coord_lower),u_tile_units_to_pixels:new y.aI(p,e.u_tile_units_to_pixels)}),terrain:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_texture:new y.aH(p,e.u_texture),u_ele_delta:new y.aI(p,e.u_ele_delta),u_fog_matrix:new y.aJ(p,e.u_fog_matrix),u_fog_color:new y.aL(p,e.u_fog_color),u_fog_ground_blend:new y.aI(p,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new y.aI(p,e.u_fog_ground_blend_opacity),u_horizon_color:new y.aL(p,e.u_horizon_color),u_horizon_fog_blend:new y.aI(p,e.u_horizon_fog_blend)}),terrainDepth:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_ele_delta:new y.aI(p,e.u_ele_delta)}),terrainCoords:(p,e)=>({u_matrix:new y.aJ(p,e.u_matrix),u_texture:new y.aH(p,e.u_texture),u_terrain_coords_id:new y.aI(p,e.u_terrain_coords_id),u_ele_delta:new y.aI(p,e.u_ele_delta)}),sky:(p,e)=>({u_sky_color:new y.aL(p,e.u_sky_color),u_horizon_color:new y.aL(p,e.u_horizon_color),u_horizon:new y.aI(p,e.u_horizon),u_sky_horizon_blend:new y.aI(p,e.u_sky_horizon_blend)})};class en{constructor(e,s,u){this.context=e;const c=e.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Os{constructor(e,s,u,c){this.length=s.length,this.attributes=u,this.itemSize=s.bytesPerElement,this.dynamicDraw=c,this.context=e;const f=e.gl;this.buffer=f.createBuffer(),e.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,s){for(let u=0;u<this.attributes.length;u++){const c=s.attributes[this.attributes[u].name];c!==void 0&&e.enableVertexAttribArray(c)}}setVertexAttribPointers(e,s,u){for(let c=0;c<this.attributes.length;c++){const f=this.attributes[c],x=s.attributes[f.name];x!==void 0&&e.vertexAttribPointer(x,f.components,e[Xl[f.type]],!1,this.itemSize,f.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ns=new WeakMap;function Mr(p){var e;if(Ns.has(p))return Ns.get(p);{const s=(e=p.getParameter(p.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Ns.set(p,s),s}}class _i{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class fs extends _i{getDefault(){return y.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class $l extends _i{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Fs extends _i{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Xh extends _i{getDefault(){return[!0,!0,!0,!0]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class $c extends _i{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class $h extends _i{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Yl extends _i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const s=this.current;(e.func!==s.func||e.ref!==s.ref||e.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Ju extends _i{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Yc extends _i{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=e,this.dirty=!1}}class Kc extends _i{getDefault(){return[0,1]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Jc extends _i{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=e,this.dirty=!1}}class Qc extends _i{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class ps extends _i{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.BLEND):s.disable(s.BLEND),this.current=e,this.dirty=!1}}class Wc extends _i{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Yh extends _i{getDefault(){return y.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class eh extends _i{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class dl extends _i{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=e,this.dirty=!1}}class Qu extends _i{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Kl extends _i{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Kh extends _i{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Jh extends _i{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Wu extends _i{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class th extends _i{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ih extends _i{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ec extends _i{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ah extends _i{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Jl extends _i{getDefault(){return null}set(e){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class qr extends _i{getDefault(){return null}set(e){var s;if(e===this.current&&!this.dirty)return;const u=this.gl;Mr(u)?u.bindVertexArray(e):(s=u.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class tc extends _i{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class ic extends _i{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ac extends _i{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class So extends _i{constructor(e,s){super(e),this.context=e,this.parent=s}getDefault(){return null}}class js extends So{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Us extends So{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ql extends So{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class nh{constructor(e,s,u,c,f){this.context=e,this.width=s,this.height=u;const x=e.gl,S=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new js(e,S),c)this.depthAttachment=f?new Ql(e,S):new Us(e,S);else if(f)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,s=this.colorAttachment.get();if(s&&e.deleteTexture(s),this.depthAttachment){const u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class oa{constructor(e,s,u){this.blendFunction=e,this.blendColor=s,this.mask=u}}oa.Replace=[1,0],oa.disabled=new oa(oa.Replace,y.aM.transparent,[!1,!1,!1,!1]),oa.unblended=new oa(oa.Replace,y.aM.transparent,[!0,!0,!0,!0]),oa.alphaBlended=new oa([1,771],y.aM.transparent,[!0,!0,!0,!0]);class rh{constructor(e){var s,u;if(this.gl=e,this.clearColor=new fs(this),this.clearDepth=new $l(this),this.clearStencil=new Fs(this),this.colorMask=new Xh(this),this.depthMask=new $c(this),this.stencilMask=new $h(this),this.stencilFunc=new Yl(this),this.stencilOp=new Ju(this),this.stencilTest=new Yc(this),this.depthRange=new Kc(this),this.depthTest=new Jc(this),this.depthFunc=new Qc(this),this.blend=new ps(this),this.blendFunc=new Wc(this),this.blendColor=new Yh(this),this.blendEquation=new eh(this),this.cullFace=new dl(this),this.cullFaceSide=new Qu(this),this.frontFace=new Kl(this),this.program=new Kh(this),this.activeTexture=new Jh(this),this.viewport=new Wu(this),this.bindFramebuffer=new th(this),this.bindRenderbuffer=new ih(this),this.bindTexture=new ec(this),this.bindVertexBuffer=new ah(this),this.bindElementBuffer=new Jl(this),this.bindVertexArray=new qr(this),this.pixelStoreUnpack=new tc(this),this.pixelStoreUnpackPremultiplyAlpha=new ic(this),this.pixelStoreUnpackFlipY=new ac(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Mr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const c=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=e.RGBA16F)!==null&&s!==void 0?s:c==null?void 0:c.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:c==null?void 0:c.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const c=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=c==null?void 0:c.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,s){return new en(this,e,s)}createVertexBuffer(e,s,u){return new Os(this,e,s,u)}createRenderbuffer(e,s,u){const c=this.gl,f=c.createRenderbuffer();return this.bindRenderbuffer.set(f),c.renderbufferStorage(c.RENDERBUFFER,e,s,u),this.bindRenderbuffer.set(null),f}createFramebuffer(e,s,u,c){return new nh(this,e,s,u,c)}clear({color:e,depth:s,stencil:u}){const c=this.gl;let f=0;e&&(f|=c.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(f|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),u!==void 0&&(f|=c.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),c.clear(f)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){y.aE(e.blendFunction,oa.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Mr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var s;return Mr(this.gl)?this.gl.deleteVertexArray(e):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class Jt{constructor(e,s,u){this.func=e,this.mask=s,this.range=u}}Jt.ReadOnly=!1,Jt.ReadWrite=!0,Jt.disabled=new Jt(519,Jt.ReadOnly,[0,1]);const Zr=7680;class Zi{constructor(e,s,u,c,f,x){this.test=e,this.ref=s,this.mask=u,this.fail=c,this.depthFail=f,this.pass=x}}Zi.disabled=new Zi({func:519,mask:0},0,0,Zr,Zr,Zr);class Li{constructor(e,s,u){this.enable=e,this.mode=s,this.frontFace=u}}let Vs;function To(p,e,s,u,c){const f=p.context,x=f.gl,S=p.useProgram("collisionBox"),T=[];let E=0,D=0;for(let J=0;J<u.length;J++){const ee=u[J],Z=e.getTile(ee).getBucket(s);if(!Z)continue;const ne=c?Z.textCollisionBox:Z.iconCollisionBox,oe=Z.collisionCircleArray;if(oe.length>0){const fe=y.H();y.aQ(fe,Z.placementInvProjMatrix,p.transform.glCoordMatrix),y.aQ(fe,fe,Z.placementViewportMatrix),T.push({circleArray:oe,circleOffset:D,transform:ee.posMatrix,invTransform:fe,coord:ee}),E+=oe.length/4,D=E}ne&&S.draw(f,x.LINES,Jt.disabled,Zi.disabled,p.colorModeForRenderPass(),Li.disabled,{u_matrix:ee.posMatrix,u_pixel_extrude_scale:[1/(I=p.transform).width,1/I.height]},p.style.map.terrain&&p.style.map.terrain.getTerrainData(ee),s.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,null,p.transform.zoom,null,null,ne.collisionVertexBuffer)}var I;if(!c||!T.length)return;const P=p.useProgram("collisionCircle"),j=new y.aR;j.resize(4*E),j._trim();let q=0;for(const J of T)for(let ee=0;ee<J.circleArray.length/4;ee++){const Z=4*ee,ne=J.circleArray[Z+0],oe=J.circleArray[Z+1],fe=J.circleArray[Z+2],De=J.circleArray[Z+3];j.emplace(q++,ne,oe,fe,De,0),j.emplace(q++,ne,oe,fe,De,1),j.emplace(q++,ne,oe,fe,De,2),j.emplace(q++,ne,oe,fe,De,3)}(!Vs||Vs.length<2*E)&&(Vs=(function(J){const ee=2*J,Z=new y.aT;Z.resize(ee),Z._trim();for(let ne=0;ne<ee;ne++){const oe=6*ne;Z.uint16[oe+0]=4*ne+0,Z.uint16[oe+1]=4*ne+1,Z.uint16[oe+2]=4*ne+2,Z.uint16[oe+3]=4*ne+2,Z.uint16[oe+4]=4*ne+3,Z.uint16[oe+5]=4*ne+0}return Z})(E));const X=f.createIndexBuffer(Vs,!0),K=f.createVertexBuffer(j,y.aS.members,!0);for(const J of T){const ee=cn(J.transform,J.invTransform,p.transform);P.draw(f,x.TRIANGLES,Jt.disabled,Zi.disabled,p.colorModeForRenderPass(),Li.disabled,ee,p.style.map.terrain&&p.style.map.terrain.getTerrainData(J.coord),s.id,K,X,y.a0.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,p.transform.zoom,null,null,null)}K.destroy(),X.destroy()}Li.disabled=new Li(!1,1029,2305),Li.backCCW=new Li(!0,1029,2305);const Ao=y.an(new Float32Array(16));function qs(p,e,s,u,c,f){const{horizontalAlign:x,verticalAlign:S}=y.au(p);return new y.P((-(x-.5)*e/c+u[0])*f,(-(S-.5)*s/c+u[1])*f)}function cr(p,e,s,u,c,f){const x=e.tileAnchorPoint.add(new y.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let S=u.mult(f);s||(S=S.rotate(-c));const T=x.add(S);return $(T.x,T.y,e.labelPlaneMatrix,e.getElevation).point}if(s){const S=Ae(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(p),T=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return p.add(u.rotate(T))}return p.add(u)}function zo(p,e,s,u,c,f,x,S,T,E,D,I,P,j){const q=p.text.placedSymbolArray,X=p.text.dynamicLayoutVertexArray,K=p.icon.dynamicLayoutVertexArray,J={};X.clear();for(let ee=0;ee<q.length;ee++){const Z=q.get(ee),ne=Z.hidden||!Z.crossTileID||p.allowVerticalPlacement&&!Z.placedOrientation?null:u[Z.crossTileID];if(ne){const oe=new y.P(Z.anchorX,Z.anchorY),fe={getElevation:j,width:c.width,height:c.height,labelPlaneMatrix:f,pitchWithMap:s,projection:D,tileAnchorPoint:oe,translation:I,unwrappedTileID:P},De=s?$(oe.x,oe.y,x,j):Ae(oe.x,oe.y,fe),Oe=L(c.cameraToCenterDistance,De.signedDistanceFromCamera);let Ge=y.ai(p.textSizeData,T,Z)*Oe/y.ap;s&&(Ge*=p.tilePixelRatio/S);const{width:We,height:$e,anchor:Fe,textOffset:it,textBoxScale:It}=ne,Ye=qs(Fe,We,$e,it,It,Ge),Je=D.getPitchedTextCorrection(c,oe.add(new y.P(I[0],I[1])),P),zt=cr(De.point,fe,e,Ye,c.angle,Je),Ci=p.allowVerticalPlacement&&Z.placedOrientation===y.ah.vertical?Math.PI/2:0;for(let Gt=0;Gt<Z.numGlyphs;Gt++)y.aj(X,zt,Ci);E&&Z.associatedIconIndex>=0&&(J[Z.associatedIconIndex]={shiftedAnchor:zt,angle:Ci})}else bt(Z.numGlyphs,X)}if(E){K.clear();const ee=p.icon.placedSymbolArray;for(let Z=0;Z<ee.length;Z++){const ne=ee.get(Z);if(ne.hidden)bt(ne.numGlyphs,K);else{const oe=J[Z];if(oe)for(let fe=0;fe<ne.numGlyphs;fe++)y.aj(K,oe.shiftedAnchor,oe.angle);else bt(ne.numGlyphs,K)}}p.icon.dynamicLayoutVertexBuffer.updateData(K)}p.text.dynamicLayoutVertexBuffer.updateData(X)}function hn(p,e,s){return s.iconsInText&&e?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Wl(p,e,s,u,c,f,x,S,T,E,D,I){const P=p.context,j=P.gl,q=p.transform,X=ks(),K=S==="map",J=T==="map",ee=S!=="viewport"&&s.layout.get("symbol-placement")!=="point",Z=K&&!J&&!ee,ne=!J&&ee,oe=!s.layout.get("symbol-sort-key").isConstant();let fe=!1;const De=p.depthModeForSublayer(0,Jt.ReadOnly),Oe=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ge=[],We=X.getCircleRadiusCorrection(q);for(const $e of u){const Fe=e.getTile($e),it=Fe.getBucket(s);if(!it)continue;const It=c?it.text:it.icon;if(!It||!It.segments.get().length||!It.hasVisibleVertices)continue;const Ye=It.programConfigurations.get(s.id),Je=c||it.sdfIcons,zt=c?it.textSizeData:it.iconSizeData,Ci=J||q.pitch!==0,Gt=p.useProgram(hn(Je,c,it),Ye),ii=y.ag(zt,q.zoom),Ei=p.style.map.terrain&&p.style.map.terrain.getTerrainData($e);let La,Xn,Pi,rn,Gi=[0,0],Hi=null;if(c)Xn=Fe.glyphAtlasTexture,Pi=j.LINEAR,La=Fe.glyphAtlasTexture.size,it.iconsInText&&(Gi=Fe.imageAtlasTexture.size,Hi=Fe.imageAtlasTexture,rn=Ci||p.options.rotating||p.options.zooming||zt.kind==="composite"||zt.kind==="camera"?j.LINEAR:j.NEAREST);else{const Wt=s.layout.get("icon-size").constantOr(0)!==1||it.iconsNeedLinear;Xn=Fe.imageAtlasTexture,Pi=Je||p.options.rotating||p.options.zooming||Wt||Ci?j.LINEAR:j.NEAREST,La=Fe.imageAtlasTexture.size}const ga=Xt(Fe,1,p.transform.zoom),$n=ne?$e.posMatrix:Ao,eo=lr($n,J,K,p.transform,ga),pr=In($n,J,K,p.transform,ga),Na=In($e.posMatrix,J,K,p.transform,ga),bi=X.translatePosition(p.transform,Fe,f,x),to=Oe&&it.hasTextData(),mr=s.layout.get("icon-text-fit")!=="none"&&to&&it.hasIconData();if(ee){const Wt=p.style.map.terrain?(No,$i)=>p.style.map.terrain.getElevation($e,No,$i):null,Yn=s.layout.get("text-rotation-alignment")==="map";V(it,$e.posMatrix,p,c,eo,Na,J,E,Yn,X,$e.toUnwrapped(),q.width,q.height,bi,Wt)}const Rt=$e.posMatrix,ri=c&&Oe||mr,Xi=ee||ri?Ao:eo,An=pr,ya=Je&&s.paint.get(c?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let _a;_a=Je?it.iconsInText?wo(zt.kind,ii,Z,J,ee,ri,p,Rt,Xi,An,bi,La,Gi,We):bo(zt.kind,ii,Z,J,ee,ri,p,Rt,Xi,An,bi,c,La,!0,We):hl(zt.kind,ii,Z,J,ee,ri,p,Rt,Xi,An,bi,c,La,We);const sn={program:Gt,buffers:It,uniformValues:_a,atlasTexture:Xn,atlasTextureIcon:Hi,atlasInterpolation:Pi,atlasInterpolationIcon:rn,isSDF:Je,hasHalo:ya};if(oe&&it.canOverlap){fe=!0;const Wt=It.segments.get();for(const Yn of Wt)Ge.push({segments:new y.a0([Yn]),sortKey:Yn.sortKey,state:sn,terrainData:Ei})}else Ge.push({segments:It.segments,sortKey:0,state:sn,terrainData:Ei})}fe&&Ge.sort((($e,Fe)=>$e.sortKey-Fe.sortKey));for(const $e of Ge){const Fe=$e.state;if(P.activeTexture.set(j.TEXTURE0),Fe.atlasTexture.bind(Fe.atlasInterpolation,j.CLAMP_TO_EDGE),Fe.atlasTextureIcon&&(P.activeTexture.set(j.TEXTURE1),Fe.atlasTextureIcon&&Fe.atlasTextureIcon.bind(Fe.atlasInterpolationIcon,j.CLAMP_TO_EDGE)),Fe.isSDF){const it=Fe.uniformValues;Fe.hasHalo&&(it.u_is_halo=1,eu(Fe.buffers,$e.segments,s,p,Fe.program,De,D,I,it,$e.terrainData)),it.u_is_halo=0}eu(Fe.buffers,$e.segments,s,p,Fe.program,De,D,I,Fe.uniformValues,$e.terrainData)}}function eu(p,e,s,u,c,f,x,S,T,E){const D=u.context;c.draw(D,D.gl.TRIANGLES,f,x,S,Li.disabled,T,E,s.id,p.layoutVertexBuffer,p.indexBuffer,e,s.paint,u.transform.zoom,p.programConfigurations.get(s.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function fl(p,e,s,u){const c=p.context,f=c.gl,x=Zi.disabled,S=new oa([f.ONE,f.ONE],y.aM.transparent,[!0,!0,!0,!0]),T=e.getBucket(s);if(!T)return;const E=u.key;let D=s.heatmapFbos.get(E);D||(D=Eo(c,e.tileSize,e.tileSize),s.heatmapFbos.set(E,D)),c.bindFramebuffer.set(D.framebuffer),c.viewport.set([0,0,e.tileSize,e.tileSize]),c.clear({color:y.aM.transparent});const I=T.programConfigurations.get(s.id),P=p.useProgram("heatmap",I),j=p.style.map.terrain.getTerrainData(u);P.draw(c,f.TRIANGLES,Jt.disabled,x,S,Li.disabled,ka(u.posMatrix,e,p.transform.zoom,s.paint.get("heatmap-intensity")),j,s.id,T.layoutVertexBuffer,T.indexBuffer,T.segments,s.paint,p.transform.zoom,I)}function Gr(p,e,s){const u=p.context,c=u.gl;u.setColorMode(p.colorModeForRenderPass());const f=Mo(u,e),x=s.key,S=e.heatmapFbos.get(x);S&&(u.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,S.colorAttachment.get()),u.activeTexture.set(c.TEXTURE1),f.bind(c.LINEAR,c.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(u,c.TRIANGLES,Jt.disabled,Zi.disabled,p.colorModeForRenderPass(),Li.disabled,Ur(p,e,0,1),null,e.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments,e.paint,p.transform.zoom),S.destroy(),e.heatmapFbos.delete(x))}function Eo(p,e,s){var u,c;const f=p.gl,x=f.createTexture();f.bindTexture(f.TEXTURE_2D,x),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);const S=(u=p.HALF_FLOAT)!==null&&u!==void 0?u:f.UNSIGNED_BYTE,T=(c=p.RGBA16F)!==null&&c!==void 0?c:f.RGBA;f.texImage2D(f.TEXTURE_2D,0,T,e,s,0,f.RGBA,S,null);const E=p.createFramebuffer(e,s,!1,!1);return E.colorAttachment.set(x),E}function Mo(p,e){return e.colorRampTexture||(e.colorRampTexture=new Pt(p,e.colorRamp,p.gl.RGBA)),e.colorRampTexture}function Zs(p,e,s,u,c){if(!s||!u||!u.imageAtlas)return;const f=u.imageAtlas.patternPositions;let x=f[s.to.toString()],S=f[s.from.toString()];if(!x&&S&&(x=S),!S&&x&&(S=x),!x||!S){const T=c.getPaintProperty(e);x=f[T],S=f[T]}x&&S&&p.setConstantPatternPositions(x,S)}function pl(p,e,s,u,c,f,x){const S=p.context.gl,T="fill-pattern",E=s.paint.get(T),D=E&&E.constantOr(1),I=s.getCrossfadeParameters();let P,j,q,X,K;x?(j=D&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",P=S.LINES):(j=D?"fillPattern":"fill",P=S.TRIANGLES);const J=E.constantOr(null);for(const ee of u){const Z=e.getTile(ee);if(D&&!Z.patternsLoaded())continue;const ne=Z.getBucket(s);if(!ne)continue;const oe=ne.programConfigurations.get(s.id),fe=p.useProgram(j,oe),De=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ee);D&&(p.context.activeTexture.set(S.TEXTURE0),Z.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),oe.updatePaintBuffers(I)),Zs(oe,T,J,Z,s);const Oe=De?ee:null,Ge=p.translatePosMatrix(Oe?Oe.posMatrix:ee.posMatrix,Z,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(x){X=ne.indexBuffer2,K=ne.segments2;const We=[S.drawingBufferWidth,S.drawingBufferHeight];q=j==="fillOutlinePattern"&&D?Xc(Ge,p,I,Z,We):Hh(Ge,We)}else X=ne.indexBuffer,K=ne.segments,q=D?ql(Ge,p,I,Z):Ls(Ge);fe.draw(p.context,P,c,p.stencilModeForClipping(ee),f,Li.disabled,q,De,s.id,ne.layoutVertexBuffer,X,K,s.paint,p.transform.zoom,oe)}}function tu(p,e,s,u,c,f,x){const S=p.context,T=S.gl,E="fill-extrusion-pattern",D=s.paint.get(E),I=D.constantOr(1),P=s.getCrossfadeParameters(),j=s.paint.get("fill-extrusion-opacity"),q=D.constantOr(null);for(const X of u){const K=e.getTile(X),J=K.getBucket(s);if(!J)continue;const ee=p.style.map.terrain&&p.style.map.terrain.getTerrainData(X),Z=J.programConfigurations.get(s.id),ne=p.useProgram(I?"fillExtrusionPattern":"fillExtrusion",Z);I&&(p.context.activeTexture.set(T.TEXTURE0),K.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),Z.updatePaintBuffers(P)),Zs(Z,E,q,K,s);const oe=p.translatePosMatrix(X.posMatrix,K,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),fe=s.paint.get("fill-extrusion-vertical-gradient"),De=I?ul(oe,p,fe,j,X,P,K):ll(oe,p,fe,j);ne.draw(S,S.gl.TRIANGLES,c,f,x,Li.backCCW,De,ee,s.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,s.paint,p.transform.zoom,Z,p.style.map.terrain&&J.centroidVertexBuffer)}}function Co(p,e,s,u,c,f,x){const S=p.context,T=S.gl,E=s.fbo;if(!E)return;const D=p.useProgram("hillshade"),I=p.style.map.terrain&&p.style.map.terrain.getTerrainData(e);S.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,E.colorAttachment.get()),D.draw(S,T.TRIANGLES,c,f,x,Li.disabled,((P,j,q,X)=>{const K=q.paint.get("hillshade-shadow-color"),J=q.paint.get("hillshade-highlight-color"),ee=q.paint.get("hillshade-accent-color");let Z=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);q.paint.get("hillshade-illumination-anchor")==="viewport"&&(Z-=P.transform.angle);const ne=!P.options.moving;return{u_matrix:X?X.posMatrix:P.transform.calculatePosMatrix(j.tileID.toUnwrapped(),ne),u_image:0,u_latrange:cl(0,j.tileID),u_light:[q.paint.get("hillshade-exaggeration"),Z],u_shadow:K,u_highlight:J,u_accent:ee}})(p,s,u,I?e:null),I,u.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}function Do(p,e,s,u,c,f){const x=p.context,S=x.gl,T=e.dem;if(T&&T.data){const E=T.dim,D=T.stride,I=T.getPixels();if(x.activeTexture.set(S.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||p.getTileTexture(D),e.demTexture){const j=e.demTexture;j.update(I,{premultiply:!1}),j.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else e.demTexture=new Pt(x,I,S.RGBA,{premultiply:!1}),e.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);x.activeTexture.set(S.TEXTURE0);let P=e.fbo;if(!P){const j=new Pt(x,{width:E,height:E,data:null},S.RGBA);j.bind(S.LINEAR,S.CLAMP_TO_EDGE),P=e.fbo=x.createFramebuffer(E,E,!0,!1),P.colorAttachment.set(j.texture)}x.bindFramebuffer.set(P.framebuffer),x.viewport.set([0,0,E,E]),p.useProgram("hillshadePrepare").draw(x,S.TRIANGLES,u,c,f,Li.disabled,((j,q)=>{const X=q.stride,K=y.H();return y.aP(K,0,y.X,-y.X,0,0,1),y.J(K,K,[0,-y.X,0]),{u_matrix:K,u_image:1,u_dimension:[X,X],u_zoom:j.overscaledZ,u_unpack:q.getUnpackVector()}})(e.tileID,T),null,s.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function sh(p,e,s,u,c,f){const x=u.paint.get("raster-fade-duration");if(!f&&x>0){const S=me.now(),T=(S-p.timeAdded)/x,E=e?(S-e.timeAdded)/x:-1,D=s.getSource(),I=c.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),P=!e||Math.abs(e.tileID.overscaledZ-I)>Math.abs(p.tileID.overscaledZ-I),j=P&&p.refreshedUponExpiration?1:y.ac(P?T:1-E,0,1);return p.refreshedUponExpiration&&T>=1&&(p.refreshedUponExpiration=!1),e?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}const dn=new y.aM(1,0,0,1),ui=new y.aM(0,1,0,1),ml=new y.aM(0,0,1,1),oh=new y.aM(1,0,1,1),nc=new y.aM(0,1,1,1);function Gs(p,e,s,u){au(p,0,e+s/2,p.transform.width,s,u)}function iu(p,e,s,u){au(p,e-s/2,0,s,p.transform.height,u)}function au(p,e,s,u,c,f){const x=p.context,S=x.gl;S.enable(S.SCISSOR_TEST),S.scissor(e*p.pixelRatio,s*p.pixelRatio,u*p.pixelRatio,c*p.pixelRatio),x.clear({color:f}),S.disable(S.SCISSOR_TEST)}function Hs(p,e,s){const u=p.context,c=u.gl,f=s.posMatrix,x=p.useProgram("debug"),S=Jt.disabled,T=Zi.disabled,E=p.colorModeForRenderPass(),D="$debug",I=p.style.map.terrain&&p.style.map.terrain.getTerrainData(s);u.activeTexture.set(c.TEXTURE0);const P=e.getTileByID(s.key).latestRawTileData,j=Math.floor((P&&P.byteLength||0)/1024),q=e.getTile(s).tileSize,X=512/Math.min(q,512)*(s.overscaledZ/p.transform.zoom)*.5;let K=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(K+=` => ${s.overscaledZ}`),(function(J,ee){J.initDebugOverlayCanvas();const Z=J.debugOverlayCanvas,ne=J.context.gl,oe=J.debugOverlayCanvas.getContext("2d");oe.clearRect(0,0,Z.width,Z.height),oe.shadowColor="white",oe.shadowBlur=2,oe.lineWidth=1.5,oe.strokeStyle="white",oe.textBaseline="top",oe.font="bold 36px Open Sans, sans-serif",oe.fillText(ee,5,5),oe.strokeText(ee,5,5),J.debugOverlayTexture.update(Z),J.debugOverlayTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE)})(p,`${K} ${j}kB`),x.draw(u,c.TRIANGLES,S,T,oa.alphaBlended,Li.disabled,Bs(f,y.aM.transparent,X),null,D,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),x.draw(u,c.LINE_STRIP,S,T,E,Li.disabled,Bs(f,y.aM.red),I,D,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function nu(p,e,s){const u=p.context,c=u.gl,f=p.colorModeForRenderPass(),x=new Jt(c.LEQUAL,Jt.ReadWrite,p.depthRangeFor3D),S=p.useProgram("terrain"),T=e.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,p.width,p.height]);for(const E of s){const D=p.renderToTexture.getTexture(E),I=e.getTerrainData(E.tileID);u.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,D.texture);const P=p.transform.calculatePosMatrix(E.tileID.toUnwrapped()),j=e.getMeshFrameDelta(p.transform.zoom),q=p.transform.calculateFogMatrix(E.tileID.toUnwrapped()),X=hs(P,j,q,p.style.sky,p.transform.pitch);S.draw(u,c.TRIANGLES,x,Zi.disabled,f,Li.backCCW,X,I,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class ms{constructor(e,s,u){this.vertexBuffer=e,this.indexBuffer=s,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Io{constructor(e,s){this.context=new rh(e),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:y.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=xt.maxUnderzooming+xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new sl}resize(e,s,u){if(this.width=Math.floor(e*u),this.height=Math.floor(s*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const c of this.style._order)this.style._layers[c].resize()}setup(){const e=this.context,s=new y.aX;s.emplaceBack(0,0),s.emplaceBack(y.X,0),s.emplaceBack(0,y.X),s.emplaceBack(y.X,y.X),this.tileExtentBuffer=e.createVertexBuffer(s,Oa.members),this.tileExtentSegments=y.a0.simpleSegment(0,0,4,2);const u=new y.aX;u.emplaceBack(0,0),u.emplaceBack(y.X,0),u.emplaceBack(0,y.X),u.emplaceBack(y.X,y.X),this.debugBuffer=e.createVertexBuffer(u,Oa.members),this.debugSegments=y.a0.simpleSegment(0,0,4,5);const c=new y.$;c.emplaceBack(0,0,0,0),c.emplaceBack(y.X,0,y.X,0),c.emplaceBack(0,y.X,0,y.X),c.emplaceBack(y.X,y.X,y.X,y.X),this.rasterBoundsBuffer=e.createVertexBuffer(c,ls.members),this.rasterBoundsSegments=y.a0.simpleSegment(0,0,4,2);const f=new y.aX;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(f,Oa.members),this.viewportSegments=y.a0.simpleSegment(0,0,4,2);const x=new y.aZ;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(x);const S=new y.aY;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(S);const T=this.context.gl;this.stencilClearMode=new Zi({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const e=this.context,s=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=y.H();y.aP(u,0,this.width,this.height,0,0,1),y.K(u,u,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,s.TRIANGLES,Jt.disabled,this.stencilClearMode,oa.disabled,Li.disabled,Qa(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,s){if(this.currentStencilSource===e.source||!e.isTileClipped()||!s||!s.length)return;this.currentStencilSource=e.source;const u=this.context,c=u.gl;this.nextStencilID+s.length>256&&this.clearStencil(),u.setColorMode(oa.disabled),u.setDepthMode(Jt.disabled);const f=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of s){const S=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);f.draw(u,c.TRIANGLES,Jt.disabled,new Zi({func:c.ALWAYS,mask:0},S,255,c.KEEP,c.KEEP,c.REPLACE),oa.disabled,Li.disabled,Qa(x.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,s=this.context.gl;return new Zi({func:s.NOTEQUAL,mask:255},e,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(e){const s=this.context.gl;return new Zi({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(e){const s=this.context.gl,u=e.sort(((x,S)=>S.overscaledZ-x.overscaledZ)),c=u[u.length-1].overscaledZ,f=u[0].overscaledZ-c+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();const x={};for(let S=0;S<f;S++)x[S+c]=new Zi({func:s.GEQUAL,mask:255},S+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=f,[x,u]}return[{[c]:Zi.disabled},u]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new oa([e.CONSTANT_COLOR,e.ONE],new y.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?oa.unblended:oa.alphaBlended}depthModeForSublayer(e,s,u){if(!this.opaquePassEnabledForLayer())return Jt.disabled;const c=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Jt(u||this.context.gl.LEQUAL,s,[c,c])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,s){this.style=e,this.options=s,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(me.now()),this.imageManager.beginFrame();const u=this.style._order,c=this.style.sourceCaches,f={},x={},S={};for(const T in c){const E=c[T];E.used&&E.prepare(this.context),f[T]=E.getVisibleCoordinates(),x[T]=f[T].slice().reverse(),S[T]=E.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<u.length;T++)if(this.style._layers[u[T]].is3D()){this.opaquePassCutoff=T;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const T of u){const E=this.style._layers[T];if(!E.hasOffscreenPass()||E.isHidden(this.transform.zoom))continue;const D=x[E.source];(E.type==="custom"||D.length)&&this.renderLayer(this,c[E.source],E,D)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?y.aM.black:y.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(T,E){const D=T.context,I=D.gl,P=((J,ee,Z)=>({u_sky_color:J.properties.get("sky-color"),u_horizon_color:J.properties.get("horizon-color"),u_horizon:(ee.height/2+ee.getHorizon())*Z,u_sky_horizon_blend:J.properties.get("sky-horizon-blend")*ee.height/2*Z}))(E,T.style.map.transform,T.pixelRatio),j=new Jt(I.LEQUAL,Jt.ReadWrite,[0,1]),q=Zi.disabled,X=T.colorModeForRenderPass(),K=T.useProgram("sky");if(!E.mesh){const J=new y.aX;J.emplaceBack(-1,-1),J.emplaceBack(1,-1),J.emplaceBack(1,1),J.emplaceBack(-1,1);const ee=new y.aY;ee.emplaceBack(0,1,2),ee.emplaceBack(0,2,3),E.mesh=new ms(D.createVertexBuffer(J,Oa.members),D.createIndexBuffer(ee),y.a0.simpleSegment(0,0,J.length,ee.length))}K.draw(D,I.TRIANGLES,j,q,X,Li.disabled,P,void 0,"sky",E.mesh.vertexBuffer,E.mesh.indexBuffer,E.mesh.segments)})(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[u[this.currentLayer]],E=c[T.source],D=f[T.source];this._renderTileClippingMasks(T,D),this.renderLayer(this,E,T,D)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const T=this.style._layers[u[this.currentLayer]],E=c[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const D=(T.type==="symbol"?S:x)[T.source];this._renderTileClippingMasks(T,f[T.source]),this.renderLayer(this,E,T,D)}if(this.options.showTileBoundaries){const T=(function(E,D){let I=null;const P=Object.values(E._layers).flatMap((K=>K.source&&!K.isHidden(D)?[E.sourceCaches[K.source]]:[])),j=P.filter((K=>K.getSource().type==="vector")),q=P.filter((K=>K.getSource().type!=="vector")),X=K=>{(!I||I.getSource().maxzoom<K.getSource().maxzoom)&&(I=K)};return j.forEach((K=>X(K))),I||q.forEach((K=>X(K))),I})(this.style,this.transform.zoom);T&&(function(E,D,I){for(let P=0;P<I.length;P++)Hs(E,D,I[P])})(this,T,T.getVisibleCoordinates())}this.options.showPadding&&(function(T){const E=T.transform.padding;Gs(T,T.transform.height-(E.top||0),3,dn),Gs(T,E.bottom||0,3,ui),iu(T,E.left||0,3,ml),iu(T,T.transform.width-(E.right||0),3,oh);const D=T.transform.centerPoint;(function(I,P,j,q){au(I,P-1,j-10,2,20,q),au(I,P-10,j-1,20,2,q)})(T,D.x,T.transform.height-D.y,nc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let c=this.terrainFacilitator.dirty;c||(c=e?!y.a_(s,u):!y.a$(s,u)),c||(c=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),c&&(y.b0(s,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(f,x){const S=f.context,T=S.gl,E=oa.unblended,D=new Jt(T.LEQUAL,Jt.ReadWrite,[0,1]),I=x.getTerrainMesh(),P=x.sourceCache.getRenderableTiles(),j=f.useProgram("terrainDepth");S.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),S.clear({color:y.aM.transparent,depth:1});for(const q of P){const X=x.getTerrainData(q.tileID),K={u_matrix:f.transform.calculatePosMatrix(q.tileID.toUnwrapped()),u_ele_delta:x.getMeshFrameDelta(f.transform.zoom)};j.draw(S,T.TRIANGLES,D,Zi.disabled,E,Li.backCCW,K,X,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,f.width,f.height])})(this,this.style.map.terrain),(function(f,x){const S=f.context,T=S.gl,E=oa.unblended,D=new Jt(T.LEQUAL,Jt.ReadWrite,[0,1]),I=x.getTerrainMesh(),P=x.getCoordsTexture(),j=x.sourceCache.getRenderableTiles(),q=f.useProgram("terrainCoords");S.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),S.clear({color:y.aM.transparent,depth:1}),x.coordsIndex=[];for(const X of j){const K=x.getTerrainData(X.tileID);S.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,P.texture);const J={u_matrix:f.transform.calculatePosMatrix(X.tileID.toUnwrapped()),u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(f.transform.zoom)};q.draw(S,T.TRIANGLES,D,Zi.disabled,E,Li.backCCW,J,K,"terrain",I.vertexBuffer,I.indexBuffer,I.segments),x.coordsIndex.push(X.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,f.width,f.height])})(this,this.style.map.terrain))}renderLayer(e,s,u,c){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(c||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(f,x,S,T,E){if(f.renderPass!=="translucent")return;const D=Zi.disabled,I=f.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(P,j,q,X,K,J,ee,Z,ne){const oe=j.transform,fe=ks(),De=K==="map",Oe=J==="map";for(const Ge of P){const We=X.getTile(Ge),$e=We.getBucket(q);if(!$e||!$e.text||!$e.text.segments.get().length)continue;const Fe=y.ag($e.textSizeData,oe.zoom),it=Xt(We,1,j.transform.zoom),It=lr(Ge.posMatrix,Oe,De,j.transform,it),Ye=q.layout.get("icon-text-fit")!=="none"&&$e.hasIconData();if(Fe){const Je=Math.pow(2,oe.zoom-We.tileID.overscaledZ),zt=j.style.map.terrain?(Gt,ii)=>j.style.map.terrain.getElevation(Ge,Gt,ii):null,Ci=fe.translatePosition(oe,We,ee,Z);zo($e,De,Oe,ne,oe,It,Ge.posMatrix,Je,Fe,Ye,fe,Ci,Ge.toUnwrapped(),zt)}}})(T,f,S,x,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),E),S.paint.get("icon-opacity").constantOr(1)!==0&&Wl(f,x,S,T,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),D,I),S.paint.get("text-opacity").constantOr(1)!==0&&Wl(f,x,S,T,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),D,I),x.map.showCollisionBoxes&&(To(f,x,S,T,!0),To(f,x,S,T,!1))})(e,s,u,c,this.style.placement.variableOffsets);break;case"circle":(function(f,x,S,T){if(f.renderPass!=="translucent")return;const E=S.paint.get("circle-opacity"),D=S.paint.get("circle-stroke-width"),I=S.paint.get("circle-stroke-opacity"),P=!S.layout.get("circle-sort-key").isConstant();if(E.constantOr(1)===0&&(D.constantOr(1)===0||I.constantOr(1)===0))return;const j=f.context,q=j.gl,X=f.depthModeForSublayer(0,Jt.ReadOnly),K=Zi.disabled,J=f.colorModeForRenderPass(),ee=[];for(let Z=0;Z<T.length;Z++){const ne=T[Z],oe=x.getTile(ne),fe=oe.getBucket(S);if(!fe)continue;const De=fe.programConfigurations.get(S.id),Oe=f.useProgram("circle",De),Ge=fe.layoutVertexBuffer,We=fe.indexBuffer,$e=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ne),Fe={programConfiguration:De,program:Oe,layoutVertexBuffer:Ge,indexBuffer:We,uniformValues:Zl(f,ne,oe,S),terrainData:$e};if(P){const it=fe.segments.get();for(const It of it)ee.push({segments:new y.a0([It]),sortKey:It.sortKey,state:Fe})}else ee.push({segments:fe.segments,sortKey:0,state:Fe})}P&&ee.sort(((Z,ne)=>Z.sortKey-ne.sortKey));for(const Z of ee){const{programConfiguration:ne,program:oe,layoutVertexBuffer:fe,indexBuffer:De,uniformValues:Oe,terrainData:Ge}=Z.state;oe.draw(j,q.TRIANGLES,X,K,J,Li.disabled,Oe,Ge,S.id,fe,De,Z.segments,S.paint,f.transform.zoom,ne)}})(e,s,u,c);break;case"heatmap":(function(f,x,S,T){if(S.paint.get("heatmap-opacity")===0)return;const E=f.context;if(f.style.map.terrain){for(const D of T){const I=x.getTile(D);x.hasRenderableParent(D)||(f.renderPass==="offscreen"?fl(f,I,S,D):f.renderPass==="translucent"&&Gr(f,S,D))}E.viewport.set([0,0,f.width,f.height])}else f.renderPass==="offscreen"?(function(D,I,P,j){const q=D.context,X=q.gl,K=Zi.disabled,J=new oa([X.ONE,X.ONE],y.aM.transparent,[!0,!0,!0,!0]);(function(ee,Z,ne){const oe=ee.gl;ee.activeTexture.set(oe.TEXTURE1),ee.viewport.set([0,0,Z.width/4,Z.height/4]);let fe=ne.heatmapFbos.get(y.aU);fe?(oe.bindTexture(oe.TEXTURE_2D,fe.colorAttachment.get()),ee.bindFramebuffer.set(fe.framebuffer)):(fe=Eo(ee,Z.width/4,Z.height/4),ne.heatmapFbos.set(y.aU,fe))})(q,D,P),q.clear({color:y.aM.transparent});for(let ee=0;ee<j.length;ee++){const Z=j[ee];if(I.hasRenderableParent(Z))continue;const ne=I.getTile(Z),oe=ne.getBucket(P);if(!oe)continue;const fe=oe.programConfigurations.get(P.id),De=D.useProgram("heatmap",fe),{zoom:Oe}=D.transform;De.draw(q,X.TRIANGLES,Jt.disabled,K,J,Li.disabled,ka(Z.posMatrix,ne,Oe,P.paint.get("heatmap-intensity")),null,P.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,P.paint,D.transform.zoom,fe)}q.viewport.set([0,0,D.width,D.height])})(f,x,S,T):f.renderPass==="translucent"&&(function(D,I){const P=D.context,j=P.gl;P.setColorMode(D.colorModeForRenderPass());const q=I.heatmapFbos.get(y.aU);q&&(P.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,q.colorAttachment.get()),P.activeTexture.set(j.TEXTURE1),Mo(P,I).bind(j.LINEAR,j.CLAMP_TO_EDGE),D.useProgram("heatmapTexture").draw(P,j.TRIANGLES,Jt.disabled,Zi.disabled,D.colorModeForRenderPass(),Li.disabled,Ur(D,I,0,1),null,I.id,D.viewportBuffer,D.quadTriangleIndexBuffer,D.viewportSegments,I.paint,D.transform.zoom))})(f,S)})(e,s,u,c);break;case"line":(function(f,x,S,T){if(f.renderPass!=="translucent")return;const E=S.paint.get("line-opacity"),D=S.paint.get("line-width");if(E.constantOr(1)===0||D.constantOr(1)===0)return;const I=f.depthModeForSublayer(0,Jt.ReadOnly),P=f.colorModeForRenderPass(),j=S.paint.get("line-dasharray"),q=S.paint.get("line-pattern"),X=q.constantOr(1),K=S.paint.get("line-gradient"),J=S.getCrossfadeParameters(),ee=X?"linePattern":j?"lineSDF":K?"lineGradient":"line",Z=f.context,ne=Z.gl;let oe=!0;for(const fe of T){const De=x.getTile(fe);if(X&&!De.patternsLoaded())continue;const Oe=De.getBucket(S);if(!Oe)continue;const Ge=Oe.programConfigurations.get(S.id),We=f.context.program.get(),$e=f.useProgram(ee,Ge),Fe=oe||$e.program!==We,it=f.style.map.terrain&&f.style.map.terrain.getTerrainData(fe),It=q.constantOr(null);if(It&&De.imageAtlas){const zt=De.imageAtlas,Ci=zt.patternPositions[It.to.toString()],Gt=zt.patternPositions[It.from.toString()];Ci&&Gt&&Ge.setConstantPatternPositions(Ci,Gt)}const Ye=it?fe:null,Je=X?Er(f,De,S,J,Ye):j?Vr(f,De,S,j,J,Ye):K?Yu(f,De,S,Oe.lineClipsArray.length,Ye):vo(f,De,S,Ye);if(X)Z.activeTexture.set(ne.TEXTURE0),De.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),Ge.updatePaintBuffers(J);else if(j&&(Fe||f.lineAtlas.dirty))Z.activeTexture.set(ne.TEXTURE0),f.lineAtlas.bind(Z);else if(K){const zt=Oe.gradients[S.id];let Ci=zt.texture;if(S.gradientVersion!==zt.version){let Gt=256;if(S.stepInterpolant){const ii=x.getSource().maxzoom,Ei=fe.canonical.z===ii?Math.ceil(1<<f.transform.maxZoom-fe.canonical.z):1;Gt=y.ac(y.aV(Oe.maxLineLength/y.X*1024*Ei),256,Z.maxTextureSize)}zt.gradient=y.aW({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Gt,image:zt.gradient||void 0,clips:Oe.lineClipsArray}),zt.texture?zt.texture.update(zt.gradient):zt.texture=new Pt(Z,zt.gradient,ne.RGBA),zt.version=S.gradientVersion,Ci=zt.texture}Z.activeTexture.set(ne.TEXTURE0),Ci.bind(S.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}$e.draw(Z,ne.TRIANGLES,I,f.stencilModeForClipping(fe),P,Li.disabled,Je,it,S.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,S.paint,f.transform.zoom,Ge,Oe.layoutVertexBuffer2),oe=!1}})(e,s,u,c);break;case"fill":(function(f,x,S,T){const E=S.paint.get("fill-color"),D=S.paint.get("fill-opacity");if(D.constantOr(1)===0)return;const I=f.colorModeForRenderPass(),P=S.paint.get("fill-pattern"),j=f.opaquePassEnabledForLayer()&&!P.constantOr(1)&&E.constantOr(y.aM.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===j){const q=f.depthModeForSublayer(1,f.renderPass==="opaque"?Jt.ReadWrite:Jt.ReadOnly);pl(f,x,S,T,q,I,!1)}if(f.renderPass==="translucent"&&S.paint.get("fill-antialias")){const q=f.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Jt.ReadOnly);pl(f,x,S,T,q,I,!0)}})(e,s,u,c);break;case"fill-extrusion":(function(f,x,S,T){const E=S.paint.get("fill-extrusion-opacity");if(E!==0&&f.renderPass==="translucent"){const D=new Jt(f.context.gl.LEQUAL,Jt.ReadWrite,f.depthRangeFor3D);if(E!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))tu(f,x,S,T,D,Zi.disabled,oa.disabled),tu(f,x,S,T,D,f.stencilModeFor3D(),f.colorModeForRenderPass());else{const I=f.colorModeForRenderPass();tu(f,x,S,T,D,Zi.disabled,I)}}})(e,s,u,c);break;case"hillshade":(function(f,x,S,T){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const E=f.context,D=f.depthModeForSublayer(0,Jt.ReadOnly),I=f.colorModeForRenderPass(),[P,j]=f.renderPass==="translucent"?f.stencilConfigForOverlap(T):[{},T];for(const q of j){const X=x.getTile(q);X.needsHillshadePrepare!==void 0&&X.needsHillshadePrepare&&f.renderPass==="offscreen"?Do(f,X,S,D,Zi.disabled,I):f.renderPass==="translucent"&&Co(f,q,X,S,D,P[q.overscaledZ],I)}E.viewport.set([0,0,f.width,f.height])})(e,s,u,c);break;case"raster":(function(f,x,S,T){if(f.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!T.length)return;const E=f.context,D=E.gl,I=x.getSource(),P=f.useProgram("raster"),j=f.colorModeForRenderPass(),[q,X]=I instanceof Fr?[{},T]:f.stencilConfigForOverlap(T),K=X[X.length-1].overscaledZ,J=!f.options.moving;for(const ee of X){const Z=f.depthModeForSublayer(ee.overscaledZ-K,S.paint.get("raster-opacity")===1?Jt.ReadWrite:Jt.ReadOnly,D.LESS),ne=x.getTile(ee);ne.registerFadeDuration(S.paint.get("raster-fade-duration"));const oe=x.findLoadedParent(ee,0),fe=x.findLoadedSibling(ee),De=sh(ne,oe||fe||null,x,S,f.transform,f.style.map.terrain);let Oe,Ge;const We=S.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;E.activeTexture.set(D.TEXTURE0),ne.texture.bind(We,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(D.TEXTURE1),oe?(oe.texture.bind(We,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Oe=Math.pow(2,oe.tileID.overscaledZ-ne.tileID.overscaledZ),Ge=[ne.tileID.canonical.x*Oe%1,ne.tileID.canonical.y*Oe%1]):ne.texture.bind(We,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),ne.texture.useMipmap&&E.extTextureFilterAnisotropic&&f.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax);const $e=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ee),Fe=$e?ee:null,it=Fe?Fe.posMatrix:f.transform.calculatePosMatrix(ee.toUnwrapped(),J),It=ds(it,Ge||[0,0],Oe||1,De,S);I instanceof Fr?P.draw(E,D.TRIANGLES,Z,Zi.disabled,j,Li.disabled,It,$e,S.id,I.boundsBuffer,f.quadTriangleIndexBuffer,I.boundsSegments):P.draw(E,D.TRIANGLES,Z,q[ee.overscaledZ],j,Li.disabled,It,$e,S.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}})(e,s,u,c);break;case"background":(function(f,x,S,T){const E=S.paint.get("background-color"),D=S.paint.get("background-opacity");if(D===0)return;const I=f.context,P=I.gl,j=f.transform,q=j.tileSize,X=S.paint.get("background-pattern");if(f.isPatternMissing(X))return;const K=!X&&E.a===1&&D===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==K)return;const J=Zi.disabled,ee=f.depthModeForSublayer(0,K==="opaque"?Jt.ReadWrite:Jt.ReadOnly),Z=f.colorModeForRenderPass(),ne=f.useProgram(X?"backgroundPattern":"background"),oe=T||j.coveringTiles({tileSize:q,terrain:f.style.map.terrain});X&&(I.activeTexture.set(P.TEXTURE0),f.imageManager.bind(f.context));const fe=S.getCrossfadeParameters();for(const De of oe){const Oe=T?De.posMatrix:f.transform.calculatePosMatrix(De.toUnwrapped()),Ge=X?Hl(Oe,D,f,X,{tileID:De,tileSize:q},fe):Ps(Oe,D,E),We=f.style.map.terrain&&f.style.map.terrain.getTerrainData(De);ne.draw(I,P.TRIANGLES,ee,J,Z,Li.disabled,Ge,We,S.id,f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}})(e,0,u,c);break;case"custom":(function(f,x,S){const T=f.context,E=S.implementation;if(f.renderPass==="offscreen"){const D=E.prerender;D&&(f.setCustomLayerDefaults(),T.setColorMode(f.colorModeForRenderPass()),D.call(E,T.gl,f.transform.customLayerMatrix()),T.setDirty(),f.setBaseState())}else if(f.renderPass==="translucent"){f.setCustomLayerDefaults(),T.setColorMode(f.colorModeForRenderPass()),T.setStencilMode(Zi.disabled);const D=E.renderingMode==="3d"?new Jt(f.context.gl.LEQUAL,Jt.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,Jt.ReadOnly);T.setDepthMode(D),E.render(T.gl,f.transform.customLayerMatrix(),{farZ:f.transform.farZ,nearZ:f.transform.nearZ,fov:f.transform._fov,modelViewProjectionMatrix:f.transform.modelViewProjectionMatrix,projectionMatrix:f.transform.projectionMatrix}),T.setDirty(),f.setBaseState(),T.bindFramebuffer.set(null)}})(e,0,u)}}translatePosMatrix(e,s,u,c,f){if(!u[0]&&!u[1])return e;const x=f?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(x){const E=Math.sin(x),D=Math.cos(x);u=[u[0]*D-u[1]*E,u[0]*E+u[1]*D]}const S=[f?u[0]:Xt(s,u[0],this.transform.zoom),f?u[1]:Xt(s,u[1],this.transform.zoom),0],T=new Float32Array(16);return y.J(T,e,S),T}saveTileTexture(e){const s=this._tileTextures[e.size[0]];s?s.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const s=this._tileTextures[e];return s&&s.length>0?s.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const s=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!s||!u}useProgram(e,s){this.cache=this.cache||{};const u=e+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new Vl(this.context,zr[e],s,Wa[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Pt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:s}=this.context.gl;return this.width!==e||this.height!==s}}class Xs{constructor(e,s){this.points=e,this.planes=s}static fromInvProjectionMatrix(e,s,u){const c=Math.pow(2,u),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((S=>{const T=1/(S=y.af([],S,e))[3]/s*c;return y.b1(S,S,[T,T,1/S[3],T])})),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((S=>{const T=(function(P,j){var q=j[0],X=j[1],K=j[2],J=q*q+X*X+K*K;return J>0&&(J=1/Math.sqrt(J)),P[0]=j[0]*J,P[1]=j[1]*J,P[2]=j[2]*J,P})([],(function(P,j,q){var X=j[0],K=j[1],J=j[2],ee=q[0],Z=q[1],ne=q[2];return P[0]=K*ne-J*Z,P[1]=J*ee-X*ne,P[2]=X*Z-K*ee,P})([],ot([],f[S[0]],f[S[1]]),ot([],f[S[2]],f[S[1]]))),E=-((D=T)[0]*(I=f[S[1]])[0]+D[1]*I[1]+D[2]*I[2]);var D,I;return T.concat(E)}));return new Xs(f,x)}}class qn{constructor(e,s){this.min=e,this.max=s,this.center=(function(u,c,f){return u[0]=.5*c[0],u[1]=.5*c[1],u[2]=.5*c[2],u})([],(function(u,c,f){return u[0]=c[0]+f[0],u[1]=c[1]+f[1],u[2]=c[2]+f[2],u})([],this.min,this.max))}quadrant(e){const s=[e%2==0,e<2],u=Ht(this.min),c=Ht(this.max);for(let f=0;f<s.length;f++)u[f]=s[f]?this.min[f]:this.center[f],c[f]=s[f]?this.center[f]:this.max[f];return c[2]=this.max[2],new qn(u,c)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let c=0;c<e.planes.length;c++){const f=e.planes[c];let x=0;for(let S=0;S<s.length;S++)y.b2(f,s[S])>=0&&x++;if(x===0)return 0;x!==s.length&&(u=!1)}if(u)return 2;for(let c=0;c<3;c++){let f=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let S=0;S<e.points.length;S++){const T=e.points[S][c]-this.min[c];f=Math.min(f,T),x=Math.max(x,T)}if(x<0||f>this.max[c]-this.min[c])return 0}return 1}}class hr{constructor(e=0,s=0,u=0,c=0){if(isNaN(e)||e<0||isNaN(s)||s<0||isNaN(u)||u<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=s,this.left=u,this.right=c}interpolate(e,s,u){return s.top!=null&&e.top!=null&&(this.top=y.y.number(e.top,s.top,u)),s.bottom!=null&&e.bottom!=null&&(this.bottom=y.y.number(e.bottom,s.bottom,u)),s.left!=null&&e.left!=null&&(this.left=y.y.number(e.left,s.left,u)),s.right!=null&&e.right!=null&&(this.right=y.y.number(e.right,s.right,u)),this}getCenter(e,s){const u=y.ac((this.left+e-this.right)/2,0,e),c=y.ac((this.top+s-this.bottom)/2,0,s);return new y.P(u,c)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new hr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const gl=85.051129;class $s{constructor(e,s,u,c,f){this.tileSize=512,this._renderWorldCopies=f===void 0||!!f,this._minZoom=e||0,this._maxZoom=s||22,this._minPitch=u??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new y.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new hr,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new $s(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new y.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const s=-y.b3(e,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(function(){var u=new y.A(4);return y.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u})(),(function(u,c,f){var x=c[0],S=c[1],T=c[2],E=c[3],D=Math.sin(f),I=Math.cos(f);u[0]=x*I+T*D,u[1]=S*I+E*D,u[2]=x*-D+T*I,u[3]=S*-D+E*I})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const s=y.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const s=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,s,u){this._unmodified=!1,this._edgeInsets.interpolate(e,s,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const s=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(e){const s=[new y.b4(0,e)];if(this._renderWorldCopies){const u=this.pointCoordinate(new y.P(0,0)),c=this.pointCoordinate(new y.P(this.width,0)),f=this.pointCoordinate(new y.P(this.width,this.height)),x=this.pointCoordinate(new y.P(0,this.height)),S=Math.floor(Math.min(u.x,c.x,f.x,x.x)),T=Math.floor(Math.max(u.x,c.x,f.x,x.x)),E=1;for(let D=S-E;D<=T+E;D++)D!==0&&s.push(new y.b4(D,e))}return s}coveringTiles(e){var s,u;let c=this.coveringZoomLevel(e);const f=c;if(e.minzoom!==void 0&&c<e.minzoom)return[];e.maxzoom!==void 0&&c>e.maxzoom&&(c=e.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),S=y.Z.fromLngLat(this.center),T=Math.pow(2,c),E=[T*x.x,T*x.y,0],D=[T*S.x,T*S.y,0],I=Xs.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,c);let P=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(P=c);const j=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,q=Z=>({aabb:new qn([Z*T,0,0],[(Z+1)*T,T,0]),zoom:0,x:0,y:0,wrap:Z,fullyVisible:!1}),X=[],K=[],J=c,ee=e.reparseOverscaled?f:c;if(this._renderWorldCopies)for(let Z=1;Z<=3;Z++)X.push(q(-Z)),X.push(q(Z));for(X.push(q(0));X.length>0;){const Z=X.pop(),ne=Z.x,oe=Z.y;let fe=Z.fullyVisible;if(!fe){const $e=Z.aabb.intersects(I);if($e===0)continue;fe=$e===2}const De=e.terrain?E:D,Oe=Z.aabb.distanceX(De),Ge=Z.aabb.distanceY(De),We=Math.max(Math.abs(Oe),Math.abs(Ge));if(Z.zoom===J||We>j+(1<<J-Z.zoom)-2&&Z.zoom>=P){const $e=J-Z.zoom,Fe=E[0]-.5-(ne<<$e),it=E[1]-.5-(oe<<$e);K.push({tileID:new y.S(Z.zoom===J?ee:Z.zoom,Z.wrap,Z.zoom,ne,oe),distanceSq:ni([D[0]-.5-ne,D[1]-.5-oe]),tileDistanceToCamera:Math.sqrt(Fe*Fe+it*it)})}else for(let $e=0;$e<4;$e++){const Fe=(ne<<1)+$e%2,it=(oe<<1)+($e>>1),It=Z.zoom+1;let Ye=Z.aabb.quadrant($e);if(e.terrain){const Je=new y.S(It,Z.wrap,It,Fe,it),zt=e.terrain.getMinMaxElevation(Je),Ci=(s=zt.minElevation)!==null&&s!==void 0?s:this.elevation,Gt=(u=zt.maxElevation)!==null&&u!==void 0?u:this.elevation;Ye=new qn([Ye.min[0],Ye.min[1],Ci],[Ye.max[0],Ye.max[1],Gt])}X.push({aabb:Ye,zoom:It,x:Fe,y:it,wrap:Z.wrap,fullyVisible:fe})}}return K.sort(((Z,ne)=>Z.distanceSq-ne.distanceSq)).map((Z=>Z.tileID))}resize(e,s){this.width=e,this.height=s,this.pixelsToGLUnits=[2/e,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const s=y.ac(e.lat,-85.051129,gl);return new y.P(y.O(e.lng)*this.worldSize,y.Q(s)*this.worldSize)}unproject(e){return new y.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const s=this.elevation,u=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,c=this.pointLocation(this.centerPoint,e),f=e.getElevationForLngLatZoom(c,this.tileZoom);if(!(this.elevation-f))return;const x=u+s-f,S=Math.cos(this._pitch)*this.cameraToCenterDistance/x/y.b5(1,c.lat),T=this.scaleZoom(S/this.tileSize);this._elevation=f,this._center=c,this.zoom=T}setLocationAtPoint(e,s){const u=this.pointCoordinate(s),c=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(e),x=new y.Z(f.x-(u.x-c.x),f.y-(u.y-c.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,s){return s?this.coordinatePoint(this.locationCoordinate(e),s.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,s){return this.coordinateLocation(this.pointCoordinate(e,s))}locationCoordinate(e){return y.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,s){if(s){const P=s.pointCoordinate(e);if(P!=null)return P}const u=[e.x,e.y,0,1],c=[e.x,e.y,1,1];y.af(u,u,this.pixelMatrixInverse),y.af(c,c,this.pixelMatrixInverse);const f=u[3],x=c[3],S=u[1]/f,T=c[1]/x,E=u[2]/f,D=c[2]/x,I=E===D?0:(0-E)/(D-E);return new y.Z(y.y.number(u[0]/f,c[0]/x,I)/this.worldSize,y.y.number(S,T,I)/this.worldSize)}coordinatePoint(e,s=0,u=this.pixelMatrix){const c=[e.x*this.worldSize,e.y*this.worldSize,s,1];return y.af(c,c,u),new y.P(c[0]/c[3],c[1]/c[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return new xe().extend(this.pointLocation(new y.P(0,e))).extend(this.pointLocation(new y.P(this.width,e))).extend(this.pointLocation(new y.P(this.width,this.height))).extend(this.pointLocation(new y.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new xe([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,gl])}calculateTileMatrix(e){const s=e.canonical,u=this.worldSize/this.zoomScale(s.z),c=s.x+Math.pow(2,s.z)*e.wrap,f=y.an(new Float64Array(16));return y.J(f,f,[c*u,s.y*u,0]),y.K(f,f,[u/y.X,u/y.X,1]),f}calculatePosMatrix(e,s=!1){const u=e.key,c=s?this._alignedPosMatrixCache:this._posMatrixCache;if(c[u])return c[u];const f=this.calculateTileMatrix(e);return y.L(f,s?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,f),c[u]=new Float32Array(f),c[u]}calculateFogMatrix(e){const s=e.key,u=this._fogMatrixCache;if(u[s])return u[s];const c=this.calculateTileMatrix(e);return y.L(c,this.fogMatrix,c),u[s]=new Float32Array(c),u[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,s){s=y.ac(+s,this.minZoom,this.maxZoom);const u={center:new y.N(e.lng,e.lat),zoom:s};let c=this.lngRange;if(!this._renderWorldCopies&&c===null){const Z=179.9999999999;c=[-Z,Z]}const f=this.tileSize*this.zoomScale(u.zoom);let x=0,S=f,T=0,E=f,D=0,I=0;const{x:P,y:j}=this.size;if(this.latRange){const Z=this.latRange;x=y.Q(Z[1])*f,S=y.Q(Z[0])*f,S-x<j&&(D=j/(S-x))}c&&(T=y.b3(y.O(c[0])*f,0,f),E=y.b3(y.O(c[1])*f,0,f),E<T&&(E+=f),E-T<P&&(I=P/(E-T)));const{x:q,y:X}=this.project.call({worldSize:f},e);let K,J;const ee=Math.max(I||0,D||0);if(ee){const Z=new y.P(I?(E+T)/2:q,D?(S+x)/2:X);return u.center=this.unproject.call({worldSize:f},Z).wrap(),u.zoom+=this.scaleZoom(ee),u}if(this.latRange){const Z=j/2;X-Z<x&&(J=x+Z),X+Z>S&&(J=S-Z)}if(c){const Z=(T+E)/2;let ne=q;this._renderWorldCopies&&(ne=y.b3(q,Z-f/2,Z+f/2));const oe=P/2;ne-oe<T&&(K=T+oe),ne+oe>E&&(K=E-oe)}if(K!==void 0||J!==void 0){const Z=new y.P(K??q,J??X);u.center=this.unproject.call({worldSize:f},Z).wrap()}return u}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:s,zoom:u}=this.getConstrained(this.center,this.zoom);this.center=s,this.zoom=u,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,s=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=y.b5(1,this.center.lat)*this.worldSize;let c=y.an(new Float64Array(16));y.K(c,c,[this.width/2,-this.height/2,1]),y.J(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=y.an(new Float64Array(16)),y.K(c,c,[1,-1,1]),y.J(c,c,[-1,-1,0]),y.K(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c;const f=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),x=Math.min(this.elevation,this.minElevationForCurrentTile),S=f-x*this._pixelPerMeter/Math.cos(this._pitch),T=x<0?S:f,E=Math.PI/2+this._pitch,D=this._fov*(.5+e.y/this.height),I=Math.sin(D)*T/Math.sin(y.ac(Math.PI-E-D,.01,Math.PI-.01)),P=this.getHorizon(),j=2*Math.atan(P/this.cameraToCenterDistance)*(.5+e.y/(2*P)),q=Math.sin(j)*T/Math.sin(y.ac(Math.PI-E-j,.01,Math.PI-.01)),X=Math.min(I,q);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*X+T),this.nearZ=this.height/50,c=new Float64Array(16),y.b6(c,this._fov,this.width/this.height,this.nearZ,this.farZ),c[8]=2*-e.x/this.width,c[9]=2*e.y/this.height,this.projectionMatrix=y.ae(c),y.K(c,c,[1,-1,1]),y.J(c,c,[0,0,-this.cameraToCenterDistance]),y.b7(c,c,this._pitch),y.ad(c,c,this.angle),y.J(c,c,[-s,-u,0]),this.mercatorMatrix=y.K([],c,[this.worldSize,this.worldSize,this.worldSize]),y.K(c,c,[1,1,this._pixelPerMeter]),this.pixelMatrix=y.L(new Float64Array(16),this.labelPlaneMatrix,c),y.J(c,c,[0,0,-this.elevation]),this.modelViewProjectionMatrix=c,this.invModelViewProjectionMatrix=y.as([],c),this.fogMatrix=new Float64Array(16),y.b6(this.fogMatrix,this._fov,this.width/this.height,f,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,y.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),y.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),y.b7(this.fogMatrix,this.fogMatrix,this._pitch),y.ad(this.fogMatrix,this.fogMatrix,this.angle),y.J(this.fogMatrix,this.fogMatrix,[-s,-u,0]),y.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),y.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=y.L(new Float64Array(16),this.labelPlaneMatrix,c);const K=this.width%2/2,J=this.height%2/2,ee=Math.cos(this.angle),Z=Math.sin(this.angle),ne=s-Math.round(s)+ee*K+Z*J,oe=u-Math.round(u)+ee*J+Z*K,fe=new Float64Array(c);if(y.J(fe,fe,[ne>.5?ne-1:ne,oe>.5?oe-1:oe,0]),this.alignedModelViewProjectionMatrix=fe,c=y.as(new Float64Array(16),this.pixelMatrix),!c)throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new y.P(0,0)),s=[e.x*this.worldSize,e.y*this.worldSize,0,1];return y.af(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new y.P(0,e))}getCameraQueryGeometry(e){const s=this.getCameraPoint();if(e.length===1)return[e[0],s];{let u=s.x,c=s.y,f=s.x,x=s.y;for(const S of e)u=Math.min(u,S.x),c=Math.min(c,S.y),f=Math.max(f,S.x),x=Math.max(x,S.y);return[new y.P(u,c),new y.P(f,c),new y.P(f,x),new y.P(u,x),new y.P(u,c)]}}lngLatToCameraDepth(e,s){const u=this.locationCoordinate(e),c=[u.x*this.worldSize,u.y*this.worldSize,s,1];return y.af(c,c,this.modelViewProjectionMatrix),c[2]/c[3]}}function dr(p,e){let s,u=!1,c=null,f=null;const x=()=>{c=null,u&&(p.apply(f,s),c=setTimeout(x,e),u=!1)};return(...S)=>(u=!0,f=this,s=S,c||x(),c)}class yl{constructor(e){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map((c=>c.split("="))).forEach((c=>{c[0]===this._hashName&&(u=c)})),(u&&u[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(s.length>=3&&!s.some((u=>isNaN(u)))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:u,pitch:+(s[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const u=s.join("/");let c=u;c.split("&").length>0&&(c=c.split("&")[0]),this._hashName&&(c=`${this._hashName}=${u}`);let f=window.location.hash.replace(c,"");f.startsWith("#&")?f=f.slice(0,1)+f.slice(2):f==="#"&&(f="");let x=window.location.href.replace(/(#.+)?$/,f);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=dr(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const s=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,c=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,c),x=Math.round(s.lng*f)/f,S=Math.round(s.lat*f)/f,T=this._map.getBearing(),E=this._map.getPitch();let D="";if(D+=e?`/${x}/${S}/${u}`:`${u}/${S}/${x}`,(T||E)&&(D+="/"+Math.round(10*T)/10),E&&(D+=`/${Math.round(E)}`),this._hashName){const I=this._hashName;let P=!1;const j=window.location.hash.slice(1).split("&").map((q=>{const X=q.split("=")[0];return X===I?(P=!0,`${X}=${D}`):q})).filter((q=>q));return P||j.push(`${I}=${D}`),`#${j.join("&")}`}return`#${D}`}}const _l={linearity:.3,easing:y.b8(0,0,.3,1)},ru=y.e({deceleration:2500,maxSpeed:1400},_l),Qh=y.e({deceleration:20,maxSpeed:1400},_l),lh=y.e({deceleration:1e3,maxSpeed:360},_l),su=y.e({deceleration:1e3,maxSpeed:90},_l);class ou{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:me.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,s=me.now();for(;e.length>0&&s-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new y.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:f}of this._inertiaBuffer)s.zoom+=f.zoomDelta||0,s.bearing+=f.bearingDelta||0,s.pitch+=f.pitchDelta||0,f.panDelta&&s.pan._add(f.panDelta),f.around&&(s.around=f.around),f.pinchAround&&(s.pinchAround=f.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(s.pan.mag()){const f=Ys(s.pan.mag(),u,y.e({},ru,e||{}));c.offset=s.pan.mult(f.amount/s.pan.mag()),c.center=this._map.transform.center,ko(c,f)}if(s.zoom){const f=Ys(s.zoom,u,Qh);c.zoom=this._map.transform.zoom+f.amount,ko(c,f)}if(s.bearing){const f=Ys(s.bearing,u,lh);c.bearing=this._map.transform.bearing+y.ac(f.amount,-179,179),ko(c,f)}if(s.pitch){const f=Ys(s.pitch,u,su);c.pitch=this._map.transform.pitch+f.amount,ko(c,f)}if(c.zoom||c.bearing){const f=s.pinchAround===void 0?s.around:s.pinchAround;c.around=f?this._map.unproject(f):this._map.getCenter()}return this.clear(),y.e(c,{noMoveStart:!0})}}function ko(p,e){(!p.duration||p.duration<e.duration)&&(p.duration=e.duration,p.easing=e.easing)}function Ys(p,e,s){const{maxSpeed:u,linearity:c,deceleration:f}=s,x=y.ac(p*c/(e/1e3),-u,u),S=Math.abs(x)/(f*c);return{easing:s.easing,duration:1e3*S,amount:x*(S/2)}}class Ji extends y.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,u,c={}){const f=pe.mousePos(s.getCanvas(),u),x=s.unproject(f);super(e,y.e({point:f,lngLat:x,originalEvent:u},c)),this._defaultPrevented=!1,this.target=s}}class Cr extends y.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,u){const c=e==="touchend"?u.changedTouches:u.touches,f=pe.touchPos(s.getCanvasContainer(),c),x=f.map((T=>s.unproject(T))),S=f.reduce(((T,E,D,I)=>T.add(E.div(I.length))),new y.P(0,0));super(e,{points:f,point:S,lngLats:x,lngLat:s.unproject(S),originalEvent:u}),this._defaultPrevented=!1}}class kn extends y.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class Ks{constructor(e,s){this._map=e,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new kn(e.type,this._map,e))}mousedown(e,s){return this._mousedownPos=s,this._firePreventable(new Ji(e.type,this._map,e))}mouseup(e){this._map.fire(new Ji(e.type,this._map,e))}click(e,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Ji(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ji(e.type,this._map,e))}mouseover(e){this._map.fire(new Ji(e.type,this._map,e))}mouseout(e){this._map.fire(new Ji(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Cr(e.type,this._map,e))}touchmove(e){this._map.fire(new Cr(e.type,this._map,e))}touchend(e){this._map.fire(new Cr(e.type,this._map,e))}touchcancel(e){this._map.fire(new Cr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ia{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ji(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ji("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ji(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bn{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(y.P.convert(e),this._map.terrain)}}class tn{constructor(e,s){this._map=e,this._tr=new bn(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,s){this.isEnabled()&&e.shiftKey&&e.button===0&&(pe.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(e,s){if(!this._active)return;const u=s;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const c=this._startPos;this._lastPos=u,this._box||(this._box=pe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const f=Math.min(c.x,u.x),x=Math.max(c.x,u.x),S=Math.min(c.y,u.y),T=Math.max(c.y,u.y);pe.setTransform(this._box,`translate(${f}px,${S}px)`),this._box.style.width=x-f+"px",this._box.style.height=T-S+"px"}mouseupWindow(e,s){if(!this._active||e.button!==0)return;const u=this._startPos,c=s;if(this.reset(),pe.suppressClick(),u.x!==c.x||u.y!==c.y)return this._map.fire(new y.k("boxzoomend",{originalEvent:e})),{cameraAnimation:f=>f.fitScreenCoordinates(u,c,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(pe.remove(this._box),this._box=null),pe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,s){return this._map.fire(new y.k(e,{originalEvent:s}))}}function Js(p,e){if(p.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${e.length}`);const s={};for(let u=0;u<p.length;u++)s[p[u].identifier]=e[u];return s}class Hr{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,s,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=(function(c){const f=new y.P(0,0);for(const x of c)f._add(x);return f.div(c.length)})(s),this.touches=Js(u,s)))}touchmove(e,s,u){if(this.aborted||!this.centroid)return;const c=Js(u,s);for(const f in this.touches){const x=c[f];(!x||x.dist(this.touches[f])>30)&&(this.aborted=!0)}}touchend(e,s,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class vl{constructor(e){this.singleTap=new Hr(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,s,u){this.singleTap.touchstart(e,s,u)}touchmove(e,s,u){this.singleTap.touchmove(e,s,u)}touchend(e,s,u){const c=this.singleTap.touchend(e,s,u);if(c){const f=e.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(c)<30;if(f&&x||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class Xr{constructor(e){this._tr=new bn(e),this._zoomIn=new vl({numTouches:1,numTaps:2}),this._zoomOut=new vl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,s,u){this._zoomIn.touchstart(e,s,u),this._zoomOut.touchstart(e,s,u)}touchmove(e,s,u){this._zoomIn.touchmove(e,s,u),this._zoomOut.touchmove(e,s,u)}touchend(e,s,u){const c=this._zoomIn.touchend(e,s,u),f=this._zoomOut.touchend(e,s,u),x=this._tr;return c?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(c)},{originalEvent:e})}):f?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(f)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const s=this._moveFunction(...e);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(e,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,s){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const c=s.length?s[0]:s;return!this._moved&&c.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=c,this._move(u,c))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&pe.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const rc={0:1,2:2};class an{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const s=pe.mouseButton(e);this._eventButton=s}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(s,u){const c=rc[u];return s.buttons===void 0||(s.buttons&c)!==c})(e,this._eventButton)}isValidEndEvent(e){return pe.mouseButton(e)===this._eventButton}}class xl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const Zn=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=e=>{e.preventDefault()}},lu=({enable:p,clickTolerance:e,bearingDegreesPerPixelMoved:s=.8})=>{const u=new an({checkCorrectEvent:c=>pe.mouseButton(c)===0&&c.ctrlKey||pe.mouseButton(c)===2});return new wn({clickTolerance:e,move:(c,f)=>({bearingDelta:(f.x-c.x)*s}),moveStateManager:u,enable:p,assignEvents:Zn})},Ro=({enable:p,clickTolerance:e,pitchDegreesPerPixelMoved:s=-.5})=>{const u=new an({checkCorrectEvent:c=>pe.mouseButton(c)===0&&c.ctrlKey||pe.mouseButton(c)===2});return new wn({clickTolerance:e,move:(c,f)=>({pitchDelta:(f.y-c.y)*s}),moveStateManager:u,enable:p,assignEvents:Zn})};class Rn{constructor(e,s){this._clickTolerance=e.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new y.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,s,u){return this._calculateTransform(e,s,u)}touchmove(e,s,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,s,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,s,u){this._calculateTransform(e,s,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,s,u){u.length>0&&(this._active=!0);const c=Js(u,s),f=new y.P(0,0),x=new y.P(0,0);let S=0;for(const E in c){const D=c[E],I=this._touches[E];I&&(f._add(D),x._add(D.sub(I)),S++,c[E]=D)}if(this._touches=c,this._shouldBePrevented(S)||!x.mag())return;const T=x.div(S);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:f.div(S),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,s,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([s[0],s[1]]))}touchmove(e,s,u){if(!this._firstTwoTouches)return;e.preventDefault();const[c,f]=this._firstTwoTouches,x=Bo(u,s,c),S=Bo(u,s,f);if(!x||!S)return;const T=this._aroundCenter?null:x.add(S).div(2);return this._move([x,S],T,e)}touchend(e,s,u){if(!this._firstTwoTouches)return;const[c,f]=this._firstTwoTouches,x=Bo(u,s,c),S=Bo(u,s,f);x&&S||(this._active&&pe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Bo(p,e,s){for(let u=0;u<p.length;u++)if(p[u].identifier===s)return e[u]}function bl(p,e){return Math.log(p/e)/Math.LN2}class uu extends Lo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,s){const u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(bl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bl(this._distance,u),pinchAround:s}}}function Sn(p,e){return 180*p.angleWith(e)/Math.PI}class gs extends Lo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,s,u){const c=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Sn(this._vector,c),pinchAround:s}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const s=25/(Math.PI*this._minDiameter)*360,u=Sn(e,this._startVector);return Math.abs(u)<s}}function $r(p){return Math.abs(p.y)>Math.abs(p.x)}class ys extends Lo{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,s,u){super.touchstart(e,s,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,$r(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,s,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const c=e[0].sub(this._lastPoints[0]),f=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(c,f,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(c.y+f.y)/2*-.5}):void 0}gestureBeginsVertically(e,s,u){if(this._valid!==void 0)return this._valid;const c=e.mag()>=2,f=s.mag()>=2;if(!c&&!f)return;if(!c||!f)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const x=e.y>0==s.y>0;return $r(e)&&$r(s)&&x}}const Po={panStep:100,bearingStep:15,pitchStep:10};class la{constructor(e){this._tr=new bn(e);const s=Po;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let s=0,u=0,c=0,f=0,x=0;switch(e.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),f=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),f=1);break;case 38:e.shiftKey?c=1:(e.preventDefault(),x=-1);break;case 40:e.shiftKey?c=-1:(e.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,c=0),{cameraAnimation:S=>{const T=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:xa,zoom:s?Math.round(T.zoom)+s*(e.shiftKey?2:1):T.zoom,bearing:T.bearing+u*this._bearingStep,pitch:T.pitch+c*this._pitchStep,offset:[-f*this._panStep,-x*this._panStep],center:T.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function xa(p){return p*(2-p)}const Dr=4.000244140625;class Ea{constructor(e,s){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new bn(e),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let s=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const u=me.now(),c=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,s!==0&&s%Dr==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(c*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),e.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=e,this._delta-=s,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=pe.mousePos(this._map.getCanvas(),e),u=this._tr;this._around=s.y>u.transform.height/2-u.transform.getHorizon()?y.N.convert(this._aroundCenter?u.center:u.unproject(s)):y.N.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>Dr?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&E!==0&&(E=1/E);const D=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(D*E))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,u=this._startZoom,c=this._easing;let f,x=!1;const S=me.now()-this._lastWheelEventTime;if(this._type==="wheel"&&u&&c&&S){const T=Math.min(S/200,1),E=c(T);f=y.y.number(u,s,E),T<1?this._frameId||(this._frameId=!0):x=!0}else f=s,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:f-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let s=y.b9;if(this._prevEase){const u=this._prevEase,c=(me.now()-u.start)/u.duration,f=u.easing(c+.01)-u.easing(c),x=.27/Math.sqrt(f*f+1e-4)*.01,S=Math.sqrt(.0729-x*x);s=y.b8(x,S,.25,1)}return this._prevEase={start:me.now(),duration:e,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class nn{constructor(e,s){this._clickZoom=e,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Yr{constructor(e){this._tr=new bn(e),this.reset()}reset(){this._active=!1}dblclick(e,s){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uh{constructor(){this._tap=new vl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,s,u){if(!this._swipePoint)if(this._tapTime){const c=s[0],f=e.timeStamp-this._tapTime<500,x=this._tapPoint.dist(c)<30;f&&x?u.length>0&&(this._swipePoint=c,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,s,u)}touchmove(e,s,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const c=s[0],f=c.y-this._swipePoint.y;return this._swipePoint=c,e.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(e,s,u)}touchend(e,s,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const c=this._tap.touchend(e,s,u);c&&(this._tapTime=e.timeStamp,this._tapPoint=c)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cu{constructor(e,s,u){this._el=e,this._mousePan=s,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class hu{constructor(e,s,u){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=s,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class du{constructor(e,s,u,c){this._el=e,this._touchZoom=s,this._touchRotate=u,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ma{constructor(e,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=pe.create("div","maplibregl-cooperative-gesture-screen",e);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),c=document.createElement("div");c.className="maplibregl-desktop-message",c.textContent=s,this._container.appendChild(c);const f=document.createElement("div");f.className="maplibregl-mobile-message",f.textContent=u,this._container.appendChild(f),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(pe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,s){this._enabled&&(this._map.fire(new y.k("cooperativegestureprevented",{gestureType:e,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const hi=p=>p.zoom||p.drag||p.pitch||p.rotate;class Be extends y.k{}function fr(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Tn{constructor(e,s){this.handleWindowEvent=c=>{this.handleEvent(c,`${c.type}Window`)},this.handleEvent=(c,f)=>{if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=c.type==="renderFrame"?void 0:c,S={needsRenderFrame:!1},T={},E={},D=c.touches,I=D?this._getMapTouches(D):void 0,P=I?pe.touchPos(this._map.getCanvas(),I):pe.mousePos(this._map.getCanvas(),c);for(const{handlerName:X,handler:K,allowed:J}of this._handlers){if(!K.isEnabled())continue;let ee;this._blockedByActive(E,J,X)?K.reset():K[f||c.type]&&(ee=K[f||c.type](c,P,I),this.mergeHandlerResult(S,T,ee,X,x),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||K.isActive())&&(E[X]=K)}const j={};for(const X in this._previousActiveHandlers)E[X]||(j[X]=x);this._previousActiveHandlers=E,(Object.keys(j).length||fr(S))&&(this._changes.push([S,T,j]),this._triggerRenderFrame()),(Object.keys(E).length||fr(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=S;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ou(e),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[c,f,x]of this._listeners)pe.addEventListener(c,f,c===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[e,s,u]of this._listeners)pe.removeEventListener(e,s,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){const s=this._map,u=s.getCanvasContainer();this._add("mapEvent",new Ks(s,e));const c=s.boxZoom=new tn(s,e);this._add("boxZoom",c),e.interactive&&e.boxZoom&&c.enable();const f=s.cooperativeGestures=new ma(s,e.cooperativeGestures);this._add("cooperativeGestures",f),e.cooperativeGestures&&f.enable();const x=new Xr(s),S=new Yr(s);s.doubleClickZoom=new nn(S,x),this._add("tapZoom",x),this._add("clickZoom",S),e.interactive&&e.doubleClickZoom&&s.doubleClickZoom.enable();const T=new uh;this._add("tapDragZoom",T);const E=s.touchPitch=new ys(s);this._add("touchPitch",E),e.interactive&&e.touchPitch&&s.touchPitch.enable(e.touchPitch);const D=lu(e),I=Ro(e);s.dragRotate=new hu(e,D,I),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",I,["mouseRotate"]),e.interactive&&e.dragRotate&&s.dragRotate.enable();const P=(({enable:ee,clickTolerance:Z})=>{const ne=new an({checkCorrectEvent:oe=>pe.mouseButton(oe)===0&&!oe.ctrlKey});return new wn({clickTolerance:Z,move:(oe,fe)=>({around:fe,panDelta:fe.sub(oe)}),activateOnStart:!0,moveStateManager:ne,enable:ee,assignEvents:Zn})})(e),j=new Rn(e,s);s.dragPan=new cu(u,P,j),this._add("mousePan",P),this._add("touchPan",j,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&s.dragPan.enable(e.dragPan);const q=new gs,X=new uu;s.touchZoomRotate=new du(u,X,q,T),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&s.touchZoomRotate.enable(e.touchZoomRotate);const K=s.scrollZoom=new Ea(s,(()=>this._triggerRenderFrame()));this._add("scrollZoom",K,["mousePan"]),e.interactive&&e.scrollZoom&&s.scrollZoom.enable(e.scrollZoom);const J=s.keyboard=new la(s);this._add("keyboard",J),e.interactive&&e.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new ia(s))}_add(e,s,u){this._handlers.push({handlerName:e,handler:s,allowed:u}),this._handlersById[e]=s}stop(e){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!hi(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,s,u){for(const c in e)if(c!==u&&(!s||s.indexOf(c)<0))return!0;return!1}_getMapTouches(e){const s=[];for(const u of e)this._el.contains(u.target)&&s.push(u);return s}mergeHandlerResult(e,s,u,c,f){if(!u)return;y.e(e,u);const x={handlerName:c,originalEvent:u.originalEvent||f};u.zoomDelta!==void 0&&(s.zoom=x),u.panDelta!==void 0&&(s.drag=x),u.pitchDelta!==void 0&&(s.pitch=x),u.bearingDelta!==void 0&&(s.rotate=x)}_applyChanges(){const e={},s={},u={};for(const[c,f,x]of this._changes)c.panDelta&&(e.panDelta=(e.panDelta||new y.P(0,0))._add(c.panDelta)),c.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+c.pitchDelta),c.around!==void 0&&(e.around=c.around),c.pinchAround!==void 0&&(e.pinchAround=c.pinchAround),c.noInertia&&(e.noInertia=c.noInertia),y.e(s,f),y.e(u,x);this._updateMapTransform(e,s,u),this._changes=[]}_updateMapTransform(e,s,u){const c=this._map,f=c._getTransformForUpdate(),x=c.terrain;if(!(fr(e)||x&&this._terrainMovement))return this._fireEvents(s,u,!0);let{panDelta:S,zoomDelta:T,bearingDelta:E,pitchDelta:D,around:I,pinchAround:P}=e;P!==void 0&&(I=P),c._stop(!0),I=I||c.transform.centerPoint;const j=f.pointLocation(S?I.sub(S):I);E&&(f.bearing+=E),D&&(f.pitch+=D),T&&(f.zoom+=T),x?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?f.center=f.pointLocation(f.centerPoint.sub(S)):f.setLocationAtPoint(j,I):(this._terrainMovement=!0,this._map._elevationFreeze=!0,f.setLocationAtPoint(j,I)):f.setLocationAtPoint(j,I),c._applyUpdatedTransform(f),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(s,u,!0)}_fireEvents(e,s,u){const c=hi(this._eventsInProgress),f=hi(e),x={};for(const I in e){const{originalEvent:P}=e[I];this._eventsInProgress[I]||(x[`${I}start`]=P),this._eventsInProgress[I]=e[I]}!c&&f&&this._fireEvent("movestart",f.originalEvent);for(const I in x)this._fireEvent(I,x[I]);f&&this._fireEvent("move",f.originalEvent);for(const I in e){const{originalEvent:P}=e[I];this._fireEvent(I,P)}const S={};let T;for(const I in this._eventsInProgress){const{handlerName:P,originalEvent:j}=this._eventsInProgress[I];this._handlersById[P].isActive()||(delete this._eventsInProgress[I],T=s[P]||j,S[`${I}end`]=T)}for(const I in S)this._fireEvent(I,S[I]);const E=hi(this._eventsInProgress),D=(c||f)&&!E;if(D&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const I=this._map._getTransformForUpdate();I.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(I)}if(u&&D){this._updatingCamera=!0;const I=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;!I||!I.essential&&me.prefersReducedMotion?(this._map.fire(new y.k("moveend",{originalEvent:T})),P(this._map.getBearing())&&this._map.resetNorth()):(P(I.bearing||this._map.getBearing())&&(I.bearing=0),I.freezeElevation=!0,this._map.easeTo(I,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(e,s){this._map.fire(new y.k(e,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new Be("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class fu extends y.E{constructor(e,s){super(),this._renderFrameCallback=()=>{const u=Math.min((me.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=s.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new y.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,s){return this.jumpTo({center:e},s)}panBy(e,s,u){return e=y.P.convert(e).mult(-1),this.panTo(this.transform.center,y.e({offset:e},s),u)}panTo(e,s,u){return this.easeTo(y.e({center:e},s),u)}getZoom(){return this.transform.zoom}setZoom(e,s){return this.jumpTo({zoom:e},s),this}zoomTo(e,s,u){return this.easeTo(y.e({zoom:e},s),u)}zoomIn(e,s){return this.zoomTo(this.getZoom()+1,e,s),this}zoomOut(e,s){return this.zoomTo(this.getZoom()-1,e,s),this}getBearing(){return this.transform.bearing}setBearing(e,s){return this.jumpTo({bearing:e},s),this}getPadding(){return this.transform.padding}setPadding(e,s){return this.jumpTo({padding:e},s),this}rotateTo(e,s,u){return this.easeTo(y.e({bearing:e},s),u)}resetNorth(e,s){return this.rotateTo(0,y.e({duration:1e3},e),s),this}resetNorthPitch(e,s){return this.easeTo(y.e({bearing:0,pitch:0,duration:1e3},e),s),this}snapToNorth(e,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,s):this}getPitch(){return this.transform.pitch}setPitch(e,s){return this.jumpTo({pitch:e},s),this}cameraForBounds(e,s){e=xe.convert(e).adjustAntiMeridian();const u=s&&s.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,s)}_cameraForBoxAndBearing(e,s,u,c){const f={top:0,bottom:0,right:0,left:0};if(typeof(c=y.e({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const $e=c.padding;c.padding={top:$e,bottom:$e,right:$e,left:$e}}c.padding=y.e(f,c.padding);const x=this.transform,S=x.padding,T=new xe(e,s),E=x.project(T.getNorthWest()),D=x.project(T.getNorthEast()),I=x.project(T.getSouthEast()),P=x.project(T.getSouthWest()),j=y.ba(-u),q=E.rotate(j),X=D.rotate(j),K=I.rotate(j),J=P.rotate(j),ee=new y.P(Math.max(q.x,X.x,J.x,K.x),Math.max(q.y,X.y,J.y,K.y)),Z=new y.P(Math.min(q.x,X.x,J.x,K.x),Math.min(q.y,X.y,J.y,K.y)),ne=ee.sub(Z),oe=(x.width-(S.left+S.right+c.padding.left+c.padding.right))/ne.x,fe=(x.height-(S.top+S.bottom+c.padding.top+c.padding.bottom))/ne.y;if(fe<0||oe<0)return void y.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const De=Math.min(x.scaleZoom(x.scale*Math.min(oe,fe)),c.maxZoom),Oe=y.P.convert(c.offset),Ge=new y.P((c.padding.left-c.padding.right)/2,(c.padding.top-c.padding.bottom)/2).rotate(y.ba(u)),We=Oe.add(Ge).mult(x.scale/x.zoomScale(De));return{center:x.unproject(E.add(I).div(2).sub(We)),zoom:De,bearing:u}}fitBounds(e,s,u){return this._fitInternal(this.cameraForBounds(e,s),s,u)}fitScreenCoordinates(e,s,u,c,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(y.P.convert(e)),this.transform.pointLocation(y.P.convert(s)),u,c),c,f)}_fitInternal(e,s,u){return e?(delete(s=y.e(e,s)).padding,s.linear?this.easeTo(s,u):this.flyTo(s,u)):this}jumpTo(e,s){this.stop();const u=this._getTransformForUpdate();let c=!1,f=!1,x=!1;return"zoom"in e&&u.zoom!==+e.zoom&&(c=!0,u.zoom=+e.zoom),e.center!==void 0&&(u.center=y.N.convert(e.center)),"bearing"in e&&u.bearing!==+e.bearing&&(f=!0,u.bearing=+e.bearing),"pitch"in e&&u.pitch!==+e.pitch&&(x=!0,u.pitch=+e.pitch),e.padding==null||u.isPaddingEqual(e.padding)||(u.padding=e.padding),this._applyUpdatedTransform(u),this.fire(new y.k("movestart",s)).fire(new y.k("move",s)),c&&this.fire(new y.k("zoomstart",s)).fire(new y.k("zoom",s)).fire(new y.k("zoomend",s)),f&&this.fire(new y.k("rotatestart",s)).fire(new y.k("rotate",s)).fire(new y.k("rotateend",s)),x&&this.fire(new y.k("pitchstart",s)).fire(new y.k("pitch",s)).fire(new y.k("pitchend",s)),this.fire(new y.k("moveend",s))}calculateCameraOptionsFromTo(e,s,u,c=0){const f=y.Z.fromLngLat(e,s),x=y.Z.fromLngLat(u,c),S=x.x-f.x,T=x.y-f.y,E=x.z-f.z,D=Math.hypot(S,T,E);if(D===0)throw new Error("Can't calculate camera options with same From and To");const I=Math.hypot(S,T),P=this.transform.scaleZoom(this.transform.cameraToCenterDistance/D/this.transform.tileSize),j=180*Math.atan2(S,-T)/Math.PI;let q=180*Math.acos(I/D)/Math.PI;return q=E<0?90-q:90+q,{center:x.toLngLat(),zoom:P,pitch:q,bearing:j}}easeTo(e,s){var u;this._stop(!1,e.easeId),((e=y.e({offset:[0,0],duration:500,easing:y.b9},e)).animate===!1||!e.essential&&me.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),f=c.zoom,x=c.bearing,S=c.pitch,T=c.padding,E="bearing"in e?this._normalizeBearing(e.bearing,x):x,D="pitch"in e?+e.pitch:S,I="padding"in e?e.padding:c.padding,P=y.P.convert(e.offset);let j=c.centerPoint.add(P);const q=c.pointLocation(j),{center:X,zoom:K}=c.getConstrained(y.N.convert(e.center||q),(u=e.zoom)!==null&&u!==void 0?u:f);this._normalizeCenter(X,c);const J=c.project(q),ee=c.project(X).sub(J),Z=c.zoomScale(K-f);let ne,oe;e.around&&(ne=y.N.convert(e.around),oe=c.locationPoint(ne));const fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||K!==f,this._rotating=this._rotating||x!==E,this._pitching=this._pitching||D!==S,this._padding=!c.isPaddingEqual(I),this._easeId=e.easeId,this._prepareEase(s,e.noMoveStart,fe),this.terrain&&this._prepareElevation(X),this._ease((De=>{if(this._zooming&&(c.zoom=y.y.number(f,K,De)),this._rotating&&(c.bearing=y.y.number(x,E,De)),this._pitching&&(c.pitch=y.y.number(S,D,De)),this._padding&&(c.interpolatePadding(T,I,De),j=c.centerPoint.add(P)),this.terrain&&!e.freezeElevation&&this._updateElevation(De),ne)c.setLocationAtPoint(ne,oe);else{const Oe=c.zoomScale(c.zoom-f),Ge=K>f?Math.min(2,Z):Math.max(.5,Z),We=Math.pow(Ge,1-De),$e=c.unproject(J.add(ee.mult(De*We)).mult(Oe));c.setLocationAtPoint(c.renderWorldCopies?$e.wrap():$e,j)}this._applyUpdatedTransform(c),this._fireMoveEvents(s)}),(De=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s,De)}),e),this}_prepareEase(e,s,u={}){this._moving=!0,s||u.moving||this.fire(new y.k("movestart",e)),this._zooming&&!u.zooming&&this.fire(new y.k("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new y.k("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new y.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&s!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(s-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=s}this.transform.elevation=y.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const s=e.getCameraPosition(),u=this.terrain.getElevationForLngLatZoom(s.lngLat,e.zoom);if(s.altitude<u){const c=this.calculateCameraOptionsFromTo(s.lngLat,u,e.center,e.elevation);return{pitch:c.pitch,zoom:c.zoom}}return{}}_applyUpdatedTransform(e){const s=[];if(this.terrain&&s.push((c=>this._elevateCameraIfInsideTerrain(c))),this.transformCameraUpdate&&s.push((c=>this.transformCameraUpdate(c))),!s.length)return;const u=e.clone();for(const c of s){const f=u.clone(),{center:x,zoom:S,pitch:T,bearing:E,elevation:D}=c(f);x&&(f.center=x),S!==void 0&&(f.zoom=S),T!==void 0&&(f.pitch=T),E!==void 0&&(f.bearing=E),D!==void 0&&(f.elevation=D),u.apply(f)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new y.k("move",e)),this._zooming&&this.fire(new y.k("zoom",e)),this._rotating&&this.fire(new y.k("rotate",e)),this._pitching&&this.fire(new y.k("pitch",e))}_afterEase(e,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const u=this._zooming,c=this._rotating,f=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new y.k("zoomend",e)),c&&this.fire(new y.k("rotateend",e)),f&&this.fire(new y.k("pitchend",e)),this.fire(new y.k("moveend",e))}flyTo(e,s){var u;if(!e.essential&&me.prefersReducedMotion){const Je=y.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Je,s)}this.stop(),e=y.e({offset:[0,0],speed:1.2,curve:1.42,easing:y.b9},e);const c=this._getTransformForUpdate(),f=c.zoom,x=c.bearing,S=c.pitch,T=c.padding,E="bearing"in e?this._normalizeBearing(e.bearing,x):x,D="pitch"in e?+e.pitch:S,I="padding"in e?e.padding:c.padding,P=y.P.convert(e.offset);let j=c.centerPoint.add(P);const q=c.pointLocation(j),{center:X,zoom:K}=c.getConstrained(y.N.convert(e.center||q),(u=e.zoom)!==null&&u!==void 0?u:f);this._normalizeCenter(X,c);const J=c.zoomScale(K-f),ee=c.project(q),Z=c.project(X).sub(ee);let ne=e.curve;const oe=Math.max(c.width,c.height),fe=oe/J,De=Z.mag();if("minZoom"in e){const Je=y.ac(Math.min(e.minZoom,f,K),c.minZoom,c.maxZoom),zt=oe/c.zoomScale(Je-f);ne=Math.sqrt(zt/De*2)}const Oe=ne*ne;function Ge(Je){const zt=(fe*fe-oe*oe+(Je?-1:1)*Oe*Oe*De*De)/(2*(Je?fe:oe)*Oe*De);return Math.log(Math.sqrt(zt*zt+1)-zt)}function We(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function $e(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const Fe=Ge(!1);let it=function(Je){return $e(Fe)/$e(Fe+ne*Je)},It=function(Je){return oe*(($e(Fe)*(We(zt=Fe+ne*Je)/$e(zt))-We(Fe))/Oe)/De;var zt},Ye=(Ge(!0)-Fe)/ne;if(Math.abs(De)<1e-6||!isFinite(Ye)){if(Math.abs(oe-fe)<1e-6)return this.easeTo(e,s);const Je=fe<oe?-1:1;Ye=Math.abs(Math.log(fe/oe))/ne,It=()=>0,it=zt=>Math.exp(Je*ne*zt)}return e.duration="duration"in e?+e.duration:1e3*Ye/("screenSpeed"in e?+e.screenSpeed/ne:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=x!==E,this._pitching=D!==S,this._padding=!c.isPaddingEqual(I),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(X),this._ease((Je=>{const zt=Je*Ye,Ci=1/it(zt);c.zoom=Je===1?K:f+c.scaleZoom(Ci),this._rotating&&(c.bearing=y.y.number(x,E,Je)),this._pitching&&(c.pitch=y.y.number(S,D,Je)),this._padding&&(c.interpolatePadding(T,I,Je),j=c.centerPoint.add(P)),this.terrain&&!e.freezeElevation&&this._updateElevation(Je);const Gt=Je===1?X:c.unproject(ee.add(Z.mult(It(zt))).mult(Ci));c.setLocationAtPoint(c.renderWorldCopies?Gt.wrap():Gt,j),this._applyUpdatedTransform(c),this._fireMoveEvents(s)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,s){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,s)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,s,u){u.animate===!1||u.duration===0?(e(1),s()):(this._easeStart=me.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,s){e=y.b3(e,-180,180);const u=Math.abs(e-s);return Math.abs(e-360-s)<u&&(e-=360),Math.abs(e+360-s)<u&&(e+=360),e}_normalizeCenter(e,s){if(!s.renderWorldCopies||s.lngRange)return;const u=e.lng-s.center.lng;e.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(y.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const Ln={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Qs{constructor(e=Ln){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=pe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=pe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=pe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){pe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,s){const u=this._map._getUIString(`AttributionControl.${s}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((c=>typeof c!="string"?"":c))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const s=this._map.style.sourceCaches;for(const c in s){const f=s[c];if(f.used||f.usedForTerrain){const x=f.getSource();x.attribution&&e.indexOf(x.attribution)<0&&e.push(x.attribution)}}e=e.filter((c=>String(c).trim())),e.sort(((c,f)=>c.length-f.length)),e=e.filter(((c,f)=>{for(let x=f+1;x<e.length;x++)if(e[x].indexOf(c)>=0)return!1;return!0}));const u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class pu{constructor(e={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=pe.create("div","maplibregl-ctrl");const s=pe.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){pe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class $t{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const s=++this._id;return this._queue.push({callback:e,id:s,cancelled:!1}),s}remove(e){const s=this._currentlyRunning,u=s?this._queue.concat(s):this._queue;for(const c of u)if(c.id===e)return void(c.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const u of s)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Kr=y.Y([{name:"a_pos3d",type:"Int16",components:3}]);class sc extends y.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,s){this.sourceCache.update(e,s),this._renderableTilesKeys=[];const u={};for(const c of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))u[c.key]=!0,this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),y.aP(c.posMatrix,0,y.X,0,y.X,0,1),this._tiles[c.key]=new us(c,this.tileSize));for(const c in this._tiles)u[c]||delete this._tiles[c]}freeRtt(e){for(const s in this._tiles){const u=this._tiles[s];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const s={};for(const u of this._renderableTilesKeys){const c=this._tiles[u].tileID;if(c.canonical.equals(e.canonical)){const f=e.clone();f.posMatrix=new Float64Array(16),y.aP(f.posMatrix,0,y.X,0,y.X,0,1),s[u]=f}else if(c.canonical.isChildOf(e.canonical)){const f=e.clone();f.posMatrix=new Float64Array(16);const x=c.canonical.z-e.canonical.z,S=c.canonical.x-(c.canonical.x>>x<<x),T=c.canonical.y-(c.canonical.y>>x<<x),E=y.X>>x;y.aP(f.posMatrix,0,E,0,E,0,1),y.J(f.posMatrix,f.posMatrix,[-S*E,-T*E,0]),s[u]=f}else if(e.canonical.isChildOf(c.canonical)){const f=e.clone();f.posMatrix=new Float64Array(16);const x=e.canonical.z-c.canonical.z,S=e.canonical.x-(e.canonical.x>>x<<x),T=e.canonical.y-(e.canonical.y>>x<<x),E=y.X>>x;y.aP(f.posMatrix,0,y.X,0,y.X,0,1),y.J(f.posMatrix,f.posMatrix,[S*E,T*E,0]),y.K(f.posMatrix,f.posMatrix,[1/2**x,1/2**x,0]),s[u]=f}}return s}getSourceTile(e,s){const u=this.sourceCache._source;let c=e.overscaledZ-this.deltaZoom;if(c>u.maxzoom&&(c=u.maxzoom),c<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(c).key);let f=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!f||!f.dem)&&s)for(;c>=u.minzoom&&(!f||!f.dem);)f=this.sourceCache.getTileByID(e.scaledTo(c--).key);return f}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter((s=>s.timeAdded>=e))}}class Ws{constructor(e,s,u){this.painter=e,this.sourceCache=new sc(s),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,s,u,c=y.X){var f;if(!(s>=0&&s<c&&u>=0&&u<c))return 0;const x=this.getTerrainData(e),S=(f=x.tile)===null||f===void 0?void 0:f.dem;if(!S)return 0;const T=(function(q,X,K){var J=X[0],ee=X[1];return q[0]=K[0]*J+K[4]*ee+K[12],q[1]=K[1]*J+K[5]*ee+K[13],q})([],[s/c*y.X,u/c*y.X],x.u_terrain_matrix),E=[T[0]*S.dim,T[1]*S.dim],D=Math.floor(E[0]),I=Math.floor(E[1]),P=E[0]-D,j=E[1]-I;return S.get(D,I)*(1-P)*(1-j)+S.get(D+1,I)*P*(1-j)+S.get(D,I+1)*(1-P)*j+S.get(D+1,I+1)*P*j}getElevationForLngLatZoom(e,s){if(!y.bb(s,e.wrap()))return 0;const{tileID:u,mercatorX:c,mercatorY:f}=this._getOverscaledTileIDFromLngLatZoom(e,s);return this.getElevation(u,c%y.X,f%y.X,y.X)}getElevation(e,s,u,c=y.X){return this.getDEMElevation(e,s,u,c)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const c=this.painter.context,f=new y.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Pt(c,f,c.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Pt(c,new y.R({width:1,height:1}),c.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=y.an([])}const s=this.sourceCache.getSourceTile(e,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const c=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new Pt(c,s.dem.getPixels(),c.gl.RGBA,{premultiply:!1}),s.demTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const u=s&&s+s.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){const c=this.sourceCache.sourceCache._source.maxzoom;let f=e.canonical.z-s.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=c?f=e.canonical.z-c:y.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=e.canonical.x-(e.canonical.x>>f<<f),S=e.canonical.y-(e.canonical.y>>f<<f),T=y.bc(new Float64Array(16),[1/(y.X<<f),1/(y.X<<f),0]);y.J(T,T,[x*y.X,S*y.X,0]),this._demMatrixCache[e.key]={matrix:T,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(e){const s=this.painter,u=s.width/devicePixelRatio,c=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===c||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Pt(s.context,{width:u,height:c,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Pt(s.context,{width:u,height:c,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(u,c,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,u,c))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let f=0,x=0;f<this._coordsTextureSize;f++)for(let S=0;S<this._coordsTextureSize;S++,x+=4)s[x+0]=255&S,s[x+1]=255&f,s[x+2]=S>>8<<4|f>>8,s[x+3]=0;const u=new y.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),c=new Pt(e,u,e.gl.RGBA,{premultiply:!1});return c.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=c,c}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),u=this.painter.context,c=u.gl,f=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),c.readPixels(f,S-x-1,1,1,c.RGBA,c.UNSIGNED_BYTE,s),u.bindFramebuffer.set(null);const T=s[0]+(s[2]>>4<<8),E=s[1]+((15&s[2])<<8),D=this.coordsIndex[255-s[3]],I=D&&this.sourceCache.getTileByID(D);if(!I)return null;const P=this._coordsTextureSize,j=(1<<I.tileID.canonical.z)*P;return new y.Z((I.tileID.canonical.x*P+T)/j+I.tileID.wrap,(I.tileID.canonical.y*P+E)/j,this.getElevation(I.tileID,T,E,P))}depthAtPoint(e){const s=new Uint8Array(4),u=this.painter.context,c=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),c.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,c.RGBA,c.UNSIGNED_BYTE,s),u.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,s=new y.bd,u=new y.aY,c=this.meshSize,f=y.X/c,x=c*c;for(let I=0;I<=c;I++)for(let P=0;P<=c;P++)s.emplaceBack(P*f,I*f,0);for(let I=0;I<x;I+=c+1)for(let P=0;P<c;P++)u.emplaceBack(P+I,c+P+I+1,c+P+I+2),u.emplaceBack(P+I,c+P+I+2,P+I+1);const S=s.length,T=S+2*(c+1);for(const I of[0,1])for(let P=0;P<=c;P++)for(const j of[0,1])s.emplaceBack(P*f,I*y.X,j);for(let I=0;I<2*c;I+=2)u.emplaceBack(T+I,T+I+1,T+I+3),u.emplaceBack(T+I,T+I+3,T+I+2),u.emplaceBack(S+I,S+I+3,S+I+1),u.emplaceBack(S+I,S+I+2,S+I+3);const E=s.length,D=E+2*(c+1);for(const I of[0,1])for(let P=0;P<=c;P++)for(const j of[0,1])s.emplaceBack(I*y.X,P*f,j);for(let I=0;I<2*c;I+=2)u.emplaceBack(E+I,E+I+1,E+I+3),u.emplaceBack(E+I,E+I+3,E+I+2),u.emplaceBack(D+I,D+I+3,D+I+1),u.emplaceBack(D+I,D+I+2,D+I+3);return this._mesh=new ms(e.createVertexBuffer(s,Kr.members),e.createIndexBuffer(u),y.a0.simpleSegment(0,0,s.length,u.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*y.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,s){var u;const{tileID:c}=this._getOverscaledTileIDFromLngLatZoom(e,s);return(u=this.getMinMaxElevation(c).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){const s=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return s&&s.dem&&(u.minElevation=s.dem.min*this.exaggeration,u.maxElevation=s.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,s){const u=y.Z.fromLngLat(e.wrap()),c=(1<<s)*y.X,f=u.x*c,x=u.y*c,S=Math.floor(f/y.X),T=Math.floor(x/y.X);return{tileID:new y.S(s,0,s,S,T),mercatorX:f,mercatorY:x}}}class oc{constructor(e,s,u){this._context=e,this._size=s,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new Pt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(u.texture),{id:e,fbo:s,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((s=>e.id!==s)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const Gn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ir{constructor(e,s){this.painter=e,this.terrain=s,this.pool=new oc(e.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((u=>!e._layers[u].isHidden(s))),this._coordsDescendingInv={};for(const u in e.sourceCaches){this._coordsDescendingInv[u]={};const c=e.sourceCaches[u].getVisibleCoordinates();for(const f of c){const x=this.terrain.sourceCache.getTerrainCoords(f);for(const S in x)this._coordsDescendingInv[u][S]||(this._coordsDescendingInv[u][S]=[]),this._coordsDescendingInv[u][S].push(x[S])}}this._coordsDescendingInvStr={};for(const u of e._order){const c=e._layers[u],f=c.source;if(Gn[c.type]&&!this._coordsDescendingInvStr[f]){this._coordsDescendingInvStr[f]={};for(const x in this._coordsDescendingInv[f])this._coordsDescendingInvStr[f][x]=this._coordsDescendingInv[f][x].map((S=>S.key)).sort().join()}}for(const u of this._renderableTiles)for(const c in this._coordsDescendingInvStr){const f=this._coordsDescendingInvStr[c][u.tileID.key];f&&f!==u.rttCoords[c]&&(u.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const s=e.type,u=this.painter,c=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Gn[s]&&(this._prevType&&Gn[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(e.id),!c))return!0;if(Gn[this._prevType]||Gn[s]&&c){this._prevType=s;const f=this._stacks.length-1,x=this._stacks[f]||[];for(const S of this._renderableTiles){if(this.pool.isFull()&&(nu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(S),S.rtt[f]){const E=this.pool.getObjectForId(S.rtt[f].id);if(E.stamp===S.rtt[f].stamp){this.pool.useObject(E);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),S.rtt[f]={id:T.id,stamp:T.stamp},u.context.bindFramebuffer.set(T.fbo.framebuffer),u.context.clear({color:y.aM.transparent,stencil:0}),u.currentStencilSource=void 0;for(let E=0;E<x.length;E++){const D=u.style._layers[x[E]],I=D.source?this._coordsDescendingInv[D.source][S.tileID.key]:[S.tileID];u.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),u._renderTileClippingMasks(D,I),u.renderLayer(u,u.style.sourceCaches[D.source],D,I),D.source&&(S.rttCoords[D.source]=this._coordsDescendingInvStr[D.source][S.tileID.key])}}return nu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Gn[s]}return!1}}const kr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Rr=Ue,lc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ln,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:y.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},wl=p=>{p.touchstart=p.dragStart,p.touchmoveWindow=p.dragMove,p.touchend=p.dragEnd},Oo={showCompass:!0,showZoom:!0,visualizePitch:!1};class mu{constructor(e,s,u=!1){this.mousedown=x=>{this.startMouse(y.e({},x,{ctrlKey:!0,preventDefault:()=>x.preventDefault()}),pe.mousePos(this.element,x)),pe.addEventListener(window,"mousemove",this.mousemove),pe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.moveMouse(x,pe.mousePos(this.element,x))},this.mouseup=x=>{this.mouseRotate.dragEnd(x),this.mousePitch&&this.mousePitch.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=pe.touchPos(this.element,x.targetTouches)[0],this.startTouch(x,this._startPos),pe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=pe.touchPos(this.element,x.targetTouches)[0],this.moveTouch(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const c=e.dragRotate._mouseRotate.getClickTolerance(),f=e.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=lu({clickTolerance:c,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:S,bearingDegreesPerPixelMoved:T=.8})=>{const E=new xl;return new wn({clickTolerance:S,move:(D,I)=>({bearingDelta:(I.x-D.x)*T}),moveStateManager:E,enable:x,assignEvents:wl})})({clickTolerance:c,enable:!0}),this.map=e,u&&(this.mousePitch=Ro({clickTolerance:f,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:S,pitchDegreesPerPixelMoved:T=-.5})=>{const E=new xl;return new wn({clickTolerance:S,move:(D,I)=>({pitchDelta:(I.y-D.y)*T}),moveStateManager:E,enable:x,assignEvents:wl})})({clickTolerance:f,enable:!0})),pe.addEventListener(s,"mousedown",this.mousedown),pe.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),pe.addEventListener(s,"touchcancel",this.reset)}startMouse(e,s){this.mouseRotate.dragStart(e,s),this.mousePitch&&this.mousePitch.dragStart(e,s),pe.disableDrag()}startTouch(e,s){this.touchRotate.dragStart(e,s),this.touchPitch&&this.touchPitch.dragStart(e,s),pe.disableDrag()}moveMouse(e,s){const u=this.map,{bearingDelta:c}=this.mouseRotate.dragMove(e,s)||{};if(c&&u.setBearing(u.getBearing()+c),this.mousePitch){const{pitchDelta:f}=this.mousePitch.dragMove(e,s)||{};f&&u.setPitch(u.getPitch()+f)}}moveTouch(e,s){const u=this.map,{bearingDelta:c}=this.touchRotate.dragMove(e,s)||{};if(c&&u.setBearing(u.getBearing()+c),this.touchPitch){const{pitchDelta:f}=this.touchPitch.dragMove(e,s)||{};f&&u.setPitch(u.getPitch()+f)}}off(){const e=this.element;pe.removeEventListener(e,"mousedown",this.mousedown),pe.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.removeEventListener(window,"touchend",this.touchend),pe.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){pe.enableDrag(),pe.removeEventListener(window,"mousemove",this.mousemove),pe.removeEventListener(window,"mouseup",this.mouseup),pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.removeEventListener(window,"touchend",this.touchend)}}let Ra;function Qt(p,e,s){const u=new y.N(p.lng,p.lat);if(p=new y.N(p.lng,p.lat),e){const c=new y.N(p.lng-360,p.lat),f=new y.N(p.lng+360,p.lat),x=s.locationPoint(p).distSqr(e);s.locationPoint(c).distSqr(e)<x?p=c:s.locationPoint(f).distSqr(e)<x&&(p=f)}for(;Math.abs(p.lng-s.center.lng)>180;){const c=s.locationPoint(p);if(c.x>=0&&c.y>=0&&c.x<=s.width&&c.y<=s.height)break;p.lng>s.center.lng?p.lng-=360:p.lng+=360}return p.lng!==u.lng&&s.locationPoint(p).y>s.height/2-s.getHorizon()?p:u}const Jr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Sl(p,e,s){const u=p.classList;for(const c in Jr)u.remove(`maplibregl-${s}-anchor-${c}`);u.add(`maplibregl-${s}-anchor-${e}`)}class gu extends y.E{constructor(e){if(super(),this._onKeyPress=s=>{const u=s.code,c=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&c!==32&&c!==13||this.togglePopup()},this._onMapClick=s=>{const u=s.originalEvent.target,c=this._element;this._popup&&(u===c||c.contains(u))&&this.togglePopup()},this._update=s=>{var u;if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Qt(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),pe.setTransform(this._element,`${Jr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${f}`),me.frameAsync(new AbortController).then((()=>{this._updateOpacity(s&&s.type==="moveend")})).catch((()=>{}))},this._onMove=s=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new y.k("dragstart"))),this.fire(new y.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new y.k("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=y.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=pe.create("div");const s=pe.createNS("http://www.w3.org/2000/svg","svg"),u=41,c=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${u}px`),s.setAttributeNS(null,"width",`${c}px`),s.setAttributeNS(null,"viewBox",`0 0 ${c} ${u}`);const f=pe.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");const x=pe.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const S=pe.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const J of T){const ee=pe.createNS("http://www.w3.org/2000/svg","ellipse");ee.setAttributeNS(null,"opacity","0.04"),ee.setAttributeNS(null,"cx","10.5"),ee.setAttributeNS(null,"cy","5.80029008"),ee.setAttributeNS(null,"rx",J.rx),ee.setAttributeNS(null,"ry",J.ry),S.appendChild(ee)}const E=pe.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const D=pe.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(D);const I=pe.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"opacity","0.25"),I.setAttributeNS(null,"fill","#000000");const P=pe.createNS("http://www.w3.org/2000/svg","path");P.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),I.appendChild(P);const j=pe.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(6.0, 7.0)"),j.setAttributeNS(null,"fill","#FFFFFF");const q=pe.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const X=pe.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#000000"),X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"cx","5.5"),X.setAttributeNS(null,"cy","5.5"),X.setAttributeNS(null,"r","5.4999962");const K=pe.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#FFFFFF"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962"),q.appendChild(X),q.appendChild(K),x.appendChild(S),x.appendChild(E),x.appendChild(I),x.appendChild(j),x.appendChild(q),s.appendChild(x),s.setAttributeNS(null,"height",u*this._scale+"px"),s.setAttributeNS(null,"width",c*this._scale+"px"),this._element.appendChild(s),this._offset=y.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(s=>{s.preventDefault()})),this._element.addEventListener("mousedown",(s=>{s.preventDefault()})),Sl(this._element,this._anchor,"marker"),e&&e.className)for(const s of e.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),pe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=y.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const c=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(38.1-13.5+c)],"bottom-right":[-c,-1*(38.1-13.5+c)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var s,u;if(!(!((s=this._map)===null||s===void 0)&&s.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const c=this._map,f=c.terrain.depthAtPoint(this._pos),x=c.terrain.getElevationForLngLatZoom(this._lngLat,c.transform.tileZoom);if(c.transform.lngLatToCameraDepth(this._lngLat,x)-f<.006)return void(this._element.style.opacity=this._opacity);const S=-this._offset.y/c.transform._pixelPerMeter,T=Math.sin(c.getPitch()*Math.PI/180)*S,E=c.terrain.depthAtPoint(new y.P(this._pos.x,this._pos.y-this._offset.y)),D=c.transform.lngLatToCameraDepth(this._lngLat,x+T)-E>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&D&&this._popup.remove(),this._element.style.opacity=D?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=y.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,s){return e===void 0&&s===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const ch={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Tl=0,aa=!1;const Hn={maxWidth:100,unit:"metric"};function Qr(p,e,s){const u=s&&s.maxWidth||100,c=p._container.clientHeight/2,f=p.unproject([0,c]),x=p.unproject([u,c]),S=f.distanceTo(x);if(s&&s.unit==="imperial"){const T=3.2808*S;T>5280?st(e,u,T/5280,p._getUIString("ScaleControl.Miles")):st(e,u,T,p._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?st(e,u,S/1852,p._getUIString("ScaleControl.NauticalMiles")):S>=1e3?st(e,u,S/1e3,p._getUIString("ScaleControl.Kilometers")):st(e,u,S,p._getUIString("ScaleControl.Meters"))}function st(p,e,s,u){const c=(function(f){const x=Math.pow(10,`${Math.floor(f)}`.length-1);let S=f/x;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:(function(T){const E=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*E)/E})(S),x*S})(s);p.style.width=e*(c/s)+"px",p.innerHTML=`${c}&nbsp;${u}`}const wt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Wr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function es(p){if(p){if(typeof p=="number"){const e=Math.round(Math.abs(p)/Math.SQRT2);return{center:new y.P(0,0),top:new y.P(0,p),"top-left":new y.P(e,e),"top-right":new y.P(-e,e),bottom:new y.P(0,-p),"bottom-left":new y.P(e,-e),"bottom-right":new y.P(-e,-e),left:new y.P(p,0),right:new y.P(-p,0)}}if(p instanceof y.P||Array.isArray(p)){const e=y.P.convert(p);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:y.P.convert(p.center||[0,0]),top:y.P.convert(p.top||[0,0]),"top-left":y.P.convert(p["top-left"]||[0,0]),"top-right":y.P.convert(p["top-right"]||[0,0]),bottom:y.P.convert(p.bottom||[0,0]),"bottom-left":y.P.convert(p["bottom-left"]||[0,0]),"bottom-right":y.P.convert(p["bottom-right"]||[0,0]),left:y.P.convert(p.left||[0,0]),right:y.P.convert(p.right||[0,0])}}return es(new y.P(0,0))}const uc=Ue;O.AJAXError=y.bh,O.Evented=y.E,O.LngLat=y.N,O.MercatorCoordinate=y.Z,O.Point=y.P,O.addProtocol=y.bi,O.config=y.a,O.removeProtocol=y.bj,O.AttributionControl=Qs,O.BoxZoomHandler=tn,O.CanvasSource=Fn,O.CooperativeGesturesHandler=ma,O.DoubleClickZoomHandler=nn,O.DragPanHandler=cu,O.DragRotateHandler=hu,O.EdgeInsets=hr,O.FullscreenControl=class extends y.E{constructor(p={}){super(),this._onFullscreenChange=()=>{var e;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=s==null?void 0:s.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:y.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){pe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=pe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);pe.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new y.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new y.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},O.GeoJSONSource=Ds,O.GeolocateControl=class extends y.E{constructor(p){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new y.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new y.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const s=new y.N(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,c=this._map.getBearing(),f=y.e({bearing:c},this.options.fitBoundsOptions),x=xe.fromLngLat(s,u);this._map.fitBounds(x,f,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const s=new y.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&aa)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new y.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=pe.create("button","maplibregl-ctrl-geolocate",this._container),pe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){y.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new gu({element:this._dotElement}),this._circleElement=pe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new y.k("trackuserlocationend")),this.fire(new y.k("userlocationlostfocus")))}))}},this.options=y.e({},ch,p)}onAdd(p){return this._map=p,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return y._(this,arguments,void 0,(function*(e=!1){if(Ra!==void 0&&!e)return Ra;if(window.navigator.permissions===void 0)return Ra=!!window.navigator.geolocation,Ra;try{Ra=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ra=!!window.navigator.geolocation}return Ra}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),pe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Tl=0,aa=!1}_isOutOfMapMaxBounds(p){const e=this._map.getMaxBounds(),s=p.coords;return e&&(s.longitude<e.getWest()||s.longitude>e.getEast()||s.latitude<e.getSouth()||s.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),e=p.getSouthEast(),s=p.getNorthEast(),u=e.distanceTo(s),c=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}trigger(){if(!this._setup)return y.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new y.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Tl--,aa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new y.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new y.k("trackuserlocationstart")),this.fire(new y.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Tl++,Tl>1?(p={maximumAge:6e5,timeout:0},aa=!0):(p=this.options.positionOptions,aa=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},O.Hash=yl,O.ImageSource=Fr,O.KeyboardHandler=la,O.LngLatBounds=xe,O.LogoControl=pu,O.Map=class extends fu{constructor(p){y.bf.mark(y.bg.create);const e=Object.assign(Object.assign({},lc),p);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new $s(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new $t,this._controls=[],this._mapId=y.a4(),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new y.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new y.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},kr),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=dt.addThrottleControl((()=>this.isMoving())),this._requestManager=new ft(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const u=dr((c=>{this._trackResize&&!this._removed&&(this.resize(c),this.redraw())}),50);this._resizeObserver=new ResizeObserver((c=>{s?u(c):s=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Tn(this,e),this._hash=e.hash&&new yl(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,y.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Qs(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new pu,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(s=>{this._update(s.dataType==="style"),this.fire(new y.k(`${s.dataType}data`,s))})),this.on("dataloading",(s=>{this.fire(new y.k(`${s.dataType}dataloading`,s))})),this.on("dataabort",(s=>{this.fire(new y.k("sourcedataabort",s))}))}_getMapId(){return this._mapId}addControl(p,e){if(e===void 0&&(e=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new y.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=p.onAdd(this);this._controls.push(p);const u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(s,u.firstChild):u.appendChild(s),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new y.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(p);return e>-1&&this._controls.splice(e,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,e,s,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,e,s,u)}resize(p){var e;const s=this._containerDimensions(),u=s[0],c=s[1],f=this._getClampedPixelRatio(u,c);if(this._resizeCanvas(u,c,f),this.painter.resize(u,c,f),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const T=this._getClampedPixelRatio(u,c);this._resizeCanvas(u,c,T),this.painter.resize(u,c,T)}this.transform.resize(u,c),(e=this._requestedCameraState)===null||e===void 0||e.resize(u,c);const x=!this._moving;return x&&(this.stop(),this.fire(new y.k("movestart",p)).fire(new y.k("move",p))),this.fire(new y.k("resize",p)),x&&this.fire(new y.k("moveend",p)),this}_getClampedPixelRatio(p,e){const{0:s,1:u}=this._maxCanvasSize,c=this.getPixelRatio(),f=p*c,x=e*c;return Math.min(f>s?s/f:1,x>u?u/x:1)*c}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(xe.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}project(p){return this.transform.locationPoint(y.N.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.pointLocation(y.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,e,s){if(p==="mouseenter"||p==="mouseover"){let u=!1;return{layers:e,listener:s,delegates:{mousemove:f=>{const x=e.filter((T=>this.getLayer(T))),S=x.length!==0?this.queryRenderedFeatures(f.point,{layers:x}):[];S.length?u||(u=!0,s.call(this,new Ji(p,this,f.originalEvent,{features:S}))):u=!1},mouseout:()=>{u=!1}}}}if(p==="mouseleave"||p==="mouseout"){let u=!1;return{layers:e,listener:s,delegates:{mousemove:x=>{const S=e.filter((T=>this.getLayer(T)));(S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[]).length?u=!0:u&&(u=!1,s.call(this,new Ji(p,this,x.originalEvent)))},mouseout:x=>{u&&(u=!1,s.call(this,new Ji(p,this,x.originalEvent)))}}}}{const u=c=>{const f=e.filter((S=>this.getLayer(S))),x=f.length!==0?this.queryRenderedFeatures(c.point,{layers:f}):[];x.length&&(c.features=x,s.call(this,c),delete c.features)};return{layers:e,listener:s,delegates:{[p]:u}}}}_saveDelegatedListener(p,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(e)}_removeDelegatedListener(p,e,s){if(!this._delegatedListeners||!this._delegatedListeners[p])return;const u=this._delegatedListeners[p];for(let c=0;c<u.length;c++){const f=u[c];if(f.listener===s&&f.layers.length===e.length&&f.layers.every((x=>e.includes(x)))){for(const x in f.delegates)this.off(x,f.delegates[x]);return void u.splice(c,1)}}}on(p,e,s){if(s===void 0)return super.on(p,e);const u=this._createDelegatedListener(p,typeof e=="string"?[e]:e,s);this._saveDelegatedListener(p,u);for(const c in u.delegates)this.on(c,u.delegates[c]);return this}once(p,e,s){if(s===void 0)return super.once(p,e);const u=typeof e=="string"?[e]:e,c=this._createDelegatedListener(p,u,s);for(const f in c.delegates){const x=c.delegates[f];c.delegates[f]=(...S)=>{this._removeDelegatedListener(p,u,s),x(...S)}}this._saveDelegatedListener(p,c);for(const f in c.delegates)this.once(f,c.delegates[f]);return this}off(p,e,s){return s===void 0?super.off(p,e):(this._removeDelegatedListener(p,typeof e=="string"?[e]:e,s),this)}queryRenderedFeatures(p,e){if(!this.style)return[];let s;const u=p instanceof y.P||Array.isArray(p),c=u?p:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:p)||{},c instanceof y.P||typeof c[0]=="number")s=[y.P.convert(c)];else{const f=y.P.convert(c[0]),x=y.P.convert(c[1]);s=[f,new y.P(x.x,f.y),x,new y.P(f.x,x.y),f]}return this.style.queryRenderedFeatures(s,e,this.transform)}querySourceFeatures(p,e){return this.style.querySourceFeatures(p,e)}setStyle(p,e){return(e=y.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(p,e))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const e=this._locale[p];if(e==null)throw new Error(`Missing UI string '${p}'`);return e}_updateStyle(p,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(p,e)));const s=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new Ul(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,e,s):this.style.loadJSON(p,e,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ul(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,e){if(typeof p=="string"){const s=this._requestManager.transformRequest(p,"Style");y.h(s,new AbortController).then((u=>{this._updateDiff(u.data,e)})).catch((u=>{u&&this.fire(new y.j(u))}))}else typeof p=="object"&&this._updateDiff(p,e)}_updateDiff(p,e){try{this.style.setState(p,e)&&this._update(!0)}catch(s){y.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(p,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():y.w("There is no style added to the map.")}addSource(p,e){return this._lazyInitEmptyStyle(),this.style.addSource(p,e),this._update(!0)}isSourceLoaded(p){const e=this.style&&this.style.sourceCaches[p];if(e!==void 0)return e.loaded();this.fire(new y.j(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const e=this.style.sourceCaches[p.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);this.terrain===null&&e.reload();for(const s in this.style._layers){const u=this.style._layers[s];u.type==="hillshade"&&u.source===p.source&&y.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ws(this.painter,e,p),this.painter.renderToTexture=new Ir(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==p.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new y.k("terrain",{terrain:p})),this}getTerrain(){var p,e;return(e=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const e in p){const s=p[e]._tiles;for(const u in s){const c=s[u];if(c.state!=="loaded"&&c.state!=="errored")return!1}}return!0}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,e,s={}){const{pixelRatio:u=1,sdf:c=!1,stretchX:f,stretchY:x,content:S,textFitWidth:T,textFitHeight:E}=s;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||y.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new y.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:D,height:I,data:P}=e,j=e;return this.style.addImage(p,{data:new y.R({width:D,height:I},new Uint8Array(P)),pixelRatio:u,stretchX:f,stretchY:x,content:S,textFitWidth:T,textFitHeight:E,sdf:c,version:0,userImage:j}),j.onAdd&&j.onAdd(this,p),this}}{const{width:D,height:I,data:P}=me.getImageData(e);this.style.addImage(p,{data:new y.R({width:D,height:I},P),pixelRatio:u,stretchX:f,stretchY:x,content:S,textFitWidth:T,textFitHeight:E,sdf:c,version:0})}}updateImage(p,e){const s=this.style.getImage(p);if(!s)return this.fire(new y.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=e instanceof HTMLImageElement||y.b(e)?me.getImageData(e):e,{width:c,height:f,data:x}=u;if(c===void 0||f===void 0)return this.fire(new y.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(c!==s.data.width||f!==s.data.height)return this.fire(new y.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(e instanceof HTMLImageElement||y.b(e));return s.data.replace(x,S),this.style.updateImage(p,s),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new y.j(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p){return dt.getImage(this._requestManager.transformRequest(p,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(p,e){return this._lazyInitEmptyStyle(),this.style.addLayer(p,e),this._update(!0)}moveLayer(p,e){return this.style.moveLayer(p,e),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,e,s){return this.style.setLayerZoomRange(p,e,s),this._update(!0)}setFilter(p,e,s={}){return this.style.setFilter(p,e,s),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,e,s,u={}){return this.style.setPaintProperty(p,e,s,u),this._update(!0)}getPaintProperty(p,e){return this.style.getPaintProperty(p,e)}setLayoutProperty(p,e,s,u={}){return this.style.setLayoutProperty(p,e,s,u),this._update(!0)}getLayoutProperty(p,e){return this.style.getLayoutProperty(p,e)}setGlyphs(p,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,e,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,e,s,(u=>{u||this._update(!0)})),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,e,(s=>{s||this._update(!0)})),this}setLight(p,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(p){return this._lazyInitEmptyStyle(),this.style.setSky(p),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(p,e){return this.style.setFeatureState(p,e),this._update()}removeFeatureState(p,e){return this.style.removeFeatureState(p,e),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,e=0;return this._container&&(p=this._container.clientWidth||400,e=this._container.clientHeight||300),[p,e]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const e=this._canvasContainer=pe.create("div","maplibregl-canvas-container",p);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=pe.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),u=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],u);const c=this._controlContainer=pe.create("div","maplibregl-control-container",p),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((x=>{f[x]=pe.create("div",`maplibregl-ctrl-${x} `,c)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,e,s){this._canvas.width=Math.floor(s*p),this._canvas.height=Math.floor(s*e),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const p={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",(u=>{e={requestedAttributes:p},u&&(e.statusMessage=u.statusMessage,e.type=u.type)}),{once:!0});const s=this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p);if(!s){const u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new Io(s,this.transform),Ii.testSupport(s)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const c=this.transform.zoom,f=me.now();this.style.zoomHistory.update(c,f);const x=new y.z(c,{now:f,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),S=x.crossFadingFactor();S===1&&S===this._crossFadingFactor||(s=!0,this._crossFadingFactor=S),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new y.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,y.bf.mark(y.bg.load),this.fire(new y.k("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new y.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,y.bf.mark(y.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),dt.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),pe.remove(this._canvasContainer),pe.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),y.bf.clearMetrics(),this._removed=!0,this.fire(new y.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,me.frameAsync(this._frameRequest).then((p=>{y.bf.frame(p),this._frameRequest=null,this._render(p)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return Rr}getCameraTargetElevation(){return this.transform.elevation}},O.MapMouseEvent=Ji,O.MapTouchEvent=Cr,O.MapWheelEvent=kn,O.Marker=gu,O.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const e=this._map.getZoom(),s=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,s)=>{const u=this._map._getUIString(`NavigationControl.${s}`);e.title=u,e.setAttribute("aria-label",u)},this.options=y.e({},Oo,p),this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),pe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),pe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=pe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new mu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){pe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,e){const s=pe.create("button",p,this._container);return s.type="button",s.addEventListener("click",e),s}},O.Popup=class extends y.E{constructor(p){super(),this.remove=()=>(this._content&&pe.remove(this._content),this._container&&(pe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new y.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var s;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=pe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=pe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Qt(this._lngLat,this._flatPos,this._map.transform):(s=this._lngLat)===null||s===void 0?void 0:s.wrap(),this._trackPointer&&!e)return;const u=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let c=this.options.anchor;const f=es(this.options.offset);if(!c){const S=this._container.offsetWidth,T=this._container.offsetHeight;let E;E=u.y+f.bottom.y<T?["top"]:u.y>this._map.transform.height-T?["bottom"]:[],u.x<S/2?E.push("left"):u.x>this._map.transform.width-S/2&&E.push("right"),c=E.length===0?"bottom":E.join("-")}let x=u.add(f[c]);this.options.subpixelPositioning||(x=x.round()),pe.setTransform(this._container,`${Jr[c]} translate(${x.x}px,${x.y}px)`),Sl(this._container,c,"popup")},this._onClose=()=>{this.remove()},this.options=y.e(Object.create(wt),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new y.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=y.N.convert(p),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const e=document.createDocumentFragment(),s=document.createElement("body");let u;for(s.innerHTML=p;u=s.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=pe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){return this._container&&this._container.classList.add(p),this}removeClassName(p){return this._container&&this._container.classList.remove(p),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}setSubpixelPositioning(p){this.options.subpixelPositioning=p}_createCloseButton(){this.options.closeButton&&(this._closeButton=pe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Wr);p&&p.focus()}},O.RasterDEMTileSource=ea,O.RasterTileSource=pi,O.ScaleControl=class{constructor(p){this._onMove=()=>{Qr(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Qr(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Hn),p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){pe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},O.ScrollZoomHandler=Ea,O.Style=Ul,O.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=p}onAdd(p){return this._map=p,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=pe.create("button","maplibregl-ctrl-terrain",this._container),pe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){pe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},O.TwoFingersTouchPitchHandler=ys,O.TwoFingersTouchRotateHandler=gs,O.TwoFingersTouchZoomHandler=uu,O.TwoFingersTouchZoomRotateHandler=du,O.VectorTileSource=mo,O.VideoSource=Pa,O.addSourceType=(p,e)=>y._(void 0,void 0,void 0,(function*(){if(yo(p))throw new Error(`A source type called "${p}" already exists.`);((s,u)=>{go[s]=u})(p,e)})),O.clearPrewarmedResources=function(){const p=Ot;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(et),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},O.getMaxParallelImageRequests=function(){return y.a.MAX_PARALLEL_IMAGE_REQUESTS},O.getRTLTextPluginStatus=function(){return Sr().getRTLTextPluginStatus()},O.getVersion=function(){return uc},O.getWorkerCount=function(){return lt.workerCount},O.getWorkerUrl=function(){return y.a.WORKER_URL},O.importScriptInWorkers=function(p){return ss().broadcast("IS",p)},O.prewarm=function(){Ai().acquire(et)},O.setMaxParallelImageRequests=function(p){y.a.MAX_PARALLEL_IMAGE_REQUESTS=p},O.setRTLTextPlugin=function(p,e){return Sr().setRTLTextPlugin(p,e)},O.setWorkerCount=function(p){lt.workerCount=p},O.setWorkerUrl=function(p){y.a.WORKER_URL=p}}));var Mt=Tt;return Mt}))})(hp)),hp.exports}var Sm=wm();const Dp=kp(Sm),Tm="https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",am={blue:"#007AFF",purple:"#5856D6",orange:"#FF9500",teal:"#5AC8FA",green:"#34C759"},Jp=[],Am="GeoJSON/china_provinces.geojson",zm="GeoJSON/china_cities_v2.geojson",Em="GeoJSON/Countries/CHN/ADM0.geojson",Mm=({visits:Ce,settings:Et,onVisitSelect:Tt,selectedVisitId:ue,isPicking:_t,onMapClick:Mt})=>{const O=oi.useRef(null),y=oi.useRef(null),[Ue,Ee]=oi.useState(!1),ht=oi.useRef(new Set),me=oi.useRef(Ce),pe=oi.useRef(Tt),Ii=oi.useRef(_t),ki=oi.useRef(Mt);oi.useEffect(()=>{me.current=Ce},[Ce]),oi.useEffect(()=>{pe.current=Tt},[Tt]),oi.useEffect(()=>{Ii.current=_t},[_t]),oi.useEffect(()=>{ki.current=Mt},[Mt]),oi.useEffect(()=>{y.current&&(y.current.getCanvas().style.cursor=_t?"crosshair":"")},[_t]),oi.useEffect(()=>y.current||!O.current?void 0:((async()=>{try{console.log("Initializing MapLibre..."),y.current=new Dp.Map({container:O.current,style:Tm,center:[105,35],zoom:3,projection:"globe",pitch:0,attributionControl:!1,cooperativeGestures:!0}),y.current.addControl(new Dp.AttributionControl({compact:!0}),"bottom-right"),y.current.addControl(new Dp.NavigationControl({showCompass:!0,showZoom:!0}),"top-right"),y.current.on("load",()=>{console.log("Map loaded successfully"),Ee(!0)}),y.current.on("click",Ct=>{if(Ii.current&&ki.current){ki.current(Ct.lngLat.lat,Ct.lngLat.lng);return}}),y.current.on("error",Ct=>{console.warn("MapLibre runtime warning/error:",Ct)})}catch(Ct){console.error("Error initializing map:",Ct)}})(),()=>{y.current&&(y.current.remove(),y.current=null)}),[]),oi.useEffect(()=>{if(!y.current||!Ue)return;const Ut=async qt=>{var ni,vi,Si,Pt,Vi,Ti;if(ht.current.has(qt)||qt==="CHN")return;console.log(`Loading data for country: ${qt}`),ht.current.add(qt);const dt=[0,1,2],ft=[0,4,6],Ht=[4,6,24],Zt=(ni=y.current)==null?void 0:ni.getStyle();let ot;if((vi=y.current)!=null&&vi.getLayer("footprint-heat"))ot="footprint-heat";else for(const li of(Zt==null?void 0:Zt.layers)||[])if(li.type==="symbol"){ot=li.id;break}for(let li=0;li<dt.length;li++){const mt=dt[li],ge=`source-${qt}-${mt}`,He=`GeoJSON/Countries/${qt}/ADM${mt}.geojson`;try{const gt=await fetch(He);if(!gt.ok)throw new Error(`HTTP ${gt.status}`);const Ne=await gt.json();if(!((Si=y.current)!=null&&Si.getSource(ge))){const nt=mt===0?"shapeGroup":"shapeName";(Pt=y.current)==null||Pt.addSource(ge,{type:"geojson",data:Ne,promoteId:nt}),(Vi=y.current)==null||Vi.addLayer({id:`layer-${qt}-${mt}-fill`,type:"fill",source:ge,minzoom:ft[li],maxzoom:Ht[li],paint:{"fill-color":Et.themeColor,"fill-opacity":["case",["boolean",["feature-state","visited"],!1],["interpolate",["linear"],["feature-state","intensity"],0,0,1,.8],0]}},ot),(Ti=y.current)==null||Ti.addLayer({id:`layer-${qt}-${mt}-line`,type:"line",source:ge,minzoom:ft[li],maxzoom:Ht[li],paint:{"line-color":Et.themeColor,"line-width":1,"line-opacity":.3}},ot)}}catch(gt){console.warn(`Failed to load ${He}:`,gt)}}ti()},Ct=new Set;Ce.forEach(qt=>{qt.regionCode&&qt.regionCode.split(",").forEach(ft=>{const Ht=ft.trim();Ht.length===3&&/^[A-Z]{3}$/.test(Ht)&&Ct.add(Ht)})}),Ct.forEach(qt=>Ut(qt))},[Ce,Ue,Et.themeColor]);const ti=tm.useCallback(()=>{if(!y.current)return;const Ut="china-provinces",Ct="china-cities",qt="china-country",dt={};Ce.forEach(ft=>{if(ft.regionCode){const Ht=ft.regionCode.split(",");Ht.forEach(ot=>{const ni=ot.trim();ni&&(dt[ni]=(dt[ni]||0)+ft.count)}),Ht.some(ot=>/[\u4e00-\u9fa5]/.test(ot))&&(dt.CHN=(dt.CHN||0)+ft.count)}}),console.log("Updating region states:",dt),Object.entries(dt).forEach(([ft,Ht])=>{const Zt=Math.min(.2+Ht*.05,.9),ot=ni=>{var vi,Si;try{(vi=y.current)!=null&&vi.getSource(ni)&&((Si=y.current)!=null&&Si.isSourceLoaded(ni))&&y.current.setFeatureState({source:ni,id:ft},{visited:!0,intensity:Zt})}catch{}};ot(qt),ot(Ut),ot(Ct),ht.current.forEach(ni=>{[0,1,2].forEach(vi=>{var Pt,Vi;const Si=`source-${ni}-${vi}`;try{(Pt=y.current)!=null&&Pt.getSource(Si)&&((Vi=y.current)!=null&&Vi.isSourceLoaded(Si))&&y.current.setFeatureState({source:Si,id:ft},{visited:!0,intensity:Zt})}catch{}})})})},[Ce]);return oi.useEffect(()=>{if(!y.current||!Ue)return;const Ut=y.current.getStyle();if(!Ut||!Ut.layers)return;const Ct=Ut.layers;let qt;for(const ft of Ct)if(ft.type==="symbol"){qt=ft.id;break}const dt=(ft,Ht,Zt,ot,ni="name")=>{y.current.getSource(ft)||(y.current.addSource(ft,{type:"geojson",data:Ht,promoteId:ni}),y.current.addLayer({id:`${ft}-fill`,type:"fill",source:ft,minzoom:Zt,maxzoom:ot,paint:{"fill-color":Et.themeColor,"fill-opacity":["case",["boolean",["feature-state","visited"],!1],["interpolate",["linear"],["feature-state","intensity"],0,0,1,.8],0]}},qt),y.current.addLayer({id:`${ft}-line`,type:"line",source:ft,minzoom:Zt,maxzoom:ot,paint:{"line-color":Et.themeColor,"line-width":1,"line-opacity":.3}},qt))};dt("china-country",Em,0,4,"shapeGroup"),dt("china-provinces",Am,4,6,"name"),dt("china-cities",zm,6,24,"name"),ti()},[Ue,Et,Ce,ti]),oi.useEffect(()=>{if(!y.current||!Ue)return;const Ut=Ct=>{Ct.isSourceLoaded&&(Ct.sourceId.startsWith("china-")||Ct.sourceId.startsWith("source-"))&&ti()};return y.current.on("sourcedata",Ut),()=>{var Ct;(Ct=y.current)==null||Ct.off("sourcedata",Ut)}},[Ue,ti]),oi.useEffect(()=>{if(!y.current||!Ue)return;const Ut={type:"FeatureCollection",features:Ce.map(dt=>({type:"Feature",geometry:{type:"Point",coordinates:[dt.longitude,dt.latitude]},properties:{id:dt.id,name:dt.name,count:dt.count}}))},Ct="footprint-points";let qt=y.current.getSource(Ct);qt?qt.setData(Ut):(y.current.addSource(Ct,{type:"geojson",data:Ut}),y.current.addLayer({id:"footprint-circles",type:"circle",source:Ct,minzoom:3,paint:{"circle-radius":["interpolate",["linear"],["zoom"],3,4,15,12],"circle-color":Et.themeColor,"circle-stroke-color":"#ffffff","circle-stroke-width":2,"circle-opacity":["interpolate",["linear"],["get","count"],1,.6,10,1]}}),y.current.on("click","footprint-circles",dt=>{if(!Ii.current&&dt.features&&dt.features[0]){const Ht=dt.features[0].properties,Zt=me.current.find(ot=>ot.id===Ht.id);pe.current(Zt||null),Zt&&y.current&&y.current.flyTo({center:[Zt.longitude,Zt.latitude],zoom:10,essential:!0})}}),y.current.on("mouseenter","footprint-circles",()=>y.current.getCanvas().style.cursor="pointer"),y.current.on("mouseleave","footprint-circles",()=>y.current.getCanvas().style.cursor="")),y.current.getLayer("footprint-circles")&&y.current.setPaintProperty("footprint-circles","circle-color",Et.themeColor)},[Ue,Et,Ce]),oi.useEffect(()=>{if(y.current&&ue){const Ut=Ce.find(Ct=>Ct.id===ue);Ut&&y.current.flyTo({center:[Ut.longitude,Ut.latitude],zoom:12,essential:!0,speed:1.2})}},[ue,Ce]),Te.jsx("div",{ref:O,className:"w-full h-full"})},Cm=({user:Ce,visits:Et,groups:Tt,settings:ue,onLogin:_t,onLogout:Mt,onAddVisit:O,onUpdateSettings:y,onSelectVisit:Ue,selectedVisitId:Ee,onDeleteVisit:ht,onCreateGroup:me,onDeleteGroup:pe,onBatchDeleteVisits:Ii,onBatchGroupVisits:ki})=>{const[ti,Ut]=oi.useState("places"),[Ct,qt]=oi.useState(!1),[dt,ft]=oi.useState(new Set),[Ht,Zt]=oi.useState(""),[ot,ni]=oi.useState(!1),vi=Et.reduce((mt,ge)=>mt+ge.count,0),Si=oi.useMemo(()=>{const mt={ungrouped:[]};return Tt.forEach(ge=>mt[ge.id]=[]),Et.forEach(ge=>{ge.groupId&&mt[ge.groupId]?mt[ge.groupId].push(ge):mt.ungrouped.push(ge)}),mt},[Et,Tt]),Pt=mt=>{const ge=new Set(dt);ge.has(mt)?ge.delete(mt):ge.add(mt),ft(ge)},Vi=()=>{Ii(Array.from(dt)),ft(new Set),qt(!1)},Ti=mt=>{ki(Array.from(dt),mt),ft(new Set),qt(!1)},li=mt=>{mt.preventDefault(),Ht.trim()&&(me(Ht,"#000000"),Zt(""),ni(!1))};return Te.jsxs("div",{className:"flex flex-col h-full bg-white/80 backdrop-blur-xl border-r border-white/20 shadow-2xl text-slate-800",children:[Te.jsxs("div",{className:"p-6 pb-2",children:[Te.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Te.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Footprint"}),Ce?Te.jsxs("div",{className:"relative group",children:[Te.jsx("img",{src:Ce.avatarUrl,alt:"User",className:"w-10 h-10 rounded-full border-2 border-white shadow-sm cursor-pointer"}),Te.jsx("button",{onClick:Mt,className:"absolute right-0 top-12 bg-white/90 backdrop-blur-md shadow-lg rounded-lg px-4 py-2 text-sm text-red-500 hidden group-hover:block whitespace-nowrap z-50 border border-gray-100",children:"Log Out"})]}):Te.jsx("button",{onClick:_t,className:"bg-black text-white px-4 py-1.5 rounded-full text-sm font-medium hover:bg-gray-800 transition-colors",children:"Sign In"})]}),Ce&&Te.jsx("div",{className:"bg-gradient-to-br from-gray-100 to-white p-4 rounded-2xl shadow-sm border border-white mb-6",children:Te.jsxs("div",{className:"flex justify-between text-center",children:[Te.jsxs("div",{children:[Te.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Et.length}),Te.jsx("div",{className:"text-xs text-gray-500 uppercase font-semibold tracking-wider",children:"Places"})]}),Te.jsxs("div",{children:[Te.jsx("div",{className:"text-2xl font-bold text-gray-900",children:vi}),Te.jsx("div",{className:"text-xs text-gray-500 uppercase font-semibold tracking-wider",children:"Check-ins"})]}),Te.jsxs("div",{children:[Te.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Math.floor(vi/5)+1}),Te.jsx("div",{className:"text-xs text-gray-500 uppercase font-semibold tracking-wider",children:"Level"})]})]})}),Te.jsxs("div",{className:"flex space-x-1 bg-gray-200/50 p-1 rounded-xl mb-4",children:[Te.jsx("button",{onClick:()=>Ut("places"),className:`flex-1 py-1.5 text-sm font-medium rounded-lg transition-all ${ti==="places"?"bg-white shadow-sm text-black":"text-gray-500 hover:text-gray-700"}`,children:"My Places"}),Te.jsx("button",{onClick:()=>Ut("settings"),className:`flex-1 py-1.5 text-sm font-medium rounded-lg transition-all ${ti==="settings"?"bg-white shadow-sm text-black":"text-gray-500 hover:text-gray-700"}`,children:"Settings"})]})]}),Te.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-20 custom-scrollbar relative",children:[ti==="places"&&Te.jsxs("div",{className:"space-y-6",children:[Te.jsx("div",{className:"flex gap-2",children:Ct?Te.jsxs("div",{className:"flex-1 flex gap-2 items-center justify-between bg-blue-50 p-2 rounded-xl border border-blue-100",children:[Te.jsxs("span",{className:"text-sm font-medium text-blue-700 px-2",children:[dt.size," Selected"]}),Te.jsx("button",{onClick:()=>{qt(!1),ft(new Set)},className:"text-xs bg-white text-gray-600 px-3 py-1.5 rounded-lg shadow-sm hover:bg-gray-50",children:"Cancel"})]}):Te.jsxs(Te.Fragment,{children:[Te.jsxs("button",{onClick:()=>O("current"),disabled:!Ce,className:"flex-1 py-3 border-2 border-dashed border-gray-300 rounded-2xl text-gray-400 font-medium hover:border-gray-400 hover:bg-gray-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-xs",children:[Te.jsx("i",{className:"fa-solid fa-location-crosshairs"}),"Current"]}),Te.jsxs("button",{onClick:()=>O("custom"),disabled:!Ce,className:"flex-1 py-3 border-2 border-dashed border-gray-300 rounded-2xl text-gray-400 font-medium hover:border-gray-400 hover:bg-gray-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-xs",children:[Te.jsx("i",{className:"fa-solid fa-map-pin"}),"Custom"]}),Te.jsxs("button",{onClick:()=>O("pick"),disabled:!Ce,className:"flex-1 py-3 border-2 border-dashed border-gray-300 rounded-2xl text-gray-400 font-medium hover:border-gray-400 hover:bg-gray-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-xs",children:[Te.jsx("i",{className:"fa-solid fa-crosshairs"}),"Pick"]}),Te.jsx("button",{onClick:()=>qt(!0),disabled:!Ce||Et.length===0,className:"px-3 py-3 border-2 border-dashed border-gray-300 rounded-2xl text-gray-400 font-medium hover:border-gray-400 hover:bg-gray-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",title:"Batch Select",children:Te.jsx("i",{className:"fa-solid fa-check-double"})})]})}),Si.ungrouped.length>0&&Te.jsxs("div",{children:[Te.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-1",children:"Uncategorized"}),Te.jsx("div",{className:"space-y-3",children:Si.ungrouped.map(mt=>Te.jsx(Qp,{visit:mt,isBatchMode:Ct,isSelected:dt.has(mt.id),onToggle:()=>Pt(mt.id),selectedVisitId:Ee,onSelectVisit:Ue,onDeleteVisit:ht},mt.id))})]}),Tt.map(mt=>{var ge,He;return Te.jsxs("div",{children:[Te.jsxs("div",{className:"flex items-center justify-between mb-3 px-1 group",children:[Te.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:mt.name}),Te.jsx("button",{onClick:()=>{confirm(`Delete group "${mt.name}"? Visits will be ungrouped.`)&&pe(mt.id)},className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:Te.jsx("i",{className:"fa-solid fa-trash-can text-xs"})})]}),Te.jsxs("div",{className:"space-y-3",children:[(ge=Si[mt.id])==null?void 0:ge.map(gt=>Te.jsx(Qp,{visit:gt,isBatchMode:Ct,isSelected:dt.has(gt.id),onToggle:()=>Pt(gt.id),selectedVisitId:Ee,onSelectVisit:Ue,onDeleteVisit:ht},gt.id)),((He=Si[mt.id])==null?void 0:He.length)===0&&Te.jsx("p",{className:"text-xs text-gray-400 italic px-2",children:"No visits in this group"})]})]},mt.id)}),Ce&&Te.jsx("div",{className:"pt-4 border-t border-gray-100",children:ot?Te.jsxs("form",{onSubmit:li,className:"flex gap-2",children:[Te.jsx("input",{type:"text",autoFocus:!0,placeholder:"Group Name",className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-xl outline-none focus:border-blue-300",value:Ht,onChange:mt=>Zt(mt.target.value)}),Te.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-3 rounded-xl text-xs font-medium",children:"Add"}),Te.jsx("button",{type:"button",onClick:()=>ni(!1),className:"text-gray-400 px-2 hover:text-gray-600",children:Te.jsx("i",{className:"fa-solid fa-xmark"})})]}):Te.jsx("button",{onClick:()=>ni(!0),className:"w-full py-2 border-2 border-dashed border-gray-200 rounded-xl text-gray-400 text-xs font-medium hover:border-gray-300 hover:text-gray-500 transition-all",children:"+ Create New Group"})})]}),ti==="settings"&&Te.jsxs("div",{className:"space-y-6 pt-2",children:[Te.jsxs("section",{children:[Te.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Map Theme"}),Te.jsx("div",{className:"flex gap-3",children:Object.entries(am).map(([mt,ge])=>Te.jsx("button",{onClick:()=>y({...ue,themeColor:ge}),className:`w-8 h-8 rounded-full shadow-sm transition-transform hover:scale-110 ring-2 ring-offset-2 ${ue.themeColor===ge?"ring-gray-400 scale-110":"ring-transparent"}`,style:{backgroundColor:ge},"aria-label":`Select ${mt} theme`},mt))})]}),Te.jsx("section",{className:"space-y-4",children:Te.jsxs("div",{className:"flex items-center justify-between",children:[Te.jsx("span",{className:"text-sm font-medium",children:"Heatmap Visualization"}),Te.jsx("button",{onClick:()=>y({...ue,showHeatmap:!ue.showHeatmap}),className:`w-12 h-7 rounded-full transition-colors relative ${ue.showHeatmap?"bg-green-500":"bg-gray-300"}`,children:Te.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md absolute top-1 transition-all ${ue.showHeatmap?"left-6":"left-1"}`})})]})}),Te.jsxs("section",{children:[Te.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Data"}),Te.jsxs("button",{className:"w-full text-left px-4 py-3 bg-white rounded-xl text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors mb-2",children:[Te.jsx("i",{className:"fa-solid fa-download mr-2 text-gray-400"}),"Export GeoJSON"]}),Te.jsxs("button",{className:"w-full text-left px-4 py-3 bg-white rounded-xl text-sm font-medium text-red-600 hover:bg-red-50 transition-colors",children:[Te.jsx("i",{className:"fa-solid fa-trash mr-2 text-red-400"}),"Clear All History"]})]})]})]}),Ct&&dt.size>0&&Te.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-gray-900 text-white p-3 rounded-xl shadow-xl z-20 flex items-center justify-between animate-slide-up",children:[Te.jsxs("span",{className:"text-xs font-medium pl-2",children:[dt.size," items"]}),Te.jsxs("div",{className:"flex gap-2",children:[Te.jsxs("div",{className:"relative group",children:[Te.jsx("button",{className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-xs font-medium transition-colors",children:"Move to..."}),Te.jsxs("div",{className:"absolute bottom-full right-0 mb-2 w-40 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden hidden group-hover:block text-gray-800",children:[Tt.map(mt=>Te.jsx("button",{onClick:()=>Ti(mt.id),className:"w-full text-left px-4 py-2 text-xs hover:bg-gray-50 border-b border-gray-50 last:border-0",children:mt.name},mt.id)),Te.jsx("button",{onClick:()=>Ti(""),className:"w-full text-left px-4 py-2 text-xs hover:bg-gray-50 text-gray-500",children:"Uncategorized"})]})]}),Te.jsx("button",{onClick:Vi,className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 rounded-lg text-xs font-medium transition-colors",children:"Delete"})]})]})]})},Qp=({visit:Ce,isBatchMode:Et,isSelected:Tt,onToggle:ue,selectedVisitId:_t,onSelectVisit:Mt,onDeleteVisit:O})=>Te.jsxs("div",{onClick:()=>{Et?ue():Mt(Ce.id)},className:`p-4 rounded-2xl transition-all cursor-pointer border relative group select-none ${_t===Ce.id?"bg-white shadow-md border-blue-200 ring-2 ring-blue-100":Tt?"bg-blue-50 border-blue-200":"bg-white/50 hover:bg-white border-transparent hover:shadow-sm"}`,children:[Te.jsxs("div",{className:"flex items-start gap-3",children:[Et&&Te.jsx("div",{className:`mt-1 w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ${Tt?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:Tt&&Te.jsx("i",{className:"fa-solid fa-check text-white text-[10px]"})}),Te.jsx("div",{className:"flex-1 min-w-0",children:Te.jsxs("div",{className:"flex justify-between items-start",children:[Te.jsxs("div",{children:[Te.jsx("h3",{className:"font-semibold text-gray-900 truncate pr-6",children:Ce.name}),Te.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:new Date(Ce.timestamp).toLocaleDateString()}),Ce.note&&Te.jsxs("p",{className:"text-xs text-gray-400 mt-1 italic truncate",children:['"',Ce.note,'"']})]}),Te.jsxs("div",{className:"bg-gray-100 px-2 py-1 rounded-lg text-xs font-bold text-gray-600 flex-shrink-0",children:["x",Ce.count]})]})})]}),!Et&&Te.jsx("button",{onClick:y=>{y.stopPropagation(),O(Ce.id)},className:"absolute bottom-2 right-2 p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-xl opacity-0 group-hover:opacity-100 transition-all",title:"Delete visit",children:Te.jsx("i",{className:"fa-solid fa-trash-can"})})]}),Wp=({isOpen:Ce,onClose:Et,title:Tt,children:ue})=>{if(!Ce)return null;const _t=Mt=>{Mt.stopPropagation()};return Te.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm animate-fade-in",onClick:Et,children:Te.jsxs("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden animate-scale-up border border-white/40",onClick:_t,children:[Te.jsxs("div",{className:"px-6 py-4 border-b border-gray-200/50 flex justify-between items-center",children:[Te.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:Tt}),Te.jsx("button",{onClick:Et,className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:Te.jsx("i",{className:"fa-solid fa-xmark text-gray-500"})})]}),Te.jsx("div",{className:"p-6",children:ue})]})})},Dm="GeoJSON/china_provinces.geojson",Im="GeoJSON/china_cities_v2.geojson",km="GeoJSON/world_lowres.geojson";let lp=null,up=null,cp=null;async function Rm(){if(lp)return lp;try{const Ce=await fetch(Dm);if(!Ce.ok)throw new Error("Failed to fetch province data");return lp=await Ce.json(),lp}catch(Ce){return console.error("Failed to load province data",Ce),{type:"FeatureCollection",features:[]}}}async function Lm(){if(up)return up;try{const Ce=await fetch(Im);if(!Ce.ok)throw new Error("Failed to fetch city data");return up=await Ce.json(),up}catch(Ce){return console.error("Failed to load city data",Ce),{type:"FeatureCollection",features:[]}}}async function Bm(){if(cp)return cp;try{const Ce=await fetch(km);if(!Ce.ok)throw new Error("Failed to fetch world data");return cp=await Ce.json(),cp}catch(Ce){return console.error("Failed to load world data",Ce),{type:"FeatureCollection",features:[]}}}function em(Ce,Et){const Tt=Ce[0],ue=Ce[1];let _t=!1;for(let Mt=0,O=Et.length-1;Mt<Et.length;O=Mt++){const y=Et[Mt][0],Ue=Et[Mt][1],Ee=Et[O][0],ht=Et[O][1];Ue>ue!=ht>ue&&Tt<(Ee-y)*(ue-Ue)/(ht-Ue)+y&&(_t=!_t)}return _t}async function Ip(Ce,Et){const Tt=[Ce,Et],ue=[],_t=(Mt,O,y="name")=>{for(const Ue of Mt.features){const{geometry:Ee}=Ue;if(!Ee)continue;let ht=!1;if(Ee.type==="Polygon")em(Tt,Ee.coordinates[0])&&(ht=!0);else if(Ee.type==="MultiPolygon"){for(const me of Ee.coordinates)if(em(Tt,me[0])){ht=!0;break}}if(ht){const me=Ue.properties[y]||Ue.id;me&&(console.log(`Found in ${O}: ${me}`),ue.push(me))}}};try{const[Mt,O]=await Promise.all([Rm(),Lm()]);if(_t(Mt,"Province","name"),_t(O,"City","name"),ue.length===0){const y=await Bm();if(_t(y,"Country","id"),ue.length>0){const Ue=ue[0];console.log(`Detected Country: ${Ue}, checking sub-regions...`);try{const[Ee,ht]=await Promise.allSettled([fetch(`GeoJSON/Countries/${Ue}/ADM1.geojson`),fetch(`GeoJSON/Countries/${Ue}/ADM2.geojson`)]);if(Ee.status==="fulfilled"&&Ee.value.ok)try{const me=await Ee.value.json();_t(me,"Global District","shapeName")}catch(me){console.warn("Failed to parse ADM1",me)}if(ht.status==="fulfilled"&&ht.value.ok)try{const me=await ht.value.json();_t(me,"Global Municipality","shapeName")}catch(me){console.warn("Failed to parse ADM2",me)}}catch(Ee){console.warn(`Failed to load sub-regions for ${Ue}`,Ee)}}}ue.length===0&&console.log("No regions found for point:",Tt)}catch(Mt){console.error("Error loading GeoJSON for region detection",Mt)}return ue}const Ms="https://footlogin.finderskys.online",Pm=()=>{const[Ce,Et]=oi.useState(null),[Tt,ue]=oi.useState([]),[_t,Mt]=oi.useState([]),[O,y]=oi.useState({themeColor:am.blue,opacity:.8,showHeatmap:!0});oi.useEffect(()=>{Ce?(fetch(`${Ms}/api/visits?googleId=${Ce.id}`).then(Ne=>Ne.json()).then(Ne=>{Array.isArray(Ne)&&ue(Ne)}).catch(Ne=>console.error("Failed to load visits",Ne)),fetch(`${Ms}/api/groups`).then(Ne=>Ne.json()).then(Ne=>{Array.isArray(Ne)&&Mt(Ne)}).catch(Ne=>console.error("Failed to load groups",Ne))):(ue(Jp),Mt([]))},[Ce]);const[Ue,Ee]=oi.useState(null),[ht,me]=oi.useState(!0),[pe,Ii]=oi.useState(!1),[ki,ti]=oi.useState(!1),[Ut,Ct]=oi.useState(window.innerWidth<768),[qt,dt]=oi.useState(!1),[ft,Ht]=oi.useState(null),[Zt,ot]=oi.useState(!1);oi.useEffect(()=>{const Ne=()=>{const nt=window.innerWidth<768;Ct(nt),nt&&me(!1)};return window.addEventListener("resize",Ne),()=>window.removeEventListener("resize",Ne)},[]);const ni=Ne=>{if(Ne&&Ne.preventDefault(),!Ne){setTimeout(()=>{},800);return}const nt=new FormData(Ne.currentTarget),Q=nt.get("email"),be=nt.get("password"),et=nt.get("isRegister")==="true"?`${Ms}/api/register`:`${Ms}/api/login`;fetch(et,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:Q,password:be})}).then(async lt=>{const Lt=await lt.json();if(!lt.ok)throw new Error(Lt.error||"Auth failed");return Lt}).then(lt=>{Et(lt.user),Ii(!1)}).catch(lt=>{alert(lt.message)})};oi.useEffect(()=>{fetch(`${Ms}/api/session`).then(Ne=>{if(Ne.ok)return Ne.json();throw new Error("No session")}).then(Ne=>Et(Ne.user)).catch(()=>Et(null))},[]);const vi=()=>{fetch(`${Ms}/api/logout`,{method:"POST"}).then(()=>{Et(null),ue(Jp)})},Si=Ne=>{Ce&&fetch(`${Ms}/api/visits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({googleId:Ce.id,visit:Ne})}).catch(nt=>console.error("Failed to save visit",nt))},Pt=Ne=>{Ce&&confirm("Are you sure you want to delete this visit?")&&fetch(`${Ms}/api/visits/${Ne}`,{method:"DELETE"}).then(nt=>{if(nt.ok)ue(Q=>Q.filter(be=>be.id!==Ne)),Ue===Ne&&Ee(null);else throw new Error("Failed to delete")}).catch(nt=>alert(nt.message))},Vi=Ne=>{Ce&&confirm(`Are you sure you want to delete ${Ne.length} visits?`)&&fetch(`${Ms}/api/visits/batch-delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitIds:Ne})}).then(nt=>{if(nt.ok)ue(Q=>Q.filter(be=>!Ne.includes(be.id))),Ue&&Ne.includes(Ue)&&Ee(null);else throw new Error("Failed to batch delete")}).catch(nt=>alert(nt.message))},Ti=(Ne,nt)=>{Ce&&fetch(`${Ms}/api/groups`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ne,color:nt})}).then(Q=>Q.json()).then(Q=>{Mt(be=>[...be,Q])}).catch(Q=>console.error(Q))},li=Ne=>{Ce&&fetch(`${Ms}/api/groups/${Ne}`,{method:"DELETE"}).then(nt=>{nt.ok&&(Mt(Q=>Q.filter(be=>be.id!==Ne)),ue(Q=>Q.map(be=>be.groupId===Ne?{...be,groupId:void 0}:be)))})},mt=(Ne,nt)=>{Ce&&fetch(`${Ms}/api/visits/batch-group`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitIds:Ne,groupId:nt})}).then(Q=>{Q.ok&&ue(be=>be.map(qe=>Ne.includes(qe.id)?{...qe,groupId:nt}:qe))}).catch(Q=>console.error(Q))},ge=oi.useCallback(Ne=>{if(Ne==="custom"){Ht(null),ti(!0);return}if(Ne==="pick"){dt(!0),Ut&&me(!1);return}if(!navigator.geolocation){alert("Geolocation is not supported by your browser");return}navigator.geolocation.getCurrentPosition(async nt=>{const Q=nt.coords.latitude,be=nt.coords.longitude,qe={id:Date.now().toString(),name:`Current Location ${Tt.length+1}`,latitude:Q,longitude:be,timestamp:Date.now(),count:1,regionCode:void 0,note:"Just visited!"};ue(et=>[qe,...et]),Ee(qe.id),Ut&&me(!1),Ip(be,Q).then(et=>{const lt=et.join(",");lt?(ue(Lt=>Lt.map(Ot=>Ot.id===qe.id?{...Ot,regionCode:lt}:Ot)),Si({...qe,regionCode:lt})):Si(qe)})},nt=>{console.error("Error getting location",nt),alert("Unable to retrieve your location. Please ensure permission is granted.")})},[Tt.length,Ut,Ce]),He=oi.useCallback((Ne,nt)=>{qt&&(dt(!1),Ht({lat:Ne,lng:nt,regionCode:""}),ti(!0),Ut&&me(!0),ot(!0),Ip(nt,Ne).then(Q=>{Ht(be=>!be||be.lat!==Ne||be.lng!==nt?be:{...be,regionCode:Q.join(",")}),ot(!1)}).catch(()=>ot(!1)))},[qt,Ut]),gt=async Ne=>{Ne.preventDefault();const nt=new FormData(Ne.currentTarget),Q=nt.get("name"),be=parseFloat(nt.get("latitude")),qe=parseFloat(nt.get("longitude"));let et=nt.get("regionCode");const lt={id:Date.now().toString(),name:Q||`Location ${Tt.length+1}`,latitude:be,longitude:qe,timestamp:Date.now(),count:1,regionCode:et||void 0,note:"Manual entry"};ue(Lt=>[lt,...Lt]),et?Si(lt):(Si(lt),Ip(qe,be).then(Lt=>{const Ot=Lt.join(",");Ot&&(ue(qi=>qi.map(Ai=>Ai.id===lt.id?{...Ai,regionCode:Ot}:Ai)),Si({...lt,regionCode:Ot}))})),Ee(lt.id),ti(!1),Ut&&me(!1)};return Te.jsxs("div",{className:"relative w-full h-full flex overflow-hidden bg-gray-50",children:[Te.jsx("div",{className:`fixed inset-y-0 left-0 z-20 w-80 transform transition-transform duration-300 ease-in-out ${ht?"translate-x-0":"-translate-x-full"} md:relative md:translate-x-0 md:w-96 flex-shrink-0`,children:Te.jsx(Cm,{user:Ce,visits:Tt,groups:_t,settings:O,onLogin:()=>Ii(!0),onLogout:vi,onAddVisit:ge,onDeleteVisit:Pt,onUpdateSettings:y,onSelectVisit:Ee,selectedVisitId:Ue,onCreateGroup:Ti,onDeleteGroup:li,onBatchDeleteVisits:Vi,onBatchGroupVisits:mt})}),Te.jsxs("div",{className:"flex-1 relative h-full",children:[Te.jsx("button",{onClick:()=>me(!ht),className:"md:hidden absolute top-4 left-4 z-10 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center text-gray-700 hover:bg-gray-50",children:Te.jsx("i",{className:`fa-solid ${ht?"fa-times":"fa-bars"}`})}),Te.jsx(Mm,{visits:Tt,settings:O,onVisitSelect:Ne=>{Ee((Ne==null?void 0:Ne.id)||null),Ne&&Ut&&me(!0)},selectedVisitId:Ue,isPicking:qt,onMapClick:He}),qt&&Te.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-black/80 text-white px-4 py-2 rounded-full text-sm font-medium shadow-lg z-30 pointer-events-none",children:"Click on the map to select location"}),qt&&Te.jsx("button",{onClick:()=>dt(!1),className:"absolute top-4 right-4 bg-white text-black px-4 py-2 rounded-full text-sm font-medium shadow-lg z-30 hover:bg-gray-100",children:"Cancel"})]}),Te.jsx(Wp,{isOpen:pe,onClose:()=>Ii(!1),title:"Sign In / Register",children:Te.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Te.jsx("p",{className:"text-gray-600 text-center text-sm mb-2",children:"Sign in to sync your footprint across devices."}),Te.jsxs("form",{onSubmit:ni,className:"w-full space-y-3",children:[Te.jsx("input",{type:"hidden",name:"isRegister",value:"false",id:"isRegisterInput"}),Te.jsx("input",{type:"email",name:"email",required:!0,placeholder:"Email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}),Te.jsx("input",{type:"password",name:"password",required:!0,placeholder:"Password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}),Te.jsxs("div",{className:"flex gap-2",children:[Te.jsx("button",{type:"submit",onClick:()=>{document.getElementById("isRegisterInput").value="false"},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-xl transition-all shadow-sm",children:"Sign In"}),Te.jsx("button",{type:"submit",onClick:()=>{document.getElementById("isRegisterInput").value="true"},className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-xl transition-all shadow-sm",children:"Register"})]})]}),Te.jsxs("div",{className:"relative w-full py-2",children:[Te.jsx("div",{className:"absolute inset-0 flex items-center",children:Te.jsx("span",{className:"w-full border-t border-gray-200"})}),Te.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:Te.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Or"})})]}),Te.jsxs("button",{onClick:()=>ni(),className:"w-full flex items-center justify-center gap-3 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-semibold py-2.5 px-4 rounded-xl transition-all shadow-sm",children:[Te.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google",className:"w-5 h-5"}),"Continue with Google (Mock)"]})]})}),Te.jsx(Wp,{isOpen:ki,onClose:()=>ti(!1),title:"Add Custom Location",children:Te.jsxs("form",{onSubmit:gt,className:"space-y-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location Name"}),Te.jsx("input",{type:"text",name:"name",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Eiffel Tower"})]}),Te.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),Te.jsx("input",{type:"number",name:"latitude",step:"any",required:!0,defaultValue:ft==null?void 0:ft.lat,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"48.8584"},ft!=null&&ft.lat?`lat-${ft.lat}`:"lat-empty")]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),Te.jsx("input",{type:"number",name:"longitude",step:"any",required:!0,defaultValue:ft==null?void 0:ft.lng,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"2.2945"},ft!=null&&ft.lng?`lng-${ft.lng}`:"lng-empty")]})]}),Te.jsxs("div",{children:[Te.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Region Name (Optional)",Zt&&Te.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-blue-500 text-xs"})]}),Te.jsx("input",{type:"text",name:"regionCode",defaultValue:ft==null?void 0:ft.regionCode,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:Zt?"Detecting region...":"e.g. Paris or le-de-France"},ft!=null&&ft.regionCode?`region-${ft.regionCode}`:"region-empty"),Te.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used to highlight the region on map."})]}),Te.jsx("button",{type:"submit",className:"w-full bg-black text-white font-semibold py-2.5 rounded-xl hover:bg-gray-800 transition-all mt-2",children:"Add Location"})]})}),ht&&Ut&&Te.jsx("div",{className:"fixed inset-0 bg-black/20 z-10 backdrop-blur-sm md:hidden",onClick:()=>me(!1)})]})},nm=document.getElementById("root");if(!nm)throw new Error("Could not find root element to mount to");const Om=xm.createRoot(nm);Om.render(Te.jsx(tm.StrictMode,{children:Te.jsx(Pm,{})}));
